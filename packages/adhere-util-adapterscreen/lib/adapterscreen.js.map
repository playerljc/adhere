{"version":3,"file":"adapterscreen.js","sources":["adapterscreen.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar currRenderDom = '';\nvar currentRectification = '';\nvar currentRectificationLevel = -1;\nvar resizeListener = function () { };\nvar timer;\nvar currScale = 1;\nvar isAutoFitRunning = false;\nvar isElRectification = false;\nfunction elRectification(el, level) {\n    if (level === void 0) { level = 1; }\n    if (!isAutoFitRunning) {\n        console.error('adapterScreen.js：adapterScreen has not been initialized yet');\n    }\n    !el && console.error(\"adapterScreen.js\\uFF1Abad selector: \".concat(el));\n    currentRectification = el;\n    currentRectificationLevel = level;\n    var currEl = document.querySelectorAll(el);\n    if (currEl.length == 0) {\n        console.error('adapterScreen.js：elRectification found no element');\n        return;\n    }\n    for (var _i = 0, _a = Array.from(currEl); _i < _a.length; _i++) {\n        var item = _a[_i];\n        if (!isElRectification) {\n            // @ts-ignore\n            item.originalWidth = item.clientWidth;\n            // @ts-ignore\n            item.originalHeight = item.clientHeight;\n        }\n        var rectification = currScale == 1 ? 1 : currScale * level;\n        // @ts-ignore\n        item.style.width = \"\".concat(item.originalWidth * rectification, \"px\");\n        // @ts-ignore\n        item.style.height = \"\".concat(item.originalHeight * rectification, \"px\");\n        item.style.transform = \"scale(\".concat(1 / currScale, \")\");\n        item.style.transformOrigin = \"0 0\";\n    }\n    isElRectification = true;\n}\nfunction keepFit(dw, dh, dom, ignore) {\n    var clientHeight = document.documentElement.clientHeight;\n    var clientWidth = document.documentElement.clientWidth;\n    currScale = clientWidth / clientHeight < dw / dh ? clientWidth / dw : clientHeight / dh;\n    dom.style.height = \"\".concat(clientHeight / currScale, \"px\");\n    dom.style.width = \"\".concat(clientWidth / currScale, \"px\");\n    dom.style.transform = \"scale(\".concat(currScale, \")\");\n    for (var _i = 0, ignore_1 = ignore; _i < ignore_1.length; _i++) {\n        var item = ignore_1[_i];\n        var ignoreStyle = document.querySelector('#ignoreStyle');\n        var itemEl = item.el || item.dom;\n        if (!itemEl) {\n            console.error(\"adapterScreen: bad selector: \".concat(itemEl));\n            continue;\n        }\n        var realScale = item.scale ? item.scale : 1 / currScale;\n        var realFontSize = realScale != currScale ? item.fontSize : 'autofit';\n        var realWidth = realScale != currScale ? item.width : 'autofit';\n        var realHeight = realScale != currScale ? item.height : 'autofit';\n        var regex = new RegExp(\"\".concat(itemEl, \"( |{)\"), 'gm');\n        var isIgnored = regex.test((ignoreStyle === null || ignoreStyle === void 0 ? void 0 : ignoreStyle.innerHTML) || '');\n        if (isIgnored) {\n            continue;\n        }\n        if (ignoreStyle) {\n            ignoreStyle.innerHTML += \"\\n\".concat(itemEl, \" { \\n        transform: scale(\").concat(realScale, \")!important;\\n        transform-origin: 0 0;\\n        width: \").concat(realWidth, \"px!important;\\n        height: \").concat(realHeight, \"px!important;\\n      }\");\n            ignoreStyle.innerHTML += \"\\n\".concat(itemEl, \" div ,\").concat(itemEl, \" span,\").concat(itemEl, \" a,\").concat(itemEl, \" * {\\n        font-size: \").concat(realFontSize, \"px;\\n        }\");\n        }\n    }\n}\nvar adapterScreen = {\n    init: function (defaultDefaultOptions, isShowInitTip) {\n        if (defaultDefaultOptions === void 0) { defaultDefaultOptions = {}; }\n        if (isShowInitTip === void 0) { isShowInitTip = true; }\n        if (isShowInitTip) {\n            console.log(\"%c\" + \"adapterScreen.js\" + \" is running\", \"font-weight: bold; color: #ffb712; background:linear-gradient(-45deg, #bd34fe 50%, #47caff 50% );background: -webkit-linear-gradient( 120deg, #bd34fe 30%, #41d1ff );background-clip: text;-webkit-background-clip: text; -webkit-text-fill-color:linear-gradient( -45deg, #bd34fe 50%, #47caff 50% ); padding: 8px 12px; border-radius: 4px;\");\n        }\n        var options = {\n            designWidth: 1920,\n            dw: 1920,\n            designHeight: 929,\n            dh: 929,\n            renderDom: typeof defaultDefaultOptions === 'string' ? defaultDefaultOptions : '#app',\n            el: typeof defaultDefaultOptions === 'string' ? defaultDefaultOptions : '#app',\n            resize: true,\n            ignore: [],\n            transition: 'none',\n            delay: 0,\n        };\n        var designWidth = options.designWidth, dw = options.dw, designHeight = options.designHeight, dh = options.dh, renderDom = options.renderDom, el = options.el, resize = options.resize, ignore = options.ignore, transition = options.transition, delay = options.delay;\n        currRenderDom = el || renderDom;\n        var dom = document.querySelector(el);\n        if (!dom) {\n            console.error(\"adapterScreen: '\".concat(el, \"' is not exist\"));\n            return;\n        }\n        var style = document.createElement('style');\n        var ignoreStyle = document.createElement('style');\n        style.lang = 'text/css';\n        ignoreStyle.lang = 'text/css';\n        style.id = 'autofit-style';\n        ignoreStyle.id = 'ignoreStyle';\n        style.innerHTML = \"\\n      body {\\n        overflow: hidden;\\n      }\\n    \";\n        dom.appendChild(style);\n        dom.appendChild(ignoreStyle);\n        dom.style.height = \"\".concat(dh || designHeight, \"px\");\n        dom.style.width = \"\".concat(dw || designWidth, \"px\");\n        dom.style.transformOrigin = \"0 0\";\n        keepFit(dw || designWidth, dh || designHeight, dom, ignore);\n        resizeListener = function () {\n            window.clearTimeout(timer);\n            if (delay != 0)\n                timer = window.setTimeout(function () {\n                    keepFit(dw || designWidth, dh || designHeight, dom, ignore);\n                    isElRectification && elRectification(currentRectification, currentRectificationLevel);\n                }, delay);\n            else {\n                keepFit(dw || designWidth, dh || designHeight, dom, ignore);\n                isElRectification && elRectification(currentRectification, currentRectificationLevel);\n            }\n        };\n        resize && window.addEventListener('resize', resizeListener);\n        isAutoFitRunning = true;\n        setTimeout(function () {\n            if (dom) {\n                dom.style.transition = \"\".concat(transition, \"s\");\n            }\n        });\n    },\n    off: function (el) {\n        var _a, _b, _c;\n        if (el === void 0) { el = '#app'; }\n        try {\n            isElRectification = false;\n            window.removeEventListener('resize', resizeListener);\n            (_c = (_b = (_a = document === null || document === void 0 ? void 0 : document.querySelector) === null || _a === void 0 ? void 0 : _a.call(document, '#autofit-style')) === null || _b === void 0 ? void 0 : _b.remove) === null || _c === void 0 ? void 0 : _c.call(_b);\n            var _dom = document.querySelector(currRenderDom ? currRenderDom : el);\n            if (_dom) {\n                // @ts-ignore\n                _dom.style = '';\n            }\n            var currentRectificationEls = document.querySelectorAll(currentRectification);\n            for (var _i = 0, _d = Array.from(currentRectificationEls); _i < _d.length; _i++) {\n                var item = _d[_i];\n                item.style.width = \"\";\n                item.style.height = \"\";\n                item.style.transform = \"\";\n            }\n        }\n        catch (error) {\n            console.error(\"adapterScreen: Failed to remove normally\", error);\n            isAutoFitRunning = false;\n        }\n        isAutoFitRunning &&\n            console.log(\"%c\" + \"adapterScreen.js\" + \" is off\", \"font-weight: bold;color: #707070; background: #c9c9c9; padding: 8px 12px; border-radius: 4px;\");\n    },\n    elRectification: elRectification,\n};\nexports.default = adapterScreen;\n"],"names":["Object","defineProperty","exports","value","timer","currRenderDom","currentRectification","currentRectificationLevel","resizeListener","currScale","isAutoFitRunning","isElRectification","elRectification","el","level","console","error","concat","currEl","document","querySelectorAll","length","_i","_a","Array","from","item","rectification","originalWidth","clientWidth","originalHeight","clientHeight","style","width","height","transform","transformOrigin","keepFit","dw","dh","dom","ignore","documentElement","ignore_1","realScale","realFontSize","realWidth","ignoreStyle","querySelector","itemEl","scale","fontSize","realHeight","RegExp","test","innerHTML","adapterScreen","init","defaultDefaultOptions","isShowInitTip","log","options","designWidth","designHeight","renderDom","resize","transition","delay","createElement","lang","id","appendChild","window","clearTimeout","setTimeout","addEventListener","off","_b","_c","removeEventListener","call","remove","_dom","currentRectificationEls","_d","default"],"mappings":"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"}