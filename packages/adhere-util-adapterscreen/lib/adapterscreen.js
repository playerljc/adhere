"use strict";var timer,__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},adhere_util_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("@baifendian/adhere-util"))),currRenderDom="",currentRectification="",currentRectificationLevel=-1,resizeListener=function(){},currScale=1,isAutoFitRunning=!1,isElRectification=!1;function elRectification(e,t){void 0===t&&(t=1),isAutoFitRunning||console.error("adapterScreen.js：adapterScreen has not been initialized yet"),e||console.error("adapterScreen.js：bad selector: ".concat(e)),currentRectification=e,currentRectificationLevel=t;e=document.querySelectorAll(e);if(0==e.length)console.error("adapterScreen.js：elRectification found no element");else{for(var i=0,n=Array.from(e);i<n.length;i++){var o=n[i],r=(isElRectification||(o.originalWidth=o.clientWidth,o.originalHeight=o.clientHeight),1==currScale?1:currScale*t);o.style.width="".concat(o.originalWidth*r,"px"),o.style.height="".concat(o.originalHeight*r,"px"),o.style.transform="scale(".concat(1/currScale,")"),o.style.transformOrigin="0 0"}isElRectification=!0}}function keepFit(e,t,i,n){var o=document.documentElement.clientHeight,r=document.documentElement.clientWidth;currScale=r/o<e/t?r/e:o/t,i.style.height="".concat(o/currScale,"px"),i.style.width="".concat(r/currScale,"px"),i.style.transform="scale(".concat(currScale,")");for(var c=0,a=n;c<a.length;c++){var d,l,s,u=a[c],f=document.querySelector("#ignoreStyle"),m=u.el||u.dom;m?(l=(d=u.scale||1/currScale)!=currScale?u.fontSize:"autofit",s=d!=currScale?u.width:"autofit",u=d!=currScale?u.height:"autofit",new RegExp("".concat(m,"( |{)"),"gm").test((null==f?void 0:f.innerHTML)||"")||f&&(f.innerHTML+="\n".concat(m," { \n        transform: scale(").concat(d,")!important;\n        transform-origin: 0 0;\n        width: ").concat(s,"px!important;\n        height: ").concat(u,"px!important;\n      }"),f.innerHTML+="\n".concat(m," div ,").concat(m," span,").concat(m," a,").concat(m," * {\n        font-size: ").concat(l,"px;\n        }"))):console.error("adapterScreen: bad selector: ".concat(m))}}var adapterScreen={init:function(e,t){void 0===e&&(e={}),(t=void 0===t?!0:t)&&console.log("%cadapterScreen.js is running","font-weight: bold; color: #ffb712; background:linear-gradient(-45deg, #bd34fe 50%, #47caff 50% );background: -webkit-linear-gradient( 120deg, #bd34fe 30%, #41d1ff );background-clip: text;-webkit-background-clip: text; -webkit-text-fill-color:linear-gradient( -45deg, #bd34fe 50%, #47caff 50% ); padding: 8px 12px; border-radius: 4px;");var i,t={designWidth:1920,dw:1920,designHeight:929,dh:929,renderDom:"string"==typeof e?e:"#app",el:"string"==typeof e?e:"#app",resize:!0,ignore:[],transition:"none",delay:0},n=t.designWidth,o=t.dw,r=t.designHeight,c=t.dh,e=t.el,a=t.resize,d=t.ignore,l=t.transition,s=t.delay,u=(currRenderDom=e||t.renderDom,document.querySelector(e));u?(t=document.createElement("style"),i=document.createElement("style"),t.lang="text/css",i.lang="text/css",t.id="autofit-style",i.id="ignoreStyle",t.innerHTML="\n      body {\n        overflow: hidden;\n      }\n    ",u.appendChild(t),u.appendChild(i),u.style.height="".concat(c||r,"px"),u.style.width="".concat(o||n,"px"),u.style.transformOrigin="0 0",keepFit(o||n,c||r,u,d),resizeListener=function(){window.clearTimeout(timer),0!=s?timer=window.setTimeout(function(){keepFit(o||n,c||r,u,d),isElRectification&&elRectification(currentRectification,currentRectificationLevel)},s):(keepFit(o||n,c||r,u,d),isElRectification&&elRectification(currentRectification,currentRectificationLevel))},a&&window.addEventListener("resize",resizeListener),isAutoFitRunning=!0,setTimeout(function(){u&&(u.style.transition="".concat(l,"s"))})):console.error("adapterScreen: '".concat(e,"' is not exist"))},off:function(e){var t,i,n;void 0===e&&(e="#app");try{isElRectification=!1,window.removeEventListener("resize",resizeListener),null!=(n=null==(i=null==(t=null===document||void 0===document?void 0:document.querySelector)?void 0:t.call(document,"#autofit-style"))?void 0:i.remove)&&n.call(i);for(var o=document.querySelector(currRenderDom||e),r=(o&&(o.style=""),document.querySelectorAll(currentRectification)),c=0,a=Array.from(r);c<a.length;c++){var d=a[c];d.style.width="",d.style.height="",d.style.transform=""}}catch(e){console.error("adapterScreen: Failed to remove normally",e),isAutoFitRunning=!1}isAutoFitRunning&&console.log("%cadapterScreen.js is off","font-weight: bold;color: #707070; background: #c9c9c9; padding: 8px 12px; border-radius: 4px;")},detectZoom:function(){var e=0;void 0!==window.devicePixelRatio?e=window.devicePixelRatio:void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),1!==(e=e&&Math.round(100*e))&&(document.body.style.zoom=100/Number(e))},flexible:function(i){function t(){var e=window.screen.availWidth/10;r.style.fontSize=e+"px"}function n(){var e,t;return!i||(e=r.clientWidth,t=r.clientHeight,i.minWidth<=e&&i.minHeight<=t)}var e,o,r=document.documentElement,c=window.devicePixelRatio||1;!function e(){var t;document.body?(t=window.screen.availWidth/10,document.body.style.fontSize=12*c/t+"rem"):document.addEventListener("DOMContentLoaded",e)}(),t(),window.addEventListener("resize",function(){n()&&t()}),window.addEventListener("pageshow",function(e){e.persisted&&n()&&t()}),2<=c&&(e=document.createElement("body"),(o=document.createElement("div")).style.border=".5px solid transparent",e.appendChild(o),r.appendChild(e),1===o.offsetHeight&&r.classList.add("hairlines"),r.removeChild(e))},setPageMinSizeToCSS:function(i){function t(){var e=adhere_util_1.default.getMaximizedViewportSize(),t=e.width,e=e.height,t=t-adhere_util_1.default.getScrollbarWidth();(null!=i?i:document.body).style.minWidth="".concat(t,"px"),(null!=i?i:document.body).style.minHeight="".concat(e,"px")}window.addEventListener("resize",function(){t()}),window.addEventListener("pageshow",function(e){e.persisted&&t()})},elRectification:elRectification};exports.default=adapterScreen;
//# sourceMappingURL=AdapterScreen.js.map
