{"version":3,"file":"dom.js","sources":["dom.js"],"sourcesContent":["import ClientDetectionUtil from './clientDetection';\nvar eventListenerHandlers = new Map();\nvar DomUtil = {\n    /**--------------------------dom-start-------------------------**/\n    /**\n     * isTextNode - 是否是文本节点\n     * @param el - Node\n     * @return {boolean}\n     */\n    isTextNode: function (el) {\n        return el.nodeType === Node.TEXT_NODE;\n    },\n    /**\n     * isCommentNode - 是否是注释节点\n     * @param el\n     * @return {boolean}\n     */\n    isCommentNode: function (el) {\n        return el.nodeType === Node.COMMENT_NODE;\n    },\n    /**\n     * isElementNode - 是否是元素节点\n     * @param el - Element\n     * @return {boolean}\n     */\n    isElementNode: function (el) {\n        return el.nodeType === Node.ELEMENT_NODE;\n    },\n    /**\n     * createElement - 根据html字符串创建dom\n     * @param htmlStr - string\n     * @return {Element}\n     */\n    createElement: function (htmlStr) {\n        var el = document.createElement('div');\n        el.innerHTML = htmlStr;\n        return el.firstElementChild;\n    },\n    /**\n     * getTopDom - 已source为开始向上查找元素\n     * @param {HtmlElement} source\n     * @param {string | string[]} selector\n     * @return {HtmlElement}\n     */\n    getTopDom: function (source, selector) {\n        if (!source || !selector || (Array.isArray(selector) && !selector.length))\n            return null;\n        var classNames = typeof selector === 'string' ? [selector] : selector;\n        if (classNames.every(function (name) { return source.classList.contains(name); })) {\n            return source;\n        }\n        var parentDom = source;\n        while ((parentDom = parentDom === null || parentDom === void 0 ? void 0 : parentDom.parentElement)) {\n            if (classNames.every(function (name) { var _a, _b; return (_b = (_a = parentDom === null || parentDom === void 0 ? void 0 : parentDom.classList) === null || _a === void 0 ? void 0 : _a.contains) === null || _b === void 0 ? void 0 : _b.call(_a, name); })) {\n                break;\n            }\n            else if (parentDom === document.body)\n                break;\n        }\n        if (parentDom) {\n            if (parentDom === document.body) {\n                return null;\n            }\n            else {\n                return parentDom;\n            }\n        }\n        else {\n            return null;\n        }\n    },\n    /**\n     * on - 注册事件\n     * @param el\n     * @param tag\n     * @param type\n     * @param handler\n     * @param capture\n     */\n    on: function (el, tag, type, handler, capture) {\n        var _a, _b, _c;\n        if (capture === void 0) { capture = false; }\n        var value = eventListenerHandlers.get(el);\n        if (!value) {\n            value = (_a = {},\n                _a[tag] = (_b = {},\n                    _b[type] = [],\n                    _b),\n                _a);\n            eventListenerHandlers.set(el, value);\n        }\n        var evtObj = value[tag];\n        if (!evtObj) {\n            evtObj = (_c = {},\n                _c[type] = [],\n                _c);\n            value[tag] = evtObj;\n        }\n        var handlers = evtObj[type];\n        if (!handlers) {\n            handlers = [];\n            evtObj[type] = handlers;\n        }\n        handlers.push(handler);\n        el.addEventListener(type, handler, capture);\n    },\n    /**\n     * off\n     * @param el\n     * @param tag\n     * @param type\n     * @param handler\n     */\n    off: function (el, tag, type, handler) {\n        if (tag && type && handler) {\n            var value = eventListenerHandlers.get(el);\n            if (value && value[tag] && value[tag][type]) {\n                var index = value[tag][type].indexOf(handler);\n                if (index !== -1) {\n                    value[tag][type].splice(index, 1);\n                }\n                // @ts-ignore\n                el.removeEventListener(type, handler);\n            }\n        }\n        else if (tag && type && !handler) {\n            var value = eventListenerHandlers.get(el);\n            if (value && value[tag] && value[tag][type]) {\n                value[tag][type].forEach(function (h) {\n                    el.removeEventListener(type, h);\n                });\n                value[tag][type] = [];\n            }\n        }\n        else if (tag && !type && !handler) {\n            var value = eventListenerHandlers.get(el);\n            if (value && value[tag]) {\n                var _loop_1 = function (t) {\n                    var h = value[tag][t];\n                    h.forEach(function (ih) {\n                        el.removeEventListener(t, ih);\n                    });\n                    value[tag][t] = [];\n                };\n                for (var t in value[tag]) {\n                    _loop_1(t);\n                }\n            }\n        }\n    },\n    /**\n     * addClass\n     * @param {HTMLElement} el\n     * @param {String} classes\n     */\n    addClass: function (el, classes) {\n        if (classes === void 0) { classes = ''; }\n        var classNames = classes.split(' ');\n        for (var i = 0; i < classNames.length; i++) {\n            el.classList.add(classNames[i]);\n        }\n    },\n    /**\n     * removeClass\n     * @param {HTMLElement} el\n     * @param {String} classes\n     */\n    removeClass: function (el, classes) {\n        if (classes === void 0) { classes = ''; }\n        var classNames = classes.split(' ');\n        for (var i = 0; i < classNames.length; i++) {\n            el.classList.remove(classNames[i]);\n        }\n    },\n    /**\n     * hasClass\n     * @param {HTMLElement} el\n     * @param {String} className\n     * @return {Boolean}\n     */\n    hasClass: function (el, className) {\n        return el.classList.contains(className);\n    },\n    /**\n     * DOM没有提供insertAfter()方法\n     * @param {HtmlElement} newElement\n     * @param {HtmlElement} targetElement\n     */\n    insertAfter: function (newElement, targetElement) {\n        var parent = targetElement.parentNode;\n        if (parent.lastChild === targetElement) {\n            // 如果最后的节点是目标元素，则直接添加。因为默认是最后\n            parent.appendChild(newElement);\n        }\n        else {\n            parent.insertBefore(newElement, targetElement.nextSibling);\n            // 如果不是，则插入在目标元素的下一个兄弟节点 的前面。也就是目标元素的后面\n        }\n    },\n    /**\n     * prepend\n     * @param el\n     * @param children\n     */\n    prepend: function (el, children) {\n        var childrenEl;\n        if (children instanceof String) {\n            childrenEl = DomUtil.createElement(children);\n        }\n        else {\n            childrenEl = children;\n        }\n        var firstEl = el.firstChild;\n        el.insertBefore(childrenEl, firstEl);\n    },\n    /**\n     * remove\n     * @param el\n     */\n    remove: function (el) {\n        el.parentNode.removeChild(el);\n    },\n    /**\n     * getParentElementByTag\n     * @param {HtmlElement} el\n     * @param {string} tag\n     * @return {HtmlElement}\n     */\n    getParentElementByTag: function (el, tag) {\n        if (!tag)\n            return null;\n        var element;\n        var parent = el;\n        var popup = function () {\n            parent = parent.parentElement;\n            if (!parent)\n                return null;\n            var tagParent = parent.tagName.toLocaleLowerCase();\n            if (tagParent === tag) {\n                element = parent;\n            }\n            else if (tagParent === 'body') {\n                element = null;\n            }\n            else {\n                popup();\n            }\n        };\n        popup();\n        return element;\n    },\n    /**\n     * children\n     * @param {HTMLElement} el\n     * @param {string} selector\n     */\n    children: function (el, selector) {\n        var elements = Array.prototype.filter.call(el.children, function (t) {\n            return t.nodeType === 1;\n        });\n        return elements.filter(function (t) {\n            return t.classList.contains(selector);\n        });\n    },\n    /**\n     * isTouch\n     * @return {boolean}\n     */\n    isTouch: function () {\n        return 'ontouchend' in document;\n    },\n    /**\n     * objectToDataSet\n     * @param obj\n     * @param dom\n     */\n    objectToDataSet: function (obj, dom) {\n        for (var p in obj) {\n            dom.dataset[p] = obj[p];\n        }\n    },\n    /**\n     * dataSetToObj\n     * @returns {Object}\n     * @param dom\n     */\n    dataSetToObject: function (dom) {\n        var obj = {};\n        for (var p in dom.dataset) {\n            obj[p] = dom.dataset[p];\n        }\n        return obj;\n    },\n    /**\n     * getPageLeft - 获取指定元素距离视口的left\n     * @return {SelectOptions}\n     * @param el\n     */\n    getPageLeft: function (el) {\n        var left = el.offsetLeft;\n        var offsetParent = el.offsetParent;\n        do {\n            left += offsetParent.offsetLeft;\n        } while (!!(offsetParent = offsetParent.offsetParent));\n        return left;\n    },\n    /**\n     * getPageTop - 获取指定元素距离视口的top\n     * @return {SelectOptions}\n     * @param el\n     */\n    getPageTop: function (el) {\n        var top = el.offsetTop;\n        var offsetParent = el.offsetParent;\n        do {\n            top += offsetParent.offsetTop;\n        } while (!!(offsetParent = offsetParent.offsetParent));\n        return top;\n    },\n    /**\n     * getPageRect - 获取元素距离视口的Rect\n     * @return {{top: number, left: number}}\n     * @param el\n     */\n    getPageRect: function (el) {\n        var top = el.offsetTop;\n        var left = el.offsetLeft;\n        var offsetParent = el.offsetParent;\n        do {\n            top += offsetParent.offsetTop;\n            left += offsetParent.offsetLeft;\n        } while (!!(offsetParent = offsetParent.offsetParent));\n        return {\n            top: top,\n            bottom: top + el.offsetHeight,\n            left: left,\n            right: left + el.offsetWidth,\n        };\n    },\n    /**\n     * getLeftUntil\n     * @description - 获取left直到untilEl\n     * @param el\n     * @param untilEl\n     */\n    getLeftUntil: function (_a) {\n        var el = _a.el, untilEl = _a.untilEl;\n        var left = el.offsetLeft;\n        var offsetParent = el.offsetParent;\n        while (untilEl !== offsetParent) {\n            left += offsetParent.offsetLeft;\n            offsetParent = offsetParent.offsetParent;\n        }\n        return left;\n    },\n    /**\n     * getTopUntil\n     * @description - 获取top直到untilEl\n     * @param el\n     * @param untilEl\n     */\n    getTopUntil: function (_a) {\n        var el = _a.el, untilEl = _a.untilEl;\n        var top = el.offsetTop;\n        var offsetParent = el.offsetParent;\n        while (untilEl !== offsetParent) {\n            top += offsetParent.offsetTop;\n            offsetParent = offsetParent.offsetParent;\n        }\n        return top;\n    },\n    /**\n     * getRectUntil\n     * @description - 获取Rect直到untilEl\n     * @param el\n     * @param untilEl\n     */\n    getRectUntil: function (_a) {\n        var el = _a.el, untilEl = _a.untilEl;\n        var top = el.offsetTop;\n        var left = el.offsetLeft;\n        var offsetParent = el.offsetParent;\n        while (untilEl !== offsetParent) {\n            top += offsetParent.offsetTop;\n            left += offsetParent.offsetLeft;\n            offsetParent = offsetParent.offsetParent;\n        }\n        return {\n            top: top,\n            bottom: top + el.offsetHeight,\n            left: left,\n            right: left + el.offsetWidth,\n        };\n    },\n    /**\n     * isIframeEmbed - 是否是iframe嵌入\n     * @return {boolean}\n     */\n    isIframeEmbed: function () {\n        return typeof window === 'undefined' ? false : window.top && window.top !== window;\n    },\n    /**\n     * addClickListener - 支持PC和移动端的点击事件\n     * @param el\n     * @param handler\n     * @param capture\n     */\n    addClickListener: (function () {\n        return function (el, handler, capture) {\n            var isStart = false;\n            var isMove = false;\n            var startTime = 0;\n            var endTime = 0;\n            var handlers = Array();\n            // 如果是移动端浏览器\n            if (ClientDetectionUtil.isTouch()) {\n                var touchStartHandler = function () {\n                    isStart = true;\n                    startTime = new Date().getTime();\n                };\n                var touchMoveHandler = function () {\n                    isMove = true;\n                };\n                var touchEndHandler = function (e) {\n                    endTime = new Date().getTime();\n                    var step = endTime - startTime;\n                    if ((isStart && !isMove) || (isStart && isMove && step <= 200) /*事件少于200ms*/) {\n                        // 命中\n                        handler(e);\n                    }\n                };\n                handlers.push({\n                    type: 'touchstart',\n                    handler: touchStartHandler,\n                });\n                handlers.push({\n                    type: 'touchmove',\n                    handler: touchMoveHandler,\n                });\n                handlers.push({\n                    type: 'touchend',\n                    handler: touchEndHandler,\n                });\n                el.addEventListener('touchstart', touchStartHandler, capture || false);\n                el.addEventListener('touchmove', touchMoveHandler, capture || false);\n                el.addEventListener('touchend', touchEndHandler, capture || false);\n            }\n            // 是PC端浏览器\n            else {\n                var clickHandler = function (e) {\n                    handler(e);\n                };\n                handlers.push({\n                    type: 'click',\n                    handler: clickHandler,\n                });\n                el.addEventListener('click', clickHandler, capture || false);\n            }\n            return function () {\n                handlers.forEach(function (_a) {\n                    var type = _a.type, handler = _a.handler;\n                    // @ts-ignore\n                    el.removeEventListener(type, handler);\n                });\n            };\n        };\n    })(),\n    /**\n     * clickInRange\n     * @description 再点击区域内执行点击操作，超出的区域执行bodyClickHandler的操作\n     * @param params\n     * @return Function\n     */\n    clickInRange: function (params) {\n        function onRootClick(e) {\n            e.stopPropagation();\n        }\n        function onBodyClickHandler() {\n            if (params.bodyClickHandler) {\n                params.bodyClickHandler();\n            }\n        }\n        params.rootEl.addEventListener('click', onRootClick);\n        document.body.addEventListener('click', onBodyClickHandler);\n        return function () {\n            params.rootEl.removeEventListener('click', onRootClick);\n            document.body.removeEventListener('click', onBodyClickHandler);\n        };\n    },\n    /**\n     * includeHTML\n     * @description 使用ajax方式引入html\n     * @param {string} attr 属性\n     * @param {string} onLoadError\n     */\n    includeHTML: function (attr, onLoadError) {\n        if (attr === void 0) { attr = 'w3-include-html'; }\n        return new Promise(function (contextResolve) {\n            var defaultAttr = 'w3-include-html';\n            function load(el, file) {\n                return new Promise(function (_resolve, _reject) {\n                    var xhr = new XMLHttpRequest();\n                    xhr.onreadystatechange = function () {\n                        var _a;\n                        if (this.readyState == 4) {\n                            if (this.status == 200) {\n                                el.innerHTML = this.responseText;\n                                _resolve('');\n                            }\n                            if (this.status == 404) {\n                                el.innerHTML = (_a = onLoadError === null || onLoadError === void 0 ? void 0 : onLoadError()) !== null && _a !== void 0 ? _a : 'Page not found.';\n                                _reject('');\n                            }\n                            el.removeAttribute(attr !== null && attr !== void 0 ? attr : defaultAttr);\n                        }\n                    };\n                    xhr.open('GET', file, true);\n                    xhr.send();\n                });\n            }\n            var loop = function (_attr, _onLoadError) {\n                var allEls = document.querySelectorAll(\"[\".concat(attr !== null && attr !== void 0 ? attr : defaultAttr, \"]\"));\n                if (!allEls.length) {\n                    contextResolve('');\n                    return;\n                }\n                var tasks = [];\n                for (var i = 0; i < allEls.length; i++) {\n                    var el = allEls[i];\n                    var file = el.getAttribute(attr !== null && attr !== void 0 ? attr : defaultAttr);\n                    tasks.push(load(el, file));\n                }\n                if (tasks.length) {\n                    Promise.all(tasks).then(function () {\n                        loop(_attr, _onLoadError);\n                    });\n                }\n            };\n            loop(attr, onLoadError);\n        });\n    },\n    /**\n     * setCursorToEnd\n     * @description 将光标设置到内容末尾\n     * @param {HTMLElement} element\n     */\n    setCursorToEnd: function (element) {\n        var _a, _b;\n        var range = document.createRange();\n        var selection = window.getSelection();\n        range.selectNodeContents(element);\n        range.collapse(false); // 将光标设置到末尾\n        (_a = selection === null || selection === void 0 ? void 0 : selection.removeAllRanges) === null || _a === void 0 ? void 0 : _a.call(selection);\n        (_b = selection === null || selection === void 0 ? void 0 : selection.addRange) === null || _b === void 0 ? void 0 : _b.call(selection, range);\n    },\n    /**\n     * setCursorPositionToNode\n     * @description 设置Node的光标位置\n     * @param {Node} node\n     * @param {number} offset\n     */\n    setCursorPositionToNode: function (node, offset) {\n        var _a, _b, _c, _d;\n        var range = document.createRange();\n        (_a = range === null || range === void 0 ? void 0 : range.setStart) === null || _a === void 0 ? void 0 : _a.call(range, node, offset);\n        (_b = range === null || range === void 0 ? void 0 : range.collapse) === null || _b === void 0 ? void 0 : _b.call(range, true);\n        var sel = window.getSelection();\n        (_c = sel === null || sel === void 0 ? void 0 : sel.removeAllRanges) === null || _c === void 0 ? void 0 : _c.call(sel);\n        (_d = sel === null || sel === void 0 ? void 0 : sel.addRange) === null || _d === void 0 ? void 0 : _d.call(sel, range);\n    },\n    /**\n     * setCursorPosition\n     * @description 设置光标的位置\n     * @param {HTMLElement} element\n     * @param {number} offset\n     */\n    setCursorPosition: function (element, offset) {\n        var _a, _b;\n        var range = document.createRange();\n        range.setStart(element.childNodes[0], offset);\n        range.collapse(true);\n        var sel = window.getSelection();\n        (_a = sel === null || sel === void 0 ? void 0 : sel.removeAllRanges) === null || _a === void 0 ? void 0 : _a.call(sel);\n        (_b = sel === null || sel === void 0 ? void 0 : sel.addRange) === null || _b === void 0 ? void 0 : _b.call(sel, range);\n    },\n    /**\n     * getCurrentElementWithCursor\n     * @description 获取光标输入的的element\n     * @return {Node | null}\n     */\n    getCurrentElementWithCursor: function () {\n        var _a;\n        var selection = window.getSelection();\n        if (selection && (selection === null || selection === void 0 ? void 0 : selection.rangeCount) > 0) {\n            var range = (_a = selection === null || selection === void 0 ? void 0 : selection.getRangeAt) === null || _a === void 0 ? void 0 : _a.call(selection, 0);\n            return range === null || range === void 0 ? void 0 : range.startContainer /*.parentElement*/;\n        }\n        return null;\n    },\n    /**\n     * getCurrentParentElementWithCursor\n     * @description 获取光标输入的parentElement\n     * @return {Node | null}\n     */\n    getCurrentParentElementWithCursor: function () {\n        var currentElement = DomUtil.getCurrentElementWithCursor();\n        if (currentElement) {\n            return currentElement.parentElement;\n        }\n        return null;\n    },\n    /**\n     * getCursorIndex\n     * @description 获取光标的索引\n     * @return {number}\n     */\n    getCursorIndex: function () {\n        var _a, _b, _c, _d;\n        var selection = window.getSelection();\n        if (selection && (selection === null || selection === void 0 ? void 0 : selection.rangeCount) > 0) {\n            var range = (_a = selection === null || selection === void 0 ? void 0 : selection.getRangeAt) === null || _a === void 0 ? void 0 : _a.call(selection, 0);\n            var preSelectionRange = (_b = range === null || range === void 0 ? void 0 : range.cloneRange) === null || _b === void 0 ? void 0 : _b.call(range);\n            preSelectionRange === null || preSelectionRange === void 0 ? void 0 : preSelectionRange.selectNodeContents(range === null || range === void 0 ? void 0 : range.startContainer);\n            preSelectionRange === null || preSelectionRange === void 0 ? void 0 : preSelectionRange.setEnd(range === null || range === void 0 ? void 0 : range.startContainer, range === null || range === void 0 ? void 0 : range.startOffset);\n            return (_d = (_c = preSelectionRange === null || preSelectionRange === void 0 ? void 0 : preSelectionRange.toString) === null || _c === void 0 ? void 0 : _c.call(preSelectionRange)) === null || _d === void 0 ? void 0 : _d.length;\n        }\n        return -1;\n    },\n    /**\n     * getCursorRectByDocument\n     * @description 获取光标在文档中的位置\n     * @return {DOMRect | null}\n     */\n    getCursorRectByDocument: function () {\n        var _a;\n        if (window.getSelection) {\n            var selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                var range = selection.getRangeAt(0);\n                return (_a = range === null || range === void 0 ? void 0 : range.getBoundingClientRect) === null || _a === void 0 ? void 0 : _a.call(range);\n            }\n        }\n        return null;\n    },\n    /**\n     * getTransformValues\n     * @description\n     * @param {HTMLElement} element\n     * @return {\n     *\n     * }\n     */\n    getTransformValues: function (element) {\n        var style = window.getComputedStyle(element);\n        var transform = style.transform;\n        // 矩阵解析\n        var mat = transform.match(/^matrix\\((.+)\\)$/);\n        if (mat) {\n            var values = mat[1].split(', ').map(parseFloat);\n            return {\n                translateX: values[4],\n                translateY: values[5],\n                scaleX: Math.sqrt(values[0] * values[0] + values[1] * values[1]),\n                scaleY: Math.sqrt(values[2] * values[2] + values[3] * values[3]),\n                rotate: Math.atan2(values[1], values[0]) * (180 / Math.PI),\n                // 这里的旋转角度是以度数返回的\n            };\n        }\n        // 如果没有应用 transform 或格式不是 matrix，可以返回一个默认或空对象\n        return {\n            translateX: 0,\n            translateY: 0,\n            scaleX: 1,\n            scaleY: 1,\n            rotate: 0,\n        };\n    },\n    /**--------------------------dom-end-------------------------**/\n};\nexport default DomUtil;\n"],"names":["ClientDetectionUtil","eventListenerHandlers","Map","DomUtil","isTextNode","el","nodeType","Node","TEXT_NODE","isCommentNode","COMMENT_NODE","isElementNode","ELEMENT_NODE","createElement","htmlStr","document","innerHTML","firstElementChild","getTopDom","source","selector","Array","isArray","length","classNames","every","name","classList","contains","parentDom","parentElement","_a","_b","call","body","on","tag","type","handler","capture","value","get","evtObj","set","handlers","_c","push","addEventListener","off","index","indexOf","splice","removeEventListener","forEach","h","t","_loop_1","ih","addClass","classes","split","i","add","removeClass","remove","hasClass","className","insertAfter","newElement","targetElement","parent","parentNode","lastChild","appendChild","insertBefore","nextSibling","prepend","children","childrenEl","String","firstEl","firstChild","removeChild","getParentElementByTag","element","popup","tagParent","tagName","toLocaleLowerCase","prototype","filter","isTouch","objectToDataSet","obj","dom","p","dataset","dataSetToObject","getPageLeft","left","offsetLeft","offsetParent","getPageTop","top","offsetTop","getPageRect","bottom","offsetHeight","right","offsetWidth","getLeftUntil","untilEl","getTopUntil","getRectUntil","isIframeEmbed","window","addClickListener","endTime","touchMoveHandler","touchEndHandler","clickHandler","isStart","isMove","startTime","e","Date","getTime","touchStartHandler","clickInRange","params","onRootClick","stopPropagation","onBodyClickHandler","bodyClickHandler","rootEl","includeHTML","attr","onLoadError","Promise","contextResolve","defaultAttr","loop","_attr","_onLoadError","allEls","querySelectorAll","concat","tasks","file","getAttribute","_resolve","_reject","xhr","XMLHttpRequest","onreadystatechange","this","readyState","status","responseText","removeAttribute","open","send","all","then","setCursorToEnd","range","createRange","selection","getSelection","selectNodeContents","collapse","removeAllRanges","addRange","setCursorPositionToNode","node","offset","_d","sel","setStart","setCursorPosition","childNodes","getCurrentElementWithCursor","rangeCount","getRangeAt","startContainer","getCurrentParentElementWithCursor","currentElement","getCursorIndex","preSelectionRange","cloneRange","setEnd","startOffset","toString","getCursorRectByDocument","getBoundingClientRect","getTransformValues","mat","getComputedStyle","transform","match","translateX","values","map","parseFloat","translateY","scaleX","Math","sqrt","scaleY","rotate","atan2","PI"],"mappings":"OAAOA,wBAAyB,oBAChC,IAAIC,sBAAwB,IAAIC,IAC5BC,QAAU,CAOVC,WAAY,SAAUC,GAClB,OAAOA,EAAGC,WAAaC,KAAKC,SAChC,EAMAC,cAAe,SAAUJ,GACrB,OAAOA,EAAGC,WAAaC,KAAKG,YAChC,EAMAC,cAAe,SAAUN,GACrB,OAAOA,EAAGC,WAAaC,KAAKK,YAChC,EAMAC,cAAe,SAAUC,GACrB,IAAIT,EAAKU,SAASF,cAAc,KAAK,EAErC,OADAR,EAAGW,UAAYF,EACRT,EAAGY,iBACd,EAOAC,UAAW,SAAUC,EAAQC,GACzB,GAAI,CAACD,GAAU,CAACC,GAAaC,MAAMC,QAAQF,CAAQ,GAAK,CAACA,EAASG,OAC9D,OAAO,KACX,IAAIC,EAAiC,UAApB,OAAOJ,EAAwB,CAACA,GAAYA,EAC7D,GAAII,EAAWC,MAAM,SAAUC,GAAQ,OAAOP,EAAOQ,UAAUC,SAASF,CAAI,CAAG,CAAC,EAC5E,OAAOP,EAGX,IADA,IAAIU,EAAYV,GACRU,EAAYA,MAAAA,EAA6C,KAAA,EAASA,EAAUC,gBAC5EN,CAAAA,EAAWC,MAAM,SAAUC,GAAQ,IAAIK,EAAIC,EAAI,OAAO,OAACA,EAAK,OAACD,EAAKF,MAAAA,EAA6C,KAAA,EAASA,EAAUF,WAAuC,KAAA,EAASI,EAAGH,UAAsC,KAAA,EAASI,EAAGC,KAAKF,EAAIL,CAAI,CAAG,CAAC,GAGnPG,IAAcd,SAASmB,OAGpC,MAAIL,CAAAA,GACIA,IAAcd,SAASmB,KAQpB,KAJIL,CAMnB,EASAM,GAAI,SAAU9B,EAAI+B,EAAKC,EAAMC,EAASC,GAElB,KAAA,IAAZA,IAAsBA,EAAU,CAAA,GADpC,IAEIC,EAAQvC,sBAAsBwC,IAAIpC,CAAE,EASpCqC,GARCF,KACQT,EAAK,IACPK,KAAQJ,EAAK,IACTK,GAAQ,GACXL,GAHRQ,EAIIT,EACJ9B,sBAAsB0C,IAAItC,EAAImC,CAAK,GAE1BA,EAAMJ,IAOfQ,GANCF,KACSG,EAAK,IACRR,GAAQ,GADfK,EAEIG,EACJL,EAAMJ,GAAOM,GAEFA,EAAOL,IACjBO,IAEDF,EAAOL,GADPO,EAAW,IAGfA,EAASE,KAAKR,CAAO,EACrBjC,EAAG0C,iBAAiBV,EAAMC,EAASC,CAAO,CAC9C,EAQAS,IAAK,SAAU3C,EAAI+B,EAAKC,EAAMC,GAEtB,IAEQW,EAkBJT,EArBR,GAAIJ,GAAOC,GAAQC,GAEXE,EADQvC,sBAAsBwC,IAAIpC,CAAE,IAC3BmC,EAAMJ,IAAQI,EAAMJ,GAAKC,KAEpB,CAAC,KADXY,EAAQT,EAAMJ,GAAKC,GAAMa,QAAQZ,CAAO,IAExCE,EAAMJ,GAAKC,GAAMc,OAAOF,EAAO,CAAC,EAGpC5C,EAAG+C,oBAAoBf,EAAMC,CAAO,QAGvC,GAAIF,GAAOC,GAAQ,CAACC,GAEjBE,EADQvC,sBAAsBwC,IAAIpC,CAAE,IAC3BmC,EAAMJ,IAAQI,EAAMJ,GAAKC,KAClCG,EAAMJ,GAAKC,GAAMgB,QAAQ,SAAUC,GAC/BjD,EAAG+C,oBAAoBf,EAAMiB,CAAC,CAClC,CAAC,EACDd,EAAMJ,GAAKC,GAAQ,SAGtB,GAAID,GAAO,CAACC,GAAQ,CAACC,EAEtB,IAAIE,EADQvC,sBAAsBwC,IAAIpC,CAAE,IAC3BmC,EAAMJ,GAQf,IAPA,IAOSmB,KAAKf,EAAMJ,GAChBoB,CARU,SAAUD,GACZf,EAAMJ,GAAKmB,GACjBF,QAAQ,SAAUI,GAChBpD,EAAG+C,oBAAoBG,EAAGE,CAAE,CAChC,CAAC,EACDjB,EAAMJ,GAAKmB,GAAK,EACpB,EAEYA,CAAC,CAIzB,EAMAG,SAAU,SAAUrD,EAAIsD,GAGpB,IADA,IAAInC,GADsBmC,EAAV,KAAA,IAAZA,EAAgC,GACnBA,GAAQC,MAAM,GAAG,EACzBC,EAAI,EAAGA,EAAIrC,EAAWD,OAAQsC,CAAC,GACpCxD,EAAGsB,UAAUmC,IAAItC,EAAWqC,EAAE,CAEtC,EAMAE,YAAa,SAAU1D,EAAIsD,GAGvB,IADA,IAAInC,GADsBmC,EAAV,KAAA,IAAZA,EAAgC,GACnBA,GAAQC,MAAM,GAAG,EACzBC,EAAI,EAAGA,EAAIrC,EAAWD,OAAQsC,CAAC,GACpCxD,EAAGsB,UAAUqC,OAAOxC,EAAWqC,EAAE,CAEzC,EAOAI,SAAU,SAAU5D,EAAI6D,GACpB,OAAO7D,EAAGsB,UAAUC,SAASsC,CAAS,CAC1C,EAMAC,YAAa,SAAUC,EAAYC,GAC/B,IAAIC,EAASD,EAAcE,WACvBD,EAAOE,YAAcH,EAErBC,EAAOG,YAAYL,CAAU,EAG7BE,EAAOI,aAAaN,EAAYC,EAAcM,WAAW,CAGjE,EAMAC,QAAS,SAAUvE,EAAIwE,GACnB,IAEIC,EADAD,aAAoBE,OACP5E,QAAQU,cAAcgE,CAAQ,EAG9BA,EAEbG,EAAU3E,EAAG4E,WACjB5E,EAAGqE,aAAaI,EAAYE,CAAO,CACvC,EAKAhB,OAAQ,SAAU3D,GACdA,EAAGkE,WAAWW,YAAY7E,CAAE,CAChC,EAOA8E,sBAAuB,SAAU9E,EAAI+B,GACjC,IAEIgD,EACAd,EACAe,EAJJ,OAAKjD,GAGDkC,EAASjE,GACTgF,EAAQ,WAER,GAAI,EADJf,EAASA,EAAOxC,eAEZ,OAAO,KACX,IAAIwD,EAAYhB,EAAOiB,QAAQC,kBAAkB,EAC7CF,IAAclD,EACdgD,EAAUd,EAES,SAAdgB,EACLF,EAAU,KAGVC,EAAM,CAEd,GACM,EACCD,GAnBI,IAoBf,EAMAP,SAAU,SAAUxE,EAAIe,GAIpB,OAHeC,MAAMoE,UAAUC,OAAOzD,KAAK5B,EAAGwE,SAAU,SAAUtB,GAC9D,OAAsB,IAAfA,EAAEjD,QACb,CAAC,EACeoF,OAAO,SAAUnC,GAC7B,OAAOA,EAAE5B,UAAUC,SAASR,CAAQ,CACxC,CAAC,CACL,EAKAuE,QAAS,WACL,MAAO,eAAgB5E,QAC3B,EAMA6E,gBAAiB,SAAUC,EAAKC,GAC5B,IAAK,IAAIC,KAAKF,EACVC,EAAIE,QAAQD,GAAKF,EAAIE,EAE7B,EAMAE,gBAAiB,SAAUH,GACvB,IACSC,EADLF,EAAM,GACV,IAASE,KAAKD,EAAIE,QACdH,EAAIE,GAAKD,EAAIE,QAAQD,GAEzB,OAAOF,CACX,EAMAK,YAAa,SAAU7F,GAGnB,IAFA,IAAI8F,EAAO9F,EAAG+F,WACVC,EAAehG,EAAGgG,aAElBF,GAAQE,EAAaD,WACbC,EAAeA,EAAaA,eACxC,OAAOF,CACX,EAMAG,WAAY,SAAUjG,GAGlB,IAFA,IAAIkG,EAAMlG,EAAGmG,UACTH,EAAehG,EAAGgG,aAElBE,GAAOF,EAAaG,UACZH,EAAeA,EAAaA,eACxC,OAAOE,CACX,EAMAE,YAAa,SAAUpG,GAInB,IAHA,IAAIkG,EAAMlG,EAAGmG,UACTL,EAAO9F,EAAG+F,WACVC,EAAehG,EAAGgG,aAElBE,GAAOF,EAAaG,UACpBL,GAAQE,EAAaD,WACbC,EAAeA,EAAaA,eACxC,MAAO,CACHE,IAAKA,EACLG,OAAQH,EAAMlG,EAAGsG,aACjBR,KAAMA,EACNS,MAAOT,EAAO9F,EAAGwG,WACrB,CACJ,EAOAC,aAAc,SAAU/E,GAIpB,IAHA,IAAI1B,EAAK0B,EAAG1B,GAAI0G,EAAUhF,EAAGgF,QACzBZ,EAAO9F,EAAG+F,WACVC,EAAehG,EAAGgG,aACfU,IAAYV,GACfF,GAAQE,EAAaD,WACrBC,EAAeA,EAAaA,aAEhC,OAAOF,CACX,EAOAa,YAAa,SAAUjF,GAInB,IAHA,IAAI1B,EAAK0B,EAAG1B,GAAI0G,EAAUhF,EAAGgF,QACzBR,EAAMlG,EAAGmG,UACTH,EAAehG,EAAGgG,aACfU,IAAYV,GACfE,GAAOF,EAAaG,UACpBH,EAAeA,EAAaA,aAEhC,OAAOE,CACX,EAOAU,aAAc,SAAUlF,GAKpB,IAJA,IAAI1B,EAAK0B,EAAG1B,GAAI0G,EAAUhF,EAAGgF,QACzBR,EAAMlG,EAAGmG,UACTL,EAAO9F,EAAG+F,WACVC,EAAehG,EAAGgG,aACfU,IAAYV,GACfE,GAAOF,EAAaG,UACpBL,GAAQE,EAAaD,WACrBC,EAAeA,EAAaA,aAEhC,MAAO,CACHE,IAAKA,EACLG,OAAQH,EAAMlG,EAAGsG,aACjBR,KAAMA,EACNS,MAAOT,EAAO9F,EAAGwG,WACrB,CACJ,EAKAK,cAAe,WACX,MAAyB,aAAlB,OAAOC,QAAiCA,OAAOZ,KAAOY,OAAOZ,MAAQY,MAChF,EAOAC,iBACW,SAAU/G,EAAIiC,EAASC,GAC1B,IAGI8E,EAQIC,EAGAC,EA0BAC,EAxCJC,EAAU,CAAA,EACVC,EAAS,CAAA,EACTC,EAAY,EAEZ/E,EAAWvB,MAAM,EA6CrB,OA3CIrB,oBAAoB2F,QAAQ,GAKxB2B,EAAmB,WACnBI,EAAS,CAAA,CACb,EACIH,EAAkB,SAAUK,GAC5BP,GAAU,IAAIQ,MAAOC,QAAQ,GAExBL,GAAW,CAACC,GAAYD,GAAWC,GAD7BL,EAAUM,GACqC,MAEtDrF,EAAQsF,CAAC,CAEjB,EACAhF,EAASE,KAAK,CACVT,KAAM,aACNC,QAjBAyF,EAAoB,WACpBN,EAAU,CAAA,EACVE,GAAY,IAAIE,MAAOC,QAAQ,CACnC,CAeA,CAAC,EACDlF,EAASE,KAAK,CACVT,KAAM,YACNC,QAASgF,CACb,CAAC,EACD1E,EAASE,KAAK,CACVT,KAAM,WACNC,QAASiF,CACb,CAAC,EACDlH,EAAG0C,iBAAiB,aAAcgF,EAAmBxF,GAAW,CAAA,CAAK,EACrElC,EAAG0C,iBAAiB,YAAauE,EAAkB/E,GAAW,CAAA,CAAK,EACnElC,EAAG0C,iBAAiB,WAAYwE,EAAiBhF,GAAW,CAAA,CAAK,IAOjEK,EAASE,KAAK,CACVT,KAAM,QACNC,QALAkF,EAAe,SAAUI,GACzBtF,EAAQsF,CAAC,CACb,CAIA,CAAC,EACDvH,EAAG0C,iBAAiB,QAASyE,EAAcjF,GAAW,CAAA,CAAK,GAExD,WACHK,EAASS,QAAQ,SAAUtB,GACvB,IAAIM,EAAON,EAAGM,KAAMC,EAAUP,EAAGO,QAEjCjC,EAAG+C,oBAAoBf,EAAMC,CAAO,CACxC,CAAC,CACL,CACJ,EAQJ0F,aAAc,SAAUC,GACpB,SAASC,EAAYN,GACjBA,EAAEO,gBAAgB,CACtB,CACA,SAASC,IACDH,EAAOI,kBACPJ,EAAOI,iBAAiB,CAEhC,CAGA,OAFAJ,EAAOK,OAAOvF,iBAAiB,QAASmF,CAAW,EACnDnH,SAASmB,KAAKa,iBAAiB,QAASqF,CAAkB,EACnD,WACHH,EAAOK,OAAOlF,oBAAoB,QAAS8E,CAAW,EACtDnH,SAASmB,KAAKkB,oBAAoB,QAASgF,CAAkB,CACjE,CACJ,EAOAG,YAAa,SAAUC,EAAMC,GAEzB,OADa,KAAA,IAATD,IAAmBA,EAAO,mBACvB,IAAIE,QAAQ,SAAUC,GACzB,IAAIC,EAAc,kBAsBP,SAAPC,EAAiBC,EAAOC,GACxB,IAAIC,EAASjI,SAASkI,iBAAiB,IAAIC,OAAOV,MAAAA,EAAmCA,EAAOI,EAAa,GAAG,CAAC,EAC7G,GAAKI,EAAOzH,OAAZ,CAKA,IADA,IAAI4H,EAAQ,GACHtF,EAAI,EAAGA,EAAImF,EAAOzH,OAAQsC,CAAC,GAAI,CACpC,IAAIxD,EAAK2I,EAAOnF,GACZuF,EAAO/I,EAAGgJ,aAAab,MAAAA,EAAmCA,EAAOI,CAAW,EAChFO,EAAMrG,KA/Bd,SAAczC,EAAI+I,GACd,OAAO,IAAIV,QAAQ,SAAUY,EAAUC,GACnC,IAAIC,EAAM,IAAIC,eACdD,EAAIE,mBAAqB,WACrB,IAAI3H,EACmB,GAAnB4H,KAAKC,aACc,KAAfD,KAAKE,SACLxJ,EAAGW,UAAY2I,KAAKG,aACpBR,EAAS,EAAE,GAEI,KAAfK,KAAKE,SACLxJ,EAAGW,UAAY,OAACe,EAAK0G,MAAAA,EAAiD,KAAA,EAASA,EAAY,GAA+B1G,EAAK,kBAC/HwH,EAAQ,EAAE,GAEdlJ,EAAG0J,gBAAgBvB,MAAAA,EAAmCA,EAAOI,CAAW,EAEhF,EACAY,EAAIQ,KAAK,MAAOZ,EAAM,CAAA,CAAI,EAC1BI,EAAIS,KAAK,CACb,CAAC,CACL,EAWwB5J,EAAI+I,CAAI,CAAC,CAC7B,CACID,EAAM5H,QACNmH,QAAQwB,IAAIf,CAAK,EAAEgB,KAAK,WACpBtB,EAAKC,EAAOC,CAAY,CAC5B,CAAC,CAVL,MAFIJ,EAAe,EAAE,CAczB,CACAE,EAAKL,EAAMC,CAAW,CAC1B,CAAC,CACL,EAMA2B,eAAgB,SAAUhF,GACtB,IACIiF,EAAQtJ,SAASuJ,YAAY,EAC7BC,EAAYpD,OAAOqD,aAAa,EACpCH,EAAMI,mBAAmBrF,CAAO,EAChCiF,EAAMK,SAAS,CAAA,CAAK,EACpB,OAAC3I,EAAKwI,MAAAA,EAA6C,KAAA,EAASA,EAAUI,kBAAsD5I,EAAGE,KAAKsI,CAAS,EAC7I,OAACvI,EAAKuI,MAAAA,EAA6C,KAAA,EAASA,EAAUK,WAA+C5I,EAAGC,KAAKsI,EAAWF,CAAK,CACjJ,EAOAQ,wBAAyB,SAAUC,EAAMC,GACrC,IAAgBC,EACZX,EAAQtJ,SAASuJ,YAAY,EAG7BW,GAFJ,OAAClJ,EAAKsI,MAAAA,EAAqC,KAAA,EAASA,EAAMa,WAA+CnJ,EAAGE,KAAKoI,EAAOS,EAAMC,CAAM,EACpI,OAAC/I,EAAKqI,MAAAA,EAAqC,KAAA,EAASA,EAAMK,WAA+C1I,EAAGC,KAAKoI,EAAO,CAAA,CAAI,EAClHlD,OAAOqD,aAAa,GAC9B,OAAC3H,EAAKoI,MAAAA,EAAiC,KAAA,EAASA,EAAIN,kBAAsD9H,EAAGZ,KAAKgJ,CAAG,EACrH,OAACD,EAAKC,MAAAA,EAAiC,KAAA,EAASA,EAAIL,WAA+CI,EAAG/I,KAAKgJ,EAAKZ,CAAK,CACzH,EAOAc,kBAAmB,SAAU/F,EAAS2F,GAClC,IACIV,EAAQtJ,SAASuJ,YAAY,EAG7BW,GAFJZ,EAAMa,SAAS9F,EAAQgG,WAAW,GAAIL,CAAM,EAC5CV,EAAMK,SAAS,CAAA,CAAI,EACTvD,OAAOqD,aAAa,GAC9B,OAACzI,EAAKkJ,MAAAA,EAAiC,KAAA,EAASA,EAAIN,kBAAsD5I,EAAGE,KAAKgJ,CAAG,EACrH,OAACjJ,EAAKiJ,MAAAA,EAAiC,KAAA,EAASA,EAAIL,WAA+C5I,EAAGC,KAAKgJ,EAAKZ,CAAK,CACzH,EAMAgB,4BAA6B,WACzB,IAGQhB,EAFJE,EAAYpD,OAAOqD,aAAa,EACpC,OAAID,GAA4F,GAA9EA,MAAAA,EAA6C,KAAA,EAASA,EAAUe,YAEvEjB,OADHA,EAAQ,OAACtI,EAAKwI,MAAAA,EAA6C,KAAA,EAASA,EAAUgB,YAAwC,KAAA,EAASxJ,EAAGE,KAAKsI,EAAW,CAAC,GAC3G,KAAA,EAASF,EAAMmB,eAExD,IACX,EAMAC,kCAAmC,WAC/B,IAAIC,EAAiBvL,QAAQkL,4BAA4B,EACzD,OAAIK,EACOA,EAAe5J,cAEnB,IACX,EAMA6J,eAAgB,WACZ,IAGQtB,EAFJE,EAAYpD,OAAOqD,aAAa,EACpC,OAAID,GAA4F,GAA9EA,MAAAA,EAA6C,KAAA,EAASA,EAAUe,aAG9EM,OADIA,EAAoB,OAAC5J,EAAKqI,OAD1BA,EAAQ,OAACtI,EAAKwI,MAAAA,EAA6C,KAAA,EAASA,EAAUgB,YAAwC,KAAA,EAASxJ,EAAGE,KAAKsI,EAAW,CAAC,GACpF,KAAA,EAASF,EAAMwB,YAAwC,KAAA,EAAS7J,EAAGC,KAAKoI,CAAK,IAC1EuB,EAAkBnB,mBAAmBJ,MAAAA,EAAqC,KAAA,EAASA,EAAMmB,cAAc,EAC7KI,MAAAA,GAAsEA,EAAkBE,OAAOzB,MAAAA,EAAqC,KAAA,EAASA,EAAMmB,eAAgBnB,MAAAA,EAAqC,KAAA,EAASA,EAAM0B,WAAW,EAC3N,OAACf,EAAK,OAACnI,EAAK+I,MAAAA,EAA6D,KAAA,EAASA,EAAkBI,UAAsC,KAAA,EAASnJ,EAAGZ,KAAK2J,CAAiB,GAA+B,KAAA,EAASZ,EAAGzJ,QAE3N,CAAC,CACZ,EAMA0K,wBAAyB,WACrB,IAAIlK,EACJ,GAAIoF,OAAOqD,aAAc,CACrB,IAAID,EAAYpD,OAAOqD,aAAa,EACpC,GAAID,GAAoC,EAAvBA,EAAUe,WAEvB,OAAO,OAACvJ,EAAKsI,OADTA,EAAQE,EAAUgB,WAAW,CAAC,GACgB,KAAA,EAASlB,EAAM6B,uBAAmD,KAAA,EAASnK,EAAGE,KAAKoI,CAAK,CAElJ,CACA,OAAO,IACX,EASA8B,mBAAoB,SAAU/G,GAC1B,IAGIgH,EAHQjF,OAAOkF,iBAAiBjH,CAAO,EACrBkH,UAEFC,MAAM,kBAAkB,EAC5C,OAAIH,EAEO,CACHI,YAFAC,EAASL,EAAI,GAAGxI,MAAM,IAAI,EAAE8I,IAAIC,UAAU,GAEvB,GACnBC,WAAYH,EAAO,GACnBI,OAAQC,KAAKC,KAAKN,EAAO,GAAKA,EAAO,GAAKA,EAAO,GAAKA,EAAO,EAAE,EAC/DO,OAAQF,KAAKC,KAAKN,EAAO,GAAKA,EAAO,GAAKA,EAAO,GAAKA,EAAO,EAAE,EAC/DQ,OAAQH,KAAKI,MAAMT,EAAO,GAAIA,EAAO,EAAE,GAAK,IAAMK,KAAKK,GAE3D,EAGG,CACHX,WAAY,EACZI,WAAY,EACZC,OAAQ,EACRG,OAAQ,EACRC,OAAQ,CACZ,CACJ,CAEJ,iBACe9M"}