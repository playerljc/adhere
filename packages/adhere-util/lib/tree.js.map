{"version":3,"file":"tree.js","sources":["tree.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexport default {\r\n    /**\r\n     * arrayToAntdTree - array转换成Tree\r\n     * @param arr\r\n     * @param keyAttr - id的属性\r\n     * @param titleAttr - title的属性\r\n     * @param rootParentId - root的parentId值\r\n     */\r\n    arrayToAntdTree: function (arr, _a) {\r\n        var keyAttr = _a.keyAttr, titleAttr = _a.titleAttr, rootParentId = _a.rootParentId;\r\n        /**\r\n         * findNodesByParentId\r\n         * @param arr\r\n         * @param parentId\r\n         * @return {*}\r\n         */\r\n        function findNodesByParentId(arr, parentId) {\r\n            return arr\r\n                .filter(function (item) { return item.parentId == parentId; })\r\n                .map(function (item) { return ({\r\n                title: item[titleAttr],\r\n                key: item[keyAttr],\r\n                children: [],\r\n                props: __assign({}, item),\r\n                isLeaf: true,\r\n            }); });\r\n        }\r\n        /**\r\n         * Recursion\r\n         * @constructor\r\n         */\r\n        function Recursion(node) {\r\n            node.children = findNodesByParentId(arr, node.props[keyAttr]);\r\n            node.isLeaf = !node.children.length;\r\n            if (node.isLeaf) {\r\n                delete node.children;\r\n            }\r\n            (node.children || []).forEach(function (node) {\r\n                Recursion(node);\r\n            });\r\n        }\r\n        var roots = findNodesByParentId(arr, rootParentId);\r\n        roots.forEach(function (root) {\r\n            Recursion(root);\r\n        });\r\n        return roots;\r\n    },\r\n    /**\r\n     * getAncestor - 获取祖先\r\n     * @param data\r\n     * @param node\r\n     * @param config\r\n     */\r\n    getAncestor: function (data, node, config) {\r\n        var result = [];\r\n        var curNode = node;\r\n        while (curNode && curNode[config.parentIdAttr] != config.rootParentId) {\r\n            var item = data.find(function (t) { return t[config.keyAttr] === curNode[config.parentIdAttr]; });\r\n            if (item) {\r\n                result.push(item);\r\n            }\r\n            curNode = item;\r\n        }\r\n        return result;\r\n    },\r\n    /**\r\n     * filterTree - 本地过滤tree\r\n     * @param data\r\n     * @param kw\r\n     * @param config\r\n     */\r\n    filterTree: function (data, kw, config) {\r\n        var _this = this;\r\n        var filterAttr = config.filterAttr, parentIdAttr = config.parentIdAttr, arrayToAntdTreeConfig = __rest(config, [\"filterAttr\", \"parentIdAttr\"]);\r\n        if (kw) {\r\n            var set_1 = new Set();\r\n            var arr = data.filter(function (node) {\r\n                return node[config.filterAttr].indexOf(kw) !== -1;\r\n            });\r\n            arr.forEach(function (t) {\r\n                var tops = _this.getAncestor(data, t, config);\r\n                var tArr = __spreadArrays((tops || [])).map(function (item) { return item[config.keyAttr]; });\r\n                set_1 = new Set(__spreadArrays(set_1, tArr));\r\n            });\r\n            set_1 = new Set(__spreadArrays(set_1, arr.map(function (t) { return t[config.keyAttr]; })));\r\n            return this.arrayToAntdTree(__spreadArrays(set_1).map(function (t) { return data.find(function (item) { return item[config.keyAttr] === t; }); }), arrayToAntdTreeConfig);\r\n        }\r\n        else {\r\n            return this.arrayToAntdTree(data, arrayToAntdTreeConfig);\r\n        }\r\n    },\r\n};\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","Array","k","a","j","jl","arrayToAntdTree","arr","_a","keyAttr","titleAttr","rootParentId","findNodesByParentId","parentId","filter","item","map","title","key","children","props","isLeaf","roots","forEach","root","Recursion","node","getAncestor","data","config","result","curNode","parentIdAttr","find","push","filterTree","kw","_this","arrayToAntdTreeConfig","filterAttr","set_1","Set","tops","tArr"],"mappings":"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"}