{"version":3,"file":"Trigger.js","sources":["Trigger.js"],"sourcesContent":["import _LeftOutline from \"antd-mobile-icons/es/LeftOutline\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport classNames from 'classnames';\nimport debounce from 'lodash.debounce';\nimport React, { useMemo } from 'react';\nimport Intl from '@baifendian/adhere-util-intl';\nimport Popup from './popup';\nimport SubmitButton from './SubmitButton';\nvar selectorPrefix = 'adhere-ui-popup';\nvar triggerSelectorPrefix = \"\".concat(selectorPrefix, \"-trigger\");\nvar triggerSelectorInnerPrefix = \"\".concat(triggerSelectorPrefix, \"-inner\");\n/**\n * Trigger\n * @param className\n * @param style\n * @param renderTrigger\n * @param popupConfig\n * @param title\n * @param closeIcon\n * @param extra\n * @param actions\n * @param children\n * @param value\n * @param onChange\n * @constructor\n */\nvar Trigger = function Trigger(_a) {\n  var className = _a.className,\n    style = _a.style,\n    renderTrigger = _a.renderTrigger,\n    popupConfig = _a.popupConfig,\n    title = _a.title,\n    _b = _a.closeIcon,\n    closeIcon = _b === void 0 ? true : _b,\n    extra = _a.extra,\n    actions = _a.actions,\n    children = _a.children,\n    value = _a.value,\n    onChange = _a.onChange;\n  var onConfirm = function onConfirm(onClick, close) {\n    return new Promise(function (resolve, reject) {\n      var _a;\n      (_a = onClick === null || onClick === void 0 ? void 0 : onClick()) === null || _a === void 0 ? void 0 : _a.then(function (result) {\n        onChange === null || onChange === void 0 ? void 0 : onChange(result);\n        setTimeout(function () {\n          resolve(result);\n          close === null || close === void 0 ? void 0 : close();\n        }, 300);\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  };\n  var Children = useMemo(function () {\n    return children ? /*#__PURE__*/React.cloneElement(children, __assign(__assign({}, children.props), {\n      value: value\n    }), children.props.children) : null;\n  }, [children]);\n  var onTrigger = function onTrigger() {\n    var _a, _b, _c;\n    var popup = Popup.create(__assign(__assign({}, popupConfig !== null && popupConfig !== void 0 ? popupConfig : {}), {\n      onBeforeClose: function onBeforeClose() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = popupConfig !== null && popupConfig !== void 0 ? popupConfig : {}) === null || _a === void 0 ? void 0 : _a.onBeforeClose) === null || _b === void 0 ? void 0 : _b.call(_a)) !== null && _c !== void 0 ? _c : Promise.resolve();\n      },\n      onAfterClose: function onAfterClose() {\n        var _a, _b, _c;\n        return (_c = (_b = (_a = popupConfig !== null && popupConfig !== void 0 ? popupConfig : {}) === null || _a === void 0 ? void 0 : _a.onAfterClose) === null || _b === void 0 ? void 0 : _b.call(_a)) !== null && _c !== void 0 ? _c : Popup.destroy(popup);\n      },\n      children: /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(triggerSelectorInnerPrefix)\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(\"\".concat(triggerSelectorInnerPrefix, \"-header\"))\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(triggerSelectorInnerPrefix, \"-close\"),\n        onClick: function onClick() {\n          return popup.close();\n        }\n      }, closeIcon && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"\".concat(triggerSelectorInnerPrefix, \"-close-inner\")\n      }, /*#__PURE__*/React.createElement(_LeftOutline, null))), title && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(triggerSelectorInnerPrefix, \"-title\")\n      }, title), extra && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(triggerSelectorInnerPrefix, \"-extra\")\n      }, extra)), /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(\"\".concat(triggerSelectorInnerPrefix, \"-body\"))\n      }, Children), /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(\"\".concat(triggerSelectorInnerPrefix, \"-actions\"))\n      }, __spreadArray([/*#__PURE__*/React.createElement(\"div\", {\n        key: \"close\",\n        className: classNames(\"\".concat(triggerSelectorInnerPrefix, \"-action\"))\n      }, /*#__PURE__*/React.createElement(SubmitButton, {\n        key: \"close\",\n        onClick: function onClick() {\n          return new Promise(function (resolve) {\n            popup === null || popup === void 0 ? void 0 : popup.close();\n            resolve();\n          });\n        }\n      }, Intl.v('关闭')))], (_c = (_b = (_a = actions !== null && actions !== void 0 ? actions : []).map) === null || _b === void 0 ? void 0 : _b.call(_a, function (_actionConfig) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: _actionConfig.key,\n          className: classNames(\"\".concat(triggerSelectorInnerPrefix, \"-action\"))\n        }, /*#__PURE__*/React.createElement(SubmitButton, __assign({}, _actionConfig !== null && _actionConfig !== void 0 ? _actionConfig : {}, {\n          onClick: function onClick() {\n            return onConfirm(_actionConfig.onClick, function () {\n              return popup === null || popup === void 0 ? void 0 : popup.close();\n            });\n          }\n        })));\n      })) !== null && _c !== void 0 ? _c : [], true)))\n    }));\n    popup.show();\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(triggerSelectorPrefix, className !== null && className !== void 0 ? className : ''),\n    style: style !== null && style !== void 0 ? style : {},\n    onClick: debounce(onTrigger, 200)\n  }, renderTrigger === null || renderTrigger === void 0 ? void 0 : renderTrigger());\n};\nexport default Trigger;"],"names":["_LeftOutline","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","ar","l","Array","slice","concat","classNames","debounce","React","useMemo","Intl","Popup","SubmitButton","selectorPrefix","triggerSelectorPrefix","triggerSelectorInnerPrefix","Trigger","_a","className","style","renderTrigger","popupConfig","title","_b","closeIcon","extra","actions","children","value","onChange","Children","cloneElement","props","createElement","onClick","_c","popup","create","onBeforeClose","Promise","resolve","onAfterClose","destroy","close","key","v","map","_actionConfig","reject","then","result","setTimeout","catch","error","show"],"mappings":"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"}