var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var l in r=arguments[t])Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,l=0,c=r.length;l<c;l++)!n&&l in r||((n=n||Array.prototype.slice.call(r,0,l))[l]=r[l]);return e.concat(n||Array.prototype.slice.call(r))};import{LeftOutline}from"antd-mobile-icons";import classNames from"classnames";import debounce from"lodash.debounce";import React,{useEffect,useMemo,useRef}from"react";import Intl from"@baifendian/adhere-util-intl";import Popup from"./Popup";import SubmitButton from"./SubmitButton";var selectorPrefix="adhere-ui-popup",triggerSelectorPrefix="".concat(selectorPrefix,"-trigger"),triggerSelectorInnerPrefix="".concat(triggerSelectorPrefix,"-inner"),Trigger=function(e){var r=e.className,t=e.style,n=e.renderTrigger,l=e.popupConfig,c=e.title,a=e.closeIcon,o=void 0===a||a,i=e.extra,s=e.actions,u=e.children,m=e.value,a=e.disabled,f=void 0!==a&&a,g=e.onChange,d=useRef(),p=useMemo(function(){return u?React.cloneElement(u,__assign(__assign({},u.props),{value:m}),u.props.children):null},[u,m]),v=useMemo(function(){var e,r;return React.createElement("div",{className:classNames(triggerSelectorInnerPrefix)},React.createElement("div",{className:classNames("".concat(triggerSelectorInnerPrefix,"-header"))},React.createElement("div",{className:"".concat(triggerSelectorInnerPrefix,"-close"),onClick:function(){var e;null!=(e=d.current)&&e.close()}},o&&React.createElement("span",{className:"".concat(triggerSelectorInnerPrefix,"-close-inner")},React.createElement(LeftOutline,null))),c&&React.createElement("div",{className:"".concat(triggerSelectorInnerPrefix,"-title")},c),i&&React.createElement("div",{className:"".concat(triggerSelectorInnerPrefix,"-extra")},i)),React.createElement("div",{className:classNames("".concat(triggerSelectorInnerPrefix,"-body"))},p),React.createElement("div",{className:classNames("".concat(triggerSelectorInnerPrefix,"-actions"))},__spreadArray([React.createElement("div",{key:"close",className:classNames("".concat(triggerSelectorInnerPrefix,"-action"))},React.createElement(SubmitButton,{key:"close",onClick:function(){return new Promise(function(e){setTimeout(function(){var e;null!=(e=d.current)&&e.close()},100),e()})}},Intl.v("关闭")))],null!=(r=null==(r=(e=null!=s?s:[]).map)?void 0:r.call(e,function(e){return React.createElement("div",{key:e.key,className:classNames("".concat(triggerSelectorInnerPrefix,"-action"))},React.createElement(SubmitButton,__assign({},null!=e?e:{},{onClick:function(){return n=e.onClick,l=function(){var e;return null==(e=null==d?void 0:d.current)?void 0:e.close()},new Promise(function(r,t){var e;null!=(e=null==n?void 0:n())&&e.then(function(e){null!=g&&g(e),setTimeout(function(){r(e),null!=l&&l()},400)}).catch(function(e){return t(e)})});var n,l}})))}))?r:[],!0)))},[p,c,s,i,o]);return useEffect(function(){var e;null!=(e=d.current)&&e.update(v)}),React.createElement("div",{className:classNames(triggerSelectorPrefix,null!=r?r:""),style:null!=t?t:{},onClick:debounce(function(){var e;f||(d.current=Popup.create(__assign(__assign({},null!=l?l:{}),{onBeforeClose:function(){var e,r;return null!=(r=null==(r=null==(e=null!=l?l:{})?void 0:e.onBeforeClose)?void 0:r.call(e))?r:Promise.resolve()},onAfterClose:function(){var e,r;return null!=(r=null==(r=null==(e=null!=l?l:{})?void 0:e.onAfterClose)?void 0:r.call(e))?r:Popup.destroy(d.current)},children:v})),null!=(e=d.current)&&e.show())},200)},null==n?void 0:n())};Trigger.displayName="Trigger";export default Trigger;
//# sourceMappingURL=Trigger.js.map
