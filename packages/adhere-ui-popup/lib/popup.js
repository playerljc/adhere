"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var prePopup,maskEl,react_dom_1=__importDefault(require("react-dom")),uuid_1=require("uuid"),selectorPrefix="adhere-ui-popup",popups=[],el=null,Popup=function(){function t(t){this.id="",this.config=null,this.isShow=!1,this.el=null,this.popupEl=null,this.isShow=!1,this.el=PopupFactory.getEl(),this.id=uuid_1.v1(),this.config=t,this.onMaskElTransitionend=this.onMaskElTransitionend.bind(this),this.onInnerElTransitionend=this.onInnerElTransitionend.bind(this),this.render()}return t.prototype.createMask=function(){var t=this.config.zIndex;(maskEl=document.createElement("div")).className=selectorPrefix+"-mask",maskEl.style.zIndex=String((t||11e3)-1500),this.el.appendChild(maskEl),maskEl.addEventListener("transitionend",this.onMaskElTransitionend)},t.prototype.render=function(){var t=this,e=this.config,o=e.children,e=e.zIndex;this.popupEl=document.createElement("div"),this.popupEl.addEventListener("transitionend",this.onInnerElTransitionend),this.popupEl.className=selectorPrefix,this.popupEl.style.zIndex=String(e||11e3),react_dom_1.default.render(o,this.popupEl,function(){t.el.appendChild(t.popupEl),t.trigger("onCreate")})},t.prototype.trigger=function(t){if(this.config[t])return this.config[t]()},t.prototype.show=function(){var t=this;return maskEl||this.createMask(),maskEl.style.display="block",this.popupEl.style.display="block",this.isShow=!0,this.trigger("onBeforeShow"),setTimeout(function(){maskEl.classList.add("modal-in"),t.popupEl.classList.add("modal-in")},100),!0},t.prototype.showClosePrePopup=function(){var t=this;return maskEl||this.createMask(),prePopup&&prePopup.close(),maskEl.style.display="block",this.popupEl.style.display="block",this.isShow=!0,this.trigger("onBeforeShow"),setTimeout(function(){maskEl.classList.add("modal-in"),t.popupEl.classList.add("modal-in")},100),!0},t.prototype.close=function(){var t=this;maskEl||this.createMask(),this.isShow=!1;var e=this.trigger("onBeforeClose");return e?e.then(function(){t.popupEl.classList.remove("modal-in"),maskEl.classList.remove("modal-in")}):(this.popupEl.classList.remove("modal-in"),maskEl.classList.remove("modal-in")),!0},t.prototype.destroy=function(){return react_dom_1.default.unmountComponentAtNode(this.popupEl)&&(this.popupEl.parentNode.removeChild(this.popupEl),this.popupEl=null),this.trigger("onDestroy"),!0},t.prototype.isDestroy=function(){return!this.popupEl},t.prototype.getId=function(){return this.id},t.prototype.onInnerElTransitionend=function(){this.isShow?(prePopup=this).trigger("onAfterShow"):(prePopup=null,this.popupEl.style.display="none",this.trigger("onAfterClose"))},t.prototype.onMaskElTransitionend=function(){this.isShow||(maskEl.style.display="none")},t}(),PopupFactory={create:function(t){t=new Popup(t);return popups.push(t),t},show:function(t){return!!t&&(!t.isDestroy()&&(t!==prePopup&&((!prePopup||t.getId()!==prePopup.getId())&&t.show())))},showClosePrePopup:function(t){return!!t&&(!t.isDestroy()&&(t!==prePopup&&((!prePopup||t.getId()!==prePopup.getId())&&(prePopup&&prePopup.close(),t.show()))))},close:function(t){return!!t&&(!t.isDestroy()&&t.close())},closeAll:function(){var e=this,o=[];return popups.forEach(function(t){t=e.close(t);o.push(t)}),o.every(function(t){return t})},destroy:function(e){if(!e)return!1;if(e.isDestroy())return!1;var t,o=e.destroy();return!o||-1!==(t=popups.findIndex(function(t){return t===e}))&&popups.splice(t,1),o},getEl:function(){return el||document.body},setEl:function(t){el=t}};exports.default=PopupFactory;
//# sourceMappingURL=popup.js.map
