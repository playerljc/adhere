"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,l=1,r=arguments.length;l<r;l++)for(var n in t=arguments[l])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding=Object.create?function(e,t,l,r){void 0===r&&(r=l);var n=Object.getOwnPropertyDescriptor(t,l);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[l]}}),Object.defineProperty(e,r,n)}:function(e,t,l,r){e[r=void 0===r?l:r]=t[l]},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)"default"!==l&&Object.prototype.hasOwnProperty.call(e,l)&&__createBinding(t,e,l);return __setModuleDefault(t,e),t},__spreadArray=function(e,t,l){if(l||2===arguments.length)for(var r,n=0,a=t.length;n<a;n++)!r&&n in t||((r=r||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},antd_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("antd")),antd_mobile_1=require("antd-mobile"),antd_mobile_icons_1=require("antd-mobile-icons"),classnames_1=__importDefault(require("classnames")),react_1=__importStar(require("react")),adhere_util_intl_1=__importDefault(require("@baifendian/adhere-util-intl")),selectorPrefix="adhere-mobile-ui-auto-complete",Title=antd_1.Typography.Title,Text=antd_1.Typography.Text,AutoComplete=(0,react_1.memo)(function(e){function t(){return!(null!=d&&d.length)}function n(e){return e[null!=f?f:"id"]}function a(e){return e[null!=m?m:"value"]}function r(e){return null!=(e=e[null!=s?s:"label"])?e:null}function u(l){var t,e;x(function(e){return e.filter(function(e){var t;return(null!=(t=a(e))?t:n(e))!==l})}),null!=v&&v((t=l,null!=(e=null==(e=null==p?void 0:p.filter)?void 0:e.call(p,function(e){return e!==t}))?e:[]))}var l=e.className,o=e.style,i=e.placeholder,c=e.searchBarProps,_=e.loadData,d=e.searchDataSource,f=e.rowKey,s=e.labelProp,m=e.valueProp,p=e.value,v=e.onChange,y=e.renderResultItem,h=e.renderEmpty,b=e.showResult,b=void 0===b||b,e=e.children,g=(0,react_1.useRef)(),E=(0,react_1.useState)(""),P=E[0],A=E[1],E=(0,react_1.useState)([]),O=E[0],x=E[1];return(0,react_1.useEffect)(function(){x(function(r){var e;return null!=(e=null==(e=null==p?void 0:p.map)?void 0:e.call(p,function(l){var e,t;return null==(t=null==(e=__spreadArray(__spreadArray([],null!=d?d:[],!0),r,!0))?void 0:e.find)?void 0:t.call(e,function(e){var t;return(null!=(t=a(e))?t:n(e))===l})}))?e:[]})},[d,p]),react_1.default.createElement("div",{className:(0,classnames_1.default)(selectorPrefix,null!=l?l:""),style:null!=o?o:{},ref:g},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-search-bar")},react_1.default.createElement(antd_mobile_1.SearchBar,__assign({placeholder:null!=i?i:adhere_util_intl_1.default.v("输入文字过滤选项"),value:P,onChange:function(e){e||null!=_&&_(""),A(e)},onSearch:function(){null!=_&&_(P)}},null!=c?c:{}))),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-body")},t()&&(null!=(E=null==h?void 0:h())?E:react_1.default.createElement(antd_mobile_1.ErrorBlock,{status:"empty"})),!t()&&(null==e?void 0:e({value:p,onChange:function(e){x(function(r){return e.map(function(l){var e,t;return null==(t=null==(e=__spreadArray(__spreadArray([],null!=d?d:[],!0),r,!0))?void 0:e.find)?void 0:t.call(e,function(e){var t;return(null!=(t=a(e))?t:n(e))===l})})}),null!=v&&v(e)},searchDataSource:__spreadArray([],null!=d?d:[],!0)}))),b&&!(null==p||!p.length)&&react_1.default.createElement(antd_mobile_1.FloatingPanel,{anchors:[28,(null!=(o=null==(l=null==g?void 0:g.current)?void 0:l.offsetHeight)?o:0)-200].filter(function(e){return 0<=e})},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-result")},react_1.default.createElement(antd_mobile_1.NoticeBar,{content:adhere_util_intl_1.default.vHtml("共 <em>{n}</em> 条",{n:O.length}),color:"info"}),react_1.default.createElement(antd_mobile_1.List,null,null==O?void 0:O.map(function(e,t){var l;return react_1.default.createElement(antd_mobile_1.List.Item,{key:n(e)},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-result-item-close"),onClick:function(){return u(null==p?void 0:p[t])}},react_1.default.createElement(antd_mobile_icons_1.CloseCircleFill,null)),null!=(l=null==y?void 0:y(e))?l:react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(Title,{level:5,ellipsis:!0},r(e)),react_1.default.createElement(Text,{type:"secondary",ellipsis:!0},r(e))))})))))});AutoComplete.displayName="AutoComplete",exports.default=AutoComplete;
//# sourceMappingURL=AutoComplete.js.map
