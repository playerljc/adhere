"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,l=1,n=arguments.length;l<n;l++)for(var r in t=arguments[l])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__createBinding=Object.create?function(e,t,l,n){void 0===n&&(n=l);var r=Object.getOwnPropertyDescriptor(t,l);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[l]}}),Object.defineProperty(e,n,r)}:function(e,t,l,n){e[n=void 0===n?l:n]=t[l]},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)"default"!==l&&Object.prototype.hasOwnProperty.call(e,l)&&__createBinding(t,e,l);return __setModuleDefault(t,e),t},__spreadArray=function(e,t,l){if(l||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||((n=n||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},antd_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("antd")),antd_mobile_1=require("antd-mobile"),antd_mobile_icons_1=require("antd-mobile-icons"),classnames_1=__importDefault(require("classnames")),react_1=__importStar(require("react")),adhere_util_1=__importDefault(require("@baifendian/adhere-util")),adhere_util_intl_1=__importDefault(require("@baifendian/adhere-util-intl")),selectorPrefix="adhere-mobile-ui-auto-complete",Title=antd_1.Typography.Title,Text=antd_1.Typography.Text,AutoComplete=(0,react_1.memo)(function(e){var t=e.className,l=e.style,n=e.searchBarClassName,r=e.searchBarStyle,a=e.bodyClassName,u=e.bodyStyle,o=e.placeholder,i=e.searchBarProps,c=e.loadData,s=e.searchDataSource,_=e.rowKey,d=e.labelProp,f=e.valueProp,m=e.value,p=e.onChange,v=e.renderResultItem,h=e.renderEmpty,y=e.showResult,y=void 0===y||y,e=e.children,b=(0,react_1.useRef)(),g=(0,react_1.useState)(""),E=g[0],P=g[1],g=(0,react_1.useState)([]),C=g[0],O=g[1],A=(0,react_1.useMemo)(function(){return(null!=m?m:[]).map(function(e){var t;return adhere_util_1.default.isObject(e)?null!=(t=S(e))?t:x(e):e})},[m]);function j(){return!(null!=s&&s.length)}function x(e){return null==e?void 0:e[null!=_?_:"id"]}function S(e){return null==e?void 0:e[null!=f?f:"value"]}function D(l){var t,e;O(function(e){return e.filter(function(e){var t;return(null!=(t=S(e))?t:x(e))!==l})}),null!=p&&p((t=l,null!=(e=null==(e=null==A?void 0:A.filter)?void 0:e.call(A,function(e){return e!==t}))?e:[]))}return(0,react_1.useEffect)(function(){O(function(e){var t=__spreadArray(__spreadArray([],null!=s?s:[],!0),e,!0);return null!=(e=null==(e=null==m?void 0:m.map)?void 0:e.call(m,function(l){return adhere_util_1.default.isObject(l)?l:t.find(function(e){var t;return(null!=(t=S(e))?t:x(e))===l})}))?e:[]})},[s,m]),react_1.default.createElement("div",{className:(0,classnames_1.default)(selectorPrefix,null!=t?t:""),style:null!=l?l:{},ref:b},react_1.default.createElement("div",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-search-bar"),null!=n?n:""),style:null!=r?r:{}},react_1.default.createElement(antd_mobile_1.SearchBar,__assign({placeholder:null!=o?o:adhere_util_intl_1.default.v("输入文字过滤选项"),value:E,onChange:function(e){console.log("onSearchChange"),e||null!=c&&c(""),P(e)},onSearch:function(){null!=c&&c(E)}},null!=i?i:{}))),react_1.default.createElement("div",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-body"),null!=a?a:""),style:null!=u?u:{}},j()&&(null!=(g=null==h?void 0:h())?g:react_1.default.createElement(antd_mobile_1.ErrorBlock,{status:"empty"})),!j()&&(null==e?void 0:e({value:A,onChange:function(e){var t=Array.isArray(e)?e:[e];O(function(n){return t.map(function(l){var e,t;return null==(t=null==(e=__spreadArray(__spreadArray([],null!=s?s:[],!0),n,!0))?void 0:e.find)?void 0:t.call(e,function(e){var t;return(null!=(t=S(e))?t:x(e))===l})})}),console.log("onCheckListChange",e),null!=p&&p(e)},searchDataSource:null!=s?s:[]}))),y&&!(null==m||!m.length)&&react_1.default.createElement(antd_mobile_1.FloatingPanel,{anchors:[28,(null!=(l=null==(t=null==b?void 0:b.current)?void 0:t.offsetHeight)?l:0)-200].filter(function(e){return 0<=e})},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-result")},react_1.default.createElement(antd_mobile_1.NoticeBar,{content:adhere_util_intl_1.default.vHtml("共 <em>{n}</em> 条",{n:C.length}),color:"info"}),react_1.default.createElement(antd_mobile_1.List,null,null==C?void 0:C.map(function(e,t){var l=x(e),n=null!=(n=null==(n=e)?void 0:n[null!=d?d:"label"])?n:null,n=react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(Title,{level:5,ellipsis:!0},n),react_1.default.createElement(Text,{type:"secondary",ellipsis:!0},n));return react_1.default.createElement(antd_mobile_1.List.Item,{key:l},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-result-item-close"),onClick:function(){return D(null==A?void 0:A[t])}},react_1.default.createElement(antd_mobile_icons_1.CloseCircleFill,null)),null!=(l=null==v?void 0:v(e,n))?l:n)})))))});AutoComplete.displayName="AutoComplete",exports.default=AutoComplete;
//# sourceMappingURL=AutoComplete.js.map
