import"core-js/modules/es.object.assign.js";import"core-js/modules/es.array.index-of.js";import"core-js/modules/es.symbol.js";import"core-js/modules/es.array.slice.js";import"core-js/modules/es.array.concat.js";import"core-js/modules/es.array.map.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/es.array.filter.js";import"core-js/modules/es.array.includes.js";import"core-js/modules/es.string.includes.js";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,r){var t={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]]);return t},__spreadArray=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,o=0,a=r.length;o<a;o++)!n&&o in r||((n=n||Array.prototype.slice.call(r,0,o))[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))};import React,{useEffect,useState}from"react";import ConditionalRender from"@baifendian/adhere-ui-conditionalrender";import{Checkbox}from"../../AntFormItemNormalize";import ListFormItem from"../ListFormItem";import MulitSelectFormItem from"../MulitSelectFormItem";var selectorPrefix="adhere-ui-antdformitem",ListMulitSelectFormItem=function(e){var t=e.dataSource,n=__rest(e,["dataSource"]),e=useState(""),r=e[0],o=e[1],e=useState(n.value||[]),a=e[0],c=e[1],e=useState(n.value?n.value.map(function(r){return t.find(function(e){return e[n.rowKey||"id"]===r})}):[]),i=(e[0],e[1]);function s(r){var t=n.rowKey||"id";return React.createElement(Checkbox,{onChange:function(e){e.stopPropagation(),e.target.checked?(c(function(e){return __spreadArray(__spreadArray([],e,!0),[r[t]],!1)}),i(function(e){return __spreadArray(__spreadArray([],e,!0),[__assign({},r)],!1)}),null!=(e=null==n?void 0:n.onChange)&&e.call(n,__spreadArray(__spreadArray([],a,!0),[r[t]],!1))):(c(function(e){return e.filter(function(e){return e!==r[t]})}),i(function(e){return e.filter(function(e){return e[t]!==r[t]})}),null!=(e=null==n?void 0:n.onChange)&&e.call(n,__spreadArray([],a.filter(function(e){return e!==r[t]}),!0)))},checked:a.includes(r[t])})}return useEffect(function(){n.value?(c(n.value),i(n.value.map(function(r){return t.find(function(e){return e[n.rowKey||"id"]===r})}))):(c([]),i([]))},[n.value]),React.createElement(MulitSelectFormItem,{selectProps:__assign({value:n.value,dropdownRender:function(){var e=r?t.filter(function(e){return-1!==e[n.labelKey||"name"].indexOf(r)}):t;return React.createElement(ListFormItem,__assign({},n,{dataSource:e,renderItem:function(r,t){return React.createElement(ConditionalRender,{conditional:!!n.renderItem,noMatch:function(){return React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap")},React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap-fixed")},s(r)),React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap-auto")},r))}},function(){var e;return React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap")},React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap-fixed")},s(r)),React.createElement("div",{className:"".concat(selectorPrefix,"-rowselectwrap-auto")},null==(e=null==n?void 0:n.renderItem)?void 0:e.call(n,r,t)))})}}))},onChange:function(e){var r;null!=(r=null==n?void 0:n.onChange)&&r.call(n,e)},filterOption:function(){return!1},onSearch:function(e){return o(e)},onBlur:function(){o("")},onClear:function(){o("")}},n.selectProps||{}),dataSource:t.map(function(e){return{label:e[n.labelKey||"name"],value:e[n.rowKey||"id"]}})})};export default ListMulitSelectFormItem;
//# sourceMappingURL=index.js.map
