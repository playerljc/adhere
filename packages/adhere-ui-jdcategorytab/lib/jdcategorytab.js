"use strict";var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(require("react")),prop_types_1=__importDefault(require("prop-types")),classnames_1=__importDefault(require("classnames")),iscroll_1=__importDefault(require("iscroll/build/iscroll")),item_1=__importDefault(require("./item")),context_1=require("./context"),selectorPrefix="adhere-ui-jdcategorytab",JdCategoryTab=function(t){function e(e){e=t.call(this,e)||this;return e.ease=iscroll_1.default.utils.ease,e.state={activeKey:e.props.activeKey},e}return __extends(e,t),e.prototype.componentDidMount=function(){this.initMenuScroll()},e.prototype.componentWillReceiveProps=function(e,t){e.activeKey!==this.state.activeKey&&this.setState({activeKey:e.activeKey})},e.prototype.componentDidUpdate=function(e,t,n){t.activeKey!==this.state.activeKey&&this.scrollTo(this.state.activeKey)},e.prototype.initMenuScroll=function(){this.scroll=new iscroll_1.default(this.menuEl,{mouseWheel:!0,click:!0}),this.menuEl.addEventListener("touchmove",function(e){e.preventDefault()})},e.prototype.findElByKey=function(t){var e=this.props.menuData.findIndex(function(e){return e.key===t});console.log("index",e);var n=Array.from(null===(n=this.menuInnerEl)||void 0===n?void 0:n.querySelectorAll("."+selectorPrefix+"-menu-item"));return n.length?n[e]:null},e.prototype.scrollTo=function(e,t,n){var s=this;void 0===t&&(t=250),n=n||this.ease.circular;var a=!0;(a=this.props.onBeforeChange?this.props.onBeforeChange(this.state.activeKey,e):a)&&(console.log(this.state.activeKey,e,t),this.scroll.scrollToElement(this.findElByKey(e),t,null,null,n),setTimeout(function(){console.log("setTimeout"),s.setState({activeKey:e},function(){console.log("setTimeoutEnd"),s.props.onChange&&s.props.onChange(e)})},t))},e.prototype.renderMenu=function(){var n=this,e=this.props,t=e.menuData,s=e.menuItemClassName,a=e.menuItemStyle,r=e.renderMenuItem,l=this.state.activeKey;return t.map(function(t){return r?react_1.default.createElement("li",{key:t.key,className:classnames_1.default(selectorPrefix+"-menu-item",l===t.key?"active":null,s.split(/\s+/)),style:__assign({},a)},react_1.default.createElement("a",{onClick:function(e){n.scrollTo(t.key)}},r(t))):react_1.default.createElement("li",{key:t.key,className:classnames_1.default(selectorPrefix+"-menu-item",l===t.key?"active":null,s.split(/\s+/)),style:__assign({},a)},react_1.default.createElement("a",{onClick:function(e){n.scrollTo(t.key)}},t.name))})},e.prototype.render=function(){var t=this,e=this.props,n=e.className,s=e.style,a=e.menuClassName,r=e.menuStyle,l=e.menuInnerClassName,o=e.menuInnerStyle,i=e.tabClassName,u=e.tabStyle,e=e.children;return react_1.default.createElement(context_1.JdCategoryContext.Provider,{value:{activeKey:this.state.activeKey}},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,n.split(/\s+/)),style:__assign({},s),ref:function(e){return t.el=e}},react_1.default.createElement("div",{ref:function(e){return t.menuEl=e},className:classnames_1.default(selectorPrefix+"-menu",a.split(/\s+/)),style:__assign({},r)},react_1.default.createElement("ul",{ref:function(e){return t.menuInnerEl=e},className:classnames_1.default(selectorPrefix+"-menu-inner",l.split(/\s+/)),style:__assign({},o)},this.renderMenu())),react_1.default.createElement("ul",{className:classnames_1.default(selectorPrefix+"-tab",i.split(/\s+/)),style:__assign({},u)},e)))},e.Item=item_1.default,e}(react_1.default.Component);JdCategoryTab.defaultProps={className:"",style:{},menuClassName:"",menuStyle:{},menuInnerClassName:"",menuInnerStyle:{},tabClassName:"",tabStyle:{},menuItemClassName:"",menuItemStyle:{},menuData:[],activeKey:"",renderMenuItem:void 0,onBeforeChange:function(){return!0},onChange:function(){}},JdCategoryTab.propTypes={className:prop_types_1.default.string,style:prop_types_1.default.object,menuClassName:prop_types_1.default.string,menuStyle:prop_types_1.default.object,menuInnerClassName:prop_types_1.default.string,menuInnerStyle:prop_types_1.default.object,tabClassName:prop_types_1.default.string,tabStyle:prop_types_1.default.object,menuItemClassName:prop_types_1.default.string,menuItemStyle:prop_types_1.default.object,menuData:prop_types_1.default.arrayOf(prop_types_1.default.shape({key:prop_types_1.default.string,name:prop_types_1.default.string,properties:prop_types_1.default.object})),activeKey:prop_types_1.default.string,renderMenuItem:prop_types_1.default.func,onBeforeChange:prop_types_1.default.func,onChange:prop_types_1.default.func},exports.default=JdCategoryTab;
//# sourceMappingURL=jdcategorytab.js.map
