"use strict";var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(require("react")),prop_types_1=__importDefault(require("prop-types")),classnames_1=__importDefault(require("classnames")),adhere_util_resource_1=__importDefault(require("@baifendian/adhere-util-resource")),selectorPrefix="adhere-ui-backtopanimation",BackTopAnimation=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.key=!1,r.onTrigger=function(){var e,t,i,a,l=r;l.key||(t=(e=r.props).onTrigger,i=e.onScrollTop,a=e.duration,t&&t().then(function(){l.key=!0,l.maskEl.style.display="block";var r=l.scrollEl.scrollTop,n=r,o=0,s=l.scrollEl.scrollHeight/(a/(screen.updateInterval||16.7)+(a%(screen.updateInterval||16.7)!=0?1:0));window.requestAnimationFrame(function e(){function t(){l.maskEl.style.display="none",l.key=!1}r<o?o<n+s?n=o:n+=s:n-s<o?n=o:n-=s,l.scrollEl.scrollTop=n,i&&i(n),r<o?o<=n?t():window.requestAnimationFrame(e):n<=o?t():window.requestAnimationFrame(e)})}))},r}return __extends(t,e),t.prototype.componentDidMount=function(){this.initScrollEvent(),this.renderMask()},t.prototype.componentWillUnmount=function(){this.maskEl&&this.maskEl.parentElement.removeChild(this.maskEl)},t.prototype.initScrollEvent=function(){this.scrollEl=this.props.target();var e=this;this.scrollEl.addEventListener("scroll",function(){0!==e.scrollEl.scrollTop?window.requestAnimationFrame(function(){e.el.style.display="block"}):window.requestAnimationFrame(function(){e.el.style.display="none"})},!1)},t.prototype.renderMask=function(){this.maskEl=document.body.querySelector("."+selectorPrefix+"-mask"),this.maskEl||(this.maskEl=document.createElement("div"),this.maskEl.className=selectorPrefix+"-mask",document.body.appendChild(this.maskEl))},t.prototype.render=function(){var t=this,e=this.props,r=e.className,e=e.style;return react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,r.split(" ")),style:__assign({},e),ref:function(e){return t.el=e},onClick:this.onTrigger})},t}(react_1.default.Component);BackTopAnimation.defaultProps={className:"",style:{},zIndex:adhere_util_resource_1.default.Dict.value.ResourceNormalMaxZIndex.value,duration:300,target:function(){return window}},BackTopAnimation.propTypes={className:prop_types_1.default.string,style:prop_types_1.default.object,zIndex:prop_types_1.default.string,duration:prop_types_1.default.number,target:prop_types_1.default.func,onTrigger:prop_types_1.default.func,onScrollTop:prop_types_1.default.func},exports.default=BackTopAnimation;
//# sourceMappingURL=backtopanimation.js.map
