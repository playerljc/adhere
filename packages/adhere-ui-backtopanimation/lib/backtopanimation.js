"use strict";var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(require("react")),prop_types_1=__importDefault(require("prop-types")),classnames_1=__importDefault(require("classnames")),adhere_util_resource_1=__importDefault(require("@baifendian/adhere-util-resource")),selectorPrefix="adhere-ui-backtopanimation",BackTopAnimation=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.key=!1,n.onTrigger=function(){var e,t,s,a,l=n;l.key||(t=(e=n.props).onTrigger,s=e.onScrollTop,a=e.duration,t&&t().then(function(){l.key=!0,l.maskEl.style.display="block";var n=l.scrollEl.scrollTop,o=n,r=0,i=l.scrollEl.scrollHeight/(a/(screen.updateInterval||16.7)+(a%(screen.updateInterval||16.7)!=0?1:0));"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function t(){l.maskEl.style.display="none",l.key=!1}n<r?r<o+i?o=r:o+=i:o-i<r?o=r:o-=i,l.scrollEl.scrollTop=o,s&&s(o),n<r?r<=o?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):o<=r?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)})}))},n}return __extends(t,e),t.prototype.componentDidMount=function(){this.initScrollEvent(),this.renderMask()},t.prototype.componentWillUnmount=function(){this.maskEl&&this.maskEl.parentElement.removeChild(this.maskEl)},t.prototype.initScrollEvent=function(){this.scrollEl=this.props.target();var e=this;this.scrollEl.addEventListener("scroll",function(){0!==e.scrollEl.scrollTop?"undefined"!=typeof window&&window.requestAnimationFrame(function(){e.el.style.display="block"}):"undefined"!=typeof window&&window.requestAnimationFrame(function(){e.el.style.display="none"})},!1)},t.prototype.renderMask=function(){this.maskEl=document.body.querySelector("."+selectorPrefix+"-mask"),this.maskEl||(this.maskEl=document.createElement("div"),this.maskEl.className=selectorPrefix+"-mask",document.body.appendChild(this.maskEl))},t.prototype.render=function(){var t=this,e=this.props,n=e.className,e=e.style;return react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,n.split(" ")),style:__assign({},e),ref:function(e){return t.el=e},onClick:this.onTrigger})},t}(react_1.default.Component);BackTopAnimation.defaultProps={className:"",style:{},zIndex:adhere_util_resource_1.default.Dict.value.ResourceNormalMaxZIndex.value,duration:300,target:function(){return window}},BackTopAnimation.propTypes={className:prop_types_1.default.string,style:prop_types_1.default.object,zIndex:prop_types_1.default.string,duration:prop_types_1.default.number,target:prop_types_1.default.func,onTrigger:prop_types_1.default.func,onScrollTop:prop_types_1.default.func},exports.default=BackTopAnimation;
//# sourceMappingURL=backtopanimation.js.map
