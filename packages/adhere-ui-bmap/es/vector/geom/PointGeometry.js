var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};import{GeometryType,VectorActions}from"../types";import Geometry from"./Geometry";import GeometryStyle from"../style/GeometryStyle";import RegularPolygonGeometry from"./RegularPolygonGeometry";import StartGeometry from"./StartGeometry";import SectorGeometry from"./SectorGeometry";import CircleGeometry from"./CircleGeometry";import RectGeometry from"./RectGeometry";import RadiusRectGeometry from"./RadiusRectGeometry";import LeafGeometry from"./LeafGeometry";import ImageCache from"../ImageCache";var PointGeometry=function(r){function a(e){var t=r.call(this)||this;return t.coordinates=e,t}return __extends(a,r),a.prototype.setCoordinates=function(e){this.coordinates=e,null!==(e=null==this?void 0:this.getLayer())&&void 0!==e&&e.getEmitter().trigger(VectorActions.UPDATE)},a.prototype.getCoordinates=function(){return __assign({},this.coordinates)},a.prototype.getType=function(){return GeometryType.Point},a.getCenterCoordinate=function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return a.centerCoordinateMapping.get(i.pointType)({ctx:t,coordinates:r,map:o,style:i,isScale:e})},a.prototype.getCenterCoordinate=function(e){var t=e.ctx,r=e.style;e.isScale;return a.getCenterCoordinate({coordinates:this.coordinates,ctx:t,map:this.getMap(),style:r,isScale:!1})},a.drawCirclePoint=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;CircleGeometry.drawCircle({ctx:t,style:r,coordinates:{radius:r.radius,center:o},map:e,isScale:!1})},a.drawImagePoint=function(e){var t,r=e.ctx,o=e.style,i=e.coordinates,a=e.map.pointToPixel(new BMap.Point(i.lng,i.lat)),i=ImageCache.get({src:(null===(i=null==o?void 0:o.img)||void 0===i?void 0:i.src)||"",width:(null===(i=null==o?void 0:o.img)||void 0===i?void 0:i.width)||0,height:(null===(i=null==o?void 0:o.img)||void 0===i?void 0:i.height)||0});i?r.drawImage(i,a.x,a.y,o.img.width,o.img.height):((t=new Image(o.img.width,o.img.height)).onload=function(){var e;ImageCache.add({src:(null===(e=null==o?void 0:o.img)||void 0===e?void 0:e.src)||"",width:(null===(e=null==o?void 0:o.img)||void 0===e?void 0:e.width)||0,height:(null===(e=null==o?void 0:o.img)||void 0===e?void 0:e.height)||0},t),r.drawImage(t,a.x,a.y,o.img.width,o.img.height)},t.src=o.img.src)},a.drawRegularPolygon=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RegularPolygonGeometry.drawRegularPolygon({ctx:t,style:r,coordinates:__assign(__assign({},r.regularPolygon),{center:o}),map:e,isScale:!1})},a.drawStart=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;StartGeometry.drawStart({ctx:t,style:r,coordinates:__assign(__assign({},r.start),{center:o}),map:e,isScale:!1})},a.drawSector=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;SectorGeometry.drawSector({ctx:t,style:r,coordinates:__assign(__assign({},r.sector),{center:o}),map:e,isScale:!1})},a.drawRect=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RectGeometry.drawRect({ctx:t,style:r,coordinates:__assign(__assign({},r.rect),{leftTop:o}),map:e,isScale:!1})},a.drawRadiusRect=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RadiusRectGeometry.drawRadiusRect({ctx:t,style:r,coordinates:__assign(__assign({},r.radiusRect),{leftTop:o}),map:e,isScale:!1})},a.drawLeaf=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;LeafGeometry.drawLeaf({ctx:t,style:r,coordinates:__assign(__assign({},r.leaf),{center:o}),map:e,isScale:!1})},a.drawPoint=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map,r=__assign(__assign(__assign({},GeometryStyle),{radius:5,pointType:"circle"}),r||{});a.drawMapping.get(null===r||void 0===r?void 0:r.pointType)({ctx:t,style:r,coordinates:o,map:e})},a.prototype.draw=function(e,t){a.drawPoint({ctx:e,style:t,coordinates:this.coordinates,map:this.getMap()})},a.isPixelInGeometry=function(e){var t=e.coordinates,r=e.map,o=e.pixel,e=e.style;return a.isPixelInGeometryMapping.get(null===e||void 0===e?void 0:e.pointType)({coordinates:a.pointTypeToCoordinatesMapping.get(null===e||void 0===e?void 0:e.pointType)(t,e),isScale:!1,map:r,style:e,pixel:o})},a.prototype.isPixelInGeometry=function(e,t){return a.isPixelInGeometry({coordinates:this.coordinates,pixel:e,map:this.getMap(),style:t})},a.drawMapping=new Map([["circle",a.drawCirclePoint],["image",a.drawImagePoint],["regularPolygon",a.drawRegularPolygon],["start",a.drawStart],["sector",a.drawSector],["rect",a.drawRect],["radiusRect",a.drawRadiusRect],["leaf",a.drawLeaf]]),a.isPixelInGeometryMapping=new Map([["circle",CircleGeometry.isPixelInGeometry],["image",RectGeometry.isPixelInGeometry],["regularPolygon",RegularPolygonGeometry.isPixelInGeometry],["start",StartGeometry.isPixelInGeometry],["sector",SectorGeometry.isPixelInGeometry],["rect",RectGeometry.isPixelInGeometry],["radiusRect",RadiusRectGeometry.isPixelInGeometry],["leaf",LeafGeometry.isPixelInGeometry]]),a.centerCoordinateMapping=new Map([["circle",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return CircleGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:{center:r,radius:i.radius}})}],["image",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.img)})}],["regularPolygon",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RegularPolygonGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.regularPolygon)})}],["start",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return StartGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.start)})}],["sector",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return SectorGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.sector)})}],["rect",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.rect)})}],["radiusRect",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RadiusRectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.radiusRect)})}],["leaf",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return LeafGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.leaf)})}]]),a.pointTypeToCoordinatesMapping=new Map([["circle",function(e,t){return{center:e,radius:t.radius}}],["image",function(e,t){return{leftTop:e,width:t.img.width,height:t.img.height}}],["regularPolygon",function(e,t){return __assign({center:e},t.regularPolygon)}],["start",function(e,t){return __assign({center:e},t.start)}],["sector",function(e,t){return __assign({center:e},t.sector)}],["rect",function(e,t){return __assign({leftTop:e},t.rect)}],["radiusRect",function(e,t){return __assign({leftTop:e},t.radiusRect)}],["leaf",function(e,t){return __assign({center:e},t.leaf)}]]),a}(Geometry);export default PointGeometry;
//# sourceMappingURL=PointGeometry.js.map
