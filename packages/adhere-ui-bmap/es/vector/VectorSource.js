var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var o=Array(t),n=0,e=0;e<r;e++)for(var i=arguments[e],s=0,u=i.length;s<u;s++,n++)o[n]=i[s];return o};import Emitter from"@baifendian/adhere-util-emitter";import{VectorActions}from"./types";import GeoJSONFormat from"./format/GeoJSONFormat";var VectorSource=function(r){function t(t){var e=r.call(this)||this;return e.context=null,e.features=[],e.features=t,e.setFeaturesContext(),e}return __extends(t,r),t.prototype.setFeaturesContext=function(){var e=this;this.features.forEach(function(t){t.setContext(e)})},t.prototype.addFeature=function(t){this.hasFeatureById(t.getId())||(this.features.push(t),this.setFeaturesContext(),null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE))},t.prototype.addFeatures=function(t){var e=this,t=t.filter(function(t){return!e.hasFeatureById(t.getId())});this.features=__spreadArrays(this.features,t),this.setFeaturesContext(),null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE)},t.prototype.addFirstFeature=function(t){this.hasFeatureById(t.getId())||(this.features.unshift(t),null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE))},t.prototype.insertFeature=function(t,e){this.hasFeatureById(t.getId())||(this.features.splice(e,0,t),this.setFeaturesContext(),null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE))},t.prototype.removeFeature=function(t){this.removeFeatureById(t.getId())},t.prototype.removeFeatureById=function(e){var t;this.hasFeatureById(e)&&(t=this.features.findIndex(function(t){return t.getId()===e}),this.features.splice(t,1),null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE))},t.prototype.clear=function(){var t;this.features=[],null!==(t=null==this?void 0:this.getContext())&&void 0!==t&&t.getEmitter().trigger(VectorActions.UPDATE)},t.prototype.getFeatureById=function(e){return this.features.find(function(t){return t.getId()===e})},t.prototype.getFeatures=function(){return __spreadArrays(this.features)},t.prototype.hasFeature=function(t){return-1!==this.features.indexOf(t)},t.prototype.hasFeatureById=function(e){return!!this.features.find(function(t){return t.getId()===e})},t.prototype.readGeoJSON=function(t,e){var r=this;this.features=GeoJSONFormat.parse(t,e),this.features.forEach(function(t){t.setContext(r)}),null!==(e=null==this?void 0:this.getContext())&&void 0!==e&&e.getEmitter().trigger(VectorActions.UPDATE)},t.prototype.appendGeoJSON=function(t,e){var r=this,e=GeoJSONFormat.parse(t,e);e.forEach(function(t){t.setContext(r)}),this.features=__spreadArrays(this.features,e),null!==(e=null==this?void 0:this.getContext())&&void 0!==e&&e.getEmitter().trigger(VectorActions.UPDATE)},t.prototype.featuresToGeoJSON=function(){return GeoJSONFormat.stringify(this.features)},t.prototype.setContext=function(t){this.context=t},t.prototype.getContext=function(){return this.context},t}(Emitter.Events);export default VectorSource;
//# sourceMappingURL=VectorSource.js.map
