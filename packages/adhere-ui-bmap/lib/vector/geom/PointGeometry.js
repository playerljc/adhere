var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};import ImageCache from"../ImageCache";import GeometryStyle from"../style/GeometryStyle";import{GeometryType,VectorActions}from"../types";import CircleGeometry from"./CircleGeometry";import Geometry from"./Geometry";import LeafGeometry from"./LeafGeometry";import RadiusRectGeometry from"./RadiusRectGeometry";import RectGeometry from"./RectGeometry";import RegularPolygonGeometry from"./RegularPolygonGeometry";import SectorGeometry from"./SectorGeometry";import StartGeometry from"./StartGeometry";var PointGeometry=function(r){function n(e){var t=r.call(this)||this;return t.coordinates=e,t}return __extends(n,r),n.prototype.setCoordinates=function(e){this.coordinates=e,null!=(e=null==this?void 0:this.getLayer())&&e.getEmitter().trigger(VectorActions.UPDATE)},n.prototype.getCoordinates=function(){return __assign({},this.coordinates)},n.prototype.getType=function(){return GeometryType.Point},n.getCenterCoordinate=function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return n.centerCoordinateMapping.get(i.pointType)({ctx:t,coordinates:r,map:o,style:i,isScale:e})},n.prototype.getCenterCoordinate=function(e){var t=e.ctx,r=e.style;e.isScale;return n.getCenterCoordinate({coordinates:this.coordinates,ctx:t,map:this.getMap(),style:r,isScale:!1})},n.drawCirclePoint=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;CircleGeometry.drawCircle({ctx:t,style:r,coordinates:{radius:r.radius,center:o},map:e,isScale:!1})},n.drawImagePoint=function(e){var t,r=e.ctx,o=e.style,i=e.coordinates,n=e.map.pointToPixel(new BMap.Point(i.lng,i.lat)),i=ImageCache.get({src:(null==(e=null==o?void 0:o.img)?void 0:e.src)||"",width:(null==(i=null==o?void 0:o.img)?void 0:i.width)||0,height:(null==(e=null==o?void 0:o.img)?void 0:e.height)||0});i?r.drawImage(i,n.x,n.y,o.img.width,o.img.height):((t=new Image(o.img.width,o.img.height)).onload=function(){var e;ImageCache.add({src:(null==(e=null==o?void 0:o.img)?void 0:e.src)||"",width:(null==(e=null==o?void 0:o.img)?void 0:e.width)||0,height:(null==(e=null==o?void 0:o.img)?void 0:e.height)||0},t),r.drawImage(t,n.x,n.y,o.img.width,o.img.height)},t.src=o.img.src)},n.drawRegularPolygon=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RegularPolygonGeometry.drawRegularPolygon({ctx:t,style:r,coordinates:__assign(__assign({},r.regularPolygon),{center:o}),map:e,isScale:!1})},n.drawStart=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;StartGeometry.drawStart({ctx:t,style:r,coordinates:__assign(__assign({},r.start),{center:o}),map:e,isScale:!1})},n.drawSector=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;SectorGeometry.drawSector({ctx:t,style:r,coordinates:__assign(__assign({},r.sector),{center:o}),map:e,isScale:!1})},n.drawRect=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RectGeometry.drawRect({ctx:t,style:r,coordinates:__assign(__assign({},r.rect),{leftTop:o}),map:e,isScale:!1})},n.drawRadiusRect=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;RadiusRectGeometry.drawRadiusRect({ctx:t,style:r,coordinates:__assign(__assign({},r.radiusRect),{leftTop:o}),map:e,isScale:!1})},n.drawLeaf=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map;LeafGeometry.drawLeaf({ctx:t,style:r,coordinates:__assign(__assign({},r.leaf),{center:o}),map:e,isScale:!1})},n.drawPoint=function(e){var t=e.ctx,r=e.style,o=e.coordinates,e=e.map,r=__assign(__assign(__assign({},GeometryStyle),{radius:5,pointType:"circle"}),r||{});n.drawMapping.get(null==r?void 0:r.pointType)({ctx:t,style:r,coordinates:o,map:e})},n.prototype.draw=function(e,t){n.drawPoint({ctx:e,style:t,coordinates:this.coordinates,map:this.getMap()})},n.isPixelInGeometry=function(e){var t=e.coordinates,r=e.map,o=e.pixel,e=e.style;return n.isPixelInGeometryMapping.get(null==e?void 0:e.pointType)({coordinates:n.pointTypeToCoordinatesMapping.get(null==e?void 0:e.pointType)(t,e),isScale:!1,map:r,style:e,pixel:o})},n.prototype.isPixelInGeometry=function(e,t){return n.isPixelInGeometry({coordinates:this.coordinates,pixel:e,map:this.getMap(),style:t})},n.drawMapping=new Map([["circle",n.drawCirclePoint],["image",n.drawImagePoint],["regularPolygon",n.drawRegularPolygon],["start",n.drawStart],["sector",n.drawSector],["rect",n.drawRect],["radiusRect",n.drawRadiusRect],["leaf",n.drawLeaf]]),n.isPixelInGeometryMapping=new Map([["circle",CircleGeometry.isPixelInGeometry],["image",RectGeometry.isPixelInGeometry],["regularPolygon",RegularPolygonGeometry.isPixelInGeometry],["start",StartGeometry.isPixelInGeometry],["sector",SectorGeometry.isPixelInGeometry],["rect",RectGeometry.isPixelInGeometry],["radiusRect",RadiusRectGeometry.isPixelInGeometry],["leaf",LeafGeometry.isPixelInGeometry]]),n.centerCoordinateMapping=new Map([["circle",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return CircleGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:{center:r,radius:i.radius}})}],["image",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.img)})}],["regularPolygon",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RegularPolygonGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.regularPolygon)})}],["start",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return StartGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.start)})}],["sector",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return SectorGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.sector)})}],["rect",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.rect)})}],["radiusRect",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return RadiusRectGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({leftTop:r},i.radiusRect)})}],["leaf",function(e){var t=e.ctx,r=e.coordinates,o=e.map,i=e.style,e=e.isScale;return LeafGeometry.getCenterCoordinate({ctx:t,map:o,style:i,isScale:e,coordinates:__assign({center:r},i.leaf)})}]]),n.pointTypeToCoordinatesMapping=new Map([["circle",function(e,t){return{center:e,radius:t.radius}}],["image",function(e,t){return{leftTop:e,width:t.img.width,height:t.img.height}}],["regularPolygon",function(e,t){return __assign({center:e},t.regularPolygon)}],["start",function(e,t){return __assign({center:e},t.start)}],["sector",function(e,t){return __assign({center:e},t.sector)}],["rect",function(e,t){return __assign({leftTop:e},t.rect)}],["radiusRect",function(e,t){return __assign({leftTop:e},t.radiusRect)}],["leaf",function(e,t){return __assign({center:e},t.leaf)}]]),n}(Geometry);export default PointGeometry;
//# sourceMappingURL=PointGeometry.js.map
