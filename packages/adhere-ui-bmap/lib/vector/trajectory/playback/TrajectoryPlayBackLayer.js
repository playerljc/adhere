"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},adhere_util_emitter_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("@baifendian/adhere-util-emitter"))),util_1=__importDefault(require("../../../util")),types_1=require("../../interaction/types"),types_2=require("../../types"),selectorPrefix="adhere-ui-trajectoryplaybacklayer",TrajectoryPlayBackLayer=function(n){function t(t,e){var r=this;return r.update=r.update.bind(r),(r=n.call(this,{update:r.update,paneName:e.paneName,zIndex:e.zIndex})||this).emitter=new adhere_util_emitter_1.default.Events,r.isLoad=!1,r.source=[],r.el=null,r.canvasEl=null,r.ctx=null,r.map=t,r.config=__assign({},e),r}return __extends(t,n),t.prototype.initCanvas=function(){this.el=this.canvas.parentElement,this.canvasEl=this.canvas,this.el.style.width="".concat(this.canvasEl.width,"px"),this.el.style.height="".concat(this.canvasEl.height,"px"),this.canvasEl.className="".concat(selectorPrefix),this.ctx=this.canvasEl.getContext("2d"),this.emitter.trigger(types_1.InteractionLayerActions.CanvasMount)},t.prototype.firstLoad=function(){this.initCanvas()},t.prototype.update=function(){var t=this.canvas.getContext("2d");t&&(this.isLoad||this.firstLoad(),this.isLoad=!0,t.clearRect(0,0,t.canvas.width,t.canvas.height),this.drawHistory())},t.prototype.getMap=function(){return this.map},t.prototype.getCtx=function(){return this.ctx},t.prototype.getCanvasEl=function(){return this.canvasEl},t.prototype.getEmitter=function(){return this.emitter},t.prototype.pixelToPoint=function(t){t=this.map.pixelToPoint(t);return{x:t.lng,y:t.lat}},t.prototype.pointToPixel=function(t){return this.map.pointToPixel(new BMap.Point(t.x,t.y))},t.prototype.distanceToActual=function(t){return t/util_1.default.getScale(this.map)},t.prototype.actualToDistance=function(t){return util_1.default.getScale(this.map)*t},t.prototype.addTrajectory=function(t){this.hasTrajectoryById(t.getId())||(this.source.push(t),t.init())},t.prototype.removeTrajectory=function(t){this.removeTrajectoryById(t.getId())},t.prototype.removeTrajectoryById=function(e){var t=this.source.findIndex(function(t){return t.getId()===e});-1!==t&&(this.source[t].destroy(),this.source.splice(t,1))},t.prototype.clean=function(){this.source.forEach(function(t){return t.destroy()}),this.source=[]},t.prototype.getTrajectoryById=function(e){return this.source.find(function(t){return t.getId()===e})},t.prototype.getTrajectorys=function(){return __spreadArray([],this.source,!0)},t.prototype.hasTrajectoryById=function(t){return!!this.getTrajectoryById(t)},t.prototype.clear=function(){var t=this.getCtx(),e=this.getCanvasEl();t&&e&&t.clearRect(0,0,e.width,e.height)},t.prototype.drawHistory=function(){this.source.filter(function(t){return t.getStatus()!==types_2.TrajectoryStatus.Destroy}).forEach(function(t){t.drawHistory()})},t}(BMap.CanvasLayer);exports.default=TrajectoryPlayBackLayer;
//# sourceMappingURL=TrajectoryPlayBackLayer.js.map
