{"version":3,"file":"DistanceDrawAction.js","sources":["vector/interaction/draw/DistanceDrawAction.js"],"sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar math_js_1 = __importDefault(require(\"@baifendian/adhere-util/lib/math.js\"));\r\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar types_1 = require(\"../types\");\r\nvar PolygonDrawAction_1 = __importDefault(require(\"./PolygonDrawAction\"));\r\nvar DistancePointStyle_1 = __importDefault(require(\"../../style/DistancePointStyle\"));\r\nvar RadiusRectGeometry_1 = __importDefault(require(\"../../geom/RadiusRectGeometry\"));\r\nvar GeometryStyle_1 = __importDefault(require(\"../../style/GeometryStyle\"));\r\nvar DefaultStyle_1 = __importDefault(require(\"../DefaultStyle\"));\r\n/**\r\n * DistanceDrawAction\r\n * @class DistanceDrawAction\r\n * @classdesc 测距\r\n */\r\nvar DistanceDrawAction = /** @class */ (function (_super) {\r\n    __extends(DistanceDrawAction, _super);\r\n    function DistanceDrawAction() {\r\n        var _this = _super.call(this) || this;\r\n        // @ts-ignore\r\n        _this.style = __assign(__assign({}, DefaultStyle_1.default), { strokeStyle: 'red' });\r\n        _this.onCanvasClick = _this.onCanvasClick.bind(_this);\r\n        _this.onCanvasMousemove = _this.onCanvasMousemove.bind(_this);\r\n        _this.onCanvasDbClick = _this.onCanvasDbClick.bind(_this);\r\n        _this.onCursorMouseMove = _this.onCursorMouseMove.bind(_this);\r\n        _this.onDelete = _this.onDelete.bind(_this);\r\n        return _this;\r\n    }\r\n    /**\r\n     * onCursorMouseMove\r\n     * @description - 监控光标移动的事件\r\n     * @param e\r\n     */\r\n    DistanceDrawAction.prototype.onCursorMouseMove = function (e) {\r\n        var _a = this, context = _a.context, pointStack = _a.pointStack;\r\n        if (!context)\r\n            return;\r\n        var canvasEl = context.getCanvasEl();\r\n        // 当前点\r\n        var targetPixel = math_js_1.default.clientToCtxPoint({\r\n            event: e,\r\n            rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect(),\r\n        });\r\n        // 计算距离\r\n        var distance = 0;\r\n        if (!pointStack.length)\r\n            return;\r\n        for (var i = 0; i < pointStack.length - 1; i++) {\r\n            var fFromPixel = pointStack[i];\r\n            var tToPixel = pointStack[i + 1];\r\n            var itemDistance = math_js_1.default.getDistanceByBetweenPoint({ p1: fFromPixel, p2: tToPixel });\r\n            distance += itemDistance;\r\n        }\r\n        var moveDistance = math_js_1.default.getDistanceByBetweenPoint({\r\n            p1: pointStack[pointStack.length - 1],\r\n            p2: targetPixel,\r\n        });\r\n        // 转换成实际距离\r\n        distance = context.distanceToActual(distance + moveDistance);\r\n        // ---------------------------计算距离结束------------------------\r\n        // ---------------------------绘制圆角矩形------------------------\r\n        var ctx = context.getCtx();\r\n        var radiusRectWidth = 120;\r\n        var radiusRectHeight = 50;\r\n        var radiusRectRadius = 2;\r\n        var toolTipPixel = {\r\n            x: targetPixel.x + 10,\r\n            y: targetPixel.y - radiusRectHeight / 2,\r\n        };\r\n        var toolTipPoint = context.pixelToPoint(toolTipPixel);\r\n        RadiusRectGeometry_1.default.drawRadiusRect({\r\n            ctx: ctx,\r\n            style: __assign(__assign({}, GeometryStyle_1.default), { lineWidth: 1, strokeStyle: 'red', fillStyle: '#fff' }),\r\n            coordinates: {\r\n                leftTop: {\r\n                    lng: toolTipPoint.x,\r\n                    lat: toolTipPoint.y,\r\n                },\r\n                width: radiusRectWidth,\r\n                height: radiusRectHeight,\r\n                radius: radiusRectRadius,\r\n            },\r\n            map: context.getMap(),\r\n            isScale: false,\r\n        });\r\n        // ---------------------------绘制文本----------------------------\r\n        var distanceText = '';\r\n        var unitText = '';\r\n        if (distance < 1000) {\r\n            distanceText = \"\" + distance.toFixed(2);\r\n            unitText = adhere_util_intl_1.default.v('米');\r\n        }\r\n        else {\r\n            // @ts-ignore\r\n            distanceText = \"\" + math_js_1.default.distance(distance, 'kilometer').toFixed(2);\r\n            unitText = adhere_util_intl_1.default.v('公里');\r\n        }\r\n        var textFont = '10px sans-serif';\r\n        var textBaseline = 'bottom';\r\n        var textX = toolTipPixel.x + radiusRectWidth / 2;\r\n        var textY = toolTipPixel.y + (radiusRectHeight / 4) * 2;\r\n        var distanceTextHalfWidth = ctx.measureText(distanceText).width / 2;\r\n        // 总长\r\n        ctx.beginPath();\r\n        ctx.font = textFont;\r\n        ctx.textAlign = 'right';\r\n        ctx.textBaseline = textBaseline;\r\n        ctx.fillStyle = '#000';\r\n        ctx.fillText(adhere_util_intl_1.default.v('总长') + \"\\uFF1A\", textX - distanceTextHalfWidth, textY, ctx.measureText(adhere_util_intl_1.default.v('总长') + \"\\uFF1A\").width);\r\n        // 数值\r\n        ctx.beginPath();\r\n        ctx.font = textFont;\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = textBaseline;\r\n        ctx.fillStyle = 'red';\r\n        ctx.fillText(distanceText, textX, textY, ctx.measureText(distanceText).width);\r\n        // 单位\r\n        ctx.beginPath();\r\n        ctx.font = textFont;\r\n        ctx.textAlign = 'left';\r\n        ctx.textBaseline = textBaseline;\r\n        ctx.fillStyle = '#000';\r\n        ctx.fillText(unitText, textX + distanceTextHalfWidth, textY, ctx.measureText(unitText).width);\r\n        // 说明\r\n        ctx.beginPath();\r\n        ctx.font = textFont;\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = textBaseline;\r\n        ctx.fillStyle = '#000';\r\n        ctx.fillText(adhere_util_intl_1.default.v('单击确定地点，双击结束'), textX, toolTipPixel.y + (radiusRectHeight / 4) * 3 + 3, ctx.measureText(adhere_util_intl_1.default.v('单击确定地点，双击结束')).width);\r\n    };\r\n    /**\r\n     * drawHistoryPath - 绘制历史数据\r\n     * @param context\r\n     * @param ctx\r\n     * @param data\r\n     */\r\n    DistanceDrawAction.drawHistoryPath = function (context, ctx, data) {\r\n        var _this = this;\r\n        if (data === void 0) { data = []; }\r\n        ctx.save();\r\n        ctx.beginPath();\r\n        var realData = PolygonDrawAction_1.default.transformOriginToReal(context, data);\r\n        (realData || []).forEach(function (pixel, index) {\r\n            if (index === 0) {\r\n                ctx.moveTo(pixel.x, pixel.y);\r\n            }\r\n            else {\r\n                ctx.lineTo(pixel.x, pixel.y);\r\n            }\r\n        });\r\n        // 描边\r\n        ctx.stroke();\r\n        ctx.restore();\r\n        data.forEach(function (point) {\r\n            _this.drawStartPoint({\r\n                context: context,\r\n                ctx: ctx,\r\n                style: DistancePointStyle_1.default,\r\n                pointStack: data,\r\n                toPoint: point,\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * drawStartPoint\r\n     * @param context\r\n     * @param ctx\r\n     * @param style\r\n     * @param pointStack\r\n     * @param toPoint\r\n     */\r\n    DistanceDrawAction.drawStartPoint = function (_a) {\r\n        var context = _a.context, ctx = _a.ctx, style = _a.style, pointStack = _a.pointStack, toPoint = _a.toPoint;\r\n        var toPixel = context.pointToPixel(toPoint);\r\n        // 绘制toolTip的文字\r\n        var pointIndex = pointStack.findIndex(function (point) {\r\n            var itemPointStr = JSON.stringify(point);\r\n            var toPointStr = JSON.stringify(toPoint);\r\n            return itemPointStr === toPointStr;\r\n        });\r\n        {\r\n            var circleRadius = 6;\r\n            // 绘制圆圈\r\n            ctx.save();\r\n            ctx.beginPath();\r\n            ctx.fillStyle = style.fillStyle;\r\n            ctx.strokeStyle = style.strokeStyle;\r\n            ctx.lineWidth = style.lineWidth;\r\n            // 需要转换\r\n            ctx.ellipse(toPixel.x, toPixel.y, circleRadius, circleRadius, (45 * Math.PI) / 180, 0, 2 * Math.PI);\r\n            ctx.stroke();\r\n            ctx.fill();\r\n            ctx.restore();\r\n            ctx.save();\r\n            ctx.beginPath();\r\n            ctx.font = '9px sans-serif';\r\n            ctx.textAlign = 'center';\r\n            ctx.textBaseline = 'middle';\r\n            ctx.fillStyle = 'blue';\r\n            ctx.fillText(\"\" + (pointIndex + 1), toPixel.x, toPixel.y);\r\n            ctx.restore();\r\n        }\r\n        /*------------------------------------------------------------------------------------------*/\r\n        {\r\n            // 绘制tooltip\r\n            var width = 50;\r\n            var height = 20;\r\n            var radius = 2;\r\n            var toolTipPixel = {\r\n                x: toPixel.x + 10,\r\n                y: toPixel.y - height / 2,\r\n            };\r\n            var toolTipPoint = context.pixelToPoint(toolTipPixel);\r\n            // 绘制toolTip的框\r\n            RadiusRectGeometry_1.default.drawRadiusRect({\r\n                ctx: ctx,\r\n                style: __assign(__assign({}, GeometryStyle_1.default), { lineWidth: 1, strokeStyle: '#000', fillStyle: '#fff' }),\r\n                coordinates: {\r\n                    leftTop: {\r\n                        lng: toolTipPoint.x,\r\n                        lat: toolTipPoint.y,\r\n                    },\r\n                    width: width,\r\n                    height: height,\r\n                    radius: radius,\r\n                },\r\n                map: context.getMap(),\r\n                isScale: false,\r\n            });\r\n            var toolTip = '';\r\n            if (pointIndex === 0) {\r\n                toolTip = adhere_util_intl_1.default.v('起点');\r\n            }\r\n            else {\r\n                // 计算距离\r\n                var distance = 0;\r\n                for (var i = 0; i < pointIndex; i++) {\r\n                    var fFromPixel = context.pointToPixel(pointStack[i]);\r\n                    var tToPixel = context.pointToPixel(pointStack[i + 1]);\r\n                    var itemDistance = math_js_1.default.getDistanceByBetweenPoint({ p1: fFromPixel, p2: tToPixel });\r\n                    distance += itemDistance;\r\n                }\r\n                // 转换成实际距离\r\n                distance = context.distanceToActual(distance);\r\n                if (distance < 1000) {\r\n                    toolTip = \"\" + distance.toFixed(2) + adhere_util_intl_1.default.v('米');\r\n                }\r\n                else {\r\n                    // @ts-ignore\r\n                    toolTip = \"\" + math_js_1.default.distance(distance, 'kilometer').toFixed(2) + adhere_util_intl_1.default.v('公里');\r\n                }\r\n            }\r\n            // 绘制到中心点上\r\n            ctx.save();\r\n            ctx.beginPath();\r\n            ctx.font = '10px sans-serif';\r\n            ctx.textAlign = 'center';\r\n            ctx.textBaseline = 'middle';\r\n            ctx.fillStyle = '#000';\r\n            ctx.fillText(toolTip, toolTipPixel.x + width / 2, toolTipPixel.y + height / 2);\r\n            ctx.restore();\r\n        }\r\n    };\r\n    /**\r\n     * drawStartPoint\r\n     * @description - 绘制开始点和点的提示框\r\n     */\r\n    DistanceDrawAction.prototype.drawStartPoint = function () {\r\n        var _a = this, context = _a.context, startPoint = _a.startPoint;\r\n        if (!context)\r\n            return;\r\n        var ctx = context.getCtx();\r\n        if (!ctx)\r\n            return;\r\n        var pointStack = this.pointStack;\r\n        DistanceDrawAction.drawStartPoint({\r\n            context: context,\r\n            ctx: ctx,\r\n            style: DistancePointStyle_1.default,\r\n            pointStack: PolygonDrawAction_1.default.transformRealToOrigin(context, __spreadArrays(pointStack)),\r\n            toPoint: context.pixelToPoint(startPoint),\r\n        });\r\n    };\r\n    /**\r\n     * fill\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.fill = function () {\r\n        var context = this.context;\r\n        if (!context)\r\n            return;\r\n        var pointStack = this.pointStack;\r\n        var ctx = context.getCtx();\r\n        if (!ctx)\r\n            return;\r\n        if (pointStack.length <= 1) {\r\n            if (pointStack.length === 1) {\r\n                DistanceDrawAction.drawStartPoint({\r\n                    context: context,\r\n                    ctx: context.getCtx(),\r\n                    style: DistancePointStyle_1.default,\r\n                    pointStack: PolygonDrawAction_1.default.transformRealToOrigin(context, pointStack),\r\n                    toPoint: context.pixelToPoint(pointStack[0]),\r\n                });\r\n            }\r\n            return;\r\n        }\r\n        ctx.fillStyle = this.style.fillStyle;\r\n        ctx.save();\r\n        ctx.beginPath();\r\n        for (var i = 0; i < pointStack.length; i++) {\r\n            var point = pointStack[i];\r\n            if (i === 0) {\r\n                ctx.moveTo(point.x, point.y);\r\n            }\r\n            else {\r\n                ctx.lineTo(point.x, point.y);\r\n            }\r\n        }\r\n        ctx.stroke();\r\n        ctx.restore();\r\n        var originData = PolygonDrawAction_1.default.transformRealToOrigin(context, pointStack);\r\n        originData.forEach(function (point, index) {\r\n            DistanceDrawAction.drawStartPoint({\r\n                context: context,\r\n                ctx: ctx,\r\n                style: DistancePointStyle_1.default,\r\n                pointStack: originData,\r\n                toPoint: originData[index],\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * drawStack\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.drawStack = function () {\r\n        var _a = this, pointStack = _a.pointStack, context = _a.context;\r\n        if (!context)\r\n            return;\r\n        if (pointStack.length <= 1) {\r\n            if (pointStack.length === 1) {\r\n                DistanceDrawAction.drawStartPoint({\r\n                    context: context,\r\n                    ctx: context.getCtx(),\r\n                    style: DistancePointStyle_1.default,\r\n                    pointStack: PolygonDrawAction_1.default.transformRealToOrigin(context, pointStack),\r\n                    toPoint: context.pixelToPoint(pointStack[0]),\r\n                });\r\n            }\r\n            return;\r\n        }\r\n        var index = 0;\r\n        do {\r\n            if (index !== pointStack.length - 1) {\r\n                this.drawLine(pointStack[index], pointStack[index + 1]);\r\n            }\r\n            DistanceDrawAction.drawStartPoint({\r\n                context: context,\r\n                ctx: context.getCtx(),\r\n                style: DistancePointStyle_1.default,\r\n                pointStack: PolygonDrawAction_1.default.transformRealToOrigin(context, pointStack),\r\n                toPoint: context.pixelToPoint(pointStack[index]),\r\n            });\r\n            index++;\r\n        } while (index < pointStack.length);\r\n    };\r\n    /**\r\n     * getCanvasClick\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.getCanvasClick = function () {\r\n        return this.onCanvasClick;\r\n    };\r\n    /**\r\n     * getCanvasMousemove\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.getCanvasMousemove = function () {\r\n        return this.onCanvasMousemove;\r\n    };\r\n    /**\r\n     * getCanvasDbClick\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.getCanvasDbClick = function () {\r\n        return this.onCanvasDbClick;\r\n    };\r\n    /**\r\n     * onCanvasClick\r\n     * @override\r\n     * @param e\r\n     */\r\n    DistanceDrawAction.prototype.onCanvasClick = function (e) {\r\n        if (e.detail >= 2) {\r\n            return;\r\n        }\r\n        _super.prototype.onCanvasClick.call(this, e);\r\n        // 画点\r\n        this.drawStartPoint();\r\n    };\r\n    /**\r\n     * onCanvasMousemove\r\n     * @override\r\n     * @param e\r\n     */\r\n    DistanceDrawAction.prototype.onCanvasMousemove = function (e) {\r\n        _super.prototype.onCanvasMousemove.call(this, e);\r\n        this.onCursorMouseMove(e);\r\n    };\r\n    /**\r\n     * onCanvasDbClick\r\n     * @override\r\n     * @param e\r\n     */\r\n    DistanceDrawAction.prototype.onCanvasDbClick = function (e) {\r\n        _super.prototype.onCanvasDbClick.call(this, e);\r\n    };\r\n    /**\r\n     * onDelete\r\n     * @param deleteMarker - mark\r\n     * @param id - 删除数据的id\r\n     */\r\n    DistanceDrawAction.prototype.onDelete = function (deleteMarker, id) {\r\n        var context = this.context;\r\n        if (!context)\r\n            return;\r\n        var map = context.getMap();\r\n        var historyData = context === null || context === void 0 ? void 0 : context.getHistoryData();\r\n        var index = historyData === null || historyData === void 0 ? void 0 : historyData.findIndex(function (data) { return data.id === id; });\r\n        if (index !== -1) {\r\n            historyData === null || historyData === void 0 ? void 0 : historyData.splice(index, 1);\r\n            context.setHistoryData(historyData);\r\n            context.clearDraw();\r\n            context.drawHistoryData();\r\n            map.removeOverlay(deleteMarker);\r\n        }\r\n    };\r\n    /**\r\n     * drawDeleteMark\r\n     * @param context\r\n     * @param point\r\n     * @param onDelete\r\n     */\r\n    DistanceDrawAction.drawDeleteMark = function (_a) {\r\n        var context = _a.context, point = _a.point, onDelete = _a.onDelete;\r\n        var map = context.getMap();\r\n        // @ts-ignore\r\n        var icon = new BMap.Icon('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjMxMTk1MDc3NjM5IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExMjQ1IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48c3R5bGUgdHlwZT0idGV4dC9jc3MiPjwvc3R5bGU+PC9kZWZzPjxwYXRoIGQ9Ik0xNTkuMjE1NDg0IDI4NC43MzgwNjVoNzE1LjQ3ODcxYzEzLjIxMjkwMyAwIDIzLjc4MzIyNi0xMC41NzAzMjMgMjMuNzgzMjI1LTIzLjc4MzIyNnMtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjUtMjMuNzgzMjI2SDE1OS4yMTU0ODRjLTEzLjIxMjkwMyAwLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnMxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNiAyMy43ODMyMjYiIHAtaWQ9IjExMjQ2IiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTM1Ny40MDkwMzIgMzU2LjA4Nzc0MnY0MTMuNTYzODcxYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZWMzU2LjA4Nzc0MmMwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjYtMTIuNTUyMjU4IDAtMjMuNzgzMjI2IDEwLjU3MDMyMy0yMy43ODMyMjYgMjMuNzgzMjI2IiBwLWlkPSIxMTI0NyIgZmlsbD0iI2Q4MWUwNiI+PC9wYXRoPjxwYXRoIGQ9Ik01MDAuNzY5MDMyIDM1Ni4wODc3NDJ2NDEzLjU2Mzg3MWMwIDEzLjIxMjkwMyAxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNiAyMy43ODMyMjZzMjMuNzgzMjI2LTEwLjU3MDMyMyAyMy43ODMyMjYtMjMuNzgzMjI2VjM1Ni4wODc3NDJjMC0xMy4yMTI5MDMtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjYtMjMuNzgzMjI2cy0yMy43ODMyMjYgMTAuNTcwMzIzLTIzLjc4MzIyNiAyMy43ODMyMjYiIHAtaWQ9IjExMjQ4IiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTYyNy42MTI5MDMgMzU2LjA4Nzc0MnY0MTMuNTYzODcxYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZWMzU2LjA4Nzc0MmMwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZTNjI3LjYxMjkwMyAzNDIuODc0ODM5IDYyNy42MTI5MDMgMzU2LjA4Nzc0MiIgcC1pZD0iMTEyNDkiIGZpbGw9IiNkODFlMDYiPjwvcGF0aD48cGF0aCBkPSJNNzU1LjExNzQxOSAyNzYuODEwMzIzdjU0MC40MDc3NDJjMCAxMy4yMTI5MDMtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjUgMjMuNzgzMjI1aC00MjkuNDE5MzU1Yy0xMy4yMTI5MDMgMC0yMy43ODMyMjYtMTAuNTcwMzIzLTIzLjc4MzIyNi0yMy43ODMyMjVWMjc2LjgxMDMyM2MwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZzLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnY1NDAuNDA3NzQyYzAgMzkuNjM4NzEgMzEuNzEwOTY4IDcxLjM0OTY3NyA3MS4zNDk2NzggNzEuMzQ5Njc3aDQyOS40MTkzNTVjMzkuNjM4NzEgMCA3MS4zNDk2NzctMzEuNzEwOTY4IDcxLjM0OTY3Ny03MS4zNDk2NzdWMjc2LjgxMDMyM2MwLTEzLjIxMjkwMy0xMC41NzAzMjMtMjMuNzgzMjI2LTIzLjc4MzIyNi0yMy43ODMyMjZzLTIzLjc4MzIyNiAxMC41NzAzMjMtMjMuNzgzMjI2IDIzLjc4MzIyNnoiIHAtaWQ9IjExMjUwIiBmaWxsPSIjZDgxZTA2Ij48L3BhdGg+PHBhdGggZD0iTTM4OS43ODA2NDUgMjQ1LjA5OTM1NXYtNDcuNTY2NDUyYzAtMjEuODAxMjkgMTcuODM3NDE5LTM5LjYzODcxIDM5LjYzODcxLTM5LjYzODcwOWgxNzUuMDcwOTY4YzIxLjgwMTI5IDAgMzkuNjM4NzEgMTcuODM3NDE5IDM5LjYzODcwOSAzOS42Mzg3MDl2NDcuNTY2NDUyYzAgMTMuMjEyOTAzIDEwLjU3MDMyMyAyMy43ODMyMjYgMjMuNzgzMjI2IDIzLjc4MzIyNnMyMy43ODMyMjYtMTAuNTcwMzIzIDIzLjc4MzIyNi0yMy43ODMyMjZ2LTQ3LjU2NjQ1MmMwLTQ4LjIyNzA5Ny0zOC45NzgwNjUtODcuMjA1MTYxLTg3LjIwNTE2MS04Ny4yMDUxNjFINDI5LjQxOTM1NWMtNDguMjI3MDk3IDAtODcuMjA1MTYxIDM4Ljk3ODA2NS04Ny4yMDUxNjEgODcuMjA1MTYxdjQ3LjU2NjQ1MmMwIDEzLjIxMjkwMyAxMC41NzAzMjMgMjMuNzgzMjI2IDIzLjc4MzIyNSAyMy43ODMyMjYgMTIuNTUyMjU4IDAgMjMuNzgzMjI2LTEwLjU3MDMyMyAyMy43ODMyMjYtMjMuNzgzMjI2eiIgcC1pZD0iMTEyNTEiIGZpbGw9IiNkODFlMDYiPjwvcGF0aD48L3N2Zz4=', \r\n        // @ts-ignore\r\n        new BMap.Size(30, 30));\r\n        // @ts-ignore\r\n        var pixel = context.pointToPixel(point);\r\n        pixel.x += 22;\r\n        pixel.y += 30;\r\n        point = context.pixelToPoint(pixel);\r\n        // @ts-ignore\r\n        var pt = new BMap.Point(point.x, point.y);\r\n        // @ts-ignore\r\n        var deleteMarker = new BMap.Marker(pt, {\r\n            icon: icon,\r\n        });\r\n        // @ts-ignore\r\n        deleteMarker.addEventListener('click', function () {\r\n            if (onDelete) {\r\n                onDelete();\r\n            }\r\n        });\r\n        // @ts-ignore\r\n        map.addOverlay(deleteMarker);\r\n        return deleteMarker;\r\n    };\r\n    DistanceDrawAction.prototype.getSelectType = function () {\r\n        return types_1.SelectType.Distance;\r\n    };\r\n    DistanceDrawAction.prototype.start = function (style) {\r\n        var _a;\r\n        var map = (_a = this === null || this === void 0 ? void 0 : this.context) === null || _a === void 0 ? void 0 : _a.getMap();\r\n        map.disableDragging();\r\n        map.disableScrollWheelZoom();\r\n        map.disableDoubleClickZoom();\r\n        map.disableContinuousZoom();\r\n        map.disablePinchToZoom();\r\n        _super.prototype.start.call(this, style);\r\n    };\r\n    /**\r\n     * end\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.end = function () {\r\n        var _this = this;\r\n        var context = this.context;\r\n        if (!context)\r\n            return;\r\n        var map = context.getMap();\r\n        map.enableDragging();\r\n        map.enableScrollWheelZoom();\r\n        map.enableDoubleClickZoom();\r\n        map.enableContinuousZoom();\r\n        map.enablePinchToZoom();\r\n        var deleteMarker = DistanceDrawAction.drawDeleteMark({\r\n            context: context,\r\n            point: context.pixelToPoint(this.pointStack[this.pointStack.length - 1]),\r\n            onDelete: function () {\r\n                // @ts-ignore\r\n                _this.onDelete(deleteMarker, id);\r\n            },\r\n        });\r\n        var id = _super.prototype.end.call(this);\r\n    };\r\n    /**\r\n     * destroy\r\n     * @override\r\n     */\r\n    DistanceDrawAction.prototype.destroy = function () {\r\n        var _a;\r\n        _super.prototype.destroy.call(this);\r\n        var map = (_a = this === null || this === void 0 ? void 0 : this.context) === null || _a === void 0 ? void 0 : _a.getMap();\r\n        map.enableDragging();\r\n        map.enableScrollWheelZoom();\r\n        map.enableDoubleClickZoom();\r\n        map.enableContinuousZoom();\r\n        map.enablePinchToZoom();\r\n    };\r\n    /**\r\n     * setCursor\r\n     * @override\r\n     * @description 设置光标\r\n     */\r\n    DistanceDrawAction.prototype.setCursor = function () {\r\n        var context = this.context;\r\n        if (!context)\r\n            return;\r\n        var canvasEl = context.getCanvasEl();\r\n        if (!canvasEl)\r\n            return;\r\n        canvasEl.style.cursor = \"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjMxMDY4ODUyOTU4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI5ODAiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTQxNiA4MjQuNkwyMjUuMSA2NjguNyA3MTYgOTYuMSA5MDYuOSAyNTJ6IiBmaWxsPSIjZDgxZTA2IiBwLWlkPSIyOTgxIj48L3BhdGg+PHBhdGggZD0iTTc4NiA5MjcuM2MtNC41IDAtOC44LTEuNi0xMi4yLTQuNEw1MjQuNSA3MTMuOGMtOC4xLTYuOC05LjEtMTguOC0yLjQtMjYuOCA2LjgtOCAxOC44LTkuMSAyNi44LTIuNGwyMzQuNyAxOTYuOEw5MTUgNzI0LjggNjc0LjYgNTIzLjJjLTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjggNi44LTggMTguOC05LjEgMjYuOC0yLjRsMjU1IDIxMy45YzguMSA2LjggOS4xIDE4LjggMi40IDI2LjhMODAwLjYgOTIwLjVjLTMuMyAzLjktNy45IDYuMy0xMi45IDYuNy0wLjYgMC4xLTEuMiAwLjEtMS43IDAuMXpNMzQwLjIgNTUzLjVjLTQuMyAwLTguNi0xLjUtMTIuMi00LjRMNzEgMzMzLjZjLTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhMMjI0LjQgMTIxYzYuOC04IDE4LjgtOS4xIDI2LjgtMi40bDI1My41IDIxMi42YzguMSA2LjggOS4xIDE4LjggMi40IDI2LjgtNi44IDguMS0xOC43IDkuMS0yNi44IDIuNEwyNDEuNCAxNjAgMTEwLjEgMzE2LjZsMjQyLjMgMjAzLjJjOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOC0zLjggNC42LTkuMiA2LjktMTQuNiA2Ljl6IiBmaWxsPSIjZDgxZTA2IiBwLWlkPSIyOTgyIj48L3BhdGg+PHBhdGggZD0iTTIzOC44IDMxOC4yYy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNzcuOS05Mi45YzYuOC04IDE4LjgtOS4xIDI2LjgtMi40IDguMSA2LjggOS4xIDE4LjggMi40IDI2LjhsLTc3LjkgOTIuOWMtMy43IDQuNS05LjEgNi44LTE0LjYgNi44ek0zNzkuMyAzNjQuOGMtNC4zIDAtOC42LTEuNS0xMi4yLTQuNC04LjEtNi44LTkuMS0xOC44LTIuNC0yNi44bDQyLjktNTEuMWM2LjgtOC4xIDE4LjgtOS4xIDI2LjgtMi40IDguMSA2LjggOS4xIDE4LjggMi40IDI2LjhMMzkzLjkgMzU4Yy0zLjggNC41LTkuMiA2LjgtMTQuNiA2Ljh6TTgwMC45IDcxOC4zYy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNDIuOS01MS4xYzYuOC04LjEgMTguOC05LjEgMjYuOC0yLjQgOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOGwtNDIuOSA1MS4xYy0zLjcgNC41LTkuMSA2LjgtMTQuNiA2Ljh6TTY2MC41IDY3MS43Yy00LjMgMC04LjYtMS41LTEyLjItNC40LTguMS02LjgtOS4xLTE4LjgtMi40LTI2LjhsNzcuOS05Mi45YzYuOC04LjEgMTguOC05LjEgMjYuOC0yLjQgOC4xIDYuOCA5LjEgMTguOCAyLjQgMjYuOGwtNzcuOSA5Mi45Yy0zLjggNC41LTkuMiA2LjgtMTQuNiA2Ljh6TTQxNiA4NDMuNmMtNC4yIDAtOC41LTEuNC0xMi00LjNMMjEzIDY4My41Yy00LTMuMi02LjUtOC02LjktMTMuMS0wLjQtNS4xIDEuMi0xMC4yIDQuNS0xNC4xTDcwMS41IDgzLjdjNi43LTcuOCAxOC41LTguOSAyNi41LTIuNGwxOTAuOSAxNTUuOWM0IDMuMiA2LjUgOCA2LjkgMTMuMSAwLjQgNS4xLTEuMiAxMC4yLTQuNSAxNC4xTDQzMC40IDgzN2MtMy43IDQuNC05LjEgNi42LTE0LjQgNi42ek0yNTIuMiA2NjYuM2wxNjEuNCAxMzEuOCA0NjYuMS01NDMuNy0xNjEuNC0xMzEuOC00NjYuMSA1NDMuN3oiIGZpbGw9IiNkODFlMDYiIHAtaWQ9IjI5ODMiPjwvcGF0aD48cGF0aCBkPSJNMTY4LjEgOTUyLjRjLTQuMyAwLTguNi0xLjUtMTIuMS00LjMtNS4zLTQuMy03LjgtMTEuMS02LjgtMTcuOGw0MC45LTI1MS40YzEuNy0xMC40IDExLjYtMTcuNCAyMS45LTE1LjggMTAuNCAxLjcgMTcuNCAxMS41IDE1LjggMjEuOWwtMzUuNiAyMTguOSAyMDcuMy03OC42YzkuOC0zLjggMjAuOCAxLjIgMjQuNiAxMSAzLjcgOS44LTEuMiAyMC44LTExIDI0LjZMMTc1IDk1MS4yYy0yLjQgMC44LTQuNyAxLjItNi45IDEuMnoiIGZpbGw9IiNkODFlMDYiIHAtaWQ9IjI5ODQiPjwvcGF0aD48L3N2Zz4=), auto\";\r\n    };\r\n    return DistanceDrawAction;\r\n}(PolygonDrawAction_1.default));\r\nexports.default = DistanceDrawAction;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__spreadArrays","il","r","k","a","j","jl","__importDefault","mod","__esModule","default","defineProperty","exports","value","math_js_1","require","adhere_util_intl_1","types_1","PolygonDrawAction_1","DistancePointStyle_1","RadiusRectGeometry_1","GeometryStyle_1","DefaultStyle_1","DistanceDrawAction","_super","_this","style","strokeStyle","onCanvasClick","bind","onCanvasMousemove","onCanvasDbClick","onCursorMouseMove","onDelete","e","context","pointStack","canvasEl","getCanvasEl","targetPixel","clientToCtxPoint","event","rect","getBoundingClientRect","distance","fFromPixel","tToPixel","getDistanceByBetweenPoint","p1","p2","moveDistance","distanceToActual","ctx","getCtx","toolTipPixel","x","y","radiusRectHeight","toolTipPoint","pixelToPoint","drawRadiusRect","lineWidth","fillStyle","coordinates","leftTop","lng","lat","width","height","radius","map","getMap","isScale","distanceText","unitText","toFixed","v","textFont","textBaseline","textX","radiusRectWidth","textY","distanceTextHalfWidth","measureText","beginPath","font","textAlign","fillText","drawHistoryPath","data","save","transformOriginToReal","forEach","pixel","index","moveTo","lineTo","stroke","restore","point","drawStartPoint","toPoint","_a","toPixel","pointToPixel","pointIndex","findIndex","JSON","stringify","ellipse","Math","PI","fill","toolTip","startPoint","transformRealToOrigin","originData","drawStack","drawLine","getCanvasClick","getCanvasMousemove","getCanvasDbClick","detail","deleteMarker","id","historyData","getHistoryData","splice","setHistoryData","clearDraw","drawHistoryData","removeOverlay","drawDeleteMark","icon","BMap","Icon","Size","pt","Point","Marker","addEventListener","addOverlay","getSelectType","SelectType","Distance","start","disableDragging","disableScrollWheelZoom","disableDoubleClickZoom","disableContinuousZoom","disablePinchToZoom","end","enableDragging","enableScrollWheelZoom","enableDoubleClickZoom","enableContinuousZoom","enablePinchToZoom","destroy","setCursor","cursor"],"mappings":"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"}