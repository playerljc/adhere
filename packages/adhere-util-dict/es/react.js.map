{"version":3,"file":"react.js","sources":["react.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { useUpdateLayoutEffect } from 'ahooks';\r\nimport React, { forwardRef, useState } from 'react';\r\nimport Suspense from '@baifendian/adhere-ui-suspense';\r\nimport Util from '@baifendian/adhere-util';\r\nimport Dict from './dict';\r\nvar ComponentMap = new Map([\r\n    [\r\n        'Function',\r\n        function (key) {\r\n            return forwardRef(function (_a, ref) {\r\n                var children = _a.children, firstLoading = _a.firstLoading, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty, args = _a.args, isUseMemo = _a.isUseMemo;\r\n                var _b = useState(), data = _b[0], setData = _b[1];\r\n                var props = {};\r\n                if (firstLoading)\r\n                    props.firstLoading = firstLoading;\r\n                if (renderEmpty)\r\n                    props.renderEmpty = renderEmpty;\r\n                if (isEmpty)\r\n                    props.isEmpty = isEmpty;\r\n                var fetchData = function () {\r\n                    var _a;\r\n                    Dict.handlers[key].isUseMemo = isUseMemo || false;\r\n                    var result = (_a = Dict.value[key]).value.apply(_a, (args || []));\r\n                    if (result.then) {\r\n                        return result.then(function (res) {\r\n                            setData(res);\r\n                            return res;\r\n                        });\r\n                    }\r\n                    else {\r\n                        setData(result);\r\n                        return Promise.resolve(result);\r\n                    }\r\n                };\r\n                useUpdateLayoutEffect(function () {\r\n                    fetchData();\r\n                }, args || []);\r\n                return (React.createElement(Suspense.ASync, __assign({ ref: ref, fetchData: fetchData }, props, { isEmpty: function () { return data === null || data === undefined || (isEmpty === null || isEmpty === void 0 ? void 0 : isEmpty(data)); } }), children === null || children === void 0 ? void 0 : children(data)));\r\n            });\r\n        },\r\n    ],\r\n    [\r\n        'NotPromise',\r\n        function (key) {\r\n            return function (_a) {\r\n                var children = _a.children;\r\n                return children === null || children === void 0 ? void 0 : children(Dict.value[key].value);\r\n            };\r\n        },\r\n    ],\r\n    [\r\n        'Promise',\r\n        function (key) {\r\n            return forwardRef(function (_a, ref) {\r\n                var children = _a.children, firstLoading = _a.firstLoading, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty;\r\n                var _b = useState(), data = _b[0], setData = _b[1];\r\n                var props = {};\r\n                if (firstLoading)\r\n                    props.firstLoading = firstLoading;\r\n                if (renderEmpty)\r\n                    props.renderEmpty = renderEmpty;\r\n                if (isEmpty)\r\n                    props.isEmpty = isEmpty;\r\n                var fetchData = function () {\r\n                    return Dict.value[key].value.then(function (res) {\r\n                        setData(res);\r\n                        return res;\r\n                    });\r\n                };\r\n                return (React.createElement(Suspense.ASync, __assign({ ref: ref, fetchData: fetchData }, props, { isEmpty: function () { return data === null || data === undefined || (isEmpty === null || isEmpty === void 0 ? void 0 : isEmpty(data)); } }), children === null || children === void 0 ? void 0 : children(data)));\r\n            });\r\n        },\r\n    ],\r\n]);\r\n/**\r\n * set - 设置字典对应的组件\r\n * @param {string} key - 字典名称\r\n * @return {void}\r\n */\r\nexport function set(key) {\r\n    if (DictReactComponents[key])\r\n        return;\r\n    DictReactComponents[key] = forwardRef(function (props, ref) {\r\n        var _a, _b, _c;\r\n        var value = Dict.value[key].value;\r\n        var Component;\r\n        // isFunction\r\n        if (Util.isFunction(value)) {\r\n            Component = (_a = ComponentMap.get('Function')) === null || _a === void 0 ? void 0 : _a(key);\r\n        }\r\n        // isNotFunction\r\n        else {\r\n            // isNotPromise\r\n            if (!value.then) {\r\n                Component = (_b = ComponentMap.get('NotPromise')) === null || _b === void 0 ? void 0 : _b(key);\r\n            }\r\n            // Promise\r\n            else {\r\n                Component = (_c = ComponentMap.get('Promise')) === null || _c === void 0 ? void 0 : _c(key);\r\n            }\r\n        }\r\n        return Component ? React.createElement(Component, __assign({ ref: ref }, props)) : null;\r\n    });\r\n}\r\n/**\r\n * Components - 字典对用的React组件\r\n * 调用init后会自动填充\r\n */\r\nvar DictReactComponents = {};\r\nexport default DictReactComponents;\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useUpdateLayoutEffect","React","forwardRef","useState","Suspense","Util","Dict","ComponentMap","Map","key","_a","ref","fetchData","handlers","isUseMemo","result","value","args","then","res","setData","Promise","resolve","children","firstLoading","isEmpty","renderEmpty","_b","data","props","createElement","ASync","set","DictReactComponents","Component","isFunction","get","_c"],"mappings":"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"}