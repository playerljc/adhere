{"version":3,"file":"react.js","sources":["react.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useUpdateLayoutEffect } from 'ahooks';\nimport React, { forwardRef, useMemo, useRef, useState } from 'react';\nimport Suspense from '@baifendian/adhere-ui-suspense';\nimport Util from '@baifendian/adhere-util';\nimport Dict from './dict';\nvar ComponentCache = new Map();\nvar ComponentMap = new Map([\n    [\n        'Function',\n        function (key) {\n            if (!ComponentCache.has(\"Function_\".concat(key))) {\n                ComponentCache.set(\"Function_\".concat(key), forwardRef(function (_a, ref) {\n                    var children = _a.children, firstLoading = _a.firstLoading, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty, args = _a.args, isUseMemo = _a.isUseMemo;\n                    var _b = useState(), data = _b[0], setData = _b[1];\n                    var asyncRef = useRef();\n                    // const props: any = {};\n                    // if (firstLoading) props.firstLoading = firstLoading;\n                    // if (renderEmpty) props.renderEmpty = renderEmpty;\n                    // if (isEmpty) props.isEmpty = isEmpty;\n                    var props = useMemo(function () {\n                        var _props = {};\n                        if (firstLoading)\n                            _props.firstLoading = firstLoading;\n                        if (renderEmpty)\n                            _props.renderEmpty = renderEmpty;\n                        if (isEmpty)\n                            _props.isEmpty = isEmpty;\n                        return _props;\n                    }, [firstLoading, renderEmpty, isEmpty]);\n                    var fetchData = function () {\n                        var _a;\n                        Dict.handlers[key].isUseMemo = isUseMemo || false;\n                        var result = (_a = Dict.value[key]).value.apply(_a, (args || []));\n                        if (result.then) {\n                            return result.then(function (res) {\n                                setData(res);\n                                return res;\n                            });\n                        }\n                        else {\n                            setData(result);\n                            return Promise.resolve(result);\n                        }\n                    };\n                    useUpdateLayoutEffect(function () {\n                        var _a, _b;\n                        (_b = (_a = asyncRef === null || asyncRef === void 0 ? void 0 : asyncRef.current) === null || _a === void 0 ? void 0 : _a.fetchData) === null || _b === void 0 ? void 0 : _b.call(_a);\n                    }, args || []);\n                    return (React.createElement(Suspense.ASync, __assign({ ref: asyncRef, fetchData: fetchData }, props, { isEmpty: function () { return data === null || data === undefined || (isEmpty === null || isEmpty === void 0 ? void 0 : isEmpty(data)); } }), children === null || children === void 0 ? void 0 : children(data)));\n                }));\n            }\n            return ComponentCache.get(\"Function_\".concat(key));\n        },\n    ],\n    [\n        'NotPromise',\n        function (key) {\n            return function (_a) {\n                var children = _a.children;\n                return children === null || children === void 0 ? void 0 : children(Dict.value[key].value);\n            };\n        },\n    ],\n    [\n        'Promise',\n        function (key) {\n            if (!ComponentCache.has(\"Promise_\".concat(key))) {\n                ComponentCache.set(\"Promise_\".concat(key), forwardRef(function (_a, ref) {\n                    var children = _a.children, firstLoading = _a.firstLoading, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty;\n                    var _b = useState(), data = _b[0], setData = _b[1];\n                    var props = useMemo(function () {\n                        var _props = {};\n                        if (firstLoading)\n                            _props.firstLoading = firstLoading;\n                        if (renderEmpty)\n                            _props.renderEmpty = renderEmpty;\n                        if (isEmpty)\n                            _props.isEmpty = isEmpty;\n                        return _props;\n                    }, [firstLoading, renderEmpty, isEmpty]);\n                    var fetchData = function () {\n                        return Dict.value[key].value.then(function (res) {\n                            setData(res);\n                            return res;\n                        });\n                    };\n                    return (React.createElement(Suspense.ASync, __assign({ ref: ref, fetchData: fetchData }, props, { isEmpty: function () { return data === null || data === undefined || (isEmpty === null || isEmpty === void 0 ? void 0 : isEmpty(data)); } }), children === null || children === void 0 ? void 0 : children(data)));\n                }));\n            }\n            return ComponentCache.get(\"Promise_\".concat(key));\n        },\n    ],\n]);\n/**\n * set - 设置字典对应的组件\n * @param {string} key - 字典名称\n * @return {void}\n */\nexport function set(key) {\n    if (DictReactComponents[key])\n        return;\n    DictReactComponents[key] = forwardRef(function (props, ref) {\n        var _a, _b, _c;\n        var value = Dict.value[key].value;\n        var Component;\n        // isFunction\n        if (Util.isFunction(value)) {\n            Component = (_a = ComponentMap.get('Function')) === null || _a === void 0 ? void 0 : _a(key);\n        }\n        // isNotFunction\n        else {\n            // isNotPromise\n            if (!value.then) {\n                Component = (_b = ComponentMap.get('NotPromise')) === null || _b === void 0 ? void 0 : _b(key);\n            }\n            // Promise\n            else {\n                Component = (_c = ComponentMap.get('Promise')) === null || _c === void 0 ? void 0 : _c(key);\n            }\n        }\n        return Component ? React.createElement(Component, __assign({ ref: ref }, props)) : null;\n    });\n}\n/**\n * Components - 字典对用的React组件\n * 调用init后会自动填充\n */\nvar DictReactComponents = {};\nexport default DictReactComponents;\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useUpdateLayoutEffect","React","forwardRef","useMemo","useRef","useState","Suspense","Util","Dict","ComponentCache","Map","ComponentMap","key","has","concat","set","_a","ref","children","firstLoading","isEmpty","renderEmpty","args","isUseMemo","_b","data","setData","asyncRef","props","_props","current","fetchData","createElement","ASync","handlers","result","value","then","res","Promise","resolve","get","DictReactComponents","Component","isFunction","_c"],"mappings":"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"}