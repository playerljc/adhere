{"version":3,"file":"theme.js","sources":["theme.js"],"sourcesContent":["import _theme from \"antd/es/theme\";\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport tinyColor from 'tinycolor2';\nimport { Preferences, Util } from '@baifendian/adhere';\n/**\n * setCssVariable\n * @description 设置css变量\n * @param {string} varName 这个变量 xxx-xxx-xxx 类型\n */\nfunction setCssVariable(varName) {\n  // 小写驼峰\n  // 例子: adhereColorPrimary\n  var varCamelCaseName = Util.toCamelCase(varName, '-');\n  // 大写驼峰\n  // 例子: AdhereColorPrimary\n  var varUpperCamelCaseName = Util.toCamelCase(varName, '-', true);\n  if (varCamelCaseName in cssVars) return;\n  var entryValue = themes.get(varName);\n  // 定义驼峰变量\n  Object.defineProperty(cssVars, varCamelCaseName, {\n    set: function (value) {\n      var _a, _b, _c, _d;\n      // --------------定义css变量 -------------\n      document.documentElement.style.setProperty(\"--\".concat(varName), value);\n      // 是颜色需要在定义一个-rgb的变量\n      var color = tinyColor(value);\n      if (color.isValid()) {\n        var rgb = color.toRgb();\n        document.documentElement.style.setProperty(\"--\".concat(varName, \"-rgb\"), \"\".concat([rgb.r, rgb.g, rgb.b].join(',')));\n      }\n      // 处理mapToken\n      if (!(entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken)) return;\n      (_d = (_c = Array.from((_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.keys) === null || _b === void 0 ? void 0 : _b.call(_a))) === null || _c === void 0 ? void 0 : _c.forEach) === null || _d === void 0 ? void 0 : _d.call(_c, function (mapTokenVarName) {\n        var _a, _b;\n        var mapTokenVEntryValue = (_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.get) === null || _b === void 0 ? void 0 : _b.call(_a, mapTokenVarName);\n        if (mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha) {\n          color.setAlpha(Number.parseFloat(mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha));\n          document.documentElement.style.setProperty(\"--\".concat(mapTokenVarName), color.toPercentageRgbString());\n        }\n        if (mapTokenVEntryValue.calc) {\n          document.documentElement.style.setProperty(\"--\".concat(mapTokenVarName), \"calc(\".concat(value, \" \").concat(mapTokenVEntryValue.calc, \")\"));\n        }\n      });\n    }\n  });\n  // 定义导出变量\n  exportObj[\"set\".concat(varUpperCamelCaseName)] = function (value) {\n    cssVars[varCamelCaseName] = value;\n    Preferences.putStringByLocal(varUpperCamelCaseName, value);\n  };\n  // 定义导出变量\n  exportObj[\"get\".concat(varUpperCamelCaseName)] = function () {\n    return document.documentElement.style.getPropertyValue(\"--\".concat(varName));\n  };\n}\n/**\n * init\n */\nfunction init(curTheme) {\n  var _a;\n  // 主题的变量\n  var mapToken = ((_a = themes.get(curTheme)) !== null && _a !== void 0 ? _a : themes.get('default')).mapToken;\n  // 主题的变量\n  Object.keys(mapToken).forEach(function (_key) {\n    // colorPrimary\n    var varName = Util.capitalized(Util.toCamelCase(_key, '-', true));\n    exportObj[\"setAntd\".concat(varName)](mapToken[_key]);\n  });\n  Object.keys(designToken).forEach(function (_key) {\n    // colorPrimary\n    var varName = Util.capitalized(Util.toCamelCase(_key, '-', true));\n    exportObj[\"setAntd\".concat(varName)](designToken[_key]);\n  });\n}\nvar getDesignToken = _theme.getDesignToken,\n  defaultAlgorithm = _theme.defaultAlgorithm,\n  defaultSeed = _theme.defaultSeed,\n  darkAlgorithm = _theme.darkAlgorithm;\nvar designToken = getDesignToken();\nvar themes = new Map([[\n// 缺省主题\n'default', {\n  // 算法(antd)\n  algorithm: _theme.defaultAlgorithm,\n  // 算法对用的mapToken(antd)\n  mapToken: defaultAlgorithm(defaultSeed)\n}], [\n// 暗黑主题\n'dark', {\n  algorithm: _theme.darkAlgorithm,\n  mapToken: darkAlgorithm(defaultSeed)\n}]]);\n// 当前变量\nvar cssVars = {};\n// 导出对象\nvar exportObj = {};\n/**\n * antdThemeToCssVariable\n * @param curTheme\n */\nexport function antdThemeToCssVariable(curTheme) {\n  var antdKeys = Object.keys(themes.get('default').mapToken);\n  var antdDesignKeys = Object.keys(designToken);\n  /* 全局的css Vars*/\n  __spreadArray(__spreadArray([], antdKeys, true), antdDesignKeys, true).map(function (_key) {\n    return Util.pascalCaseToKebabCase2(\"antd\".concat(Util.capitalized(_key)));\n  }).forEach(function (varName) {\n    setCssVariable(varName);\n  });\n  init(curTheme);\n}"],"names":["_theme","__spreadArray","this","to","from","pack","arguments","length","ar","i","l","Array","prototype","slice","call","concat","tinyColor","Preferences","Util","setCssVariable","varName","entryValue","varCamelCaseName","toCamelCase","varUpperCamelCaseName","cssVars","themes","get","Object","defineProperty","set","value","document","documentElement","style","setProperty","_c","rgb","color","isValid","toRgb","r","g","b","join","mapToken","_d","_b","_a","keys","forEach","mapTokenVarName","mapTokenVEntryValue","alpha","setAlpha","Number","parseFloat","toPercentageRgbString","calc","exportObj","putStringByLocal","getPropertyValue","init","curTheme","_key","capitalized","designToken","getDesignToken","defaultAlgorithm","defaultSeed","darkAlgorithm","Map","algorithm","antdThemeToCssVariable","antdKeys","antdDesignKeys","map","pascalCaseToKebabCase2"],"mappings":"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"}