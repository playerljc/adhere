{"version":3,"file":"messagedialog.js","sources":["messagedialog.js"],"sourcesContent":["import _ConfigProvider from \"antd/es/config-provider\";\nimport _Form from \"antd/es/form\";\nimport _Button from \"antd/es/button\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport FormItemCreator from '@baifendian/adhere-ui-formitemcreator';\nimport Intl from '@baifendian/adhere-util-intl';\nimport Resource from '@baifendian/adhere-util-resource';\nimport ModalDialog, { selectorPrefix } from './modal';\nvar DEFAULT_LOCAL = 'zh_CN';\nvar LOCAL = Resource.Dict.value.LocalsAntd.value;\nvar antdConfigProviderProps = {};\nvar PromptLayout = {\n  labelCol: {\n    span: 6\n  },\n  wrapperCol: {\n    span: 18\n  }\n};\n/**\n * renderByIcon\n * @param icon\n * @param text\n * @return React.ReactElement\n */\nfunction renderByIcon(icon, text) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-renderByIcon\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-renderByIcon-fixed\")\n  }, icon), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-renderByIcon-auto\")\n  }, text));\n}\nvar MessageDialogHandlers = new WeakMap();\nvar MessageDialogFactory = {\n  /**\n   * setAntdConfigProviderProps\n   * @description 设置ConfigProvider的props\n   * @param params\n   */\n  setAntdConfigProviderProps: function setAntdConfigProviderProps(params) {\n    antdConfigProviderProps = params;\n  },\n  /**\n   * Confirm\n   * @param title {String | ReactNode}\n   * @param text {String | ReactNode}\n   * @param width {number}\n   * @param zIndex {number}\n   * @param icon {React.ReactElement}\n   * @param {Function} - onSuccess\n   */\n  Confirm: function Confirm(_a) {\n    var title = _a.title,\n      _b = _a.text,\n      text = _b === void 0 ? null : _b,\n      _c = _a.width,\n      width = _c === void 0 ? 300 : _c,\n      _d = _a.zIndex,\n      zIndex = _d === void 0 ? 1000 : _d,\n      local = _a.local,\n      _e = _a.icon,\n      icon = _e === void 0 ? null : _e,\n      onSuccess = _a.onSuccess;\n    var close = this.Modal({\n      config: {\n        title: title,\n        centered: true,\n        width: width || 300,\n        closable: false,\n        zIndex: zIndex,\n        footer: [/*#__PURE__*/React.createElement(_Button, {\n          key: \"submit\",\n          type: \"primary\",\n          title: Intl.v('确定'),\n          onClick: function onClick() {\n            if (onSuccess) {\n              onSuccess().then(function () {\n                return close();\n              });\n            } else {\n              close();\n            }\n          }\n        }, Intl.v('确定'))]\n      },\n      local: local,\n      children: icon ? renderByIcon(icon, text) : text\n    }).close;\n  },\n  /**\n   * Alert\n   * @param title - {String | ReactNode}\n   * @param text - {String | ReactNode}\n   * @param width - {number}\n   * @param local\n   * @param zIndex\n   * @param icon - {React.ReactElement | null}\n   */\n  Alert: function Alert(_a) {\n    var title = _a.title,\n      _b = _a.text,\n      text = _b === void 0 ? null : _b,\n      _c = _a.width,\n      width = _c === void 0 ? 300 : _c,\n      _d = _a.zIndex,\n      zIndex = _d === void 0 ? 1000 : _d,\n      local = _a.local,\n      icon = _a.icon;\n    this.Modal({\n      config: {\n        title: title,\n        centered: true,\n        width: width || 300,\n        closable: false,\n        zIndex: zIndex\n      },\n      local: local,\n      children: icon ? renderByIcon(icon, text) : text\n    });\n  },\n  /**\n   * Prompt\n   * @param title\n   * @param config\n   * @param layout\n   * @param width\n   * @param zIndex\n   * @param local\n   * @param onSuccess\n   * @constructor\n   */\n  Prompt: function Prompt(_a) {\n    var title = _a.title,\n      config = _a.config,\n      _b = _a.layout,\n      layout = _b === void 0 ? PromptLayout : _b,\n      _c = _a.width,\n      width = _c === void 0 ? 300 : _c,\n      _d = _a.zIndex,\n      zIndex = _d === void 0 ? 1000 : _d,\n      local = _a.local,\n      onSuccess = _a.onSuccess;\n    var ref = /*#__PURE__*/React.createRef();\n    var close = this.Modal({\n      config: {\n        title: title,\n        centered: true,\n        width: width || 300,\n        closable: false,\n        zIndex: zIndex,\n        footer: [/*#__PURE__*/React.createElement(_Button, {\n          key: \"submit\",\n          type: \"primary\",\n          title: Intl.v('确定'),\n          onClick: function onClick() {\n            if (onSuccess) {\n              ref.current.validateFields().then(function (values) {\n                onSuccess(values === null || values === void 0 ? void 0 : values.value).then(function () {\n                  return close();\n                });\n              });\n            } else {\n              close();\n            }\n          }\n        }, Intl.v('确定'))]\n      },\n      local: local,\n      children: /*#__PURE__*/React.createElement(_Form, {\n        name: \"Prompt\",\n        ref: ref,\n        style: {\n          width: '100%'\n        }\n      }, /*#__PURE__*/React.createElement(FormItemCreator, {\n        columns: [__assign(__assign({}, config || {\n          label: 'normal',\n          type: FormItemCreator.TEXT,\n          initialValue: ''\n        }), {\n          name: 'value'\n        })],\n        layout: layout || PromptLayout\n      }))\n    }).close;\n  },\n  InputPrompt: function InputPrompt(_a) {\n    var config = _a.config,\n      params = __rest(_a, [\"config\"]);\n    MessageDialogFactory.Prompt(__assign(__assign({}, params), {\n      config: __assign(__assign({}, config), {\n        type: FormItemCreator.INPUT\n      })\n    }));\n  },\n  TextAreaPrompt: function TextAreaPrompt(_a) {\n    var config = _a.config,\n      params = __rest(_a, [\"config\"]);\n    MessageDialogFactory.Prompt(__assign(__assign({}, params), {\n      config: __assign(__assign({}, config), {\n        type: FormItemCreator.TEXTAREA\n      })\n    }));\n  },\n  PassWordPrompt: function PassWordPrompt(_a) {\n    var config = _a.config,\n      params = __rest(_a, [\"config\"]);\n    MessageDialogFactory.Prompt(__assign(__assign({}, params), {\n      config: __assign(__assign({}, config), {\n        type: FormItemCreator.PASSWORD\n      })\n    }));\n  },\n  NumberPrompt: function NumberPrompt(_a) {\n    var config = _a.config,\n      params = __rest(_a, [\"config\"]);\n    MessageDialogFactory.Prompt(__assign(__assign({}, params), {\n      config: __assign(__assign({}, config), {\n        type: FormItemCreator.NUMBER\n      })\n    }));\n  },\n  /**\n   *  Modal\n   *  @param {Object} - config\n   *  @param {String | ReactElement} - title\n   *  @param {Boolean} - maskClosable 是否点击遮罩关闭 默认是false\n   *  @param {Number} - zIndex 层级大小\n   *  @param {String} - className 容器类名\n   *  @param {String} - wrapClassName 包裹容器类名\n   *  @param {Boolean} - centered 垂直居中展示 Modal 默认false\n   *  @param {String | Number} - width 宽度\n   *  @param {Boolean} - closable 是否显示关闭 默认true\n   *  @param {Array<ReactNode>} - footer\n   *  @param {ReactNode} - children\n   *  @param defaultCloseBtn\n   */\n  Modal: function Modal(_a) {\n    var _b = _a.config,\n      config = _b === void 0 ? {} : _b,\n      _c = _a.children,\n      children = _c === void 0 ? null : _c,\n      _d = _a.defaultCloseBtn,\n      defaultCloseBtn = _d === void 0 ? true : _d,\n      _e = _a.local,\n      local = _e === void 0 ? DEFAULT_LOCAL : _e;\n    var modalConfig = Object.assign({\n      maskClosable: false\n    }, config);\n    var el = document.createElement('div');\n    function close() {\n      root.unmount();\n    }\n    var root = ReactDOM.createRoot(el);\n    root.render( /*#__PURE__*/React.createElement(_ConfigProvider, __assign({\n      locale: LOCAL[local || DEFAULT_LOCAL]\n    }, antdConfigProviderProps || {}), /*#__PURE__*/React.createElement(ModalDialog, {\n      close: close,\n      config: modalConfig,\n      closeBtn: defaultCloseBtn\n    }, children)));\n    MessageDialogHandlers.set(el, root);\n    document.body.appendChild(el);\n    return {\n      el: el,\n      close: close\n    };\n  },\n  /**\n   * close\n   * @param el\n   */\n  close: function close(el) {\n    var root = MessageDialogHandlers.get(el);\n    if (root) {\n      root.unmount();\n    }\n    // const flag = ReactDOM.unmountComponentAtNode(el);\n    // if (flag) {\n    //   el?.parentElement?.removeChild?.(el);\n    // }\n  }\n};\n\nexport default MessageDialogFactory;"],"names":["_ConfigProvider","_Form","_Button","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","React","ReactDOM","FormItemCreator","Intl","Resource","ModalDialog","selectorPrefix","DEFAULT_LOCAL","LOCAL","Dict","value","LocalsAntd","antdConfigProviderProps","PromptLayout","labelCol","span","wrapperCol","renderByIcon","icon","text","createElement","className","concat","MessageDialogHandlers","WeakMap","MessageDialogFactory","setAntdConfigProviderProps","params","Confirm","_a","title","_b","_c","width","_d","zIndex","local","_e","onSuccess","close","Modal","config","centered","closable","footer","key","type","v","onClick","then","children","Alert","Prompt","layout","ref","createRef","current","validateFields","values","name","style","columns","label","TEXT","initialValue","InputPrompt","INPUT","TextAreaPrompt","TEXTAREA","PassWordPrompt","PASSWORD","NumberPrompt","NUMBER","defaultCloseBtn","modalConfig","maskClosable","el","document","root","unmount","createRoot","render","locale","closeBtn","set","body","appendChild","get"],"mappings":"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"}