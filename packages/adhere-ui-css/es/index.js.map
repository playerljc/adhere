{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["import tinyColor from 'tinycolor2';\nimport Util from '@baifendian/adhere-util';\nvar defaultThemeMap = new Map([\n    // 品牌颜色\n    [\n        'adhere-color-primary',\n        {\n            value: '#2480ff',\n        },\n    ],\n    // 主文字颜色\n    [\n        'adhere-color-text-base',\n        {\n            value: '#000',\n            mapToken: new Map([\n                // 最深的文本色\n                ['adhere-color-text', { alpha: '0.88' }],\n                // 第二级文本\n                ['adhere-color-text-secondary', { alpha: '0.65' }],\n                // 第三级文本\n                ['adhere-color-text-tertiary', { alpha: '0.45' }],\n                // 第四级\n                ['adhere-color-text-quaternary', { alpha: '0.25' }],\n            ]),\n        },\n    ],\n    // 主背景颜色\n    [\n        'adhere-color-bg-base',\n        {\n            value: '#fff',\n        },\n    ],\n    // 主边框颜色\n    [\n        'adhere-color-border-base',\n        {\n            value: '#d9d9d9',\n        },\n    ],\n    // 主分割线颜色\n    [\n        'adhere-color-split-base',\n        {\n            value: '#f0f0f0',\n        },\n    ],\n    // 主字体大小\n    [\n        'adhere-font-size-base',\n        {\n            value: '14px',\n            mapToken: new Map([\n                [\n                    'adhere-font-size-lg',\n                    {\n                        calc: '+ 2px',\n                    },\n                ],\n                [\n                    'adhere-font-size-sm',\n                    {\n                        calc: '- 2px',\n                    },\n                ],\n                [\n                    'adhere-font-size-xl',\n                    {\n                        calc: '+ 6px',\n                    },\n                ],\n            ]),\n        },\n    ],\n    // 主层级最大值\n    [\n        'adhere-z-index-max-base',\n        {\n            value: '1999',\n        },\n    ],\n    // 主圆角大小\n    [\n        'adhere-border-radius-base',\n        {\n            value: '6px',\n        },\n    ],\n    // 用于控制组件边框、分割线等的宽度\n    [\n        'adhere-line-width',\n        {\n            value: '1px',\n        },\n    ],\n    // 用于控制组件边框、分割线等的样式，默认是实线\n    [\n        'adhere-line-type',\n        {\n            value: 'solid',\n        },\n    ],\n    // DPR\n    [\n        'adhere-device-pixel-ratio',\n        {\n            value: window.devicePixelRatio,\n        },\n    ],\n]);\n/**\n * getValue\n * @param {string | number} originValue\n * @param {ConfigProviderProps['media']} media\n * @return {string | number}\n */\nfunction getValue(originValue, media) {\n    if (media === null || media === void 0 ? void 0 : media.isUseMedia) {\n        if (typeof originValue === 'string' && originValue.endsWith('px')) {\n            return originValue\n                .split(/\\s+/gim)\n                .map(function (value) {\n                var _a;\n                if (value.endsWith('px')) {\n                    var number = parseFloat(value.replace('px', ''));\n                    return Util.pxToRem(number, (_a = media.designWidth) !== null && _a !== void 0 ? _a : 192, media);\n                }\n                return value;\n            })\n                .join(' ');\n        }\n    }\n    return originValue;\n}\n/**\n * init\n * @param theme\n * @param wrapperEL\n * @param media\n */\nvar init = function (theme, wrapperEL, media) {\n    if (wrapperEL === void 0) { wrapperEL = document.documentElement; }\n    var htmlEl = document.documentElement;\n    // 当前变量\n    var cssVars = {};\n    var exportObj = {};\n    var curTheme = theme !== null && theme !== void 0 ? theme : {};\n    var keys = Array.from(defaultThemeMap.keys());\n    keys.forEach(function (varName) {\n        var _a, _b, _c;\n        // 小写的驼峰\n        // 例子: adhereColorPrimary\n        var varCamelCaseName = Util.toCamelCase(varName, '-');\n        // 大写的驼峰\n        // 例子: AdhereColorPrimary\n        var varUpperCamelCaseName = Util.toCamelCase(varName, '-', true);\n        var entryValue = defaultThemeMap.get(varName);\n        // cssVars定义驼峰变量\n        Object.defineProperty(cssVars, varCamelCaseName, {\n            set: function (value) {\n                var _a, _b, _c, _d;\n                var targetValue = getValue(value, media);\n                // --------------定义css变量 -------------\n                wrapperEL.style.setProperty(\"--\".concat(varName), \"\".concat(targetValue));\n                if (!htmlEl.style.getPropertyValue(\"--\".concat(varName))) {\n                    htmlEl.style.setProperty(\"--\".concat(varName), \"\".concat(targetValue));\n                }\n                // 是颜色需要在定义一个-rgb的变量\n                var color = tinyColor(targetValue);\n                if (color.isValid()) {\n                    var rgb = color.toRgb();\n                    wrapperEL.style.setProperty(\"--\".concat(varName, \"-rgb\"), \"\".concat([rgb.r, rgb.g, rgb.b].join(',')));\n                    if (!htmlEl.style.getPropertyValue(\"--\".concat(varName, \"-rgb\"))) {\n                        htmlEl.style.setProperty(\"--\".concat(varName, \"-rgb\"), \"\".concat([rgb.r, rgb.g, rgb.b].join(',')));\n                    }\n                }\n                // 处理mapToken\n                if (!(entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken))\n                    return;\n                (_d = (_c = Array.from((_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.keys) === null || _b === void 0 ? void 0 : _b.call(_a))) === null || _c === void 0 ? void 0 : _c.forEach) === null || _d === void 0 ? void 0 : _d.call(_c, function (mapTokenVarName) {\n                    var _a, _b;\n                    var mapTokenVEntryValue = (_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.get) === null || _b === void 0 ? void 0 : _b.call(_a, mapTokenVarName);\n                    // alpha的处理\n                    if (mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha) {\n                        color.setAlpha(Number.parseFloat(mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha));\n                        wrapperEL.style.setProperty(\"--\".concat(mapTokenVarName), color.toPercentageRgbString());\n                        if (!htmlEl.style.getPropertyValue(\"--\".concat(mapTokenVarName))) {\n                            htmlEl.style.setProperty(\"--\".concat(mapTokenVarName), color.toPercentageRgbString());\n                        }\n                    }\n                    // calc的处理\n                    if (mapTokenVEntryValue.calc) {\n                        var targetCalc = getValue(mapTokenVEntryValue.calc, media);\n                        wrapperEL.style.setProperty(\"--\".concat(mapTokenVarName), \"calc(\".concat(targetValue, \" \").concat(targetCalc, \")\"));\n                        if (!htmlEl.style.getPropertyValue(\"--\".concat(mapTokenVarName))) {\n                            htmlEl.style.setProperty(\"--\".concat(mapTokenVarName), \"calc(\".concat(targetValue, \" \").concat(targetCalc, \")\"));\n                        }\n                    }\n                });\n            },\n        });\n        // 定义导出变量\n        exportObj[\"set\".concat(varUpperCamelCaseName)] = function (value) {\n            cssVars[varCamelCaseName] = value;\n        };\n        // 定义导出变量\n        exportObj[\"get\".concat(varUpperCamelCaseName)] = function () {\n            return wrapperEL.style.getPropertyValue(\"--\".concat(varName));\n        };\n        // -----------------------------------------------------------------------------------------\n        // ColorPrimary\n        (_a = exportObj === null || exportObj === void 0 ? void 0 : exportObj[\"set\".concat(varUpperCamelCaseName)]) === null || _a === void 0 ? void 0 : _a.call(exportObj, (_b = curTheme[Util.lowercaseInitial(varUpperCamelCaseName.substring(varUpperCamelCaseName.indexOf('Adhere') + 'Adhere'.length))]) !== null && _b !== void 0 ? _b : (_c = defaultThemeMap.get(varName)) === null || _c === void 0 ? void 0 : _c.value);\n    });\n    // keys.forEach((varName) => {\n    //   // varName === adhere-color-primary\n    //\n    //   // AdhereColorPrimary\n    //   const varCamelCaseName = Util.toCamelCase(varName, '-', true);\n    //\n    //   // ColorPrimary\n    //   const inputName = Util.lowercaseInitial(\n    //     varCamelCaseName.substring(varCamelCaseName.indexOf('Adhere') + 'Adhere'.length),\n    //   );\n    //\n    //   exportObj?.[`set${varCamelCaseName}`]?.(\n    //     curTheme[inputName] ?? defaultThemeMap.get(varName)?.value,\n    //   );\n    // });\n};\n/**\n * theme\n * {\n *   colorPrimary\n * }\n * @param theme\n */\nexport default init;\n"],"names":["tinyColor","Util","defaultThemeMap","Map","value","mapToken","alpha","calc","window","devicePixelRatio","getValue","originValue","media","isUseMedia","endsWith","split","map","number","parseFloat","replace","pxToRem","_a","designWidth","join","init","theme","wrapperEL","document","documentElement","htmlEl","cssVars","exportObj","curTheme","Array","from","keys","forEach","varName","_b","varCamelCaseName","toCamelCase","varUpperCamelCaseName","entryValue","get","Object","defineProperty","set","_c","targetValue","color","style","setProperty","concat","getPropertyValue","isValid","rgb","toRgb","r","g","b","_d","call","mapTokenVarName","targetCalc","mapTokenVEntryValue","setAlpha","Number","toPercentageRgbString","lowercaseInitial","substring","indexOf","length"],"mappings":"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"}