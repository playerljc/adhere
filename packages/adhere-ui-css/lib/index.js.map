{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tinycolor2_1 = __importDefault(require(\"tinycolor2\"));\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\nvar defaultThemeMap = new Map([\n    // 品牌颜色\n    [\n        'adhere-color-primary',\n        {\n            value: '#2480ff',\n        },\n    ],\n    // 主文字颜色\n    [\n        'adhere-color-text-base',\n        {\n            value: '#000',\n            mapToken: new Map([\n                // 最深的文本色\n                ['adhere-color-text', { alpha: '0.88' }],\n                // 第二级文本\n                ['adhere-color-text-secondary', { alpha: '0.65' }],\n                // 第三级文本\n                ['adhere-color-text-tertiary', { alpha: '0.45' }],\n                // 第四级\n                ['adhere-color-text-quaternary', { alpha: '0.25' }],\n            ]),\n        },\n    ],\n    // 主背景颜色\n    [\n        'adhere-color-bg-base',\n        {\n            value: '#fff',\n        },\n    ],\n    // 主边框颜色\n    [\n        'adhere-color-border-base',\n        {\n            value: '#d9d9d9',\n        },\n    ],\n    // 主分割线颜色\n    [\n        'adhere-color-split-base',\n        {\n            value: '#f0f0f0',\n        },\n    ],\n    // 主字体大小\n    [\n        'adhere-font-size-base',\n        {\n            value: '14px',\n            mapToken: new Map([\n                [\n                    'adhere-font-size-lg',\n                    {\n                        calc: '+ 2px',\n                    },\n                ],\n                [\n                    'adhere-font-size-sm',\n                    {\n                        calc: '- 2px',\n                    },\n                ],\n                [\n                    'adhere-font-size-xl',\n                    {\n                        calc: '+ 6px',\n                    },\n                ],\n            ]),\n        },\n    ],\n    // 主层级最大值\n    [\n        'adhere-z-index-max-base',\n        {\n            value: '1999',\n        },\n    ],\n    // 主圆角大小\n    [\n        'adhere-border-radius-base',\n        {\n            value: '6px',\n        },\n    ],\n    // 用于控制组件边框、分割线等的宽度\n    [\n        'adhere-line-width',\n        {\n            value: '1px',\n        },\n    ],\n    // 用于控制组件边框、分割线等的样式，默认是实线\n    [\n        'adhere-line-type',\n        {\n            value: 'solid',\n        },\n    ],\n    // DPR\n    [\n        'adhere-device-pixel-ratio',\n        {\n            value: window.devicePixelRatio,\n        },\n    ],\n]);\n/**\n * getValue\n * @param {string | number} originValue\n * @param {ConfigProviderProps['media']} media\n * @return {string | number}\n */\nfunction getValue(originValue, media) {\n    if (media === null || media === void 0 ? void 0 : media.isUseMedia) {\n        if (typeof originValue === 'string' && originValue.endsWith('px')) {\n            return originValue\n                .split(/\\s+/gim)\n                .map(function (value) {\n                var _a;\n                if (value.endsWith('px')) {\n                    var number = parseFloat(value.replace('px', ''));\n                    return adhere_util_1.default.pxToRem(number, (_a = media.designWidth) !== null && _a !== void 0 ? _a : 192, media);\n                }\n                return value;\n            })\n                .join(' ');\n        }\n    }\n    return originValue;\n}\n/**\n * init\n * @param theme\n * @param wrapperEL\n * @param media\n */\nvar init = function (theme, wrapperEL, media) {\n    if (wrapperEL === void 0) { wrapperEL = document.documentElement; }\n    var htmlEl = document.documentElement;\n    // 当前变量\n    var cssVars = {};\n    var exportObj = {};\n    var curTheme = theme !== null && theme !== void 0 ? theme : {};\n    var keys = Array.from(defaultThemeMap.keys());\n    keys.forEach(function (varName) {\n        var _a, _b, _c;\n        // 小写的驼峰\n        // 例子: adhereColorPrimary\n        var varCamelCaseName = adhere_util_1.default.toCamelCase(varName, '-');\n        // 大写的驼峰\n        // 例子: AdhereColorPrimary\n        var varUpperCamelCaseName = adhere_util_1.default.toCamelCase(varName, '-', true);\n        var entryValue = defaultThemeMap.get(varName);\n        // cssVars定义驼峰变量\n        Object.defineProperty(cssVars, varCamelCaseName, {\n            set: function (value) {\n                var _a, _b, _c, _d;\n                var targetValue = getValue(value, media);\n                // --------------定义css变量 -------------\n                wrapperEL.style.setProperty(\"--\".concat(varName), \"\".concat(targetValue));\n                if (!htmlEl.style.getPropertyValue(\"--\".concat(varName))) {\n                    htmlEl.style.setProperty(\"--\".concat(varName), \"\".concat(targetValue));\n                }\n                // 是颜色需要在定义一个-rgb的变量\n                var color = (0, tinycolor2_1.default)(targetValue);\n                if (color.isValid()) {\n                    var rgb = color.toRgb();\n                    wrapperEL.style.setProperty(\"--\".concat(varName, \"-rgb\"), \"\".concat([rgb.r, rgb.g, rgb.b].join(',')));\n                    if (!htmlEl.style.getPropertyValue(\"--\".concat(varName, \"-rgb\"))) {\n                        htmlEl.style.setProperty(\"--\".concat(varName, \"-rgb\"), \"\".concat([rgb.r, rgb.g, rgb.b].join(',')));\n                    }\n                }\n                // 处理mapToken\n                if (!(entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken))\n                    return;\n                (_d = (_c = Array.from((_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.keys) === null || _b === void 0 ? void 0 : _b.call(_a))) === null || _c === void 0 ? void 0 : _c.forEach) === null || _d === void 0 ? void 0 : _d.call(_c, function (mapTokenVarName) {\n                    var _a, _b;\n                    var mapTokenVEntryValue = (_b = (_a = entryValue === null || entryValue === void 0 ? void 0 : entryValue.mapToken) === null || _a === void 0 ? void 0 : _a.get) === null || _b === void 0 ? void 0 : _b.call(_a, mapTokenVarName);\n                    // alpha的处理\n                    if (mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha) {\n                        color.setAlpha(Number.parseFloat(mapTokenVEntryValue === null || mapTokenVEntryValue === void 0 ? void 0 : mapTokenVEntryValue.alpha));\n                        wrapperEL.style.setProperty(\"--\".concat(mapTokenVarName), color.toPercentageRgbString());\n                        if (!htmlEl.style.getPropertyValue(\"--\".concat(mapTokenVarName))) {\n                            htmlEl.style.setProperty(\"--\".concat(mapTokenVarName), color.toPercentageRgbString());\n                        }\n                    }\n                    // calc的处理\n                    if (mapTokenVEntryValue.calc) {\n                        var targetCalc = getValue(mapTokenVEntryValue.calc, media);\n                        wrapperEL.style.setProperty(\"--\".concat(mapTokenVarName), \"calc(\".concat(targetValue, \" \").concat(targetCalc, \")\"));\n                        if (!htmlEl.style.getPropertyValue(\"--\".concat(mapTokenVarName))) {\n                            htmlEl.style.setProperty(\"--\".concat(mapTokenVarName), \"calc(\".concat(targetValue, \" \").concat(targetCalc, \")\"));\n                        }\n                    }\n                });\n            },\n        });\n        // 定义导出变量\n        exportObj[\"set\".concat(varUpperCamelCaseName)] = function (value) {\n            cssVars[varCamelCaseName] = value;\n        };\n        // 定义导出变量\n        exportObj[\"get\".concat(varUpperCamelCaseName)] = function () {\n            return wrapperEL.style.getPropertyValue(\"--\".concat(varName));\n        };\n        // -----------------------------------------------------------------------------------------\n        // ColorPrimary\n        (_a = exportObj === null || exportObj === void 0 ? void 0 : exportObj[\"set\".concat(varUpperCamelCaseName)]) === null || _a === void 0 ? void 0 : _a.call(exportObj, (_b = curTheme[adhere_util_1.default.lowercaseInitial(varUpperCamelCaseName.substring(varUpperCamelCaseName.indexOf('Adhere') + 'Adhere'.length))]) !== null && _b !== void 0 ? _b : (_c = defaultThemeMap.get(varName)) === null || _c === void 0 ? void 0 : _c.value);\n    });\n    // keys.forEach((varName) => {\n    //   // varName === adhere-color-primary\n    //\n    //   // AdhereColorPrimary\n    //   const varCamelCaseName = Util.toCamelCase(varName, '-', true);\n    //\n    //   // ColorPrimary\n    //   const inputName = Util.lowercaseInitial(\n    //     varCamelCaseName.substring(varCamelCaseName.indexOf('Adhere') + 'Adhere'.length),\n    //   );\n    //\n    //   exportObj?.[`set${varCamelCaseName}`]?.(\n    //     curTheme[inputName] ?? defaultThemeMap.get(varName)?.value,\n    //   );\n    // });\n};\n/**\n * theme\n * {\n *   colorPrimary\n * }\n * @param theme\n */\nexports.default = init;\n"],"names":["__importDefault","this","mod","__esModule","default","tinycolor2_1","Object","defineProperty","exports","value","require","adhere_util_1","defaultThemeMap","Map","mapToken","alpha","calc","window","devicePixelRatio","getValue","originValue","media","isUseMedia","endsWith","split","map","number","parseFloat","replace","pxToRem","_a","designWidth","join","init","theme","wrapperEL","document","documentElement","htmlEl","cssVars","exportObj","curTheme","Array","from","keys","forEach","varName","_b","varCamelCaseName","toCamelCase","varUpperCamelCaseName","entryValue","get","set","_c","targetValue","color","style","setProperty","concat","getPropertyValue","isValid","rgb","toRgb","r","g","b","_d","call","mapTokenVarName","targetCalc","mapTokenVEntryValue","setAlpha","Number","toPercentageRgbString","lowercaseInitial","substring","indexOf","length"],"mappings":"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"}