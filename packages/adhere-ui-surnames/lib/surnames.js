"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(require("react")),classnames_1=__importDefault(require("classnames")),adhere_util_1=__importDefault(require("@baifendian/adhere-util")),selectorPrefix="adhere-ui-surnames",DURATION=100,Surnames=function(e,t){var r=e.position,n=void 0===r?"right":r,u=e.className,i=void 0===u?"":u,r=e.style,u=void 0===r?{}:r,r=e.indexes,o=void 0===r?[]:r,r=e.dataSource,r=void 0===r?[]:r,l=e.onScroll,c=e.onBeforeScroll,d=react_1.useRef(null),a=react_1.useRef(null),s=react_1.useRef(null),e=react_1.useRef(null),f=react_1.useRef(null),v=react_1.useRef(),m=react_1.useRef(!1),p=react_1.useRef(!1),_=react_1.useRef(!1),h=react_1.useRef(0),g=react_1.useRef(0),x=react_1.useRef(""),y=react_1.useRef([]);function E(){return"left"===n||"right"===n?"vertical":"horizontal"}function w(){"vertical"===E()?(d.current.style.height=f.current.offsetHeight+50+"px",d.current.style.width="100%"):d.current.style.height="100%"}function T(){var e,t=null===(e=f.current)||void 0===e?void 0:e.querySelectorAll("."+selectorPrefix+"-index-item");y.current=[];for(var r=0;r<t.length;r++){var n=t[r],u=n.dataset.name,i=n.getBoundingClientRect();y.current.push({name:u,top:i.top,bottom:i.bottom,left:i.left,right:i.right,offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight})}}function L(e){var t=e.target;e.preventDefault(),m.current||(m.current=!0,v.current.style.display="block",D(t.dataset.name))}function P(e,t){var r,t=function(e,t){for(var r,n=E(),u="vertical"===n?t-h.current:e-g.current,i=y.current.find(function(e){return e.name===x.current}),o=0,a=y.current.length-1;o<=a&&o<=y.current.length-1&&a<=y.current.length-1;){var l,c=y.current[l=a+o>>1],d=void 0,s=void 0,f=void 0,f="vertical"===n?(d=i.top+u,i.bottom,s=c.top,c.bottom):(d=i.left+u,i.right,s=c.left,c.right);if(s<=d&&d<=f){r=c;break}d<s?a=l-1:o=1+l}return r||null}(e,t);t&&(a.current.innerText=t.name,a.current.style.display="block","vertical"===E()?(r=t.offsetTop+Math.floor(t.height/2),a.current.style.transform="translate3d(0,"+r+"px,0)"):(r=t.offsetLeft+t.width,a.current.style.transform="translate3d("+r+"px,0,0)"),R(t.name))}function D(r,e){var t;void 0===e&&(e=100);var n=null===(t=s.current)||void 0===t?void 0:t.querySelector("."+selectorPrefix+"-group-title[data-name='"+r+"']"),u=null===(t=s.current)||void 0===t?void 0:t.scrollTop,i=u,o=n.offsetTop,n=screen.updateInterval,a=d.current.scrollHeight/((DURATION|e)/(n||16.7)+((DURATION|e)%(n||16.7)!=0?1:0));c&&c(r),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function t(){m.current=!1,p.current=!1,v.current.style.display="none",l&&l(r)}u<o?o<i+a?i=o:i+=a:i-a<o?i=o:i-=a,s.current.scrollTop=i,u<o?o<=i?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):i<=o?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)})}function R(e){var t;s.current.scrollTop=(null===(t=s.current)||void 0===t?void 0:t.querySelector("."+selectorPrefix+"-group-title[data-name='"+e+"']")).offsetTop,l&&l(e)}function b(e){e.preventDefault(),e.stopPropagation(),L(e)}function N(e){e.preventDefault();var t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX,e=e.target,e=adhere_util_1.default.getTopDom(e,selectorPrefix+"-index-item");x.current=e.dataset.name,P(r,t)}function S(){a.current.style.display="none",a.current.innerText="",a.current.style.transform="translate3d(0,0,0)"}function O(e){e.preventDefault(),h.current=e.pageY,g.current=e.pageX;e=e.target,e=adhere_util_1.default.getTopDom(e,selectorPrefix+"-index-item");x.current=null==e?void 0:e.dataset.name,p.current=!0}function q(e){if(!p.current)return!1;_.current=!0,e.preventDefault();var t=e.pageY;P(e.pageX,t)}function k(){p.current=!1,_.current=!1,a.current.style.display="none",a.current.innerText="",a.current.style.transform="translate3d(0,0,0)"}function A(e){if(_.current)return p.current=!1,_.current=!1,a.current.style.display="none",a.current.innerText="",!(a.current.style.transform="translate3d(0,0,0)");e.preventDefault(),L(e)}function M(){w(),T()}return react_1.useImperativeHandle(t,function(){return{scrollToAnimation:D,scrollTo:R}}),react_1.useLayoutEffect(function(){var e;return(e=document.createElement("div")).innerHTML="<div class='"+selectorPrefix+"-mask'></div>",v.current=e.firstElementChild,document.body.appendChild(v.current),w(),T(),function(){var e;null!==(e=null===(e=v.current)||void 0===e?void 0:e.parentElement)&&void 0!==e&&e.removeChild(v.current)}},[]),react_1.useLayoutEffect(function(){var e;return adhere_util_1.default.isTouch()?(null!==(e=f.current)&&void 0!==e&&e.addEventListener("click",b),null!==(e=f.current)&&void 0!==e&&e.addEventListener("touchmove",N),null!==(e=f.current)&&void 0!==e&&e.addEventListener("touchend",S)):(null!==(e=f.current)&&void 0!==e&&e.addEventListener("mousedown",O),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mousemove",q),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mouseleave",k),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mouseup",A),"undefined"!=typeof window&&window.addEventListener("resize",M)),w(),T(),function(){var e;null!==(e=f.current)&&void 0!==e&&e.removeEventListener("click",b),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("touchmove",N),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("touchend",S),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mousedown",O),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mousemove",q),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseleave",k),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseup",A),"undefined"!=typeof window&&window.removeEventListener("resize",M)}}),react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,selectorPrefix+"-config-position-"+n,i||""),style:u||{},ref:d},react_1.default.createElement("div",{className:selectorPrefix+"-highlighted",ref:a}),react_1.default.createElement("div",{className:selectorPrefix+"-content",ref:s},r.map(function(t){var e=o.find(function(e){return e.index===t.index});return react_1.default.createElement("div",{key:t.index,className:selectorPrefix+"-group"},react_1.default.createElement("a",{className:selectorPrefix+"-group-title","data-name":t.index},null!=e&&e.renderTitle?e.renderTitle(t):null==e?void 0:e.index),react_1.default.createElement("div",{className:selectorPrefix+"-group-inner"},null!=e&&e.renderContent?null==e?void 0:e.renderContent(t):null))})),react_1.default.createElement("div",{className:selectorPrefix+"-index",ref:e},react_1.default.createElement("div",{className:selectorPrefix+"-index-inner",ref:f},o.map(function(e){return react_1.default.createElement("a",{key:e.index,className:selectorPrefix+"-index-item","data-name":e.index},e.renderIndex?e.renderIndex(e):e.index)}))))};exports.default=react_1.forwardRef(Surnames);
//# sourceMappingURL=surnames.js.map
