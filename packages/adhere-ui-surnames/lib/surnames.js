"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var c=Object.getOwnPropertyDescriptor(t,r);c&&("get"in c?t.__esModule:!c.writable&&!c.configurable)||(c={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,c)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},classnames_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("classnames"))),react_1=__importStar(require("react")),adhere_util_1=__importDefault(require("@baifendian/adhere-util")),selectorPrefix="adhere-ui-surnames",DURATION=100,Surnames=function(e,C){var t=e.position,r=void 0===t?"right":t,t=e.className,t=void 0===t?"":t,n=e.style,n=void 0===n?{}:n,c=e.indexes,a=void 0===c?[]:c,c=e.dataSource,u=void 0===c?[]:c,i=e.onScroll,l=e.onBeforeScroll,s=(0,react_1.useRef)(null),o=(0,react_1.useRef)(null),f=(0,react_1.useRef)(null),c=(0,react_1.useRef)(null),d=(0,react_1.useRef)(null),m=(0,react_1.useRef)(),v=(0,react_1.useRef)(!1),p=(0,react_1.useRef)(!1),_=(0,react_1.useRef)(!1),h=(0,react_1.useRef)(0),g=(0,react_1.useRef)(0),x=(0,react_1.useRef)(""),y=(0,react_1.useRef)([]);function E(){return"left"===r||"right"===r?"vertical":"horizontal"}function w(){"vertical"===E()?(s.current.style.height="".concat(d.current.offsetHeight+50,"px"),s.current.style.width="100%"):s.current.style.height="100%"}var e=(0,react_1.useCallback)(function(){return u.map(function(t){var e=a.find(function(e){return e.index===t.index});return react_1.default.createElement("div",{key:t.index,className:"".concat(selectorPrefix,"-group")},react_1.default.createElement("a",{className:"".concat(selectorPrefix,"-group-title"),"data-name":t.index},null!=e&&e.renderTitle?e.renderTitle(t):null==e?void 0:e.index),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-group-inner")},null!=e&&e.renderContent?null==e?void 0:e.renderContent(t):null))})},[u,a]),j=(0,react_1.useCallback)(function(){return a.map(function(e){return react_1.default.createElement("a",{key:e.index,className:"".concat(selectorPrefix,"-index-item"),"data-name":e.index},e.renderIndex?e.renderIndex(e):e.index)})},[a]);function T(){var e,t=null==(e=d.current)?void 0:e.querySelectorAll(".".concat(selectorPrefix,"-index-item"));y.current=[];for(var r=0;r<t.length;r++){var n=t[r],c=n.dataset.name,a=n.getBoundingClientRect();y.current.push({name:c,top:a.top,bottom:a.bottom,left:a.left,right:a.right,offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight})}}function P(e){var t=e.target;e.preventDefault(),v.current||(v.current=!0,m.current.style.display="block",L(t.dataset.name))}function b(e,t){e=function(e,t){for(var r,n=E(),c="vertical"===n?t-h.current:e-g.current,a=y.current.find(function(e){return e.name===x.current}),u=0,o=y.current.length-1;u<=o&&u<=y.current.length-1&&o<=y.current.length-1;){var i,l=y.current[i=o+u>>1],s=void 0,f=void 0,d=void 0,d="vertical"===n?(s=a.top+c,a.bottom,f=l.top,l.bottom):(s=a.left+c,a.right,f=l.left,l.right);if(f<=s&&s<=d){r=l;break}s<f?o=i-1:u=1+i}return r||null}(e,t);e&&(o.current.innerText=e.name,o.current.style.display="block","vertical"===E()?(t=e.offsetTop+Math.floor(e.height/2),o.current.style.transform="translate3d(0,".concat(t,"px,0)")):(t=e.offsetLeft+e.width,o.current.style.transform="translate3d(".concat(t,"px,0,0)")),D(e.name))}function L(r,e){void 0===e&&(e=100);var t=null==(t=f.current)?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(r,"']")),n=null==(u=f.current)?void 0:u.scrollTop,c=n,a=t.offsetTop,u=screen.updateInterval,o=s.current.scrollHeight/((DURATION|e)/(u||16.7)+((DURATION|e)%(u||16.7)!=0?1:0));l&&l(r),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function t(){v.current=!1,p.current=!1,m.current.style.display="none",i&&i(r)}n<a?a<c+o?c=a:c+=o:c-o<a?c=a:c-=o,f.current.scrollTop=c,n<a?a<=c?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):c<=a?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)})}function D(e){var t;f.current.scrollTop=(null==(t=f.current)?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(e,"']"))).offsetTop,i&&i(e)}function R(e){e.preventDefault(),e.stopPropagation(),P(e)}function N(e){e.preventDefault();var t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX,e=e.target,e=adhere_util_1.default.getTopDom(e,"".concat(selectorPrefix,"-index-item"));x.current=e.dataset.name,b(r,t)}function O(){o.current.style.display="none",o.current.innerText="",o.current.style.transform="translate3d(0,0,0)"}function S(e){e.preventDefault(),h.current=e.pageY,g.current=e.pageX;e=e.target,e=adhere_util_1.default.getTopDom(e,"".concat(selectorPrefix,"-index-item"));x.current=null==e?void 0:e.dataset.name,p.current=!0}function k(e){if(!p.current)return!1;_.current=!0,e.preventDefault();var t=e.pageY;b(e.pageX,t)}function q(){p.current=!1,_.current=!1,o.current.style.display="none",o.current.innerText="",o.current.style.transform="translate3d(0,0,0)"}function M(e){if(_.current)return p.current=!1,_.current=!1,o.current.style.display="none",o.current.innerText="",!(o.current.style.transform="translate3d(0,0,0)");e.preventDefault(),P(e)}function A(){w(),T()}return(0,react_1.useImperativeHandle)(C,function(){return{scrollToAnimation:L,scrollTo:D}}),(0,react_1.useLayoutEffect)(function(){var e;return(e=document.createElement("div")).innerHTML="<div class='".concat(selectorPrefix,"-mask'></div>"),m.current=e.firstElementChild,document.body.appendChild(m.current),w(),T(),function(){var e;null!=(e=null==(e=m.current)?void 0:e.parentElement)&&e.removeChild(m.current)}},[]),(0,react_1.useLayoutEffect)(function(){var e;return adhere_util_1.default.isTouch()?(null!=(e=d.current)&&e.addEventListener("click",R),null!=(e=d.current)&&e.addEventListener("touchmove",N),null!=(e=d.current)&&e.addEventListener("touchend",O)):(null!=(e=d.current)&&e.addEventListener("mousedown",S),null!=(e=d.current)&&e.addEventListener("mousemove",k),null!=(e=d.current)&&e.addEventListener("mouseleave",q),null!=(e=d.current)&&e.addEventListener("mouseup",M),"undefined"!=typeof window&&window.addEventListener("resize",A)),w(),T(),function(){var e;null!=(e=d.current)&&e.removeEventListener("click",R),null!=(e=d.current)&&e.removeEventListener("touchmove",N),null!=(e=d.current)&&e.removeEventListener("touchend",O),null!=(e=d.current)&&e.removeEventListener("mousedown",S),null!=(e=d.current)&&e.removeEventListener("mousemove",k),null!=(e=d.current)&&e.removeEventListener("mouseleave",q),null!=(e=d.current)&&e.removeEventListener("mouseup",M),"undefined"!=typeof window&&window.removeEventListener("resize",A)}}),react_1.default.createElement("div",{className:(0,classnames_1.default)(selectorPrefix,"".concat(selectorPrefix,"-config-position-").concat(r),null!=t?t:""),style:null!=n?n:{},ref:s},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-highlighted"),ref:o}),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-content"),ref:f},e()),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-index"),ref:c},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-index-inner"),ref:d},j())))};exports.default=(0,react_1.memo)((0,react_1.forwardRef)(Surnames));
//# sourceMappingURL=surnames.js.map
