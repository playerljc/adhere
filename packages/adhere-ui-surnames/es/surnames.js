import React,{forwardRef,useImperativeHandle,useLayoutEffect,useRef}from"react";import classNames from"classnames";import Util from"@baifendian/adhere-util";var selectorPrefix="adhere-ui-surnames",DURATION=100,Surnames=function(e,t){var r=e.position,n=void 0===r?"right":r,o=e.className,i=void 0===o?"":o,r=e.style,o=void 0===r?{}:r,r=e.indexes,u=void 0===r?[]:r,r=e.dataSource,r=void 0===r?[]:r,c=e.onScroll,a=e.onBeforeScroll,s=useRef(null),l=useRef(null),d=useRef(null),e=useRef(null),f=useRef(null),v=useRef(),m=useRef(!1),p=useRef(!1),h=useRef(!1),x=useRef(0),g=useRef(0),y=useRef(""),E=useRef([]);function R(){return"left"===n||"right"===n?"vertical":"horizontal"}function w(){"vertical"===R()?(s.current.style.height=f.current.offsetHeight+50+"px",s.current.style.width="100%"):s.current.style.height="100%"}function T(){var e,t=null===(e=f.current)||void 0===e?void 0:e.querySelectorAll("."+selectorPrefix+"-index-item");E.current=[];for(var r=0;r<t.length;r++){var n=t[r],o=n.dataset.name,i=n.getBoundingClientRect();E.current.push({name:o,top:i.top,bottom:i.bottom,left:i.left,right:i.right,offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight})}}function L(e){var t=e.target;e.preventDefault(),m.current||(m.current=!0,v.current.style.display="block",N(t.dataset.name))}function P(e,t){var r,t=function(e,t){for(var r,n=R(),o="vertical"===n?t-x.current:e-g.current,i=E.current.find(function(e){return e.name===y.current}),u=0,l=E.current.length-1;u<=l&&u<=E.current.length-1&&l<=E.current.length-1;){var c,a=E.current[c=l+u>>1],s=void 0,d=void 0,f=void 0,f="vertical"===n?(s=i.top+o,i.bottom,d=a.top,a.bottom):(s=i.left+o,i.right,d=a.left,a.right);if(d<=s&&s<=f){r=a;break}s<d?l=c-1:u=1+c}return r||null}(e,t);t&&(l.current.innerText=t.name,l.current.style.display="block","vertical"===R()?(r=t.offsetTop+Math.floor(t.height/2),l.current.style.transform="translate3d(0,"+r+"px,0)"):(r=t.offsetLeft+t.width,l.current.style.transform="translate3d("+r+"px,0,0)"),D(t.name))}function N(r,e){var t;void 0===e&&(e=100);var n=null===(t=d.current)||void 0===t?void 0:t.querySelector("."+selectorPrefix+"-group-title[data-name='"+r+"']"),o=null===(t=d.current)||void 0===t?void 0:t.scrollTop,i=o,u=n.offsetTop,n=screen.updateInterval,l=s.current.scrollHeight/((DURATION|e)/(n||16.7)+((DURATION|e)%(n||16.7)!=0?1:0));a&&a(r),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function t(){m.current=!1,p.current=!1,v.current.style.display="none",c&&c(r)}o<u?u<i+l?i=u:i+=l:i-l<u?i=u:i-=l,d.current.scrollTop=i,o<u?u<=i?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):i<=u?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)})}function D(e){var t;d.current.scrollTop=(null===(t=d.current)||void 0===t?void 0:t.querySelector("."+selectorPrefix+"-group-title[data-name='"+e+"']")).offsetTop,c&&c(e)}function b(e){e.preventDefault(),e.stopPropagation(),L(e)}function k(e){e.preventDefault();var t=e.changedTouches[0].pageY,r=e.changedTouches[0].pageX,e=e.target,e=Util.getTopDom(e,selectorPrefix+"-index-item");y.current=e.dataset.name,P(r,t)}function A(){l.current.style.display="none",l.current.innerText="",l.current.style.transform="translate3d(0,0,0)"}function I(e){e.preventDefault(),x.current=e.pageY,g.current=e.pageX;e=e.target,e=Util.getTopDom(e,selectorPrefix+"-index-item");y.current=null==e?void 0:e.dataset.name,p.current=!0}function S(e){if(!p.current)return!1;h.current=!0,e.preventDefault();var t=e.pageY;P(e.pageX,t)}function U(){p.current=!1,h.current=!1,l.current.style.display="none",l.current.innerText="",l.current.style.transform="translate3d(0,0,0)"}function q(e){if(h.current)return p.current=!1,h.current=!1,l.current.style.display="none",l.current.innerText="",!(l.current.style.transform="translate3d(0,0,0)");e.preventDefault(),L(e)}function C(){w(),T()}return useImperativeHandle(t,function(){return{scrollToAnimation:N,scrollTo:D}}),useLayoutEffect(function(){var e;return(e=document.createElement("div")).innerHTML="<div class='"+selectorPrefix+"-mask'></div>",v.current=e.firstElementChild,document.body.appendChild(v.current),w(),T(),function(){var e;null!==(e=null===(e=v.current)||void 0===e?void 0:e.parentElement)&&void 0!==e&&e.removeChild(v.current)}},[]),useLayoutEffect(function(){var e;return Util.isTouch()?(null!==(e=f.current)&&void 0!==e&&e.addEventListener("click",b),null!==(e=f.current)&&void 0!==e&&e.addEventListener("touchmove",k),null!==(e=f.current)&&void 0!==e&&e.addEventListener("touchend",A)):(null!==(e=f.current)&&void 0!==e&&e.addEventListener("mousedown",I),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mousemove",S),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mouseleave",U),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mouseup",q),"undefined"!=typeof window&&window.addEventListener("resize",C)),w(),T(),function(){var e;null!==(e=f.current)&&void 0!==e&&e.removeEventListener("click",b),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("touchmove",k),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("touchend",A),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mousedown",I),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mousemove",S),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseleave",U),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseup",q),"undefined"!=typeof window&&window.removeEventListener("resize",C)}}),React.createElement("div",{className:classNames(selectorPrefix,selectorPrefix+"-config-position-"+n,i||""),style:o||{},ref:s},React.createElement("div",{className:selectorPrefix+"-highlighted",ref:l}),React.createElement("div",{className:selectorPrefix+"-content",ref:d},r.map(function(t){var e=u.find(function(e){return e.index===t.index});return React.createElement("div",{key:t.index,className:selectorPrefix+"-group"},React.createElement("a",{className:selectorPrefix+"-group-title","data-name":t.index},null!=e&&e.renderTitle?e.renderTitle(t):null==e?void 0:e.index),React.createElement("div",{className:selectorPrefix+"-group-inner"},null!=e&&e.renderContent?null==e?void 0:e.renderContent(t):null))})),React.createElement("div",{className:selectorPrefix+"-index",ref:e},React.createElement("div",{className:selectorPrefix+"-index-inner",ref:f},u.map(function(e){return React.createElement("a",{key:e.index,className:selectorPrefix+"-index-item","data-name":e.index},e.renderIndex?e.renderIndex(e):e.index)}))))};export default forwardRef(Surnames);
//# sourceMappingURL=surnames.js.map
