{"version":3,"file":"TreeAutoComplete.js","sources":["TreeAutoComplete.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __rest = void 0 && (void 0).__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar antd_1 = require(\"antd\");\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar lodash_debounce_1 = __importDefault(require(\"lodash.debounce\"));\nvar react_1 = __importStar(require(\"react\"));\nvar useCommon_1 = __importDefault(require(\"./useCommon\"));\n/**\n * TreeAutoComplete\n */\nvar TreeAutoComplete = (0, react_1.memo)(function (_a) {\n  var classNameWrap = _a.classNameWrap,\n    styleWrap = _a.styleWrap,\n    renderLoading = _a.renderLoading,\n    debounceTimeout = _a.debounceTimeout,\n    loadData = _a.loadData,\n    treeData = _a.treeData,\n    defaultTreeData = _a.defaultTreeData,\n    emptyContent = _a.emptyContent,\n    children = _a.children,\n    treeDataSimpleMode = _a.treeDataSimpleMode,\n    props = __rest(_a, [\"classNameWrap\", \"styleWrap\", \"renderLoading\", \"debounceTimeout\", \"loadData\", \"treeData\", \"defaultTreeData\", \"emptyContent\", \"children\", \"treeDataSimpleMode\"]);\n  var _b = (0, react_1.useState)(defaultTreeData !== null && defaultTreeData !== void 0 ? defaultTreeData : []),\n    selectTreeData = _b[0],\n    setSelectTreeData = _b[1];\n  var _c = (0, useCommon_1.default)({\n      renderLoading: renderLoading,\n      emptyContent: emptyContent,\n      loadData: loadData\n    }),\n    defaultDebounceTimeout = _c.defaultDebounceTimeout,\n    selectorPrefix = _c.selectorPrefix,\n    fetchLoading = _c.fetchLoading,\n    empty = _c.empty,\n    fetching = _c.fetching,\n    setOpen = _c.setOpen,\n    onClear = _c.onClear,\n    onInputMemo = _c.onInputMemo;\n  // const isMultiple = 'multiple' in props ? !!props.multiple : false;\n  /**\n   * onSelectChange\n   * @description 从下方组件触发的\n   * @param _values\n   * @param label\n   * @param extra\n   */\n  function onSelectChange(_values, label, extra) {\n    var _a;\n    setSelectTreeData(extra.allCheckedNodes);\n    // @ts-ignore\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, _values);\n  }\n  var onInput = (0, react_1.useCallback)((0, lodash_debounce_1.default)(function (_value) {\n    var _kw = _value.trim();\n    if (!_kw) {\n      onClear();\n      return;\n    }\n    onInputMemo(_kw);\n  }, debounceTimeout !== null && debounceTimeout !== void 0 ? debounceTimeout : defaultDebounceTimeout), [debounceTimeout]);\n  var containerTreeData = (0, react_1.useMemo)(function () {\n    /*\n     *  if(正常) {\n     *    treeData需要拉平\n     *    selectTreeData获取拉平后的路径\n     *\n     *    treeData + selectTreeData 去重\n     *\n     *    转换成正常\n     *  } else {\n     *     selectTreeData获取拉平后的路径\n     *\n     *     treeData + selectTreeData 去重\n     *  }\n     * */\n    return [];\n  }, [selectTreeData, treeData]);\n  var dropdownTreeData = (0, react_1.useMemo)(function () {\n    /*\n     *  if(正常) {\n     *    treeData需要拉平\n     *    defaultTreeData获取拉平后的路径，且在props.value中\n     *\n     *    treeData + defaultTreeData 去重\n     *\n     *    转换成正常\n     *  } else {\n     *     defaultTreeData过滤出在props.value中\n     *\n     *     treeData + defaultTreeData 去重\n     *  }\n     * */\n    return [];\n  }, [treeData, defaultTreeData, props.value]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setSelectTreeData(defaultTreeData !== null && defaultTreeData !== void 0 ? defaultTreeData : []);\n  }, [defaultTreeData]);\n  return react_1.default.createElement(\"div\", {\n    className: (0, classnames_1.default)(selectorPrefix, classNameWrap !== null && classNameWrap !== void 0 ? classNameWrap : ''),\n    style: styleWrap !== null && styleWrap !== void 0 ? styleWrap : {}\n  }, react_1.default.createElement(antd_1.TreeSelect, __assign({\n    showSearch: true,\n    allowClear: true,\n    treeData: containerTreeData !== null && containerTreeData !== void 0 ? containerTreeData : [],\n    onSearch: onInput,\n    dropdownRender: function dropdownRender(originNode) {\n      var _a;\n      if (fetching) return fetchLoading;\n      return !!(dropdownTreeData === null || dropdownTreeData === void 0 ? void 0 : dropdownTreeData.length) ? (_a = children === null || children === void 0 ? void 0 : children({\n        originNode: originNode,\n        treeDataSimpleMode: treeDataSimpleMode,\n        value: props.value,\n        onChange: function onChange() {\n          var params = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n          }\n          return onSelectChange.apply(void 0, params);\n        },\n        treeData: dropdownTreeData !== null && dropdownTreeData !== void 0 ? dropdownTreeData : [],\n        loading: fetching\n      })) !== null && _a !== void 0 ? _a : originNode : empty;\n    },\n    onDropdownVisibleChange: setOpen,\n    treeDataSimpleMode: !!treeDataSimpleMode\n  }, props, {\n    onChange: function onChange() {\n      var params = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        params[_i] = arguments[_i];\n      }\n      return onSelectChange.apply(void 0, params);\n    }\n  })));\n});\nTreeAutoComplete.displayName = 'TreeAutoComplete';\nexports.default = TreeAutoComplete;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","default","ahooks_1","exports","require","antd_1","classnames_1","lodash_debounce_1","react_1","useCommon_1","TreeAutoComplete","memo","_a","classNameWrap","styleWrap","renderLoading","debounceTimeout","loadData","treeData","defaultTreeData","emptyContent","children","treeDataSimpleMode","props","_b","useState","selectTreeData","setSelectTreeData","_c","defaultDebounceTimeout","selectorPrefix","fetchLoading","empty","fetching","setOpen","onClear","onInputMemo","onSelectChange","_values","label","extra","allCheckedNodes","onChange","onInput","useCallback","_value","_kw","trim","containerTreeData","useMemo","dropdownTreeData","useUpdateEffect","createElement","className","style","TreeSelect","showSearch","allowClear","onSearch","dropdownRender","originNode","params","_i","loading","onDropdownVisibleChange","displayName"],"mappings":"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"}