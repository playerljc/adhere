import _Select from"antd/es/select";import _Spin from"antd/es/spin";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,n){var r={};for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var t=0,a=Object.getOwnPropertySymbols(e);t<a.length;t++)n.indexOf(a[t])<0&&Object.prototype.propertyIsEnumerable.call(e,a[t])&&(r[a[t]]=e[a[t]]);return r},__spreadArray=this&&this.__spreadArray||function(e,n,r){if(r||2===arguments.length)for(var t,a=0,o=n.length;a<o;a++)!t&&a in n||((t=t||Array.prototype.slice.call(n,0,a))[a]=n[a]);return e.concat(t||Array.prototype.slice.call(n))};import classNames from"classnames";import debounce from"lodash.debounce";import React,{memo,useCallback,useMemo,useRef,useState}from"react";import WatchMemoized from"@baifendian/adhere-util-watchmemoized";var memoized=WatchMemoized.memoized,selectorPrefix="adhere-ui-auto-complete",AutoComplete=function(e){function r(n,e){(e=void 0===e?!0:e)&&(s.current=!0);var r=__spreadArray(__spreadArray([],null!=l?l:[],!0),null!=(e=m.current)?e:[],!0);Array.isArray(n)?m.current=n.map(function(n){return r.find(function(e){return e.value===n})}).filter(function(e){return!!e}):m.current=[r.find(function(e){return e.value===n})].filter(function(e){return!!e}),null!=(e=c.onChange)&&e.call(c,n)}var n=e.classNameWrap,t=e.styleWrap,a=e.renderLoading,o=e.debounceTimeout,o=void 0===o?300:o,l=e.options,u=e.loadData,i=e.children,c=__rest(e,["classNameWrap","styleWrap","renderLoading","debounceTimeout","options","loadData","children"]),s=useRef(!1),e=useState(!1),f=e[0],d=e[1],m=useRef([]),e=useMemo(function(){var e;return null!=(e=null==a?void 0:a())?e:React.createElement("div",{className:"".concat(selectorPrefix,"-loading")},React.createElement(_Spin,{size:"large"}))},[a]),p=useCallback(memoized.createMemoFun(function(e){d(!0),null!=u&&u(e).then(function(){d(!1)})}),[u]),o=useCallback(debounce(function(e){e=e.target.value.trim();s.current?s.current=!1:p(e)},null!=o?o:300),[o]),v=useMemo(function(){Array.isArray(c.value)?c.value.forEach(function(n){var e=null==(e=null==l?void 0:l.find)?void 0:e.call(l,function(e){return e.value===n});e&&!m.current.find(function(e){return e.value===n})&&m.current.push(e)}):(n=null==(n=null==l?void 0:l.find)?void 0:n.call(l,function(e){return e.value===c.value}))&&!m.current.find(function(e){return e.value===c.value})&&m.current.push(n);var e=__spreadArray(__spreadArray([],null!=l?l:[],!0),null!=(n=m.current)?n:[],!0),n=e.map(function(e){return e.value});return Array.from(new Set(n)).map(function(n){return e.find(function(e){return e.value===n})})},[c.value,l]);return React.createElement("div",{className:classNames(selectorPrefix,null!=n?n:""),style:null!=t?t:{}},React.createElement(_Select,__assign({showSearch:!0,allowClear:!0,notFoundContent:f&&e,filterOption:!1,options:null!=v?v:[],onInput:o,onClear:function(){null!=u&&u("").then(function(){d(!1)})},dropdownRender:function(e){var n;return null!=(n=null==i?void 0:i({originNode:e,value:c.value,onChange:function(e){return r(e,!0)},options:null!=v?v:[],loading:f}))?n:e}},c,{onChange:function(e){return r(e,!1)}})))};export default memo(AutoComplete);
//# sourceMappingURL=AutoComplete.js.map
