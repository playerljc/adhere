{"version":3,"file":"TreeAutoComplete.js","sources":["TreeAutoComplete.js"],"sourcesContent":["import _TreeSelect from \"antd/es/tree-select\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { useUpdateEffect } from 'ahooks';\nimport classNames from 'classnames';\nimport debounce from 'lodash.debounce';\nimport React, { memo, useCallback, useMemo, useState } from 'react';\nimport useCommon from './useCommon';\n/**\n * TreeAutoComplete\n */\nvar TreeAutoComplete = /*#__PURE__*/memo(function (_a) {\n  var classNameWrap = _a.classNameWrap,\n    styleWrap = _a.styleWrap,\n    renderLoading = _a.renderLoading,\n    debounceTimeout = _a.debounceTimeout,\n    loadData = _a.loadData,\n    treeData = _a.treeData,\n    defaultTreeData = _a.defaultTreeData,\n    emptyContent = _a.emptyContent,\n    children = _a.children,\n    treeDataSimpleMode = _a.treeDataSimpleMode,\n    props = __rest(_a, [\"classNameWrap\", \"styleWrap\", \"renderLoading\", \"debounceTimeout\", \"loadData\", \"treeData\", \"defaultTreeData\", \"emptyContent\", \"children\", \"treeDataSimpleMode\"]);\n  var _b = useState(defaultTreeData !== null && defaultTreeData !== void 0 ? defaultTreeData : []),\n    selectTreeData = _b[0],\n    setSelectTreeData = _b[1];\n  var _c = useCommon({\n      renderLoading: renderLoading,\n      emptyContent: emptyContent,\n      loadData: loadData\n    }),\n    defaultDebounceTimeout = _c.defaultDebounceTimeout,\n    selectorPrefix = _c.selectorPrefix,\n    fetchLoading = _c.fetchLoading,\n    empty = _c.empty,\n    fetching = _c.fetching,\n    setOpen = _c.setOpen,\n    onClear = _c.onClear,\n    onInputMemo = _c.onInputMemo;\n  // const isMultiple = 'multiple' in props ? !!props.multiple : false;\n  /**\n   * onSelectChange\n   * @description 从下方组件触发的\n   * @param _values\n   * @param label\n   * @param extra\n   */\n  function onSelectChange(_values, label, extra) {\n    var _a;\n    setSelectTreeData(extra.allCheckedNodes);\n    // @ts-ignore\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, _values);\n  }\n  var onInput = useCallback(debounce(function (_value) {\n    var _kw = _value.trim();\n    if (!_kw) {\n      onClear();\n      return;\n    }\n    onInputMemo(_kw);\n  }, debounceTimeout !== null && debounceTimeout !== void 0 ? debounceTimeout : defaultDebounceTimeout), [debounceTimeout]);\n  var containerTreeData = useMemo(function () {\n    /*\n     *  if(正常) {\n     *    treeData需要拉平\n     *    selectTreeData获取拉平后的路径\n     *\n     *    treeData + selectTreeData 去重\n     *\n     *    转换成正常\n     *  } else {\n     *     selectTreeData获取拉平后的路径\n     *\n     *     treeData + selectTreeData 去重\n     *  }\n     * */\n    return [];\n  }, [selectTreeData, treeData]);\n  var dropdownTreeData = useMemo(function () {\n    /*\n     *  if(正常) {\n     *    treeData需要拉平\n     *    defaultTreeData获取拉平后的路径，且在props.value中\n     *\n     *    treeData + defaultTreeData 去重\n     *\n     *    转换成正常\n     *  } else {\n     *     defaultTreeData过滤出在props.value中\n     *\n     *     treeData + defaultTreeData 去重\n     *  }\n     * */\n    return [];\n  }, [treeData, defaultTreeData, props.value]);\n  useUpdateEffect(function () {\n    setSelectTreeData(defaultTreeData !== null && defaultTreeData !== void 0 ? defaultTreeData : []);\n  }, [defaultTreeData]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(selectorPrefix, classNameWrap !== null && classNameWrap !== void 0 ? classNameWrap : ''),\n    style: styleWrap !== null && styleWrap !== void 0 ? styleWrap : {}\n  }, /*#__PURE__*/React.createElement(_TreeSelect, __assign({\n    showSearch: true,\n    allowClear: true,\n    treeData: containerTreeData !== null && containerTreeData !== void 0 ? containerTreeData : [],\n    onSearch: onInput,\n    dropdownRender: function dropdownRender(originNode) {\n      var _a;\n      if (fetching) return fetchLoading;\n      return !!(dropdownTreeData === null || dropdownTreeData === void 0 ? void 0 : dropdownTreeData.length) ? (_a = children === null || children === void 0 ? void 0 : children({\n        originNode: originNode,\n        treeDataSimpleMode: treeDataSimpleMode,\n        value: props.value,\n        onChange: function onChange() {\n          var params = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n          }\n          return onSelectChange.apply(void 0, params);\n        },\n        treeData: dropdownTreeData !== null && dropdownTreeData !== void 0 ? dropdownTreeData : [],\n        loading: fetching\n      })) !== null && _a !== void 0 ? _a : originNode : empty;\n    },\n    onDropdownVisibleChange: setOpen,\n    treeDataSimpleMode: !!treeDataSimpleMode\n  }, props, {\n    onChange: function onChange() {\n      var params = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        params[_i] = arguments[_i];\n      }\n      return onSelectChange.apply(void 0, params);\n    }\n  })));\n});\nTreeAutoComplete.displayName = 'TreeAutoComplete';\nexport default TreeAutoComplete;"],"names":["_TreeSelect","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","useUpdateEffect","classNames","debounce","React","memo","useCallback","useMemo","useState","useCommon","TreeAutoComplete","_a","classNameWrap","styleWrap","renderLoading","debounceTimeout","loadData","treeData","defaultTreeData","emptyContent","children","treeDataSimpleMode","props","_b","selectTreeData","setSelectTreeData","_c","defaultDebounceTimeout","selectorPrefix","fetchLoading","empty","fetching","setOpen","onClear","onInputMemo","onSelectChange","_values","label","extra","allCheckedNodes","onChange","onInput","_value","_kw","trim","containerTreeData","dropdownTreeData","value","createElement","className","style","showSearch","allowClear","onSearch","dropdownRender","originNode","params","_i","loading","onDropdownVisibleChange","displayName"],"mappings":"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"}