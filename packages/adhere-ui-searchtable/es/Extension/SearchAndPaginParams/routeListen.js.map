{"version":3,"file":"routeListen.js","sources":["Extension/SearchAndPaginParams/routeListen.js"],"sourcesContent":["import { SearchAndPaginParamsMemo as StateSearchAndPaginParamsMemo } from '../../ProSearchStateTable';\nimport { SearchAndPaginParamsMemo } from '../../ProSearchTable';\nvar historyStack = [];\n/**\n * clearSearAndPaginParamsByPathname\n * @description 清除查询条件根据pathname\n * @param pathname\n */\nfunction clearSearAndPaginParamsByPathname(pathname) {\n  var findIndex = SearchAndPaginParamsMemo.findIndexByPath(pathname);\n  if (findIndex !== -1) {\n    SearchAndPaginParamsMemo.deleteByIndex(findIndex);\n  }\n  findIndex = StateSearchAndPaginParamsMemo.findIndexByPath(pathname);\n  if (findIndex !== -1) {\n    StateSearchAndPaginParamsMemo.deleteByIndex(findIndex);\n  }\n}\nvar codeStack = [];\nvar Listener = function Listener(e, _history) {\n  var location = e.location,\n    action = e.action;\n  var code = function code() {\n    var pathname = location.pathname;\n    var findIndex = historyStack.lastIndexOf(pathname);\n    // 没找到\n    if (findIndex === -1) {\n      // 清除查询条件\n      clearSearAndPaginParamsByPathname(pathname);\n      historyStack.push(pathname);\n    }\n    // 找到了\n    else {\n      var pathArr = historyStack.slice(findIndex + 1);\n      // 1 2 1\n      // 之间只有一个页面的路径\n      if (pathArr.length === 1) {\n        // pathArr[0] /system/task/list/view\n        // pathname   /system/task/list/ 当前\n        if (!pathArr[0].startsWith(pathname)) {\n          // 清除查询条件\n          clearSearAndPaginParamsByPathname(pathname);\n        }\n      } else {\n        // 清除查询条件\n        clearSearAndPaginParamsByPathname(pathname);\n      }\n      // 都需要清空路径\n      historyStack = historyStack.slice(0, findIndex);\n      historyStack.push(pathname);\n    }\n  };\n  if (_history.action === 'PUSH') {\n    code();\n  }\n  if (_history.action === 'POP') {\n    codeStack.push(code);\n  }\n};\nListener.getCode = function () {\n  return codeStack.pop();\n};\nexport default Listener;"],"names":["StateSearchAndPaginParamsMemo","SearchAndPaginParamsMemo","historyStack","clearSearAndPaginParamsByPathname","pathname","findIndex","findIndexByPath","deleteByIndex","codeStack","Listener","e","_history","code","pathArr","location","lastIndexOf","slice","length","startsWith","push","action","getCode","pop"],"mappings":"OAAqCA,yDAAgE,KAA3B,mCACjEC,wBAAsD,KAAtB,uBACzC,IAAIC,aAAe,GAMnB,SAASC,kCAAkCC,GACzC,IAAIC,EAAYJ,yBAAyBK,gBAAgBF,CAAQ,EAC/C,CAAC,IAAfC,GACFJ,yBAAyBM,cAAcF,CAAS,EAGhC,CAAC,KADnBA,EAAYL,8BAA8BM,gBAAgBF,CAAQ,IAEhEJ,8BAA8BO,cAAcF,CAAS,CAEzD,CACA,IAAIG,UAAY,GACZC,SAAW,SAAkBC,EAAGC,GAGvB,SAAPC,IACF,IAUMC,EAVFT,EAAWU,EAASV,SACpBC,EAAYH,aAAaa,YAAYX,CAAQ,GAE/B,CAAC,IAAfC,GAEFF,kCAAkCC,CAAQ,EAC1CF,eAOuB,KAHnBW,EAAUX,aAAac,MAAMX,EAAY,CAAC,GAGlCY,QAGLJ,EAAQ,GAAGK,WAAWd,CAAQ,GAMnCD,kCAAkCC,CAAQ,EAG5CF,aAAeA,aAAac,MAAM,EAAGX,CAAS,IAnBjCc,KAAKf,CAAQ,CAsB9B,CA/BA,IAAIU,EAAWJ,EAAEI,SACNJ,EAAEU,OA+BW,SAApBT,EAASS,QACXR,EAAK,EAEiB,QAApBD,EAASS,QACXZ,UAAUW,KAAKP,CAAI,CAEvB,EACAH,SAASY,QAAU,WACjB,OAAOb,UAAUc,IAAI,CACvB,iBACeb"}