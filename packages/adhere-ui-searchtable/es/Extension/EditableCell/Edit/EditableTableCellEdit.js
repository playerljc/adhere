import _CloseOutlined from"@ant-design/icons/es/icons/CloseOutlined";import _CheckOutlined from"@ant-design/icons/es/icons/CheckOutlined";import _Form from"antd/es/form";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var l,t=1,n=arguments.length;t<n;t++)for(var a in l=arguments[t])Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,l,t){if(t||2===arguments.length)for(var n,a=0,r=l.length;a<r;a++)!n&&a in l||((n=n||Array.prototype.slice.call(l,0,a))[a]=l[a]);return e.concat(n||Array.prototype.slice.call(l))};import React,{useContext,useEffect}from"react";import ConditionalRender from"@baifendian/adhere-ui-conditionalrender";import{SearchTableContext,selectorPrefix}from"../../../SearchTable";import FormItemGenerator from"./FormItemGenerator";var EditableTableCellEdit=function(e){var l,t=e.editableConfig,n=t.useTrigger,a=t.useKeepEdit,r=t.renderSaveTrigger,i=t.renderCancelTrigger,o=t.onSave,d=t.onBeforeCancel,c=t.dataIndex,u=t.type,s=t.render,v=t.rules,t=t.formItemProps,m=e.record,f=e.rowIndex,b=e.onTriggerChange,g=useContext(SearchTableContext),p=[null==(p=null==(p=null==(p=null==(p=null==g?void 0:g.editable)?void 0:p.tableEditable)?void 0:p.formList)?void 0:p.fields[f])?void 0:p.name,c],x=__spreadArray(["dataSource"],p,!0),E=_Form.useWatch(x,null==(l=null==(l=null==g?void 0:g.editable)?void 0:l.tableEditable)?void 0:l.form);function C(){var e,l;o&&null!=(l=null==(e=null==(e=null==(l=null==(l=null==(l=null==g?void 0:g.editable)?void 0:l.tableEditable)?void 0:l.form)?void 0:l.validateFields)?void 0:e.call(l))?void 0:e.then)&&l.call(e,function(e){null!=(e=o({value:E,values:e,record:m,dataIndex:c,rowIndex:f}))&&e.then(function(){return null==b?void 0:b()})}),null!=b&&b()}function _(){var e;d?null!=(e=d({value:E,record:m,dataIndex:c,rowIndex:f}))&&e.then(function(){return null==b?void 0:b()}):null!=b&&b()}return useEffect(function(){var e,l;null!=(e=null==(e=null==(e=null==g?void 0:g.editable)?void 0:e.tableEditable)?void 0:e.form)&&e.setFieldValue(x,null==(l=null==(e=null==g?void 0:g.context)?void 0:e.valueToFormItemValue)?void 0:l.call(e,{type:u,record:m,dataIndex:c}))},[null==(l=null==g?void 0:g.context)?void 0:l.getData()]),React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit")},React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit-inner")},React.createElement(_Form.Item,__assign({name:p,rules:v},null!=t?t:{}),"custom"!==u?FormItemGenerator.render({type:u,props:__assign({autoFocus:!a},e.editableConfig.props),dictName:e.editableConfig.dictName,form:null==(l=null==(l=null==g?void 0:g.editable)?void 0:l.tableEditable)?void 0:l.form,dataIndex:c,rowIndex:f}):null==s?void 0:s({value:null==m?void 0:m[c],record:m,dataIndex:c,rowIndex:f,form:null==(v=null==(p=null==g?void 0:g.editable)?void 0:p.tableEditable)?void 0:v.form}))),React.createElement(ConditionalRender,{conditional:!!n&&!a},function(){return React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit-trigger")},React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit-trigger-inner")},React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit-trigger-save"),onClick:C},!!r&&(null==r?void 0:r({value:null==m?void 0:m[c],record:m,dataIndex:c,rowIndex:f})),!r&&React.createElement(_CheckOutlined,null)),React.createElement("div",{className:"".concat(selectorPrefix,"-editable-cell-edit-trigger-cancel"),onClick:_},!!i&&(null==i?void 0:i({value:null==m?void 0:m[c],record:m,dataIndex:c,rowIndex:f})),!i&&React.createElement(_CloseOutlined,null))))}))};EditableTableCellEdit.displayName="EditableTableCellEdit";export default EditableTableCellEdit;
//# sourceMappingURL=EditableTableCellEdit.js.map
