import _Form from"antd/es/form";import"core-js/modules/es.array.iterator.js";import"core-js/modules/es.map.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/es.string.iterator.js";import"core-js/modules/esnext.map.delete-all.js";import"core-js/modules/esnext.map.every.js";import"core-js/modules/esnext.map.filter.js";import"core-js/modules/esnext.map.find.js";import"core-js/modules/esnext.map.find-key.js";import"core-js/modules/esnext.map.includes.js";import"core-js/modules/esnext.map.key-of.js";import"core-js/modules/esnext.map.map-keys.js";import"core-js/modules/esnext.map.map-values.js";import"core-js/modules/esnext.map.merge.js";import"core-js/modules/esnext.map.reduce.js";import"core-js/modules/esnext.map.some.js";import"core-js/modules/esnext.map.update.js";import"core-js/modules/web.dom-collections.iterator.js";import{__assign}from"tslib";import moment from"moment";import React,{useContext,useEffect}from"react";import{CheckOutlined,CloseOutlined}from"@ant-design/icons";import ConditionalRender from"@baifendian/adhere-ui-conditionalrender";import{selectorPrefix}from"../../../SearchTable";import{EditableContext}from"../EditableRow";import FormItemGenerator from"./FormItemGenerator";var EditableCellEdit=function(e){var t=e.editableConfig,r=t.useTrigger,o=t.useKeepEdit,n=t.renderSaveTrigger,l=t.renderCancelTrigger,i=t.onSave,a=t.onBeforeCancel,d=t.dataIndex,s=t.type,m=t.render,c=t.rules,t=t.formItemProps,u=e.record,p=e.rowIndex,f=e.onTriggerChange,v=useContext(EditableContext),x=_Form.useWatch(d,v),j=new Map([["rangePicker",function(){var e=null==u?void 0:u[d];return Array.isArray(e)&&2===e.length?[moment(e[0]),moment(e[1])]:[moment(),moment()]}],["datePicker",function(){var e=null==u?void 0:u[d];return moment(e)}],["timePicker",function(){var e=null==u?void 0:u[d];return moment(e)}]]);function g(){null!=v&&v.validateFields().then(function(e){i?null!=(e=i({value:x,values:e,record:u,dataIndex:d,rowIndex:p}))&&e.then(function(){return null==f?void 0:f()}):null!=f&&f()})}function C(){var e;a?null!=(e=a({value:x,record:u,dataIndex:d,rowIndex:p}))&&e.then(function(){return null==f?void 0:f()}):null!=f&&f()}return useEffect(function(){var e;null!=v&&v.setFieldValue(d,(e=j.get(s))?null==e?void 0:e():null==u?void 0:u[d])},[null==u?void 0:u[d]]),React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit")},React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit-inner")},React.createElement(_Form.Item,__assign({name:d,rules:c},t||{}),"custom"!==s?(c=FormItemGenerator.render({type:s,props:__assign({autoFocus:!o},e.editableConfig.props),dictName:e.editableConfig.dictName,renderChildren:e.editableConfig.renderChildren,form:v,dataIndex:d,rowIndex:p}),m?m({value:null==u?void 0:u[d],record:u,dataIndex:d,rowIndex:p,form:v,children:c}):c):null==m?void 0:m({value:null==u?void 0:u[d],record:u,dataIndex:d,rowIndex:p,form:v}))),React.createElement(ConditionalRender,{conditional:!!r&&!o},function(){return React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit-trigger")},React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit-trigger-inner")},React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit-trigger-save"),onClick:g},!!n&&(null==n?void 0:n({value:null==u?void 0:u[d],record:u,dataIndex:d,rowIndex:p})),!n&&React.createElement(CheckOutlined,null)),React.createElement("div",{className:"".concat(selectorPrefix,"-editablecell-edit-trigger-cancel"),onClick:C},!!l&&(null==l?void 0:l({value:null==u?void 0:u[d],record:u,dataIndex:d,rowIndex:p})),!l&&React.createElement(CloseOutlined,null))))}))};export default EditableCellEdit;
//# sourceMappingURL=index.js.map
