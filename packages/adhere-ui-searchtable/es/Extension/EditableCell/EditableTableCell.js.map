{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["import { __assign } from \"tslib\";\nimport React, { useContext, useEffect, useMemo, useState } from 'react';\nimport { SearchTableContext } from '../../SearchTable';\nimport EditableTableCellEdit from './Edit/EditableTableCellEdit';\nimport EditableCellView from './View';\n/**\n * EditableTableCell\n * @description 单元格编辑\n */\n\nvar EditableTableCell = function EditableTableCell(props) {\n  var _a;\n\n  var column = props.column;\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n\n  var editableConfig = useMemo(function () {\n    return __assign(__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n\n  var _b = useState(editableConfig.defaultStatus),\n      status = _b[0],\n      setStatus = _b[1];\n\n  var context = useContext(SearchTableContext);\n  /**\n   * 数据改变则切换成查看状态\n   */\n\n  useEffect(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [(_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n\n  useEffect(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]);\n  return function (tdREL) {\n    var res = tdREL; // 单元格不是可编辑的单元格\n\n    if (!editableConfig.editable) {\n      res = tdREL;\n    } // 始终保持编辑状态\n    else if (editableConfig.useKeepEdit) {\n      res = /*#__PURE__*/React.cloneElement(tdREL, tdREL.props, [/*#__PURE__*/React.createElement(EditableTableCellEdit, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('view');\n        }\n      }))]);\n    } // 查看状态\n    else if (status === 'view') {\n      res = /*#__PURE__*/React.cloneElement(tdREL, tdREL.props, [/*#__PURE__*/React.createElement(EditableCellView, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('edit');\n        }\n      }))]);\n    } // 编辑状态\n    else if (status === 'edit') {\n      res = /*#__PURE__*/React.cloneElement(tdREL, tdREL.props, [/*#__PURE__*/React.createElement(EditableTableCellEdit, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('view');\n        }\n      }))]);\n    }\n\n    return res;\n  };\n};\n\nexport default EditableTableCell;"],"names":["__assign","React","useContext","useEffect","useMemo","useState","SearchTableContext","EditableTableCellEdit","EditableCellView","EditableTableCell","props","column","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","require","dataIndex","useKeepEdit","editableConfig","$editable","_b","status","setStatus","context","_a","getData","tdREL","res","cloneElement","createElement","onTriggerChange"],"mappings":"OAASA,QAAuB,KAAP,eAClBC,OAASC,WAAYC,UAAWC,QAASC,QAAuB,KAAP,eACvDC,kBAA6C,KAAnB,2BAC5BC,0BAA2B,sCAC3BC,qBAAsB,SAM7B,IAAIC,kBAAoB,SAA2BC,GACjD,IAEIC,EAASD,EAAMC,OAMfC,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNL,MAAO,GACPM,cAAe,GACfC,WAAY,CAAA,EACZC,QAAS,CAAA,EACTC,UAAWR,MAAAA,EAAuC,KAAA,EAASA,EAAOQ,UAClEC,YAAa,CAAA,CACf,EAMIC,EAAiBjB,QAAQ,WAC3B,OAAOJ,SAASA,SAAS,GAAIY,CAAa,GAAID,MAAAA,EAAuC,KAAA,EAASA,EAAOW,YAAc,EAAE,CACvH,EAAG,CAACX,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOQ,UAAU,EAMzEI,EAAKlB,SAASgB,EAAeP,aAAa,EAC1CU,EAASD,EAAG,GACZE,EAAYF,EAAG,GAEfG,EAAUxB,WAAWI,kBAAkB,EAe3C,OAVAH,UAAU,WACRsB,EAAUJ,MAAAA,EAAuD,KAAA,EAASA,EAAeP,aAAa,CACxG,EAAG,CAAC,OAACa,EAAKD,MAAAA,EAAyC,KAAA,EAASA,EAAQA,SAAqC,KAAA,EAASC,EAAGC,QAAQ,EAAE,EAK/HzB,UAAU,WACRsB,EAAUJ,MAAAA,EAAuD,KAAA,EAASA,EAAeP,aAAa,CACxG,EAAG,CAACO,MAAAA,EAAuD,KAAA,EAASA,EAAeP,cAAc,EAC1F,SAAUe,GACf,IAAIC,EAAMD,EA8BV,OA5BKR,EAAeR,SAGXQ,EAAeD,YACtBU,EAAmB7B,MAAM8B,aAAaF,EAAOA,EAAMnB,MAAO,CAAcT,MAAM+B,cAAczB,sBAAuBP,SAAS,GAAIU,EAAO,CACrIW,eAAgBA,EAChBY,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAEc,SAAXD,EACPM,EAAmB7B,MAAM8B,aAAaF,EAAOA,EAAMnB,MAAO,CAAcT,MAAM+B,cAAcxB,iBAAkBR,SAAS,GAAIU,EAAO,CAChIW,eAAgBA,EAChBY,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAEc,SAAXD,IACPM,EAAmB7B,MAAM8B,aAAaF,EAAOA,EAAMnB,MAAO,CAAcT,MAAM+B,cAAczB,sBAAuBP,SAAS,GAAIU,EAAO,CACrIW,eAAgBA,EAChBY,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,GAxBJK,EAAMD,EA2BDC,CACT,CACF,iBAEerB"}