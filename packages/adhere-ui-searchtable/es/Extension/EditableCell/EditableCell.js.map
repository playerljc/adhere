{"version":3,"file":"EditableCell.js","sources":["Extension/EditableCell/EditableCell.js"],"sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport React, { useEffect, useMemo, useState } from 'react';\nimport EditableCellEdit from './Edit';\nimport EditableCellView from './View';\n/**\n * EditableCell\n * @description 单元格编辑\n */\n\nvar EditableCell = function EditableCell(props) {\n  var record = props.record,\n      column = props.column,\n      rowIndex = props.rowIndex,\n      columns = props.columns,\n      $context = props.$context,\n      restProps = __rest(props, [\"record\", \"column\", \"rowIndex\", \"columns\", \"$context\"]);\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n\n\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n\n  var editableConfig = useMemo(function () {\n    return __assign(__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n\n  var _a = useState(editableConfig.defaultStatus),\n      status = _a[0],\n      setStatus = _a[1];\n  /**\n   * 数据改变则切换成查看状态\n   */\n\n\n  useEffect(function () {\n    return setStatus('view');\n  }, [$context === null || $context === void 0 ? void 0 : $context.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n\n  useEffect(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]); // 单元格不是可编辑的单元格\n\n  if (!editableConfig.editable) {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n  } // 始终保持编辑状态\n\n\n  if (editableConfig.useKeepEdit) {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellEdit, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // 查看状态\n\n\n  if (status === 'view') {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellView, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('edit');\n      }\n    })));\n  } // 编辑状态\n\n\n  if (status === 'edit') {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellEdit, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // default\n\n\n  return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n};\n\nexport default EditableCell;"],"names":["__assign","__rest","React","useEffect","useMemo","useState","EditableCellEdit","EditableCellView","EditableCell","props","record","column","$context","rowIndex","columns","restProps","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","require","dataIndex","useKeepEdit","editableConfig","$editable","_a","status","setStatus","getData","createElement","onTriggerChange","children"],"mappings":"OAASA,SAAUC,MAAqB,KAAP,eAC1BC,OAASC,UAAWC,QAASC,QAAuB,KAAP,eAC7CC,qBAAsB,gBACtBC,qBAAsB,SAM7B,IAAIC,aAAe,SAAsBC,GAC1BA,EAAMC,OAAnB,IACIC,EAASF,EAAME,OAGfC,GAFWH,EAAMI,SACPJ,EAAMK,QACLL,EAAMG,UACjBG,EAAYd,OAAOQ,EAAO,CAAC,SAAU,SAAU,WAAY,UAAW,WAAW,EAOjFO,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNV,MAAO,GACPW,cAAe,GACfC,WAAY,CAAA,EACZC,QAAS,CAAA,EACTC,UAAWZ,MAAAA,EAAuC,KAAA,EAASA,EAAOY,UAClEC,YAAa,CAAA,CACf,EAMIC,EAAiBrB,QAAQ,WAC3B,OAAOJ,SAASA,SAAS,GAAIgB,CAAa,GAAIL,MAAAA,EAAuC,KAAA,EAASA,EAAOe,YAAc,EAAE,CACvH,EAAG,CAACf,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOY,UAAU,EAMzEI,EAAKtB,SAASoB,EAAeP,aAAa,EAC1CU,EAASD,EAAG,GACZE,EAAYF,EAAG,GAiBnB,OAXAxB,UAAU,WACR,OAAO0B,EAAU,MAAM,CACzB,EAAG,CAACjB,MAAAA,EAA2C,KAAA,EAASA,EAASkB,QAAQ,EAAE,EAK3E3B,UAAU,WACR0B,EAAUJ,MAAAA,EAAuD,KAAA,EAASA,EAAeP,aAAa,CACxG,EAAG,CAACO,MAAAA,EAAuD,KAAA,EAASA,EAAeP,cAAc,EAE5FO,EAAeR,SAKhBQ,EAAeD,YACGtB,MAAM6B,cAAc,KAAM/B,SAAS,GAAIe,GAAa,EAAE,EAAgBb,MAAM6B,cAAczB,iBAAkBN,SAAS,GAAIS,EAAO,CAClJgB,eAAgBA,EAChBO,gBAAiB,WACf,OAAOH,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACkB1B,MAAM6B,cAAc,KAAM/B,SAAS,GAAIe,GAAa,EAAE,EAAgBb,MAAM6B,cAAcxB,iBAAkBP,SAAS,GAAIS,EAAO,CAClJgB,eAAgBA,EAChBO,gBAAiB,WACf,OAAOH,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACkB1B,MAAM6B,cAAc,KAAM/B,SAAS,GAAIe,GAAa,EAAE,EAAgBb,MAAM6B,cAAczB,iBAAkBN,SAAS,GAAIS,EAAO,CAClJgB,eAAgBA,EAChBO,gBAAiB,WACf,OAAOH,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIe3B,MAAM6B,cAAc,KAAM/B,SAAS,GAAIe,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAUkB,QAAQ,EAlC/H/B,MAAM6B,cAAc,KAAM/B,SAAS,GAAIe,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAUkB,QAAQ,CAmCzJ,iBAEezB"}