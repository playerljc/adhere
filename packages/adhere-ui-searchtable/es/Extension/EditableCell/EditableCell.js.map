{"version":3,"file":"EditableCell.js","sources":["Extension/EditableCell/EditableCell.js"],"sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport React, { useContext, useEffect, useMemo, useState } from 'react';\nimport { SearchTableContext } from '../../SearchTable';\nimport EditableCellEdit from './Edit/EditableCellEdit';\nimport EditableCellView from './View';\n/**\n * EditableCell\n * @description 单元格编辑\n */\n\nvar EditableCell = function EditableCell(props) {\n  var _a;\n\n  var record = props.record,\n      column = props.column,\n      rowIndex = props.rowIndex,\n      columns = props.columns,\n      restProps = __rest(props, [\"record\", \"column\", \"rowIndex\", \"columns\"]);\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n\n\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n\n  var editableConfig = useMemo(function () {\n    return __assign(__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n\n  var _b = useState(editableConfig.defaultStatus),\n      status = _b[0],\n      setStatus = _b[1];\n\n  var context = useContext(SearchTableContext);\n  /**\n   * 数据改变则切换成查看状态\n   */\n\n  useEffect(function () {\n    return setStatus('view');\n  }, [(_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n\n  useEffect(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]); // 单元格不是可编辑的单元格\n\n  if (!editableConfig.editable) {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n  } // 始终保持编辑状态\n\n\n  if (editableConfig.useKeepEdit) {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellEdit, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // 查看状态\n\n\n  if (status === 'view') {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellView, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('edit');\n      }\n    })));\n  } // 编辑状态\n\n\n  if (status === 'edit') {\n    return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), /*#__PURE__*/React.createElement(EditableCellEdit, __assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // default\n\n\n  return /*#__PURE__*/React.createElement(\"td\", __assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n};\n\nexport default EditableCell;"],"names":["__assign","__rest","React","useContext","useEffect","useMemo","useState","SearchTableContext","EditableCellEdit","EditableCellView","EditableCell","props","record","column","restProps","rowIndex","columns","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","require","dataIndex","useKeepEdit","editableConfig","$editable","_b","status","setStatus","context","_a","getData","createElement","onTriggerChange","children"],"mappings":"OAASA,SAAUC,MAAqB,KAAP,eAC1BC,OAASC,WAAYC,UAAWC,QAASC,QAAuB,KAAP,eACvDC,kBAA6C,KAAnB,2BAC5BC,qBAAsB,iCACtBC,qBAAsB,SAM7B,IAAIC,aAAe,SAAsBC,GAG1BA,EAAMC,OAFnB,IAGIC,EAASF,EAAME,OAGfC,GAFWH,EAAMI,SACPJ,EAAMK,QACJf,OAAOU,EAAO,CAAC,SAAU,SAAU,WAAY,UAAU,GAOrEM,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNT,MAAO,GACPU,cAAe,GACfC,WAAY,CAAA,EACZC,QAAS,CAAA,EACTC,UAAWX,MAAAA,EAAuC,KAAA,EAASA,EAAOW,UAClEC,YAAa,CAAA,CACf,EAMIC,EAAiBrB,QAAQ,WAC3B,OAAOL,SAASA,SAAS,GAAIiB,CAAa,GAAIJ,MAAAA,EAAuC,KAAA,EAASA,EAAOc,YAAc,EAAE,CACvH,EAAG,CAACd,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOW,UAAU,EAMzEI,EAAKtB,SAASoB,EAAeP,aAAa,EAC1CU,EAASD,EAAG,GACZE,EAAYF,EAAG,GAEfG,EAAU5B,WAAWI,kBAAkB,EAgB3C,OAXAH,UAAU,WACR,OAAO0B,EAAU,MAAM,CACzB,EAAG,CAAC,OAACE,EAAKD,MAAAA,EAAyC,KAAA,EAASA,EAAQA,SAAqC,KAAA,EAASC,EAAGC,QAAQ,EAAE,EAK/H7B,UAAU,WACR0B,EAAUJ,MAAAA,EAAuD,KAAA,EAASA,EAAeP,aAAa,CACxG,EAAG,CAACO,MAAAA,EAAuD,KAAA,EAASA,EAAeP,cAAc,EAE5FO,EAAeR,SAKhBQ,EAAeD,YACGvB,MAAMgC,cAAc,KAAMlC,SAAS,GAAIc,GAAa,EAAE,EAAgBZ,MAAMgC,cAAc1B,iBAAkBR,SAAS,GAAIW,EAAO,CAClJe,eAAgBA,EAChBS,gBAAiB,WACf,OAAOL,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACkB3B,MAAMgC,cAAc,KAAMlC,SAAS,GAAIc,GAAa,EAAE,EAAgBZ,MAAMgC,cAAczB,iBAAkBT,SAAS,GAAIW,EAAO,CAClJe,eAAgBA,EAChBS,gBAAiB,WACf,OAAOL,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACkB3B,MAAMgC,cAAc,KAAMlC,SAAS,GAAIc,GAAa,EAAE,EAAgBZ,MAAMgC,cAAc1B,iBAAkBR,SAAS,GAAIW,EAAO,CAClJe,eAAgBA,EAChBS,gBAAiB,WACf,OAAOL,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIe5B,MAAMgC,cAAc,KAAMlC,SAAS,GAAIc,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAUsB,QAAQ,EAlC/HlC,MAAMgC,cAAc,KAAMlC,SAAS,GAAIc,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAUsB,QAAQ,CAmCzJ,iBAEe1B"}