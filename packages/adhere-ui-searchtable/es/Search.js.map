{"version":3,"file":"Search.js","sources":["Search.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport FlexLayout from '@baifendian/adhere-ui-flexlayout';\r\nimport Suspense from '@baifendian/adhere-ui-suspense';\r\nimport Intl from '@baifendian/adhere-util-intl';\r\nimport { selectorPrefix } from './SearchTable';\r\nvar Fixed = FlexLayout.Fixed, Auto = FlexLayout.Auto;\r\n/**\r\n * Search\r\n * @class\r\n * @classdesc 查询\r\n */\r\nvar Search = /** @class */ (function (_super) {\r\n    __extends(Search, _super);\r\n    function Search() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    /**\r\n     * getDerivedStateFromProps\r\n     * @description getDerivedStateFromProps\r\n     * @param {SearchProps} props\r\n     * @param {SearchState} state\r\n     * @return {any}\r\n     */\r\n    Search.getDerivedStateFromProps = function (props, state) {\r\n        return __assign(__assign({}, (state || {})), { \r\n            // TODO: 处理prePage\r\n            prePage: state === null || state === void 0 ? void 0 : state.page });\r\n    };\r\n    /**\r\n     * getPagination\r\n     * @description 获取分页信息\r\n     * @return {TablePaginationConfig}\r\n     */\r\n    Search.prototype.getPagination = function () {\r\n        var _this = this;\r\n        return {\r\n            onChange: function (page, limit) {\r\n                _this.setState({\r\n                    page: page,\r\n                    limit: limit,\r\n                }, function () {\r\n                    _this.fetchData();\r\n                });\r\n            },\r\n            onShowSizeChange: function (page, limit) {\r\n                _this.setState({\r\n                    page: page,\r\n                    limit: limit,\r\n                }, function () {\r\n                    _this.fetchData();\r\n                });\r\n            },\r\n            showTotal: function (total /* [page, pageSize] */) {\r\n                return Intl.v(\"\\u5F53\\u524D {page}-{pageSize}/\\u5171 {total}\\u6761\", {\r\n                    page: _this.state.page,\r\n                    pageSize: _this.state.limit,\r\n                    total: total,\r\n                });\r\n            },\r\n            total: this.getTotal(),\r\n            current: this.state.page,\r\n            pageSize: this.state.limit,\r\n            showQuickJumper: true,\r\n        };\r\n    };\r\n    /**\r\n     * getLimit\r\n     * @description limit参数\r\n     * @return {number}\r\n     */\r\n    Search.prototype.getLimit = function () {\r\n        return 10;\r\n    };\r\n    /**\r\n     * onClear\r\n     * @description - 清除操作\r\n     * @return {Promise<void>}\r\n     */\r\n    Search.prototype.onClear = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.setState({\r\n                page: 1,\r\n                limit: _this.getLimit(),\r\n            }, function () {\r\n                _this.clear().then(function () {\r\n                    _this.fetchData();\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * renderInner\r\n     * @description\r\n     * @param {any} bodyWrapRef\r\n     * @param {string} className\r\n     * @return {ReactElement | null}\r\n     */\r\n    Search.prototype.renderInner = function (bodyWrapRef, className) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        var _l = this.props, style = _l.style, bodyClassName = _l.bodyClassName, bodyStyle = _l.bodyStyle, searchClassName = _l.searchClassName, searchStyle = _l.searchStyle, fitSearch = _l.fitSearch, fitBody = _l.fitBody, autoFixed = _l.autoFixed;\r\n        var _m = this.state.expand, expand = _m === void 0 ? false : _m;\r\n        return (React.createElement(FlexLayout, { direction: \"vertical\", className: classNames(selectorPrefix, className || ''), style: __assign({}, (style || {})) },\r\n            React.createElement(Fixed, { className: classNames(\"\".concat(selectorPrefix, \"-searchwrapper\"), searchClassName || ''), style: __assign({}, (searchStyle || {})), fit: fitSearch },\r\n                React.createElement(FlexLayout, { direction: \"vertical\" },\r\n                    !!this.renderSearchFormBefore && !!((_a = this.renderSearchFormBefore) === null || _a === void 0 ? void 0 : _a.call(this)) && (React.createElement(Fixed, null, (_b = this.renderSearchFormBefore) === null || _b === void 0 ? void 0 : _b.call(this))),\r\n                    !!this.renderSearchForm && !!((_c = this.renderSearchForm) === null || _c === void 0 ? void 0 : _c.call(this)) && (React.createElement(Fixed, null, expand && this.renderSearchForm())),\r\n                    !!this.renderSearchToolBar && !!((_d = this.renderSearchToolBar) === null || _d === void 0 ? void 0 : _d.call(this)) && (React.createElement(Fixed, null, this.renderSearchToolBar())),\r\n                    !!this.renderSearchFormAfter && !!((_e = this.renderSearchFormAfter) === null || _e === void 0 ? void 0 : _e.call(this)) && (React.createElement(Fixed, null, (_f = this.renderSearchFormAfter) === null || _f === void 0 ? void 0 : _f.call(this))))),\r\n            !!this.renderSearchHeader && !!((_g = this.renderSearchHeader) === null || _g === void 0 ? void 0 : _g.call(this)) && (React.createElement(Fixed, null, (_h = this.renderSearchHeader) === null || _h === void 0 ? void 0 : _h.call(this))),\r\n            React.createElement(Auto, { className: classNames(\"\".concat(selectorPrefix, \"-autowrapper\"), bodyClassName || '', autoFixed ? 'autofixed' : ''), style: __assign({}, (bodyStyle || {})), fit: fitBody, autoFixed: autoFixed },\r\n                React.createElement(\"div\", { ref: bodyWrapRef, className: \"\".concat(selectorPrefix, \"-tablewrapper\") }, this.renderBody())),\r\n            !!this.renderSearchFooter && !!((_j = this.renderSearchFooter) === null || _j === void 0 ? void 0 : _j.call(this)) && (React.createElement(Fixed, null, (_k = this.renderSearchFooter) === null || _k === void 0 ? void 0 : _k.call(this)))));\r\n    };\r\n    return Search;\r\n}(Suspense));\r\nexport var defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    searchClassName: '',\r\n    searchStyle: {},\r\n    // 第一次\r\n    isFirst: true,\r\n    // 第一次加载\r\n    isFirstLoading: null,\r\n    isShowExpandSearch: true,\r\n    defaultExpandSearchCollapse: true,\r\n    fitSearch: true,\r\n    fitBody: true,\r\n    autoFixed: true,\r\n};\r\nexport var propTypes = {\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    searchClassName: PropTypes.string,\r\n    searchStyle: PropTypes.object,\r\n    reset: PropTypes.bool,\r\n    firstLoading: PropTypes.node,\r\n    // 是否有展开和收缩的功能\r\n    isShowExpandSearch: PropTypes.bool,\r\n    // 展开和收缩的默认状态\r\n    defaultExpandSearchCollapse: PropTypes.bool,\r\n    // 撑开search\r\n    fitSearch: PropTypes.bool,\r\n    // 撑开表格\r\n    fitBody: PropTypes.bool,\r\n    // 是否是查询固定，表格自适应\r\n    autoFixed: PropTypes.bool,\r\n};\r\nSearch.defaultProps = defaultProps;\r\nSearch.propTypes = propTypes;\r\nexport default Search;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","classNames","PropTypes","React","FlexLayout","Suspense","Intl","selectorPrefix","Fixed","Auto","Search","_super","getDerivedStateFromProps","props","state","prePage","page","getPagination","_this","onChange","limit","setState","fetchData","onShowSizeChange","showTotal","total","v","pageSize","getTotal","current","showQuickJumper","getLimit","onClear","Promise","resolve","clear","then","renderInner","bodyWrapRef","className","_l","style","bodyClassName","bodyStyle","searchClassName","searchStyle","fitSearch","fitBody","autoFixed","_m","expand","createElement","direction","concat","fit","renderSearchFormBefore","_a","_b","renderSearchForm","_c","renderSearchToolBar","_d","renderSearchFormAfter","_e","_f","renderSearchHeader","_g","_h","ref","renderBody","renderSearchFooter","_j","_k","defaultProps","isFirst","isFirstLoading","isShowExpandSearch","defaultExpandSearchCollapse","propTypes","string","object","reset","bool","firstLoading","node"],"mappings":"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"}