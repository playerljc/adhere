{"version":3,"file":"Search.js","sources":["Search.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport FlexLayout from '@baifendian/adhere-ui-flexlayout';\r\nimport Suspense from '@baifendian/adhere-ui-suspense';\r\nimport Intl from '@baifendian/adhere-util-intl';\r\nimport { selectorPrefix } from './SearchTable';\r\nvar Fixed = FlexLayout.Fixed, Auto = FlexLayout.Auto;\r\n/**\r\n * Search\r\n * @class\r\n * @classdesc 查询\r\n */\r\nvar Search = /** @class */ (function (_super) {\r\n    __extends(Search, _super);\r\n    function Search() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    /**\r\n     * getDerivedStateFromProps\r\n     * @description getDerivedStateFromProps\r\n     * @param {SearchProps} props\r\n     * @param {SearchState} state\r\n     * @return {any}\r\n     */\r\n    Search.getDerivedStateFromProps = function (props, state) {\r\n        return __assign(__assign({}, (state || {})), { \r\n            // TODO: 处理prePage\r\n            prePage: state === null || state === void 0 ? void 0 : state.page });\r\n    };\r\n    /**\r\n     * getPagination\r\n     * @description 获取分页信息\r\n     * @return {TablePaginationConfig}\r\n     */\r\n    Search.prototype.getPagination = function () {\r\n        var _this = this;\r\n        return {\r\n            onChange: function (page, limit) {\r\n                _this.setState({\r\n                    page: page,\r\n                    limit: limit,\r\n                }, function () {\r\n                    _this.fetchData();\r\n                });\r\n            },\r\n            onShowSizeChange: function (page, limit) {\r\n                _this.setState({\r\n                    page: page,\r\n                    limit: limit,\r\n                }, function () {\r\n                    _this.fetchData();\r\n                });\r\n            },\r\n            showTotal: function (total /* [page, pageSize] */) {\r\n                return Intl.v(\"\\u5F53\\u524D {page}-{pageSize}/\\u5171 {total}\\u6761\", {\r\n                    page: _this.state.page,\r\n                    pageSize: _this.state.limit,\r\n                    total: total,\r\n                });\r\n            },\r\n            total: this.getTotal(),\r\n            current: this.state.page,\r\n            pageSize: this.state.limit,\r\n            showQuickJumper: true,\r\n        };\r\n    };\r\n    /**\r\n     * getLimit\r\n     * @description limit参数\r\n     * @return {number}\r\n     */\r\n    Search.prototype.getLimit = function () {\r\n        return 10;\r\n    };\r\n    /**\r\n     * onClear\r\n     * @description - 清除操作\r\n     * @return {Promise<void>}\r\n     */\r\n    Search.prototype.onClear = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.setState({\r\n                page: 1,\r\n                limit: _this.getLimit(),\r\n            }, function () {\r\n                _this.clear().then(function () {\r\n                    _this.fetchData();\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * renderInner\r\n     * @description\r\n     * @param {any} bodyWrapRef\r\n     * @param {string} className\r\n     * @return {ReactElement | null}\r\n     */\r\n    Search.prototype.renderInner = function (bodyWrapRef, className) {\r\n        var _a, _b, _c;\r\n        var _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s;\r\n        var _t = this.props, style = _t.style, bodyClassName = _t.bodyClassName, bodyStyle = _t.bodyStyle, searchClassName = _t.searchClassName, searchStyle = _t.searchStyle, \r\n        // fitSearch,\r\n        fitBody = _t.fitBody, autoFixed = _t.autoFixed;\r\n        var _u = this.state.expand, expand = _u === void 0 ? false : _u;\r\n        return (React.createElement(FlexLayout, { direction: \"vertical\", className: classNames(selectorPrefix, className || ''), style: __assign({}, (style || {})) },\r\n            ((!!this.renderSearchFormBefore && !!((_d = this.renderSearchFormBefore) === null || _d === void 0 ? void 0 : _d.call(this))) ||\r\n                (!!this.renderSearchForm && !!((_e = this.renderSearchForm) === null || _e === void 0 ? void 0 : _e.call(this))) ||\r\n                (!!this.renderSearchToolBar && !!((_f = this.renderSearchToolBar) === null || _f === void 0 ? void 0 : _f.call(this))) ||\r\n                (!!this.renderSearchFormAfter && !!((_g = this.renderSearchFormAfter) === null || _g === void 0 ? void 0 : _g.call(this)))) && (React.createElement(Fixed, { className: classNames(\"\".concat(selectorPrefix, \"-searchwrapper\"), searchClassName || ''), style: __assign({}, (searchStyle || {})) },\r\n                !!this.renderSearchFormBefore && !!((_h = this.renderSearchFormBefore) === null || _h === void 0 ? void 0 : _h.call(this)) && (React.createElement(Fixed, { className: \"\".concat(selectorPrefix, \"-search-form-before\") }, (_j = this.renderSearchFormBefore) === null || _j === void 0 ? void 0 : _j.call(this))),\r\n                !!this.renderSearchForm && !!((_k = this.renderSearchForm) === null || _k === void 0 ? void 0 : _k.call(this)) && expand && (React.createElement(Fixed, { className: classNames((_a = {},\r\n                        _a[\"\".concat(selectorPrefix, \"-search-form\")] = true,\r\n                        _a[\"\".concat(selectorPrefix, \"-search-form-expand\")] = expand,\r\n                        _a)) }, this.renderSearchForm())),\r\n                !!this.renderSearchToolBar && !!((_l = this.renderSearchToolBar) === null || _l === void 0 ? void 0 : _l.call(this)) && (React.createElement(Fixed, { className: classNames((_b = {},\r\n                        _b[\"\".concat(selectorPrefix, \"-search-tool-bar\")] = true,\r\n                        _b[\"\".concat(selectorPrefix, \"-search-form-expand\")] = expand,\r\n                        _b)) }, this.renderSearchToolBar())),\r\n                !!this.renderSearchFormAfter && !!((_m = this.renderSearchFormAfter) === null || _m === void 0 ? void 0 : _m.call(this)) && (React.createElement(Fixed, { className: \"\".concat(selectorPrefix, \"-search-form-after\") }, (_o = this.renderSearchFormAfter) === null || _o === void 0 ? void 0 : _o.call(this))))),\r\n            !!this.renderSearchHeader && !!((_p = this.renderSearchHeader) === null || _p === void 0 ? void 0 : _p.call(this)) && (React.createElement(Fixed, { className: \"\".concat(selectorPrefix, \"-search-header\") }, (_q = this.renderSearchHeader) === null || _q === void 0 ? void 0 : _q.call(this))),\r\n            React.createElement(Auto, { style: __assign({}, (bodyStyle || {})), className: classNames(\"\".concat(selectorPrefix, \"-autowrapper\"), bodyClassName || '', (_c = {},\r\n                    _c['autofixed'] = autoFixed,\r\n                    _c)), fit: fitBody, autoFixed: autoFixed },\r\n                React.createElement(\"div\", { ref: bodyWrapRef, className: \"\".concat(selectorPrefix, \"-tablewrapper\") }, this.renderBody())),\r\n            !!this.renderSearchFooter && !!((_r = this.renderSearchFooter) === null || _r === void 0 ? void 0 : _r.call(this)) && (React.createElement(Fixed, { className: \"\".concat(selectorPrefix, \"-search-footer\") }, (_s = this.renderSearchFooter) === null || _s === void 0 ? void 0 : _s.call(this)))));\r\n    };\r\n    return Search;\r\n}(Suspense));\r\nexport var defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    searchClassName: '',\r\n    searchStyle: {},\r\n    // 第一次\r\n    isFirst: true,\r\n    // 第一次加载\r\n    isFirstLoading: null,\r\n    isShowExpandSearch: true,\r\n    defaultExpandSearchCollapse: true,\r\n    // fitSearch: true,\r\n    fitBody: true,\r\n    autoFixed: true,\r\n};\r\nexport var propTypes = {\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    searchClassName: PropTypes.string,\r\n    searchStyle: PropTypes.object,\r\n    reset: PropTypes.bool,\r\n    firstLoading: PropTypes.node,\r\n    // 是否有展开和收缩的功能\r\n    isShowExpandSearch: PropTypes.bool,\r\n    // 展开和收缩的默认状态\r\n    defaultExpandSearchCollapse: PropTypes.bool,\r\n    // 撑开search\r\n    // fitSearch: PropTypes.bool,\r\n    // 撑开表格\r\n    fitBody: PropTypes.bool,\r\n    // 是否是查询固定，表格自适应\r\n    autoFixed: PropTypes.bool,\r\n};\r\nSearch.defaultProps = defaultProps;\r\nSearch.propTypes = propTypes;\r\nexport default Search;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","classNames","PropTypes","React","FlexLayout","Suspense","Intl","selectorPrefix","Fixed","Auto","Search","_super","getDerivedStateFromProps","props","state","prePage","page","getPagination","_this","onChange","limit","setState","fetchData","onShowSizeChange","showTotal","total","v","pageSize","getTotal","current","showQuickJumper","getLimit","onClear","Promise","resolve","clear","then","renderInner","bodyWrapRef","className","_t","style","bodyClassName","bodyStyle","searchClassName","searchStyle","fitBody","autoFixed","_u","expand","createElement","direction","renderSearchFormBefore","_d","renderSearchForm","_e","renderSearchToolBar","_f","renderSearchFormAfter","_g","concat","_h","_j","_k","_a","_l","_b","_m","_o","renderSearchHeader","_p","_q","_c","fit","ref","renderBody","renderSearchFooter","_r","_s","defaultProps","isFirst","isFirstLoading","isShowExpandSearch","defaultExpandSearchCollapse","propTypes","string","object","reset","bool","firstLoading","node"],"mappings":"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"}