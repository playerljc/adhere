{"version":3,"file":"SearchEditableCellFactory.js","sources":["Editable/SearchEditableCellFactory.js"],"sourcesContent":["var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport dayjs from 'dayjs';\nexport default function (SuperClass) {\n  return (/** @class */function (_super) {\n      __extends(class_1, _super);\n      function class_1(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * valueToFormItemValueMap\n         * @description 值和表单控件值之间的转换，现在只涉及到时间控件\n         */\n        _this.valueToFormItemValueMap = new Map([['rangePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return Array.isArray(value) && value.length === 2 ? [dayjs(value[0]), dayjs(value[1])] : [dayjs(), dayjs()];\n        }], ['datePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return dayjs(value);\n        }], ['timePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return dayjs(value);\n        }]]);\n        _this.state = __assign(__assign({}, _this.state), {\n          activeValue: ''\n        });\n        _this.cellConfigReducers = __spreadArray(__spreadArray([], _this.cellConfigReducers, true), [_this.cellEditableReducer], false);\n        return _this;\n      }\n      /**\n       * onTableRowComponentReducers\n       * @param columns\n       */\n      class_1.prototype.onTableRowComponentReducers = function (columns) {\n        var existsEditable = columns.some(function (column) {\n          var _a;\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n        if (existsEditable) {\n          return __spreadArray(__spreadArray([], this.tableRowComponentReducers, true), ['useEditableRow'], false);\n        }\n        return this.tableRowComponentReducers;\n      };\n      /**\n       * onTableCellComponentReducers\n       * @param columns\n       */\n      class_1.prototype.onTableCellComponentReducers = function (columns) {\n        var existsEditor = columns.some(function (column) {\n          var _a;\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n        if (existsEditor) {\n          return __spreadArray(__spreadArray([], this.tableCellComponentReducers, true), ['useEditableCell'], false);\n        }\n        return this.tableCellComponentReducers;\n      };\n      class_1.prototype.onEditorRow = function (params) {\n        return {\n          editable: false\n        };\n      };\n      class_1.prototype.onEditorCell = function (params) {};\n      /**\n       * cellEditableReducer\n       * @description 可编辑单元格的onCell处理\n       * @param params\n       */\n      class_1.prototype.cellEditableReducer = function (params) {\n        var _a;\n        var rowIndex = params.rowIndex,\n          column = params.column,\n          record = params.record;\n        // 如果设置了$editable则调用onEditorCell方法对每个cell进行props注入\n        if ('$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable) && this.onEditorCell) {\n          this.onEditorCell({\n            rowIndex: rowIndex,\n            editorConfig: column.$editable,\n            record: __assign({}, record)\n          });\n          return column;\n        }\n        return column;\n      };\n      /**\n       * valueToFormItemValue\n       * @description 值和表单值的转换\n       */\n      class_1.prototype.valueToFormItemValue = function (_a) {\n        var type = _a.type,\n          record = _a.record,\n          dataIndex = _a.dataIndex;\n        var item = this.valueToFormItemValueMap.get(type);\n        return item ? item === null || item === void 0 ? void 0 : item({\n          record: record,\n          dataIndex: dataIndex\n        }) : record === null || record === void 0 ? void 0 : record[dataIndex];\n      };\n      /**\n       * setActiveValue\n       * @param activeValue\n       */\n      class_1.prototype.setActiveValue = function (activeValue) {\n        var _this = this;\n        return new Promise(function (resolve) {\n          _this.setState({\n            activeValue: activeValue\n          }, function () {\n            return resolve();\n          });\n        });\n      };\n      /**\n       * getActiveValue\n       */\n      class_1.prototype.getActiveValue = function () {\n        return this.state.activeValue;\n      };\n      return class_1;\n    }(SuperClass)\n  );\n}"],"names":["__extends","this","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","ar","l","slice","concat","dayjs","SuperClass","class_1","_super","onTableRowComponentReducers","columns","some","column","_a","$editable","editable","tableRowComponentReducers","onTableCellComponentReducers","tableCellComponentReducers","onEditorRow","params","onEditorCell","cellEditableReducer","rowIndex","record","editorConfig","valueToFormItemValue","type","dataIndex","item","valueToFormItemValueMap","get","setActiveValue","activeValue","_this","Promise","resolve","setState","getActiveValue","state","props","Map","value","isArray","cellConfigReducers"],"mappings":"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"}