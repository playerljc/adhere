"use strict";var __assign=function(){return(__assign=Object.assign||function(r){for(var e,o=1,t=arguments.length;o<t;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)},__createBinding=Object.create?function(r,e,o,t){void 0===t&&(t=o);var a=Object.getOwnPropertyDescriptor(e,o);a&&("get"in a?e.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(r,t,a)}:function(r,e,o,t){r[t=void 0===t?o:t]=e[o]},__setModuleDefault=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},__importStar=function(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var o in r)"default"!==o&&Object.prototype.hasOwnProperty.call(r,o)&&__createBinding(e,r,o);return __setModuleDefault(e,r),e},__importDefault=function(r){return r&&r.__esModule?r:{default:r}},classnames_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("classnames"))),react_1=__importStar(require("react")),react_dnd_1=require("react-dnd"),SearchTable_1=require("../../../SearchTable"),util_1=require("../../../util"),type="DraggableBodyRow",DragSortRow=function(r){var e,o=r.rowIndex,t=r.rowConfig,a=r.record,n=(0,react_1.useContext)(SearchTable_1.SearchTableContext),r={type:type,dropOverDownwardClassName:"".concat(SearchTable_1.selectorPrefix,"-row-drag-sort-drop-over-downward"),dropOverUpwardClasName:"".concat(SearchTable_1.selectorPrefix,"-row-drag-sort-drop-over-upward"),dragConfig:function(){return{type:i.type,item:{index:o,record:a},collect:function(r){return{isDragging:r.isDragging()}}}},dropConfig:function(){return{accept:i.type,collect:function(r){var e=(r.getItem()||{}).index;return e===o?{}:{isOver:r.isOver(),dropClassName:e<o?i.dropOverDownwardClassName:i.dropOverUpwardClasName}},drop:function(r){var e=null==(e=null==n?void 0:n.context)?void 0:e.getData(),o=null==(o=null==n?void 0:n.context)?void 0:o.getRowKey();(0,util_1.isSameLevel)({dataSource:e,rowKey:o,sourceId:a[o],targetId:r.record[o]})&&null!=(e=null==n?void 0:n.context)&&e.moveRow(r.record,a)}}}},i=__assign(__assign({},r),(null==t?void 0:t.$rowDragSort)||{}),l=(null!=(e=null==t?void 0:t.$rowDragSort)&&e.dropConfig?i.dropConfig=Object.assign(r.dropConfig(),t.$rowDragSort.dropConfig||{}):i.dropConfig=r.dropConfig(),null!=(e=null==t?void 0:t.$rowDragSort)&&e.dragConfig?i.dragConfig=Object.assign(r.dragConfig(),t.$rowDragSort.dragConfig||{}):i.dragConfig=r.dragConfig(),(0,react_1.useRef)(null));try{var c=(0,react_dnd_1.useDrag)(i.dragConfig)[1],d=(0,react_dnd_1.useDrop)(i.dropConfig),s=d[0].isOver,u=d[0].dropClassName;(0,d[1])(c(l))}catch(r){console.log(r)}return function(r){var e={cursor:"canDrag"in i.dragConfig&&!i.dragConfig.canDrag()?"no-drop":"move"};return react_1.default.cloneElement(r,__assign(__assign({},r.props),{ref:l,style:__assign(__assign({},e),r.props.style||{}),className:(0,classnames_1.default)(r.props.className,s?u:"")}))}};exports.default=DragSortRow;
//# sourceMappingURL=DragSortRow.js.map
