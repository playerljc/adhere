"use strict";require("core-js/modules/es.object.define-property.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),antd_1=require("antd"),react_1=tslib_1.__importStar(require("react")),icons_1=require("@ant-design/icons"),adhere_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-conditionalrender")),SearchTable_1=require("../../../SearchTable"),EditableRow_1=require("../EditableRow"),FormItemGenerator_1=tslib_1.__importDefault(require("./FormItemGenerator")),EditableCellEdit=function(e){var r=e.editableConfig,t=r.useTrigger,a=r.useKeepEdit,l=r.renderSaveTrigger,n=r.renderCancelTrigger,d=r.onSave,i=r.onBeforeCancel,o=r.dataIndex,c=r.type,u=r.render,s=r.rules,r=r.formItemProps,_=e.record,f=e.rowIndex,m=e.onTriggerChange,b=(0,react_1.useContext)(EditableRow_1.EditableContext),v=(0,react_1.useContext)(SearchTable_1.SearchTableContext),x=antd_1.Form.useWatch(o,b);function g(){null!=b&&b.validateFields().then(function(e){d?null!=(e=d({value:x,values:e,record:_,dataIndex:o,rowIndex:f}))&&e.then(function(){return null==m?void 0:m()}):null!=m&&m()})}function I(){var e;i?null!=(e=i({value:x,record:_,dataIndex:o,rowIndex:f}))&&e.then(function(){return null==m?void 0:m()}):null!=m&&m()}return(0,react_1.useEffect)(function(){var e;null!=b&&b.setFieldValue(o,null==(e=null==v?void 0:v.context)?void 0:e.valueToFormItemValue({type:c,record:_,dataIndex:o}))},[null==_?void 0:_[o]]),react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-inner")},react_1.default.createElement(antd_1.Form.Item,tslib_1.__assign({name:o,rules:s},r||{}),"custom"!==c?(s=FormItemGenerator_1.default.render({type:c,props:tslib_1.__assign({autoFocus:!a},e.editableConfig.props),dictName:e.editableConfig.dictName,renderChildren:e.editableConfig.renderChildren,form:b,dataIndex:o,rowIndex:f}),u?u({value:null==_?void 0:_[o],record:_,dataIndex:o,rowIndex:f,form:b,children:s}):s):null==u?void 0:u({value:null==_?void 0:_[o],record:_,dataIndex:o,rowIndex:f,form:b}))),react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:!!t&&!a},function(){return react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-inner")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-save"),onClick:g},!!l&&(null==l?void 0:l({value:null==_?void 0:_[o],record:_,dataIndex:o,rowIndex:f})),!l&&react_1.default.createElement(icons_1.CheckOutlined,null)),react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-cancel"),onClick:I},!!n&&(null==n?void 0:n({value:null==_?void 0:_[o],record:_,dataIndex:o,rowIndex:f})),!n&&react_1.default.createElement(icons_1.CloseOutlined,null))))}))};exports.default=EditableCellEdit;
//# sourceMappingURL=EditableCellEdit.js.map
