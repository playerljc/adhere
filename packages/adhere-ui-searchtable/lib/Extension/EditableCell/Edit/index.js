"use strict";require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/es.map.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.string.iterator.js"),require("core-js/modules/esnext.map.delete-all.js"),require("core-js/modules/esnext.map.every.js"),require("core-js/modules/esnext.map.filter.js"),require("core-js/modules/esnext.map.find.js"),require("core-js/modules/esnext.map.find-key.js"),require("core-js/modules/esnext.map.includes.js"),require("core-js/modules/esnext.map.key-of.js"),require("core-js/modules/esnext.map.map-keys.js"),require("core-js/modules/esnext.map.map-values.js"),require("core-js/modules/esnext.map.merge.js"),require("core-js/modules/esnext.map.reduce.js"),require("core-js/modules/esnext.map.some.js"),require("core-js/modules/esnext.map.update.js"),require("core-js/modules/web.dom-collections.iterator.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),antd_1=require("antd"),moment_1=tslib_1.__importDefault(require("moment")),react_1=tslib_1.__importStar(require("react")),icons_1=require("@ant-design/icons"),adhere_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-conditionalrender")),SearchTable_1=require("../../../SearchTable"),EditableRow_1=require("../EditableRow"),FormItemGenerator_1=tslib_1.__importDefault(require("./FormItemGenerator")),EditableCellEdit=function(e){var r=e.editableConfig,t=r.useTrigger,l=r.useKeepEdit,a=r.renderSaveTrigger,n=r.renderCancelTrigger,i=r.onSave,o=r.onBeforeCancel,d=r.dataIndex,s=r.type,u=r.render,c=r.rules,r=r.formItemProps,m=e.record,_=e.rowIndex,f=e.onTriggerChange,v=(0,react_1.useContext)(EditableRow_1.EditableContext),j=antd_1.Form.useWatch(d,v),x=new Map([["rangePicker",function(){var e=null==m?void 0:m[d];return Array.isArray(e)&&2===e.length?[(0,moment_1.default)(e[0]),(0,moment_1.default)(e[1])]:[(0,moment_1.default)(),(0,moment_1.default)()]}],["datePicker",function(){var e=null==m?void 0:m[d];return(0,moment_1.default)(e)}],["timePicker",function(){var e=null==m?void 0:m[d];return(0,moment_1.default)(e)}]]);function b(){null!=v&&v.validateFields().then(function(e){i?null!=(e=i({value:j,values:e,record:m,dataIndex:d,rowIndex:_}))&&e.then(function(){return null==f?void 0:f()}):null!=f&&f()})}function p(){var e;o?null!=(e=o({value:j,record:m,dataIndex:d,rowIndex:_}))&&e.then(function(){return null==f?void 0:f()}):null!=f&&f()}return(0,react_1.useEffect)(function(){var e;null!=v&&v.setFieldValue(d,(e=x.get(s))?null==e?void 0:e():null==m?void 0:m[d])},[null==m?void 0:m[d]]),react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-inner")},react_1.default.createElement(antd_1.Form.Item,tslib_1.__assign({name:d,rules:c},r||{}),"custom"!==s?(c=FormItemGenerator_1.default.render({type:s,props:tslib_1.__assign({autoFocus:!l},e.editableConfig.props),dictName:e.editableConfig.dictName,renderChildren:e.editableConfig.renderChildren,form:v,dataIndex:d,rowIndex:_}),u?u({value:null==m?void 0:m[d],record:m,dataIndex:d,rowIndex:_,form:v,children:c}):c):null==u?void 0:u({value:null==m?void 0:m[d],record:m,dataIndex:d,rowIndex:_,form:v}))),react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:!!t&&!l},function(){return react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-inner")},react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-save"),onClick:b},!!a&&(null==a?void 0:a({value:null==m?void 0:m[d],record:m,dataIndex:d,rowIndex:_})),!a&&react_1.default.createElement(icons_1.CheckOutlined,null)),react_1.default.createElement("div",{className:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-cancel"),onClick:p},!!n&&(null==n?void 0:n({value:null==m?void 0:m[d],record:m,dataIndex:d,rowIndex:_})),!n&&react_1.default.createElement(icons_1.CloseOutlined,null))))}))};exports.default=EditableCellEdit;
//# sourceMappingURL=index.js.map
