{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditorRowControl/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar classnames_1 = tslib_1.__importDefault(require(\"classnames\"));\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar adhere_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\n\nvar adhere_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-util-intl\"));\n\nvar SearchTable_1 = require(\"../../../SearchTable\");\n\nvar SearchTable_2 = require(\"../../../SearchTable\");\n\nvar EditableRow_1 = require(\"../EditableRow\");\n/**\n * EditorRowControl\n * @description 编辑行的控制器\n * @param record\n * @param renderCancel\n * @param onEditor\n * @param onSave\n * @param editorRowId\n * @param rowKey\n * @param className\n * @param styles\n * @param renderEditorRow\n * @param renderSave\n * @returns {JSX.Element}\n * @constructor\n */\n\n\nvar EditorRowControl = function EditorRowControl(_a) {\n  var className = _a.className,\n      styles = _a.styles,\n      renderEditorRow = _a.renderEditorRow,\n      renderSave = _a.renderSave,\n      renderCancel = _a.renderCancel,\n      record = _a.record,\n      rowKey = _a.rowKey,\n      editorRowId = _a.editorRowId,\n      onEditor = _a.onEditor,\n      onSave = _a.onSave;\n  var form = (0, react_1.useContext)(EditableRow_1.EditableContext);\n  var renderDefaultSave = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('保存'));\n  }, []);\n  var renderDefaultCancel = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('取消'));\n  }, []);\n  var renderDefaultEditorRow = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('编辑行'));\n  }, []);\n  var context = (0, react_1.useContext)(SearchTable_2.SearchTableContext);\n  var validateFieldsSuccess = (0, react_1.useCallback)(function (values) {\n    if (onSave) {\n      onSave(values).then(function () {\n        return updateEditorCellRowData(values);\n      });\n      return;\n    }\n\n    updateEditorCellRowData(values);\n  }, []);\n\n  var _onEditor = (0, react_1.useCallback)(function () {\n    var _a;\n\n    if (onEditor) {\n      (_a = onEditor === null || onEditor === void 0 ? void 0 : onEditor(record[rowKey])) === null || _a === void 0 ? void 0 : _a.then(function () {\n        return updateRowEdit();\n      });\n      return;\n    }\n\n    updateRowEdit();\n  }, []);\n\n  var updateEditorCellRowData = function updateEditorCellRowData(values) {\n    var _a;\n\n    return (_a = context === null || context === void 0 ? void 0 : context.updateEditorCellRowData({\n      values: values,\n      record: record\n    })) === null || _a === void 0 ? void 0 : _a.then(function () {\n      return reset();\n    });\n  };\n\n  var reset = function reset() {\n    return context === null || context === void 0 ? void 0 : context.setState({\n      editorRowId: ''\n    });\n  };\n\n  var updateRowEdit = function updateRowEdit() {\n    return context === null || context === void 0 ? void 0 : context.setState({\n      editorRowId: record[rowKey]\n    });\n  };\n\n  return react_1.default.createElement(\"div\", {\n    className: (0, classnames_1.default)(\"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control\"), className),\n    style: styles || {}\n  }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n    conditional: editorRowId !== record[rowKey],\n    noMatch: function noMatch() {\n      return react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel\")\n      }, react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n        onClick: function onClick() {\n          return form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n            return validateFieldsSuccess(values);\n          });\n        }\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderSave,\n        noMatch: function noMatch() {\n          return renderSave === null || renderSave === void 0 ? void 0 : renderSave();\n        }\n      }, function () {\n        return renderDefaultSave();\n      })), react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n        onClick: reset\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderCancel,\n        noMatch: function noMatch() {\n          return renderCancel === null || renderCancel === void 0 ? void 0 : renderCancel();\n        }\n      }, function () {\n        return renderDefaultCancel();\n      })));\n    }\n  }, function () {\n    return react_1.default.createElement(\"div\", {\n      onClick: _onEditor\n    }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !renderEditorRow,\n      noMatch: function noMatch() {\n        return renderEditorRow === null || renderEditorRow === void 0 ? void 0 : renderEditorRow();\n      }\n    }, function () {\n      return renderDefaultEditorRow();\n    }));\n  }));\n};\n\nexports.default = EditorRowControl;"],"names":["require","Object","defineProperty","exports","value","tslib_1","classnames_1","__importDefault","react_1","__importStar","adhere_ui_conditionalrender_1","adhere_util_intl_1","SearchTable_1","SearchTable_2","EditableRow_1","EditorRowControl","_a","className","styles","renderEditorRow","renderSave","renderCancel","record","rowKey","editorRowId","onEditor","onSave","form","useContext","EditableContext","renderDefaultSave","useCallback","default","createElement","v","renderDefaultCancel","renderDefaultEditorRow","context","SearchTableContext","validateFieldsSuccess","values","then","updateEditorCellRowData","_onEditor","updateRowEdit","reset","setState","concat","selectorPrefix","style","conditional","noMatch","onClick","validateFields"],"mappings":"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"}