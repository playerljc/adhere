{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditorTableControl/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar classnames_1 = tslib_1.__importDefault(require(\"classnames\"));\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar adhere_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\n\nvar adhere_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-util-intl\"));\n\nvar SearchTable_1 = require(\"../../../SearchTable\");\n\nvar SearchTable_2 = require(\"../../../SearchTable\");\n/**\n * EditorTableControl\n * @description 编辑表格的控制器\n * @param className\n * @param styles\n * @param renderEditorTable\n * @param renderSave\n * @param renderCancel\n * @param rowKey\n * @param onEditor\n * @param onSave\n */\n\n\nvar EditorTableControl = function EditorTableControl(_a) {\n  var className = _a.className,\n      styles = _a.styles,\n      renderEditorTable = _a.renderEditorTable,\n      renderSave = _a.renderSave,\n      renderCancel = _a.renderCancel,\n      onEditor = _a.onEditor,\n      onSave = _a.onSave;\n  var context = (0, react_1.useContext)(SearchTable_2.SearchTableContext);\n  var renderDefaultSave = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('保存'));\n  }, []);\n  var renderDefaultCancel = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('取消'));\n  }, []);\n  var renderDefaultEditorTable = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('编辑表格'));\n  }, []);\n  var validateFieldsSuccess = (0, react_1.useCallback)(function (values) {\n    if (onSave) {\n      onSave(values.dataSource).then(function () {\n        return updateEditorCellTableData(values.dataSource);\n      });\n      return;\n    }\n\n    updateEditorCellTableData(values.dataSource);\n  }, []);\n\n  var _onEditor = (0, react_1.useCallback)(function () {\n    var _a;\n\n    if (onEditor) {\n      (_a = onEditor === null || onEditor === void 0 ? void 0 : onEditor()) === null || _a === void 0 ? void 0 : _a.then(function () {\n        return updateTableEdit();\n      });\n      return;\n    }\n\n    updateTableEdit();\n  }, []);\n\n  var updateEditorCellTableData = function updateEditorCellTableData(changeData) {\n    var _a, _b;\n\n    return (_b = (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.updateEditorData(changeData)) === null || _b === void 0 ? void 0 : _b.then(function () {\n      return reset();\n    });\n  };\n\n  var updateTableEdit = function updateTableEdit() {\n    var _a;\n\n    return (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setState({\n      isTableEditor: true\n    });\n  };\n  /**\n   * reset\n   * @description 取消\n   */\n\n\n  var reset = function reset() {\n    var _a;\n\n    return (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setState({\n      isTableEditor: false\n    });\n  };\n\n  return react_1.default.createElement(\"div\", {\n    className: (0, classnames_1.default)(\"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control\"), className),\n    style: styles || {}\n  }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n    conditional: !(context === null || context === void 0 ? void 0 : context.context.state.isTableEditor),\n    noMatch: function noMatch() {\n      return react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel\")\n      }, react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        onClick: function onClick() {\n          var _a, _b, _c;\n\n          return (_c = (_b = (_a = context === null || context === void 0 ? void 0 : context.form) === null || _a === void 0 ? void 0 : _a.validateFields()) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function (values) {\n            return validateFieldsSuccess(values);\n          });\n        }\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderSave,\n        noMatch: function noMatch() {\n          return renderSave === null || renderSave === void 0 ? void 0 : renderSave();\n        }\n      }, function () {\n        return renderDefaultSave();\n      })), react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        onClick: reset\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderCancel,\n        noMatch: function noMatch() {\n          return renderCancel === null || renderCancel === void 0 ? void 0 : renderCancel();\n        }\n      }, function () {\n        return renderDefaultCancel();\n      })));\n    }\n  }, function () {\n    return react_1.default.createElement(\"div\", {\n      onClick: _onEditor\n    }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !renderEditorTable,\n      noMatch: function noMatch() {\n        return renderEditorTable === null || renderEditorTable === void 0 ? void 0 : renderEditorTable();\n      }\n    }, function () {\n      return renderDefaultEditorTable();\n    }));\n  }));\n};\n\nexports.default = EditorTableControl;"],"names":["require","Object","defineProperty","exports","value","tslib_1","classnames_1","__importDefault","react_1","__importStar","adhere_ui_conditionalrender_1","adhere_util_intl_1","SearchTable_1","SearchTable_2","EditorTableControl","_a","className","styles","renderEditorTable","renderSave","renderCancel","onEditor","onSave","context","useContext","SearchTableContext","renderDefaultSave","useCallback","default","createElement","v","renderDefaultCancel","renderDefaultEditorTable","validateFieldsSuccess","values","dataSource","then","updateEditorCellTableData","_onEditor","updateTableEdit","changeData","_b","updateEditorData","reset","setState","isTableEditor","concat","selectorPrefix","style","conditional","state","noMatch","onClick","_c","form","validateFields","call"],"mappings":"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"}