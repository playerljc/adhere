{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableRowControl/index.js"],"sourcesContent":["\"use strict\";\n\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar SearchTable_1 = require(\"../../../SearchTable\");\nvar EditableRow_1 = require(\"../EditableRow\");\n/**\n * EditableRowControl\n * @description 编辑行的控制器\n * @param record\n * @param renderCancel\n * @param onEditor\n * @param onSave\n * @param editorRowId\n * @param rowKey\n * @param className\n * @param styles\n * @param renderEditableRow\n * @param renderSave\n * @returns {JSX.Element}\n * @constructor\n */\nvar EditableRowControl = function EditableRowControl(_a) {\n  var className = _a.className,\n    styles = _a.styles,\n    renderEditorRow = _a.renderEditorRow,\n    renderSave = _a.renderSave,\n    renderCancel = _a.renderCancel,\n    record = _a.record,\n    rowKey = _a.rowKey,\n    editorRowId = _a.editorRowId,\n    onEditor = _a.onEditor,\n    onSave = _a.onSave;\n  var context = (0, react_1.useContext)(SearchTable_1.SearchTableContext);\n  var form = (0, react_1.useContext)(EditableRow_1.EditableContext);\n  var renderDefaultSave = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('保存'));\n  }, []);\n  var renderDefaultCancel = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('取消'));\n  }, []);\n  var renderDefaultEditorRow = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('编辑行'));\n  }, []);\n  var validateFieldsSuccess = (0, react_1.useCallback)(function (values) {\n    if (onSave) {\n      onSave(values).then(function () {\n        return updateEditorCellRowData(values);\n      });\n      return;\n    }\n    updateEditorCellRowData(values);\n  }, []);\n  var _onEditor = (0, react_1.useCallback)(function () {\n    var _a;\n    if (onEditor) {\n      (_a = onEditor === null || onEditor === void 0 ? void 0 : onEditor(record[rowKey])) === null || _a === void 0 ? void 0 : _a.then(function () {\n        return updateRowEdit();\n      });\n      return;\n    }\n    updateRowEdit();\n  }, []);\n  var updateEditorCellRowData = function updateEditorCellRowData(values) {\n    var _a, _b;\n    // @ts-ignore\n    return (_b = (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.updateEditorCellRowData({\n      values: values,\n      record: record\n    })) === null || _b === void 0 ? void 0 : _b.then(function () {\n      return reset();\n    });\n  };\n  var reset = function reset() {\n    var _a;\n    // @ts-ignore\n    return (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setState({\n      editorRowId: ''\n    });\n  };\n  var updateRowEdit = function updateRowEdit() {\n    var _a;\n    // @ts-ignore\n    return (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setState({\n      editorRowId: record[rowKey]\n    });\n  };\n  return react_1.default.createElement(\"div\", {\n    className: (0, classnames_1.default)(\"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control\"), className),\n    style: styles || {}\n  }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n    conditional: editorRowId !== record[rowKey],\n    noMatch: function noMatch() {\n      return react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel\")\n      }, react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n        onClick: function onClick() {\n          return form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n            return validateFieldsSuccess(values);\n          });\n        }\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderSave,\n        noMatch: function noMatch() {\n          return renderSave === null || renderSave === void 0 ? void 0 : renderSave();\n        }\n      }, function () {\n        return renderDefaultSave();\n      })), react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n        onClick: reset\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderCancel,\n        noMatch: function noMatch() {\n          return renderCancel === null || renderCancel === void 0 ? void 0 : renderCancel();\n        }\n      }, function () {\n        return renderDefaultCancel();\n      })));\n    }\n  }, function () {\n    return react_1.default.createElement(\"div\", {\n      className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-edit\"),\n      onClick: _onEditor\n    }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !renderEditorRow,\n      noMatch: function noMatch() {\n        return renderEditorRow === null || renderEditorRow === void 0 ? void 0 : renderEditorRow();\n      }\n    }, function () {\n      return renderDefaultEditorRow();\n    }));\n  }));\n};\nexports.default = EditableRowControl;"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__importDefault","default","classnames_1","exports","require","react_1","adhere_ui_conditionalrender_1","adhere_util_intl_1","SearchTable_1","EditableRow_1","EditableRowControl","_a","className","styles","renderEditorRow","renderSave","renderCancel","record","rowKey","editorRowId","onEditor","onSave","context","useContext","SearchTableContext","form","EditableContext","renderDefaultSave","useCallback","createElement","renderDefaultCancel","renderDefaultEditorRow","validateFieldsSuccess","values","then","updateEditorCellRowData","_onEditor","updateRowEdit","_b","reset","setState","concat","selectorPrefix","style","conditional","noMatch","onClick","validateFields"],"mappings":"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"}