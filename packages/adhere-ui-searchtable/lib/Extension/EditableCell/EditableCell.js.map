{"version":3,"file":"EditableCell.js","sources":["Extension/EditableCell/EditableCell.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar SearchTable_1 = require(\"../../SearchTable\");\n\nvar Edit_1 = tslib_1.__importDefault(require(\"./Edit\"));\n\nvar View_1 = tslib_1.__importDefault(require(\"./View\"));\n/**\n * EditableCell\n * @description 单元格编辑\n */\n\n\nvar EditableCell = function EditableCell(props) {\n  var record = props.record,\n      column = props.column,\n      rowIndex = props.rowIndex,\n      columns = props.columns,\n      restProps = tslib_1.__rest(props, [\"record\", \"column\", \"rowIndex\", \"columns\"]);\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n\n\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n\n  var editableConfig = (0, react_1.useMemo)(function () {\n    return tslib_1.__assign(tslib_1.__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n\n  var _a = (0, react_1.useState)(editableConfig.defaultStatus),\n      status = _a[0],\n      setStatus = _a[1];\n\n  var context = (0, react_1.useContext)(SearchTable_1.SearchTableContext);\n  /**\n   * 数据改变则切换成查看状态\n   */\n\n  (0, react_1.useEffect)(function () {\n    return setStatus('view');\n  }, [context === null || context === void 0 ? void 0 : context.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n\n  (0, react_1.useEffect)(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]); // 单元格不是可编辑的单元格\n\n  if (!editableConfig.editable) {\n    return react_1.default.createElement(\"td\", tslib_1.__assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n  } // 始终保持编辑状态\n\n\n  if (editableConfig.useKeepEdit) {\n    return react_1.default.createElement(\"td\", tslib_1.__assign({}, restProps || {}), react_1.default.createElement(Edit_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // 查看状态\n\n\n  if (status === 'view') {\n    return react_1.default.createElement(\"td\", tslib_1.__assign({}, restProps || {}), react_1.default.createElement(View_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('edit');\n      }\n    })));\n  } // 编辑状态\n\n\n  if (status === 'edit') {\n    return react_1.default.createElement(\"td\", tslib_1.__assign({}, restProps || {}), react_1.default.createElement(Edit_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    })));\n  } // default\n\n\n  return react_1.default.createElement(\"td\", tslib_1.__assign({}, restProps || {}), restProps === null || restProps === void 0 ? void 0 : restProps.children);\n};\n\nexports.default = EditableCell;"],"names":["require","Object","defineProperty","exports","value","tslib_1","react_1","__importStar","SearchTable_1","Edit_1","__importDefault","View_1","EditableCell","props","record","column","restProps","rowIndex","columns","__rest","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","dataIndex","useKeepEdit","editableConfig","useMemo","__assign","$editable","_a","useState","status","setStatus","context","useContext","SearchTableContext","useEffect","getData","default","createElement","onTriggerChange","children"],"mappings":"AAAA,aAEAA,QAAQ,8CAA8C,EAEtDC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EAED,IAAIC,QAAUL,QAAQ,OAAO,EAEzBM,QAAUD,QAAQE,aAAaP,QAAQ,OAAO,CAAC,EAE/CQ,cAAgBR,QAAQ,mBAAmB,EAE3CS,OAASJ,QAAQK,gBAAgBV,QAAQ,QAAQ,CAAC,EAElDW,OAASN,QAAQK,gBAAgBV,QAAQ,QAAQ,CAAC,EAOlDY,aAAe,SAAsBC,GAC1BA,EAAMC,OAAnB,IACIC,EAASF,EAAME,OAGfC,GAFWH,EAAMI,SACPJ,EAAMK,QACJb,QAAQc,OAAON,EAAO,CAAC,SAAU,SAAU,WAAY,UAAU,GAO7EO,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNV,MAAO,GACPW,cAAe,GACfC,WAAY,CAAA,EACZzB,QAAS,CAAA,EACT0B,UAAWX,MAAAA,EAAuC,KAAA,EAASA,EAAOW,UAClEC,YAAa,CAAA,CACf,EAMIC,GAAiB,EAAItB,QAAQuB,SAAS,WACxC,OAAOxB,QAAQyB,SAASzB,QAAQyB,SAAS,GAAIV,CAAa,GAAIL,MAAAA,EAAuC,KAAA,EAASA,EAAOgB,YAAc,EAAE,CACvI,EAAG,CAAChB,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOW,UAAU,EAMzEM,GAAK,EAAI1B,QAAQ2B,UAAUL,EAAeN,aAAa,EACvDY,EAASF,EAAG,GACZG,EAAYH,EAAG,GAEfI,GAAU,EAAI9B,QAAQ+B,YAAY7B,cAAc8B,kBAAkB,EAgBtE,OAXA,EAAIhC,QAAQiC,WAAW,WACrB,OAAOJ,EAAU,MAAM,CACzB,EAAG,CAACC,MAAAA,EAAyC,KAAA,EAASA,EAAQI,QAAQ,EAAE,GAKxE,EAAIlC,QAAQiC,WAAW,WACrBJ,EAAUP,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CACxG,EAAG,CAACM,MAAAA,EAAuD,KAAA,EAASA,EAAeN,cAAc,EAE5FM,EAAeP,SAKhBO,EAAeD,YACVrB,QAAQmC,QAAQC,cAAc,KAAMrC,QAAQyB,SAAS,GAAId,GAAa,EAAE,EAAGV,QAAQmC,QAAQC,cAAcjC,OAAOgC,QAASpC,QAAQyB,SAAS,GAAIjB,EAAO,CAC1Je,eAAgBA,EAChBe,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACK5B,QAAQmC,QAAQC,cAAc,KAAMrC,QAAQyB,SAAS,GAAId,GAAa,EAAE,EAAGV,QAAQmC,QAAQC,cAAc/B,OAAO8B,QAASpC,QAAQyB,SAAS,GAAIjB,EAAO,CAC1Je,eAAgBA,EAChBe,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIU,SAAXD,EACK5B,QAAQmC,QAAQC,cAAc,KAAMrC,QAAQyB,SAAS,GAAId,GAAa,EAAE,EAAGV,QAAQmC,QAAQC,cAAcjC,OAAOgC,QAASpC,QAAQyB,SAAS,GAAIjB,EAAO,CAC1Je,eAAgBA,EAChBe,gBAAiB,WACf,OAAOR,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,CAAC,EAIE7B,QAAQmC,QAAQC,cAAc,KAAMrC,QAAQyB,SAAS,GAAId,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAU4B,QAAQ,EAlCjJtC,QAAQmC,QAAQC,cAAc,KAAMrC,QAAQyB,SAAS,GAAId,GAAa,EAAE,EAAGA,MAAAA,EAA6C,KAAA,EAASA,EAAU4B,QAAQ,CAmC9J,EAEAzC,QAAQsC,QAAU7B"}