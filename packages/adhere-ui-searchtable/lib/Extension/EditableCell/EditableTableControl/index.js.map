{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableTableControl/index.js"],"sourcesContent":["\"use strict\";\n\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar SearchTable_1 = require(\"../../../SearchTable\");\n/**\n * EditableTableControl\n * @description 编辑表格的控制器\n * @param className\n * @param styles\n * @param renderEditorTable\n * @param renderSave\n * @param renderCancel\n * @param rowKey\n * @param onEditor\n * @param onSave\n */\nvar EditableTableControl = function EditableTableControl(_a) {\n  var className = _a.className,\n    styles = _a.styles,\n    renderEditorTable = _a.renderEditorTable,\n    renderSave = _a.renderSave,\n    renderCancel = _a.renderCancel,\n    onEditor = _a.onEditor,\n    onSave = _a.onSave;\n  var context = (0, react_1.useContext)(SearchTable_1.SearchTableContext);\n  var renderDefaultSave = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('保存'));\n  }, []);\n  var renderDefaultCancel = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('取消'));\n  }, []);\n  var renderDefaultEditorTable = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(\"a\", null, adhere_util_intl_1.default.v('编辑表格'));\n  }, []);\n  var validateFieldsSuccess = (0, react_1.useCallback)(function (values) {\n    if (onSave) {\n      onSave(values.dataSource).then(function () {\n        return updateEditorCellTableData(values.dataSource);\n      });\n      return;\n    }\n    updateEditorCellTableData(values.dataSource);\n  }, []);\n  var _onEditor = (0, react_1.useCallback)(function () {\n    var _a;\n    if (onEditor) {\n      (_a = onEditor === null || onEditor === void 0 ? void 0 : onEditor()) === null || _a === void 0 ? void 0 : _a.then(function () {\n        return updateTableEdit();\n      });\n      return;\n    }\n    updateTableEdit();\n  }, []);\n  var updateEditorCellTableData = function updateEditorCellTableData(changeData) {\n    var _a, _b;\n    // @ts-ignore\n    return (_b = (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.updateEditorData(changeData)) === null || _b === void 0 ? void 0 : _b.then(function () {\n      return reset();\n    });\n  };\n  var updateTableEdit = function updateTableEdit() {\n    var _a, _b, _c, _d;\n    // @ts-ignore\n    (_b = (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setFieldValues) === null || _b === void 0 ? void 0 : _b.call(_a, (_c = context === null || context === void 0 ? void 0 : context.context) === null || _c === void 0 ? void 0 : _c.getData());\n    // @ts-ignore\n    (_d = context === null || context === void 0 ? void 0 : context.context) === null || _d === void 0 ? void 0 : _d.setState({\n      isTableEditor: true\n    });\n  };\n  /**\n   * reset\n   * @description 取消\n   */\n  var reset = function reset() {\n    var _a;\n    // @ts-ignore\n    return (_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.setState({\n      isTableEditor: false\n    });\n  };\n  return react_1.default.createElement(\"div\", {\n    className: (0, classnames_1.default)(\"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control\"), className),\n    style: styles || {}\n  }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n    conditional: !(context === null || context === void 0 ? void 0 : context.context.state.isTableEditor),\n    noMatch: function noMatch() {\n      return react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel\")\n      }, react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        onClick: function onClick() {\n          var _a, _b, _c, _d, _e;\n          return (_e = (_d = (_c = (_b = (_a = context === null || context === void 0 ? void 0 : context.editable) === null || _a === void 0 ? void 0 : _a.tableEditable) === null || _b === void 0 ? void 0 : _b.form) === null || _c === void 0 ? void 0 : _c.validateFields()) === null || _d === void 0 ? void 0 : _d.then) === null || _e === void 0 ? void 0 : _e.call(_d, function (values) {\n            return validateFieldsSuccess(values);\n          });\n        }\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderSave,\n        noMatch: function noMatch() {\n          return renderSave === null || renderSave === void 0 ? void 0 : renderSave();\n        }\n      }, function () {\n        return renderDefaultSave();\n      })), react_1.default.createElement(\"div\", {\n        className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        onClick: reset\n      }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n        conditional: !renderCancel,\n        noMatch: function noMatch() {\n          return renderCancel === null || renderCancel === void 0 ? void 0 : renderCancel();\n        }\n      }, function () {\n        return renderDefaultCancel();\n      })));\n    }\n  }, function () {\n    return react_1.default.createElement(\"div\", {\n      className: \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-edit\"),\n      onClick: _onEditor\n    }, react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !renderEditorTable,\n      noMatch: function noMatch() {\n        return renderEditorTable === null || renderEditorTable === void 0 ? void 0 : renderEditorTable();\n      }\n    }, function () {\n      return renderDefaultEditorTable();\n    }));\n  }));\n};\nexports.default = EditableTableControl;"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__importDefault","default","classnames_1","exports","require","react_1","adhere_ui_conditionalrender_1","adhere_util_intl_1","SearchTable_1","EditableTableControl","_a","className","styles","renderEditorTable","renderSave","renderCancel","onEditor","onSave","context","useContext","SearchTableContext","renderDefaultSave","useCallback","createElement","renderDefaultCancel","renderDefaultEditorTable","validateFieldsSuccess","values","dataSource","then","updateEditorCellTableData","_onEditor","updateTableEdit","changeData","_b","updateEditorData","reset","_c","_d","setFieldValues","getData","setState","isTableEditor","concat","selectorPrefix","style","conditional","state","noMatch","onClick","_e","editable","tableEditable","form","validateFields"],"mappings":"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"}