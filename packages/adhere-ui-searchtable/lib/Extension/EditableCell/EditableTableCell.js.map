{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar react_1 = tslib_1.__importStar(require(\"react\"));\r\nvar SearchTable_1 = require(\"../../SearchTable\");\r\nvar EditableTableCellEdit_1 = tslib_1.__importDefault(require(\"./Edit/EditableTableCellEdit\"));\r\nvar View_1 = tslib_1.__importDefault(require(\"./View\"));\r\n/**\r\n * EditableTableCell\r\n * @description 单元格编辑\r\n */\r\nvar EditableTableCell = function (props) {\r\n    var _a;\r\n    var column = props.column;\r\n    /**\r\n     * defaultConfig\r\n     * @description 缺省的单元格配置\r\n     */\r\n    var defaultConfig = {\r\n        editable: false,\r\n        defaultStatus: 'view',\r\n        type: 'input',\r\n        props: {},\r\n        formItemProps: {},\r\n        useTrigger: true,\r\n        require: true,\r\n        dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\r\n        useKeepEdit: false,\r\n    };\r\n    /**\r\n     * editableConfig\r\n     * @description 实际的单元格配置\r\n     */\r\n    var editableConfig = react_1.useMemo(function () { return (tslib_1.__assign(tslib_1.__assign({}, defaultConfig), ((column === null || column === void 0 ? void 0 : column.$editable) || {}))); }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\r\n    /**\r\n     * status\r\n     * @description 单元格的状态\r\n     */\r\n    var _b = react_1.useState(editableConfig.defaultStatus), status = _b[0], setStatus = _b[1];\r\n    var context = react_1.useContext(SearchTable_1.SearchTableContext);\r\n    /**\r\n     * 数据改变则切换成查看状态\r\n     */\r\n    react_1.useEffect(function () {\r\n        setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\r\n    }, [(_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.getData()]);\r\n    /**\r\n     * 缺省状态改变切换到缺省状态\r\n     */\r\n    react_1.useEffect(function () {\r\n        setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\r\n    }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]);\r\n    return function (tdREL) {\r\n        var res = tdREL;\r\n        // 单元格不是可编辑的单元格\r\n        if (!editableConfig.editable) {\r\n            res = tdREL;\r\n        }\r\n        // 始终保持编辑状态\r\n        else if (editableConfig.useKeepEdit) {\r\n            res = react_1.default.cloneElement(tdREL, tdREL.props, [\r\n                react_1.default.createElement(EditableTableCellEdit_1.default, tslib_1.__assign({}, props, { editableConfig: editableConfig, onTriggerChange: function () { return setStatus('view'); } })),\r\n            ]);\r\n        }\r\n        // 查看状态\r\n        else if (status === 'view') {\r\n            res = react_1.default.cloneElement(tdREL, tdREL.props, [\r\n                react_1.default.createElement(View_1.default, tslib_1.__assign({}, props, { editableConfig: editableConfig, onTriggerChange: function () { return setStatus('edit'); } })),\r\n            ]);\r\n        }\r\n        // 编辑状态\r\n        else if (status === 'edit') {\r\n            res = react_1.default.cloneElement(tdREL, tdREL.props, [\r\n                react_1.default.createElement(EditableTableCellEdit_1.default, tslib_1.__assign({}, props, { editableConfig: editableConfig, onTriggerChange: function () { return setStatus('view'); } })),\r\n            ]);\r\n        }\r\n        return res;\r\n    };\r\n};\r\nexports.default = EditableTableCell;\r\n//# sourceMappingURL=EditableTableCell.js.map"],"names":["Object","defineProperty","exports","value","tslib_1","require","react_1","__importStar","SearchTable_1","EditableTableCellEdit_1","__importDefault","View_1","EditableTableCell","props","column","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","dataIndex","useKeepEdit","editableConfig","useMemo","__assign","$editable","_b","useState","status","setStatus","context","useContext","SearchTableContext","useEffect","_a","getData","tdREL","res","default","cloneElement","createElement","onTriggerChange"],"mappings":"AAAA,aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,MAAO,CAAA,CAAK,CAAC,EAC5D,IAAIC,QAAUC,QAAQ,OAAO,EACzBC,QAAUF,QAAQG,aAAaF,QAAQ,OAAO,CAAC,EAC/CG,cAAgBH,QAAQ,mBAAmB,EAC3CI,wBAA0BL,QAAQM,gBAAgBL,QAAQ,8BAA8B,CAAC,EACzFM,OAASP,QAAQM,gBAAgBL,QAAQ,QAAQ,CAAC,EAKlDO,kBAAoB,SAAUC,GAC9B,IACIC,EAASD,EAAMC,OAKfC,EAAgB,CAChBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNL,MAAO,GACPM,cAAe,GACfC,WAAY,CAAA,EACZf,QAAS,CAAA,EACTgB,UAAWP,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAClEC,YAAa,CAAA,CACjB,EAKIC,EAAiBjB,QAAQkB,QAAQ,WAAc,OAAQpB,QAAQqB,SAASrB,QAAQqB,SAAS,GAAIV,CAAa,GAAKD,MAAAA,EAAuC,KAAA,EAASA,EAAOY,YAAc,EAAI,CAAG,EAAG,CAACZ,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAAU,EAKxQM,EAAKrB,QAAQsB,SAASL,EAAeN,aAAa,EAAGY,EAASF,EAAG,GAAIG,EAAYH,EAAG,GACpFI,EAAUzB,QAAQ0B,WAAWxB,cAAcyB,kBAAkB,EAajE,OATA3B,QAAQ4B,UAAU,WACdJ,EAAUP,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CAC1G,EAAG,CAAC,OAACkB,EAAKJ,MAAAA,EAAyC,KAAA,EAASA,EAAQA,SAAqC,KAAA,EAASI,EAAGC,QAAQ,EAAE,EAI/H9B,QAAQ4B,UAAU,WACdJ,EAAUP,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CAC1G,EAAG,CAACM,MAAAA,EAAuD,KAAA,EAASA,EAAeN,cAAc,EAC1F,SAAUoB,GACb,IAAIC,EAAMD,EAuBV,OArBKd,EAAeP,SAIXO,EAAeD,YACpBgB,EAAMhC,QAAQiC,QAAQC,aAAaH,EAAOA,EAAMxB,MAAO,CACnDP,QAAQiC,QAAQE,cAAchC,wBAAwB8B,QAASnC,QAAQqB,SAAS,GAAIZ,EAAO,CAAEU,eAAgBA,EAAgBmB,gBAAiB,WAAc,OAAOZ,EAAU,MAAM,CAAG,CAAE,CAAC,CAAC,EAC7L,EAGe,SAAXD,EACLS,EAAMhC,QAAQiC,QAAQC,aAAaH,EAAOA,EAAMxB,MAAO,CACnDP,QAAQiC,QAAQE,cAAc9B,OAAO4B,QAASnC,QAAQqB,SAAS,GAAIZ,EAAO,CAAEU,eAAgBA,EAAgBmB,gBAAiB,WAAc,OAAOZ,EAAU,MAAM,CAAG,CAAE,CAAC,CAAC,EAC5K,EAGe,SAAXD,IACLS,EAAMhC,QAAQiC,QAAQC,aAAaH,EAAOA,EAAMxB,MAAO,CACnDP,QAAQiC,QAAQE,cAAchC,wBAAwB8B,QAASnC,QAAQqB,SAAS,GAAIZ,EAAO,CAAEU,eAAgBA,EAAgBmB,gBAAiB,WAAc,OAAOZ,EAAU,MAAM,CAAG,CAAE,CAAC,CAAC,EAC7L,GAlBDQ,EAAMD,EAoBHC,CACX,CACJ,EACApC,QAAQqC,QAAU3B"}