{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar SearchTable_1 = require(\"../../SearchTable\");\n\nvar EditableTableCellEdit_1 = tslib_1.__importDefault(require(\"./Edit/EditableTableCellEdit\"));\n\nvar View_1 = tslib_1.__importDefault(require(\"./View\"));\n/**\n * EditableTableCell\n * @description 单元格编辑\n */\n\n\nvar EditableTableCell = function EditableTableCell(props, tdREL) {\n  var _a;\n\n  var column = props.column;\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n\n  var editableConfig = (0, react_1.useMemo)(function () {\n    return tslib_1.__assign(tslib_1.__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n\n  var _b = (0, react_1.useState)(editableConfig.defaultStatus),\n      status = _b[0],\n      setStatus = _b[1];\n\n  var context = (0, react_1.useContext)(SearchTable_1.SearchTableContext);\n  /**\n   * 数据改变则切换成查看状态\n   */\n\n  (0, react_1.useEffect)(function () {\n    return setStatus('view');\n  }, [(_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n\n  (0, react_1.useEffect)(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]);\n  var res = tdREL; // 单元格不是可编辑的单元格\n\n  if (!editableConfig.editable) {\n    res = tdREL;\n  } // 始终保持编辑状态\n  else if (editableConfig.useKeepEdit) {\n    res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(EditableTableCellEdit_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    }))]);\n  } // 查看状态\n  else if (status === 'view') {\n    res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(View_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('edit');\n      }\n    }))]);\n  } // 编辑状态\n  else if (status === 'edit') {\n    res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(EditableTableCellEdit_1.default, tslib_1.__assign({}, props, {\n      editableConfig: editableConfig,\n      onTriggerChange: function onTriggerChange() {\n        return setStatus('view');\n      }\n    }))]);\n  }\n\n  return function () {\n    return res;\n  };\n};\n\nexports.default = EditableTableCell;"],"names":["require","Object","defineProperty","exports","value","tslib_1","react_1","__importStar","SearchTable_1","EditableTableCellEdit_1","__importDefault","View_1","EditableTableCell","props","tdREL","column","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","dataIndex","useKeepEdit","editableConfig","useMemo","__assign","$editable","_b","useState","status","setStatus","context","useContext","SearchTableContext","res","useEffect","_a","getData","default","cloneElement","createElement","onTriggerChange"],"mappings":"AAAA,aAEAA,QAAQ,8CAA8C,EAEtDC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EAED,IAAIC,QAAUL,QAAQ,OAAO,EAEzBM,QAAUD,QAAQE,aAAaP,QAAQ,OAAO,CAAC,EAE/CQ,cAAgBR,QAAQ,mBAAmB,EAE3CS,wBAA0BJ,QAAQK,gBAAgBV,QAAQ,8BAA8B,CAAC,EAEzFW,OAASN,QAAQK,gBAAgBV,QAAQ,QAAQ,CAAC,EAOlDY,kBAAoB,SAA2BC,EAAOC,GACxD,IAEIC,EAASF,EAAME,OAMfC,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNN,MAAO,GACPO,cAAe,GACfC,WAAY,CAAA,EACZrB,QAAS,CAAA,EACTsB,UAAWP,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAClEC,YAAa,CAAA,CACf,EAMIC,GAAiB,EAAIlB,QAAQmB,SAAS,WACxC,OAAOpB,QAAQqB,SAASrB,QAAQqB,SAAS,GAAIV,CAAa,GAAID,MAAAA,EAAuC,KAAA,EAASA,EAAOY,YAAc,EAAE,CACvI,EAAG,CAACZ,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAAU,EAMzEM,GAAK,EAAItB,QAAQuB,UAAUL,EAAeN,aAAa,EACvDY,EAASF,EAAG,GACZG,EAAYH,EAAG,GAEfI,GAAU,EAAI1B,QAAQ2B,YAAYzB,cAAc0B,kBAAkB,EAelEC,IAVJ,EAAI7B,QAAQ8B,WAAW,WACrB,OAAOL,EAAU,MAAM,CACzB,EAAG,CAAC,OAACM,EAAKL,MAAAA,EAAyC,KAAA,EAASA,EAAQA,SAAqC,KAAA,EAASK,EAAGC,QAAQ,EAAE,GAK/H,EAAIhC,QAAQ8B,WAAW,WACrBL,EAAUP,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CACxG,EAAG,CAACM,MAAAA,EAAuD,KAAA,EAASA,EAAeN,cAAc,EACvFJ,GA8BV,OA5BKU,EAAeP,SAGXO,EAAeD,YACtBY,EAAM7B,QAAQiC,QAAQC,aAAa1B,EAAOA,EAAMD,MAAO,CAACP,QAAQiC,QAAQE,cAAchC,wBAAwB8B,QAASlC,QAAQqB,SAAS,GAAIb,EAAO,CACjJW,eAAgBA,EAChBkB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAEc,SAAXD,EACPK,EAAM7B,QAAQiC,QAAQC,aAAa1B,EAAOA,EAAMD,MAAO,CAACP,QAAQiC,QAAQE,cAAc9B,OAAO4B,QAASlC,QAAQqB,SAAS,GAAIb,EAAO,CAChIW,eAAgBA,EAChBkB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAEc,SAAXD,IACPK,EAAM7B,QAAQiC,QAAQC,aAAa1B,EAAOA,EAAMD,MAAO,CAACP,QAAQiC,QAAQE,cAAchC,wBAAwB8B,QAASlC,QAAQqB,SAAS,GAAIb,EAAO,CACjJW,eAAgBA,EAChBkB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,GAxBJI,EAAMrB,EA2BD,WACL,OAAOqB,CACT,CACF,EAEAhC,QAAQoC,QAAU3B"}