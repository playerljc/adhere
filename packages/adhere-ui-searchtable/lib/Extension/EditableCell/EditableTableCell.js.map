{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar react_1 = __importStar(require(\"react\"));\nvar SearchTable_1 = require(\"../../SearchTable\");\nvar EditableTableCellEdit_1 = __importDefault(require(\"./Edit/EditableTableCellEdit\"));\nvar View_1 = __importDefault(require(\"./View\"));\n/**\n * EditableTableCell\n * @description 单元格编辑\n */\nvar EditableTableCell = function EditableTableCell(props) {\n  var _a;\n  var column = props.column;\n  /**\n   * defaultConfig\n   * @description 缺省的单元格配置\n   */\n  var defaultConfig = {\n    editable: false,\n    defaultStatus: 'view',\n    type: 'input',\n    props: {},\n    formItemProps: {},\n    useTrigger: true,\n    require: true,\n    dataIndex: column === null || column === void 0 ? void 0 : column.dataIndex,\n    useKeepEdit: false\n  };\n  /**\n   * editableConfig\n   * @description 实际的单元格配置\n   */\n  var editableConfig = (0, react_1.useMemo)(function () {\n    return __assign(__assign({}, defaultConfig), (column === null || column === void 0 ? void 0 : column.$editable) || {});\n  }, [column, column === null || column === void 0 ? void 0 : column.dataIndex]);\n  /**\n   * status\n   * @description 单元格的状态\n   */\n  var _b = (0, react_1.useState)(editableConfig.defaultStatus),\n    status = _b[0],\n    setStatus = _b[1];\n  var context = (0, react_1.useContext)(SearchTable_1.SearchTableContext);\n  /**\n   * 数据改变则切换成查看状态\n   */\n  (0, react_1.useEffect)(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [(_a = context === null || context === void 0 ? void 0 : context.context) === null || _a === void 0 ? void 0 : _a.getData()]);\n  /**\n   * 缺省状态改变切换到缺省状态\n   */\n  (0, react_1.useEffect)(function () {\n    setStatus(editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus);\n  }, [editableConfig === null || editableConfig === void 0 ? void 0 : editableConfig.defaultStatus]);\n  return function (tdREL) {\n    var res = tdREL;\n    // 单元格不是可编辑的单元格\n    if (!editableConfig.editable) {\n      res = tdREL;\n    }\n    // 始终保持编辑状态\n    else if (editableConfig.useKeepEdit) {\n      res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(EditableTableCellEdit_1.default, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('view');\n        }\n      }))]);\n    }\n    // 查看状态\n    else if (status === 'view') {\n      res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(View_1.default, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('edit');\n        }\n      }))]);\n    }\n    // 编辑状态\n    else if (status === 'edit') {\n      res = react_1.default.cloneElement(tdREL, tdREL.props, [react_1.default.createElement(EditableTableCellEdit_1.default, __assign({}, props, {\n        editableConfig: editableConfig,\n        onTriggerChange: function onTriggerChange() {\n          return setStatus('view');\n        }\n      }))]);\n    }\n    return res;\n  };\n};\nexports.default = EditableTableCell;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","react_1","exports","require","SearchTable_1","EditableTableCellEdit_1","View_1","EditableTableCell","props","column","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","dataIndex","useKeepEdit","editableConfig","useMemo","$editable","_b","useState","status","setStatus","context","useContext","SearchTableContext","useEffect","_a","getData","tdREL","res","cloneElement","createElement","onTriggerChange"],"mappings":"AAAA,aAEA,IAAIA,SAA0C,WAQ5C,OAPAA,SAAWC,OAAOC,QAAU,SAAUC,GACpC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE/C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAAGN,EAAEM,GAAKL,EAAEK,IAE5E,OAAON,CACT,GACgBU,MAAMC,KAAMP,SAAS,CACvC,EACIQ,gBAAyDd,OAAOe,OAAS,SAAUC,EAAGC,EAAGC,EAAGC,GACnFC,KAAAA,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOrB,OAAOsB,yBAAyBL,EAAGC,CAAC,EAC1CG,IAAS,QAASA,EAAQJ,EAAEM,WAAaF,CAAAA,EAAKG,UAAYH,CAAAA,EAAKI,gBAClEJ,EAAO,CACLK,WAAY,CAAA,EACZC,IAAK,WACH,OAAOV,EAAEC,EACX,CACF,GAEFlB,OAAO4B,eAAeZ,EAAGG,EAAIE,CAAI,CACnC,EAAI,SAAUL,EAAGC,EAAGC,EAAGC,GAErBH,EADsBG,EAAXC,KAAAA,IAAPD,EAAuBD,EACzBC,GAAMF,EAAEC,EACZ,EACIW,mBAA+D7B,OAAOe,OAAS,SAAUC,EAAGc,GAC9F9B,OAAO4B,eAAeZ,EAAG,UAAW,CAClCU,WAAY,CAAA,EACZK,MAAOD,CACT,CAAC,CACH,EAAI,SAAUd,EAAGc,GACfd,EAAW,QAAIc,CACjB,EACIE,aAAkD,SAAUC,GAC9D,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,GACb,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBlB,OAAOS,UAAUC,eAAeC,KAAKsB,EAAKf,CAAC,GAAGJ,gBAAgBoB,EAAQD,EAAKf,CAAC,EAEvI,OADAW,mBAAmBK,EAAQD,CAAG,EACvBC,CACT,EACIC,gBAAwD,SAAUF,GACpE,OAAOA,GAAOA,EAAIV,WAAaU,EAAM,CACnCG,QAAWH,CACb,CACF,EAIII,SAHJrC,OAAO4B,eAAeU,QAAS,aAAc,CAC3CP,MAAO,CAAA,CACT,CAAC,EACaC,aAAaO,QAAQ,OAAO,CAAC,GACvCC,cAAgBD,QAAQ,mBAAmB,EAC3CE,wBAA0BN,gBAAgBI,QAAQ,8BAA8B,CAAC,EACjFG,OAASP,gBAAgBI,QAAQ,QAAQ,CAAC,EAK1CI,kBAAoB,SAA2BC,GACjD,IACIC,EAASD,EAAMC,OAKfC,EAAgB,CAClBC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNL,MAAO,GACPM,cAAe,GACfC,WAAY,CAAA,EACZZ,QAAS,CAAA,EACTa,UAAWP,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAClEC,YAAa,CAAA,CACf,EAKIC,GAAiB,EAAIjB,QAAQkB,SAAS,WACxC,OAAOxD,SAASA,SAAS,GAAI+C,CAAa,GAAID,MAAAA,EAAuC,KAAA,EAASA,EAAOW,YAAc,EAAE,CACvH,EAAG,CAACX,EAAQA,MAAAA,EAAuC,KAAA,EAASA,EAAOO,UAAU,EAKzEK,GAAK,EAAIpB,QAAQqB,UAAUJ,EAAeN,aAAa,EACzDW,EAASF,EAAG,GACZG,EAAYH,EAAG,GACbI,GAAU,EAAIxB,QAAQyB,YAAYtB,cAAcuB,kBAAkB,EAatE,OATA,EAAI1B,QAAQ2B,WAAW,WACrBJ,EAAUN,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CACxG,EAAG,CAAC,OAACiB,EAAKJ,MAAAA,EAAyC,KAAA,EAASA,EAAQA,SAAqC,KAAA,EAASI,EAAGC,QAAQ,EAAE,GAI/H,EAAI7B,QAAQ2B,WAAW,WACrBJ,EAAUN,MAAAA,EAAuD,KAAA,EAASA,EAAeN,aAAa,CACxG,EAAG,CAACM,MAAAA,EAAuD,KAAA,EAASA,EAAeN,cAAc,EAC1F,SAAUmB,GACf,IAAIC,EAAMD,EAgCV,OA9BKb,EAAeP,SAIXO,EAAeD,YACtBe,EAAM/B,QAAQD,QAAQiC,aAAaF,EAAOA,EAAMvB,MAAO,CAACP,QAAQD,QAAQkC,cAAc7B,wBAAwBL,QAASrC,SAAS,GAAI6C,EAAO,CACzIU,eAAgBA,EAChBiB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAGc,SAAXD,EACPS,EAAM/B,QAAQD,QAAQiC,aAAaF,EAAOA,EAAMvB,MAAO,CAACP,QAAQD,QAAQkC,cAAc5B,OAAON,QAASrC,SAAS,GAAI6C,EAAO,CACxHU,eAAgBA,EAChBiB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,EAGc,SAAXD,IACPS,EAAM/B,QAAQD,QAAQiC,aAAaF,EAAOA,EAAMvB,MAAO,CAACP,QAAQD,QAAQkC,cAAc7B,wBAAwBL,QAASrC,SAAS,GAAI6C,EAAO,CACzIU,eAAgBA,EAChBiB,gBAAiB,WACf,OAAOX,EAAU,MAAM,CACzB,CACF,CAAC,CAAC,EAAE,GA3BJQ,EAAMD,EA6BDC,CACT,CACF,EACA9B,QAAQF,QAAUO"}