{"version":3,"file":"routeListen.js","sources":["Extension/SearchAndPaginParams/routeListen.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ProSearchStateTable_1 = require(\"../../ProSearchStateTable\");\r\nvar ProSearchTable_1 = require(\"../../ProSearchTable\");\r\nvar historyStack = [];\r\n/**\r\n * clearSearAndPaginParamsByPathname\r\n * @description 清除查询条件根据pathname\r\n * @param pathname\r\n */\r\nfunction clearSearAndPaginParamsByPathname(pathname) {\r\n    var findIndex = ProSearchTable_1.SearchAndPaginParamsMemo.findIndexByPath(pathname);\r\n    if (findIndex !== -1) {\r\n        ProSearchTable_1.SearchAndPaginParamsMemo.deleteByIndex(findIndex);\r\n    }\r\n    findIndex = ProSearchStateTable_1.SearchAndPaginParamsMemo.findIndexByPath(pathname);\r\n    if (findIndex !== -1) {\r\n        ProSearchStateTable_1.SearchAndPaginParamsMemo.deleteByIndex(findIndex);\r\n    }\r\n}\r\nexports.default = (function (_a) {\r\n    var location = _a.location, action = _a.action;\r\n    var pathname = location.pathname;\r\n    var findIndex = historyStack.lastIndexOf(pathname);\r\n    // 没找到\r\n    if (findIndex === -1) {\r\n        // 清除查询条件\r\n        clearSearAndPaginParamsByPathname(pathname);\r\n        historyStack.push(pathname);\r\n    }\r\n    // 找到了\r\n    else {\r\n        var pathArr = historyStack.slice(findIndex + 1);\r\n        // 1 2 1\r\n        // 之间只有一个页面的路径\r\n        if (pathArr.length === 1) {\r\n            // pathArr[0] /system/task/list/view\r\n            // pathname   /system/task/list/ 当前\r\n            if (!pathArr[0].startsWith(pathname)) {\r\n                // 清除查询条件\r\n                clearSearAndPaginParamsByPathname(pathname);\r\n            }\r\n        }\r\n        else {\r\n            // 清除查询条件\r\n            clearSearAndPaginParamsByPathname(pathname);\r\n        }\r\n        // 都需要清空路径\r\n        historyStack = historyStack.slice(0, findIndex);\r\n        historyStack.push(pathname);\r\n    }\r\n});\r\n//# sourceMappingURL=routeListen.js.map"],"names":["Object","defineProperty","exports","value","ProSearchStateTable_1","require","ProSearchTable_1","historyStack","clearSearAndPaginParamsByPathname","pathname","findIndex","SearchAndPaginParamsMemo","findIndexByPath","deleteByIndex","default","_a","pathArr","location","action","lastIndexOf","slice","length","startsWith","push"],"mappings":"AAAA,aACAA,OAAOC,eAAeC,QAAS,aAAc,CAAEC,MAAO,CAAA,CAAK,CAAC,EAC5D,IAAIC,sBAAwBC,QAAQ,2BAA2B,EAC3DC,iBAAmBD,QAAQ,sBAAsB,EACjDE,aAAe,GAMnB,SAASC,kCAAkCC,GACvC,IAAIC,EAAYJ,iBAAiBK,yBAAyBC,gBAAgBH,CAAQ,EAChE,CAAC,IAAfC,GACAJ,iBAAiBK,yBAAyBE,cAAcH,CAAS,EAGnD,CAAC,KADnBA,EAAYN,sBAAsBO,yBAAyBC,gBAAgBH,CAAQ,IAE/EL,sBAAsBO,yBAAyBE,cAAcH,CAAS,CAE9E,CACAR,QAAQY,QAAU,SAAWC,GACzB,IAWQC,EAXJC,EAAWF,EAAGE,SACdR,GADiCM,EAAGG,OACzBD,EAASR,UACpBC,EAAYH,aAAaY,YAAYV,CAAQ,GAE/B,CAAC,IAAfC,GAEAF,kCAAkCC,CAAQ,EAC1CF,eAOuB,KAHnBS,EAAUT,aAAaa,MAAMV,EAAY,CAAC,GAGlCW,QAGHL,EAAQ,GAAGM,WAAWb,CAAQ,GAOnCD,kCAAkCC,CAAQ,EAG9CF,aAAeA,aAAaa,MAAM,EAAGV,CAAS,IApBjCa,KAAKd,CAAQ,CAuBjC"}