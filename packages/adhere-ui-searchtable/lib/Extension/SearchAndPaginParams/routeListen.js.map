{"version":3,"file":"routeListen.js","sources":["Extension/SearchAndPaginParams/routeListen.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ProSearchStateTable_1 = require(\"../../ProSearchStateTable\");\nvar ProSearchTable_1 = require(\"../../ProSearchTable\");\nvar historyStack = [];\nvar codeStack = [];\n/**\n * clearSearAndPaginParamsByPathname\n * @description 清除查询条件根据pathname\n * @param pathname\n */\nfunction clearSearAndPaginParamsByPathname(pathname) {\n  var findIndex = ProSearchTable_1.SearchAndPaginParamsMemo.findIndexByPath(pathname);\n  console.log('findIndex', findIndex);\n  if (findIndex !== -1) {\n    ProSearchTable_1.SearchAndPaginParamsMemo.deleteByIndex(findIndex);\n  }\n  findIndex = ProSearchStateTable_1.SearchAndPaginParamsMemo.findIndexByPath(pathname);\n  if (findIndex !== -1) {\n    ProSearchStateTable_1.SearchAndPaginParamsMemo.deleteByIndex(findIndex);\n  }\n}\n/**\n * Listener\n * @param e\n * @param _history\n * @constructor\n */\nfunction Listener(e, _history) {\n  var location = e.location,\n    action = e.action;\n  var code = function code() {\n    var pathname = location.pathname;\n    console.log('pathname', pathname);\n    console.log('pathhistoryStackname', historyStack);\n    var findIndex = historyStack.lastIndexOf(pathname);\n    // 没找到\n    if (findIndex === -1) {\n      // 清除查询条件\n      clearSearAndPaginParamsByPathname(pathname);\n      historyStack.push(pathname);\n    }\n    // 找到了\n    else {\n      var pathArr = historyStack.slice(findIndex + 1);\n      console.log('pathArr', pathArr);\n      // 1 2 1\n      // 之间只有一个页面的路径\n      if (pathArr.length === 1) {\n        // pathArr[0] /system/task/list/view\n        // pathname   /system/task/list/ 当前\n        if (!pathArr[0].startsWith(pathname)) {\n          // 清除查询条件\n          clearSearAndPaginParamsByPathname(pathname);\n        }\n      } else {\n        console.log('清除查询条件');\n        // 清除查询条件\n        clearSearAndPaginParamsByPathname(pathname);\n      }\n      // 都需要清空路径\n      historyStack = historyStack.slice(0, findIndex);\n      historyStack.push(pathname);\n    }\n  };\n  if (_history.action === 'PUSH') {\n    code();\n  } else if (_history.action === 'POP') {\n    codeStack.push(code);\n  }\n}\nListener.getCode = function () {\n  return codeStack.pop();\n};\nexports.default = Listener;"],"names":["Object","defineProperty","exports","value","ProSearchStateTable_1","require","ProSearchTable_1","historyStack","codeStack","clearSearAndPaginParamsByPathname","pathname","findIndex","SearchAndPaginParamsMemo","findIndexByPath","console","log","deleteByIndex","Listener","e","_history","code","pathArr","location","lastIndexOf","slice","length","startsWith","push","action","getCode","pop","default"],"mappings":"AAAA,aAEAA,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EACD,IAAIC,sBAAwBC,QAAQ,2BAA2B,EAC3DC,iBAAmBD,QAAQ,sBAAsB,EACjDE,aAAe,GACfC,UAAY,GAMhB,SAASC,kCAAkCC,GACzC,IAAIC,EAAYL,iBAAiBM,yBAAyBC,gBAAgBH,CAAQ,EAClFI,QAAQC,IAAI,YAAaJ,CAAS,EAChB,CAAC,IAAfA,GACFL,iBAAiBM,yBAAyBI,cAAcL,CAAS,EAGjD,CAAC,KADnBA,EAAYP,sBAAsBQ,yBAAyBC,gBAAgBH,CAAQ,IAEjFN,sBAAsBQ,yBAAyBI,cAAcL,CAAS,CAE1E,CAOA,SAASM,SAASC,EAAGC,GAGR,SAAPC,IACF,IAYMC,EAZFX,EAAWY,EAASZ,SAGpBC,GAFJG,QAAQC,IAAI,WAAYL,CAAQ,EAChCI,QAAQC,IAAI,uBAAwBR,YAAY,EAChCA,aAAagB,YAAYb,CAAQ,IAE/B,CAAC,IAAfC,GAEFF,kCAAkCC,CAAQ,EAC1CH,eAIIc,EAAUd,aAAaiB,MAAMb,EAAY,CAAC,EAC9CG,QAAQC,IAAI,UAAWM,CAAO,EAGP,IAAnBA,EAAQI,OAGLJ,EAAQ,GAAGK,WAAWhB,CAAQ,GAEjCD,kCAAkCC,CAAQ,GAG5CI,QAAQC,IAAI,QAAQ,EAEpBN,kCAAkCC,CAAQ,GAG5CH,aAAeA,aAAaiB,MAAM,EAAGb,CAAS,IArBjCgB,KAAKjB,CAAQ,CAwB9B,CAnCA,IAAIY,EAAWJ,EAAEI,SACNJ,EAAEU,OAmCW,SAApBT,EAASS,OACXR,EAAK,EACwB,QAApBD,EAASS,QAClBpB,UAAUmB,KAAKP,CAAI,CAEvB,CACAH,SAASY,QAAU,WACjB,OAAOrB,UAAUsB,IAAI,CACvB,EACA5B,QAAQ6B,QAAUd"}