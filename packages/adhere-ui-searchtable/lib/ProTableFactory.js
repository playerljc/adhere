"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),antd_1=require("antd"),dayjs_1=tslib_1.__importDefault(require("dayjs")),merge_1=tslib_1.__importDefault(require("lodash/merge")),omit_js_1=tslib_1.__importDefault(require("omit.js")),qs_1=tslib_1.__importDefault(require("qs")),react_1=tslib_1.__importDefault(require("react")),icons_1=require("@ant-design/icons"),adhere_ui_antdformitem_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-antdformitem")),adhere_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-conditionalrender")),adhere_ui_tablegridlayout_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-tablegridlayout")),adhere_ui_tableheadsearch_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-tableheadsearch")),adhere_util_intl_1=tslib_1.__importDefault(require("@baifendian/adhere-util-intl")),adhere_util_resource_1=tslib_1.__importDefault(require("@baifendian/adhere-util-resource")),adhere_util_validator_1=tslib_1.__importDefault(require("@baifendian/adhere-util-validator")),AdvancedSearchPanel_1=tslib_1.__importDefault(require("./Extension/AdvancedSearchPanel")),SearchTable_1=require("./SearchTable"),FormItemGeneratorToDict=adhere_ui_antdformitem_1.default.FormItemGeneratorToDict,_a=adhere_ui_antdformitem_1.default.AntFormItemNormalize,DatePicker=_a.DatePicker,InputNumberDecimal1=_a.InputNumberDecimal1,InputNumberDecimal2=_a.InputNumberDecimal2,InputNumberInteger=_a.InputNumberInteger,RangePicker=_a.RangePicker,TimePicker=_a.TimePicker,renderGridSearchFormGroup=adhere_ui_tablegridlayout_1.default.renderGridSearchFormGroup,Label=adhere_ui_tablegridlayout_1.default.Label,Value=adhere_ui_tablegridlayout_1.default.Value,_selectorPrefix=SearchTable_1.selectorPrefix+"-protable";exports.default=function(e,i){return a=e,tslib_1.__extends(t,a),t.prototype.componentWillUnmount=function(){a.prototype.componentWillUnmount&&a.prototype.componentWillUnmount.call(this),"openSearchParamsMemory"in this.props&&!("openSearchParamsMemory"in this.props&&this.props.openSearchParamsMemory)||this.unMountSearchAndPaginParamsDeal()},t.prototype.onSubTableChange=function(e,t,a){},t.prototype.onSearchPanelCollapseBefore=function(){this.hasAdvancedSearchPanel&&this.state.expand&&this.setState({advancedSearchPanelCollapse:!1})},t.prototype.unMountSearchAndPaginParamsDeal=function(){var e,t=this.state.searchParams||{},a=this.pathname,n=this.getComponentId();i.isEmpty()?i.add(a,((e={})[n]={search:t,page:this.state.page,limit:this.state.limit},e)):(e=i.findByPath(a))?(e.components[n].search=t,e.components[n].page=this.state.page,e.components[n].limit=this.state.limit):i.add(a,((e={})[n]={search:t,page:this.state.page,limit:this.state.limit},e))},t.prototype.initSearchAndPaginParams=function(t){var e,a,n=qs_1.default.parse(this.getSearch(),{ignoreQueryPrefix:!0}),r={};return Object.keys(n).forEach(function(e){r[e]=t?t(e,n[e]):n[e]}),!i.isEmpty()&&(e=i.findByPath(this.pathname),a=this.getComponentId(),e&&e.components[a])?tslib_1.__assign(tslib_1.__assign({},r),e.components[a]):{search:tslib_1.__assign({},r),page:1,limit:this.getLimit()}},t.prototype.hasAdvancedSearch=function(){return!0},t.prototype.hasNumberColumnFixed=function(){return!0},t.prototype.hasOptionColumnFixed=function(){return!0},t.prototype.getPathName=function(){return window.location.pathname},t.prototype.getSearch=function(){return window.location.search},t.prototype.getParams=function(){var r=this,t={},i=function(e){e.reduce(function(e,t){var a=t.$search,n=t.children,a=a||{},t=a.dataIndex||t.dataIndex;return[r.getOptionsColumnDataIndex(),r.getLinkColumnDataIndex(),"_number"].includes(t)||("rangePicker"===a.type?(a.startName&&(e[a.startName]=null),a.endName&&(e[a.endName]=null)):["datePicker","timePicker"].includes(a.type)?e[t]=null:e[t]=void 0,n&&Array.isArray(n)&&i(n)),e},t)};return i(this.getTableColumns()),t},t.prototype.getDateState=function(t){var e=Object.keys(t).filter(function(e){return null===t[e]||"null"===t[e]||adhere_util_validator_1.default.isDate(t[e],{format:"YYYY-MM-DD"})}),a={};return e.forEach(function(e){a[e]=null===t[e]||"null"===t[e]?null:dayjs_1.default(t[e])}),a},t.prototype.getDataKey=function(){return"records"},t.prototype.getTotalKey=function(){return"total"},t.prototype.getLimit=function(){return 10},t.prototype.getFetchDataParams=function(){var a=this.state.searchParams,n={};return Object.keys(a).filter(function(t){return["start","Start"].some(function(e){return-1!==t.indexOf(e)})||["end","End"].some(function(e){return-1!==t.indexOf(e)})}).forEach(function(t){n[t]=a[t]?(a[t].format(adhere_util_resource_1.default.Dict.value.ResourceMomentFormat10.value())+" "+(["start","Start"].some(function(e){return-1!==t.indexOf(e)})?"00:00:00":["end","End"].some(function(e){return-1!==t.indexOf(e)})?"23:59:59":"")).trim():null}),Object.keys(a).filter(function(e){return!(e in n)&&a[e]instanceof dayjs_1.default}).forEach(function(e){n[e]=a[e]?a[e].format(adhere_util_resource_1.default.Dict.value.ResourceMomentFormat10.value()).trim():null}),n},t.prototype.getColumns=function(e){return(e||a.prototype.getColumns.call(this)).map(function(e){return tslib_1.__assign({},e)})},t.prototype.getTableColumns=function(){var l=this,e=a.prototype.getTableColumns.call(this),t=(!this.hasOptionColumnFixed()||!(t=e.find(function(e){return e.dataIndex===(l.getOptionsColumnDataIndex()||"_options")}))||"fixed"in t||t.fixed||(t.fixed="right"),!this.hasNumberColumnFixed()||!(t=e.find(function(e){return"_number"===e.dataIndex}))||"fixed"in t||t.fixed||(t.fixed="left"),e.find(function(e){return e.dataIndex===(l.getLinkColumnDataIndex()||"_linkColumn")}));return t&&("ellipsis"in t||(t.ellipsis=!1),"align"in t||(t.align="left")),e.map(function(e){return tslib_1.__assign(tslib_1.__assign({},e),{align:[l.getLinkColumnDataIndex()||"_linkColumn"].includes(e.dataIndex)&&"align"in e&&e.align?e.align:"center"})}).map(function(e){function o(a){var e=a.$search,t=tslib_1.__rest(a,["$search"]),n=l.assignSearchConfig(e,t),e=n.showColumnHeader,r=tslib_1.__assign({},a),i=n.dataIndex||a.dataIndex;return!["_number",l.getOptionsColumnDataIndex()].includes(i)&&e&&(r=tslib_1.__assign(tslib_1.__assign({},r),adhere_ui_tableheadsearch_1.default(function(e){var t=e.confirm,a=n.type;return react_1.default.createElement("div",{className:_selectorPrefix+"-headersearchwrap"},react_1.default.createElement("div",{className:_selectorPrefix+"-headersearchwrap-main"},l.renderGridSearchFormGroupDataItem(a,{searchConfig:n,column:r,dataIndex:i})),react_1.default.createElement("div",{className:_selectorPrefix+"-headersearchwrap-footer"},react_1.default.createElement(antd_1.Button,{size:"small",onClick:function(){var e={};"rangePicker"===a?(n.startName&&(e[n.startName]=null),n.endName&&(e[n.endName]=null)):e[i]=void 0,l.setState(e,function(){return l.onSearch().then(function(){return t()})})}},adhere_util_intl_1.default.v("重置")),react_1.default.createElement(antd_1.Button,{size:"small",type:"primary",onClick:function(){return l.onSearch().then(function(){return t()})}},adhere_util_intl_1.default.v("确定"))))}))),a.children&&Array.isArray(a.children)&&a.children.forEach(function(e,t){a.children[t]=o(e)}),r}return o(e)})},t.prototype.getOptionsColumnDataIndex=function(){return"_options"},t.prototype.getLinkColumnDataIndex=function(){return"_linkColumn"},t.prototype.getPagination=function(){var n=this;return tslib_1.__assign(tslib_1.__assign({},a.prototype.getPagination.call(this)),{showTotal:function(e){var t=(n.state.page-1)*n.state.limit+1,a=(a=n.state.page*n.state.limit)<e?a:e;return adhere_util_intl_1.default.v("当前 {page}-{pageSize}/共 {total}条",{page:t,pageSize:a,total:e})}})},t.prototype.getGridSearchFormGroupParams=function(){return[[{name:"g1",columnCount:3,colgroup:[,"auto",,"auto",,"auto"],data:this.getGridSearchFormGroupDataByColumnConfig()}],{},{rowCount:1}]},t.prototype.getGridSearchFormGroupDataByColumnConfig=function(){var l=this,c=[],u=function(e){e.filter(function(e){return"$search"in e&&!!e.$search.visible}).forEach(function(e){var t=e.$search,a=tslib_1.__rest(e,["$search"]),n=l.assignSearchConfig(t,a),r=(null==n?void 0:n.type)||"input",i=n.dataIndex||e.dataIndex,o=t.title||e.title;c.push({key:i,label:react_1.default.createElement(Label,tslib_1.__assign({},t.labelAttrs||{}),o,"："),value:adhere_ui_conditionalrender_1.default.conditionalRender({conditional:!l.hasAuthority||(null==(o=l.hasAuthority)?void 0:o.call(l,n.authority)),match:react_1.default.createElement(Value,tslib_1.__assign({},t.valueAttrs||{}),l.renderGridSearchFormGroupDataItem(r,{searchConfig:n,column:a,dataIndex:i})),noMatch:t.renderNoAuthority?react_1.default.createElement(Value,tslib_1.__assign({},t.valueAttrs||{}),null==(o=null==t?void 0:t.renderNoAuthority)?void 0:o.call(t)):null})}),e.children&&Array.isArray(e.children)&&u(e.children)})};return u(this.getColumns(a.prototype.getColumns.call(this))),c.filter(function(e){return!!e.value})},t.prototype.assignSearchConfig=function(e,t){t={type:"input",visible:!0,showColumnHeader:!0,props:{},labelAttrs:{},valueAttrs:{},authority:[],renderNoAuthority:function(){return null},dataIndex:t.dataIndex,title:t.title,dictName:"",renderChildren:function(){return null},render:function(){return null},startName:"",endName:""};return tslib_1.__assign(tslib_1.__assign({},t),e||{})},t.prototype.renderSearchForm=function(){return this.renderGridSearchFormGroup.apply(this,this.getGridSearchFormGroupParams())},t.prototype.renderSearchFooterItems=function(e){var t,a,n=this,e=tslib_1.__spreadArrays(e||[]);return this.hasAdvancedSearchPanel&&this.state.expand&&(t=react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:!this.advancedSearchConfig.renderSearchButton,noMatch:function(){return n.advancedSearchConfig.renderSearchButton(function(){return n.setState({advancedSearchPanelCollapse:!0})})}},function(){return react_1.default.createElement(antd_1.Button,{icon:react_1.default.createElement(icons_1.FilterOutlined,null),type:"primary",onClick:function(){return n.setState({advancedSearchPanelCollapse:!0})}},adhere_util_intl_1.default.v("高级搜索"))}),this.advancedSearchConfig.insertSearchButton?this.advancedSearchConfig.insertSearchButton(e,t):-1!==(a=e.findIndex(function(e){return"$$typeof"in e&&"key"in e&&"reset"===e.key}))&&e.splice(a+1,0,t)),this.renderSearchFooterItemsImpl(e).map(function(e){return"$$typeof"in e?e:e.value})},t.prototype.renderSearchFooterItemsImpl=function(e){return tslib_1.__spreadArrays(e,[react_1.default.createElement("div",{className:_selectorPrefix+"-headeritem"},this.renderTableDensitySetting()),react_1.default.createElement("div",{className:_selectorPrefix+"-headeritem"},this.renderColumnSetting())])},t.prototype.renderGridSearchFormGroupDataItem=function(e,t){var n=this,a=t.searchConfig,r=t.column,i=t.dataIndex;return null==(t=new Map([["input",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(antd_1.Input,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onInputChange(a,e)}},t.props||{}))}],["textArea",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(antd_1.Input.TextArea,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onInputChange(a,e)}},t.props||{}))}],["inputNumber",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(antd_1.InputNumber,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["inputNumberDecimal1",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(InputNumberDecimal1,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["inputNumberDecimal2",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(InputNumberDecimal2,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["inputNumberInteger",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(InputNumberInteger,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["select",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"FormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["multiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["checkAllMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"CheckAllMulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["autoCompleteSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"FormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["autoCompleteSelectMulti",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["autoCompleteSelectCheckAllMulti",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"CheckAllMulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["radioHorizontal",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"HorizontalFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["radioButton",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"ButtonFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["radioSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"SelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["radioCustom",function(e){var a=e.searchConfig,t=e.dataIndex,e=FormItemGeneratorToDict[a.dictName+"CustomFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[t],onChange:function(e){return n.onSelectChange(t,e)}},a.props||{}),function(e){var t;return null==(t=null==a?void 0:a.renderChildren)?void 0:t.call(a,e)})}],["checkBoxHorizontal",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"HorizontalFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["checkBoxCheckAllHorizontal",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"CheckAllHorizontalFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["checkboxSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"SelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["checkBoxCheckAllSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"CheckAllSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["checkBoxCustom",function(e){var a=e.searchConfig,t=e.dataIndex,e=FormItemGeneratorToDict[a.dictName+"CustomFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[t],onChange:function(e){return n.onSelectChange(t,e)}},a.props||{}),function(e){var t;return null==(t=null==a?void 0:a.renderChildren)?void 0:t.call(a,e)})}],["checkBoxCheckAllCustom",function(e){var a=e.searchConfig,t=e.dataIndex,e=FormItemGeneratorToDict[a.dictName+"CheckAllCustomFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[t],onChange:function(e){return n.onSelectChange(t,e)}},a.props||{}),function(e){var t;return null==(t=null==a?void 0:a.renderChildren)?void 0:t.call(a,e)})}],["transferSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"SelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["tableSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"SelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["tableMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["tablePagingSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"PaginationSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["tablePagingMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"PaginationMulitSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["listSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"SelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["listMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["listPagingSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"PaginationSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["listPagingMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"PaginationMulitSelectFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["treeSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"FormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["treeMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["treeSelectLeaf",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"LeafFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["treeMultiSelectLeaf",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"LeafMulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["cascaderSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"FormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["cascaderMultiSelect",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"MulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["cascaderSelectLeaf",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"LeafFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["cascaderMultiSelectLeaf",function(e){var t=e.searchConfig,a=e.dataIndex,e=FormItemGeneratorToDict[t.dictName+"LeafMulitFormItem"];return react_1.default.createElement(e,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["datePicker",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(DatePicker,tslib_1.__assign({value:n.state[a],onChange:function(e){var t;n.setState(((t={})[a]=e||null,t))}},t.props||{}))}],["timePicker",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(TimePicker,tslib_1.__assign({value:n.state[a],onChange:function(e){var t;n.setState(((t={})[a]=e||null,t))}},t.props||{}))}],["rangePicker",function(e){var e=e.searchConfig,t=e.startName,a=e.endName;return react_1.default.createElement(RangePicker,tslib_1.__assign({value:[n.state[t],n.state[a]],onChange:function(e){n.onDateTimeRangeChange([t,a],e)}},e.props||{}))}],["slider",function(e){var t=e.searchConfig,a=e.dataIndex;return react_1.default.createElement(antd_1.Slider,tslib_1.__assign({value:n.state[a],onChange:function(e){return n.onSelectChange(a,e)}},t.props||{}))}],["sliderRange",function(e){e=e.searchConfig;return react_1.default.createElement(antd_1.Slider,tslib_1.__assign({range:!0,value:n.state[i],onChange:function(e){return n.onSelectChange(i,e)}},e.props||{}))}],["rate",function(e){e=e.searchConfig;return react_1.default.createElement(antd_1.Rate,tslib_1.__assign({value:n.state[i],onChange:function(e){return n.onSelectChange(i,e)}},e.props||{}))}],["switch",function(e){e=e.searchConfig;return react_1.default.createElement(antd_1.Switch,tslib_1.__assign({value:n.state[i],onChange:function(e){return n.onSelectChange(i,e)}},e.props||{}))}],["custom",function(e){var t,a=e.searchConfig,n=e.column,e=e.dataIndex;return null==(t=null==a?void 0:a.render)?void 0:t.call(a,{searchConfig:a,column:n,dataIndex:e})}]]).get(e))?void 0:t({searchConfig:a,column:r,dataIndex:i})},t.prototype.renderGridSearchFormGroup=function(e,t,a){var n,r=this,t=merge_1.default({layout:"horizontal",density:"middle"},t||{}),i=(null!=(i=null==a?void 0:a.advancedSearch)&&i.onAfterClose&&(n=a.advancedSearch.onAfterClose,a.advancedSearch.onAfterClose=function(){n(),r.setState({advancedSearchPanelCollapse:!1})}),this.advancedSearchConfig=merge_1.default({rowCount:"auto",showStrategy:"remaining",renderTitleLabel:null,renderCollapse:null,renderSearchButton:null,insertSearchButton:null,advancedSearch:{className:"",style:{},width:"60%",mask:!0,zIndex:19999,time:300,direction:"right",collapse:!0,onBeforeShow:function(){},onBeforeClose:function(){},onAfterShow:function(){},onAfterClose:function(){r.setState({advancedSearchPanelCollapse:!1})},getPopupContainer:function(){return document.body}}},a||{}),renderGridSearchFormGroup(e,t));if(this.advancedSearchConfig&&"auto"!==this.advancedSearchConfig.rowCount||this.advancedSearchConfig&&!("rowCount"in this.advancedSearchConfig)&&this.hasAdvancedSearch()||this.advancedSearchConfig&&"rowCount"in this.advancedSearchConfig&&!this.advancedSearchConfig.rowCount||!this.advancedSearchConfig&&this.hasAdvancedSearch()){var a=adhere_ui_tablegridlayout_1.default.getRenderDetail(e,t),o=a.rowCount,l=a.detail;if(o>this.advancedSearchConfig.rowCount){for(var c=[],u=[],s=this.advancedSearchConfig.rowCount,d=0;0!==s;){var m=e[d],_=l[d];_.rowCount<=s?(c.push(tslib_1.__assign({},m)),s-=_.rowCount):(_=_.detail.slice(0,s),c.push(tslib_1.__assign(tslib_1.__assign({},m),{data:m.data.slice(_[0].startIndex,_[_.length-1].endIndex+1)})),u.push(tslib_1.__assign(tslib_1.__assign({},m),{data:m.data.slice(_[_.length-1].endIndex+1)})),s=0),d+=1}for(var h=d;h<e.length;h++)u.push(tslib_1.__assign({},e[h]));return this.hasAdvancedSearchPanel=!0,this.advancedSearchConfig.advancedSearch.collapse=this.state.advancedSearchPanelCollapse,react_1.default.createElement("div",{className:_selectorPrefix+"-gridsearchformgroupwrap"},renderGridSearchFormGroup(c,t),react_1.default.createElement(AdvancedSearchPanel_1.default,{groupData:e,tableGridLayoutConfig:t,remainingGroupData:u,advancedSearchConfig:this.advancedSearchConfig,onSearch:function(){return new Promise(function(e){r.setState({page:1},function(){r.onSearch().then(function(){return e()})})})},onReset:function(){return r.onClear()},onCollapse:function(e){return r.setState({advancedSearchPanelCollapse:e})}}))}}return this.hasAdvancedSearchPanel=!1,react_1.default.createElement("div",{className:_selectorPrefix+"-gridsearchformgroupwrap"},i)},t.prototype.renderOptionColumn=function(e,t){return e.map(function(e){return e.value}).filter(function(e){return!!e})},t;function t(e){var e=a.call(this,e)||this,t=(e.pathname="undefined"!=typeof window?e.getPathName():"",{search:{},page:1,limit:e.getLimit()||10});return"openSearchParamsMemory"in e.props&&!("openSearchParamsMemory"in e.props&&e.props.openSearchParamsMemory)||(t=e.initSearchAndPaginParams()),e.state=tslib_1.__assign(tslib_1.__assign(tslib_1.__assign({},e.state),t.search),{page:t.page,limit:t.limit,searchParams:tslib_1.__assign(tslib_1.__assign({},e.state.searchParams),t.search)}),e.state=tslib_1.__assign(tslib_1.__assign(tslib_1.__assign({},e.state),e.getDateState(omit_js_1.default(e.state,["searchParams"]))),{searchParams:tslib_1.__assign(tslib_1.__assign({},e.state.searchParams),e.getDateState(e.state.searchParams)),advancedSearchPanelCollapse:!1}),e.hasAdvancedSearchPanel=!1,e.advancedSearchConfig=null,e}var a};
//# sourceMappingURL=ProTableFactory.js.map
