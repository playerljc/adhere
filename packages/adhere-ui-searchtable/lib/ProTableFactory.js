"use strict";var __extends=function(){var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__rest=function(e,t){var n={};for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n},__spreadArray=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||((r=r||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},antd_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("antd")),dayjs_1=__importDefault(require("dayjs")),lodash_merge_1=__importDefault(require("lodash.merge")),omit_js_1=__importDefault(require("omit.js")),qs_1=__importDefault(require("qs")),react_1=__importDefault(require("react")),icons_1=require("@ant-design/icons"),adhere_ui_anthoc_1=require("@baifendian/adhere-ui-anthoc"),adhere_ui_conditionalrender_1=__importDefault(require("@baifendian/adhere-ui-conditionalrender")),adhere_ui_configprovider_1=__importDefault(require("@baifendian/adhere-ui-configprovider")),adhere_ui_fieldgeneratortodict_1=__importDefault(require("@baifendian/adhere-ui-fieldgeneratortodict")),adhere_ui_tablegridlayout_1=__importDefault(require("@baifendian/adhere-ui-tablegridlayout")),adhere_ui_tableheadsearch_1=__importDefault(require("@baifendian/adhere-ui-tableheadsearch")),adhere_util_1=__importDefault(require("@baifendian/adhere-util")),adhere_util_intl_1=__importDefault(require("@baifendian/adhere-util-intl")),adhere_util_resource_1=__importDefault(require("@baifendian/adhere-util-resource")),adhere_util_validator_1=__importDefault(require("@baifendian/adhere-util-validator")),AdvancedSearchPanel_1=__importDefault(require("./Extension/AdvancedSearchPanel")),ColumnTipTitle_1=__importDefault(require("./Extension/ColumnTipTitle")),routeListen_1=__importDefault(require("./Extension/SearchAndPaginParams/routeListen")),SearchTable_1=require("./SearchTable"),TextArea=antd_1.Input.TextArea,renderGridSearchFormGroup=adhere_ui_tablegridlayout_1.default.renderGridSearchFormGroup,Label=adhere_ui_tablegridlayout_1.default.Label,Value=adhere_ui_tablegridlayout_1.default.Value,_selectorPrefix="".concat(SearchTable_1.selectorPrefix,"-protable");exports.default=function(e,i){var a;return __extends(t,a=e),t.prototype.componentWillUnmount=function(){a.prototype.componentWillUnmount&&a.prototype.componentWillUnmount.call(this),"openSearchParamsMemory"in this.props&&!("openSearchParamsMemory"in this.props&&this.props.openSearchParamsMemory)||this.unMountSearchAndPaginParamsDeal()},t.prototype.onSubTableChange=function(e,t,n){},t.prototype.onSearchPanelCollapseBefore=function(){this.hasAdvancedSearch()&&this.hasAdvancedSearchPanel&&this.state.expand&&this.setState({advancedSearchPanelCollapse:!1})},t.prototype.unMountSearchAndPaginParamsDeal=function(){var e,t,n=null!=(n=this.state.searchParams)?n:{},r=null!=(r=this.pathname)?r:"",a=this.getComponentId();i.isEmpty()?i.add(r,((t={})[a]={search:n,page:this.state.page,limit:this.state.limit},t)):(t=i.findByPath(r))&&null!=(e=null==t?void 0:t.components)&&e[a]?(t.components[a].search=n,t.components[a].page=this.state.page,t.components[a].limit=this.state.limit):i.add(r,((e={})[a]={search:n,page:this.state.page,limit:this.state.limit},e))},t.prototype.initSearchAndPaginParams=function(t){var e,n,r=qs_1.default.parse(this.getSearch(),{ignoreQueryPrefix:!0}),a={};return Object.keys(r).forEach(function(e){a[e]=t?t(e,r[e]):r[e]}),!i.isEmpty()&&(e=null!=(e=this.pathname)?e:"",e=i.findByPath(e),n=this.getComponentId(),e)&&e.components[n]?__assign(__assign({},a),e.components[n]):{search:__assign({},a),page:1,limit:this.getLimit()}},t.prototype.hasAdvancedSearch=function(){return!0},t.prototype.hasNumberColumnFixed=function(){return!0},t.prototype.hasOptionColumnFixed=function(){return!0},t.prototype.getPathName=function(){var e=null!=(e=this.props.publicPath)?e:"/",t=null!=(t=this.props.router)?t:"browser";return adhere_util_1.default.getPathName(e,t)},t.prototype.getSearch=function(){var e;return null!=(e=adhere_util_1.default.getSearch(null!=(e=this.props.router)?e:"browser"))?e:""},t.prototype.getParams=function(){var a=this,t={},i=function(e){e.reduce(function(e,t){var n=t.$search,r=t.children,n=null!=n?n:{},t=n.dataIndex||t.dataIndex;return[a.getOptionsColumnDataIndex(),a.getLinkColumnDataIndex(),"_number"].includes(t)||("rangePicker"===n.type?(n.startName&&(e[n.startName]=null),n.endName&&(e[n.endName]=null)):["datePicker","timePicker"].includes(n.type)?e[t]=null:e[t]=void 0,r&&Array.isArray(r)&&i(r)),e},t)};return i(this.getTableColumnsAll()),t},t.prototype.getDateState=function(n){var e=Object.keys(n).filter(function(e){var t=!1;try{t=null===n[e]||"null"===n[e]||void 0===n[e]||"undefined"===n[e]||""===n[e]||adhere_util_validator_1.default.isDate(n[e])}catch(e){}return t}),t={};return e.forEach(function(e){t[e]=null===n[e]||"null"===n[e]||void 0===n[e]||"undefined"===n[e]||""===n[e]?null:(0,dayjs_1.default)(n[e])}),t},t.prototype.getDataKey=function(){return"records"},t.prototype.getTotalKey=function(){return"total"},t.prototype.getLimit=function(){return 10},t.prototype.getFetchDataParams=function(){var n=this.state.searchParams,r={};return Object.keys(n).filter(function(t){return["start","Start"].some(function(e){return-1!==t.indexOf(e)})||["end","End"].some(function(e){return-1!==t.indexOf(e)})}).forEach(function(t){r[t]=n[t]?"".concat(n[t].format(adhere_util_resource_1.default.Dict.value.ResourceMomentFormat10.value())," ").concat(["start","Start"].some(function(e){return-1!==t.indexOf(e)})?"00:00:00":["end","End"].some(function(e){return-1!==t.indexOf(e)})?"23:59:59":"").trim():null}),Object.keys(n).filter(function(e){return!(e in r)&&dayjs_1.default.isDayjs(n[e])}).forEach(function(e){r[e]=n[e]?n[e].format(adhere_util_resource_1.default.Dict.value.ResourceMomentFormat10.value()).trim():null}),r},t.prototype.getColumns=function(e){return(e||(null==(e=a.prototype.getColumns)?void 0:e.call(this))||[]).map(function(e){return __assign({},e)})},t.prototype.getTableColumns=function(){var l=this,e=a.prototype.getTableColumns.call(this),t=(!this.hasOptionColumnFixed()||!(t=e.find(function(e){return e.dataIndex===(l.getOptionsColumnDataIndex()||"_options")}))||"fixed"in t||t.fixed||(t.fixed="right"),!this.hasNumberColumnFixed()||!(t=e.find(function(e){return"_number"===e.dataIndex}))||"fixed"in t||t.fixed||(t.fixed="left"),e.find(function(e){return e.dataIndex===(l.getLinkColumnDataIndex()||"_linkColumn")}));return t&&("ellipsis"in t||(t.ellipsis=!1),"align"in t||(t.align="left")),e.map(function(e){return __assign(__assign({},e),{align:![l.getLinkColumnDataIndex()||"_linkColumn"].includes(e.dataIndex)&&"align"in e&&e.align?e.align:"center"})}).map(function(e){function o(n){var e=n.$search,t=__rest(n,["$search"]),r=l.assignSearchConfig(e,t),e=r.showColumnHeader,a=__assign({},n),i=r.dataIndex||n.dataIndex;return i&&!["_number",l.getOptionsColumnDataIndex()].includes(i)&&e&&(a=__assign(__assign({},a),(0,adhere_ui_tableheadsearch_1.default)(function(e){var t=e.confirm,n=r.type;return react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headersearchwrap")},react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headersearchwrap-main")},l.renderGridSearchFormGroupDataItem(n,{searchConfig:r,column:a,dataIndex:i})),react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headersearchwrap-footer")},react_1.default.createElement(antd_1.Button,{size:"small",onClick:function(){var e={};"rangePicker"===n?(r.startName&&(e[r.startName]=null),r.endName&&(e[r.endName]=null)):e[i]=void 0,l.setState(e,function(){return l.onSearch().then(function(){return t()})})}},adhere_util_intl_1.default.v("重置")),react_1.default.createElement(antd_1.Button,{size:"small",type:"primary",onClick:function(){return l.search().then(function(){return t()})}},adhere_util_intl_1.default.v("确定"))))},l.getTableColumnSearchHeaderIcon(a)))),n.children&&Array.isArray(n.children)&&n.children.forEach(function(e,t){n.children[t]=o(e)}),a}return o(e)}).map(function(e){function i(n){var e=n.$tip,t=n.title,r=n.renderTip,a=t,r=(e&&(a=null!=(r=null==r?void 0:r(e))?r:react_1.default.createElement(ColumnTipTitle_1.default,{tip:e,title:t})),__assign(__assign({},n),{title:a}));return n.children&&Array.isArray(n.children)&&n.children.forEach(function(e,t){n.children[t]=i(e)}),r}return i(e)})},t.prototype.getTableColumnSearchHeaderIcon=function(e){var t,n=e.$search,e=e.dataIndex;return null!=(t=null==(t=this.state)?void 0:t.searchParams)&&t[(null==n?void 0:n.dataIndex)||e]?react_1.default.createElement("div",null,react_1.default.createElement("div",null,react_1.default.createElement(icons_1.SearchOutlined,{style:{fontSize:14}})),react_1.default.createElement("div",{style:{height:2,background:"#ccc"}})):react_1.default.createElement(icons_1.SearchOutlined,null)},t.prototype.getOptionsColumnDataIndex=function(){return"_options"},t.prototype.getLinkColumnDataIndex=function(){return"_linkColumn"},t.prototype.getPagination=function(){var r=this;return __assign(__assign({},a.prototype.getPagination.call(this)),{showTotal:function(e){var t=(r.state.page-1)*r.state.limit+1,n=r.state.page*r.state.limit;return adhere_util_intl_1.default.v("当前 {page}-{pageSize}/共 {total}条",{page:t,pageSize:n<e?n:e,total:e})}})},t.prototype.getGridSearchFormColgroup=function(){return{columnCount:3,colgroup:[,"auto",,"auto",,"auto"]}},t.prototype.getGridSearchFormRowCount=function(){return 1},t.prototype.getGridSearchFormProps=function(){return{rowCount:this.getGridSearchFormRowCount()}},t.prototype.getGridSearchFormGroupParams=function(){return[[__assign(__assign({name:"g1"},this.getGridSearchFormColgroup()),{data:this.getGridSearchFormGroupDataByColumnConfig()})],{},this.getGridSearchFormProps()]},t.prototype.getSearchLabelSymbol=function(e){return!("isShowLabelSymbol"in e&&!e.isShowLabelSymbol)?react_1.default.createElement("span",null,"："):null},t.prototype.getGridSearchFormGroupDataByColumnConfig=function(){var s=this,d=[],h=function(e){e.filter(function(e){return"$search"in e&&!!e.$search.visible}).forEach(function(e){var t=e.$search,n=e.$tip,r=e.renderTip,a=__rest(e,["$search","$tip","renderTip"]),i=s.assignSearchConfig(t,a),o=(null==i?void 0:i.type)||"input",l=i.dataIndex||e.dataIndex,u=t.title||e.title,c=u;n&&(c=null!=(r=null==r?void 0:r(n))?r:react_1.default.createElement(ColumnTipTitle_1.default,{tip:n,title:u})),d.push({key:l,sort:t.sort,label:react_1.default.createElement(Label,__assign({},null!=(r=t.labelAttrs)?r:{}),adhere_util_1.default.isFunction(c)?c():c,s.getSearchLabelSymbol(t)),value:adhere_ui_conditionalrender_1.default.conditionalRender({conditional:!s.hasAuthority||(null==(n=s.hasAuthority)?void 0:n.call(s,i.authority)),match:react_1.default.createElement(Value,__assign({},null!=(u=t.valueAttrs)?u:{}),s.renderGridSearchFormGroupDataItem(o,{searchConfig:i,column:a,dataIndex:l})),noMatch:t.renderNoAuthority?react_1.default.createElement(Value,__assign({},null!=(r=t.valueAttrs)?r:{}),null==(c=null==t?void 0:t.renderNoAuthority)?void 0:c.call(t)):null})}),e.children&&Array.isArray(e.children)&&h(e.children)})},e=(h((null==(e=null==this?void 0:this.getColumns)?void 0:e.call(this,(null==(e=a.prototype.getColumns)?void 0:e.call(this))||[]))||[]),(null==(e=null==d?void 0:d.filter)?void 0:e.call(d,function(e){return!!e.value}))||[]),t=e.filter(function(e){return"sort"in e&&null!==e.sort&&void 0!==e.sort}).sort(function(e,t){return e.sort-t.sort}),n=e.filter(function(e){return!("sort"in e)||null===e.sort||void 0===e.sort||"number"!=typeof e.sort});return t.forEach(function(e){n.splice(e.sort-1,0,e)}),n},t.prototype.assignSearchConfig=function(e,t){t={type:"input",visible:!0,showColumnHeader:!0,props:{},labelAttrs:{},valueAttrs:{},authority:[],renderNoAuthority:function(){return null},dataIndex:t.dataIndex,title:t.title,dictName:"",renderChildren:function(){return null},render:function(){return null},startName:"",endName:""};return __assign(__assign({},t),null!=e?e:{})},t.prototype.renderSearchBarCollapseControl=function(){var e=__spreadArray([],this.getGridSearchFormGroupParams(),!0);return e[0][0].data.length>e[0][0].columnCount?a.prototype.renderSearchBarCollapseControl.call(this):null},t.prototype.renderSearchForm=function(){var e=!0;return(e=this.getTableColumnsAll?this.getTableColumnsAll().some(function(e){return"$search"in e&&"visible"in e.$search&&e.$search.visible}):e)?this.renderGridSearchFormGroup.apply(this,this.getGridSearchFormGroupParams()):null},t.prototype.renderSearchFormToolBarItems=function(e){var t,n,r=this,e=__spreadArray([],e||[],!0);return this.hasAdvancedSearch()&&this.hasAdvancedSearchPanel&&this.state.expand&&(t=react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:!this.advancedSearchConfig.renderSearchButton,noMatch:function(){return r.advancedSearchConfig.renderSearchButton(function(){return r.setState({advancedSearchPanelCollapse:!0})})}},function(){return react_1.default.createElement(antd_1.Button,{icon:react_1.default.createElement(icons_1.FilterOutlined,null),type:"primary",onClick:function(){return r.setState({advancedSearchPanelCollapse:!0})}},adhere_util_intl_1.default.v("高级搜索"))}),this.advancedSearchConfig.insertSearchButton?this.advancedSearchConfig.insertSearchButton(e,t):-1!==(n=e.findIndex(function(e){return"$$typeof"in e&&"key"in e&&"reset"===e.key}))&&e.splice(n+1,0,t)),e},t.prototype.renderSearchFormToolBarDefaultPanel=function(){var e,t=this.state.expand;return void 0!==t&&t?null:((t=__spreadArray([],this.getGridSearchFormGroupParams(),!0))[0][0].data.length>t[0][0].columnCount&&(t[0][0].columnCount=2,"horizontal"===(e=t[1].layout)?t[0][0].colgroup=[,"auto",,"auto"]:"vertical"===e&&(t[0][0].colgroup=["auto","auto"]),t[2].rowCount=1),this.renderGridSearchFormGroup.apply(this,t))},t.prototype.renderSearchFooterItems=function(e){e=__spreadArray([],e||[],!0);return this.renderSearchFooterItemsImpl(e).map(function(e){return"$$typeof"in e?e:e.value})},t.prototype.getSearchFooterItemsEllipsisCount=function(){return 5},t.prototype.isSearchFooterItemEllipsesShowOnlyOneAfterCollapsing=function(){return!1},t.prototype.renderSearchFooterItemsImpl=function(e){var t,n,r=__spreadArray([],e,!0),a=null!=(a=this.getSearchFooterItemsEllipsisCount())?a:5;return e.length>=(a=a<=0?5:a)&&(n=(t=this.isSearchFooterItemEllipsesShowOnlyOneAfterCollapsing())?1:a-1,e.length)&&e.length>=a&&(r=__spreadArray(__spreadArray([],e.slice(0,t?1:a-1),!0),[{key:"menu",value:react_1.default.createElement(adhere_ui_anthoc_1.Dropdown,{key:"menu",menu:{items:e.slice(n).map(function(e){return{key:e.key,label:e.value}})}},react_1.default.createElement(antd_1.Button,null,react_1.default.createElement(icons_1.EllipsisOutlined,null)))}],!1)),__spreadArray(__spreadArray([],r,!0),[this.renderTableReload&&!(null==(t=this.renderTableReload)||!t.call(this))&&react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headeritem")},this.renderTableReload()),this.renderTableDensitySetting&&!(null==(a=this.renderTableDensitySetting)||!a.call(this))&&react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headeritem")},this.renderTableDensitySetting()),this.renderColumnSetting&&!(null==(e=this.renderColumnSetting)||!e.call(this))&&react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headeritem")},this.renderColumnSetting()),this.renderExportExcel&&!(null==(n=this.renderExportExcel)||!n.call(this))&&react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-headeritem")},this.renderExportExcel())],!1).filter(function(e){return!!e})},t.prototype.renderGridSearchFormGroupDataItem=function(e,t){var a=this,n=t.searchConfig,r=t.column,i=t.dataIndex;return null==(t=new Map([["dict",function(e){var t=e.searchConfig,n=e.column,r=e.dataIndex,e=adhere_ui_fieldgeneratortodict_1.default.Components[t.dictName];return react_1.default.createElement(e,__assign({value:a.state[r],onChange:function(e){return a.onSelectChange(r,e)}},Object.assign({placeholder:null!=(e=t.title)?e:n.title},{dropdownStyle:{zIndex:1051},popupStyle:{zIndex:1051}},null!=(e=t.props)?e:{})))}],["custom",function(e){var t,n=e.searchConfig,r=e.column,e=e.dataIndex;return null==(t=null==n?void 0:n.render)?void 0:t.call(n,{searchConfig:n,column:r,dataIndex:e})}],["input",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(antd_1.Input,__assign({value:a.state[n],onChange:function(e){return a.onInputChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["textArea",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(TextArea,__assign({value:a.state[n],onChange:function(e){return a.onInputChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["inputNumber",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(antd_1.InputNumber,__assign({value:a.state[n],onChange:function(e){return a.onSelectChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["inputNumberDecimal1",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(adhere_ui_anthoc_1.InputNumberDecimal1,__assign({value:a.state[n],onChange:function(e){return a.onSelectChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["inputNumberDecimal2",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(adhere_ui_anthoc_1.InputNumberDecimal2,__assign({value:a.state[n],onChange:function(e){return a.onSelectChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["inputNumberInteger",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(adhere_ui_anthoc_1.InputNumberInteger,__assign({value:a.state[n],onChange:function(e){return a.onSelectChange(n,e)},placeholder:null!=(e=t.title)?e:r.title},null!=(e=t.props)?e:{}))}],["datePicker",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(adhere_ui_anthoc_1.DatePicker,__assign({value:a.state[n],onChange:function(e){var t;a.setState(((t={})[n]=e||null,t))}},null!=(e=t.props)?e:{}))}],["timePicker",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(adhere_ui_anthoc_1.TimePicker,__assign({value:a.state[n],onChange:function(e){var t;a.setState(((t={})[n]=e||null,t))}},null!=(e=t.props)?e:{}))}],["rangePicker",function(e){var e=e.searchConfig,t=e.startName,n=e.endName;return react_1.default.createElement(adhere_ui_anthoc_1.RangePicker,__assign({value:[a.state[t],a.state[n]],onChange:function(e){a.onDateTimeRangeChange([t,n],e)}},null!=(e=e.props)?e:{}))}],["slider",function(e){var t=e.searchConfig,n=e.dataIndex;return react_1.default.createElement(antd_1.Slider,__assign({value:a.state[n],onChange:function(e){return a.onSelectChange(n,e)}},null!=(e=t.props)?e:{}))}],["sliderRange",function(e){var e=e.searchConfig;return react_1.default.createElement(antd_1.Slider,__assign({range:!0,value:a.state[i],onChange:function(e){return a.onSelectChange(i,e)}},null!=(e=e.props)?e:{}))}],["rate",function(e){var e=e.searchConfig;return react_1.default.createElement(antd_1.Rate,__assign({value:a.state[i],onChange:function(e){return a.onSelectChange(i,e)}},null!=(e=e.props)?e:{}))}],["switch",function(e){var e=e.searchConfig;return react_1.default.createElement(antd_1.Switch,__assign({value:a.state[i],onChange:function(e){return a.onSelectChange(i,e)}},null!=(e=e.props)?e:{}))}]]).get(e))?void 0:t({searchConfig:n,column:r,dataIndex:i})},t.prototype.renderGridSearchFormGroup=function(t,e,n){var r,a=this,i=(0,lodash_merge_1.default)({layout:"horizontal",density:"middle"},null!=e?e:{}),e=(null!=(e=null==n?void 0:n.advancedSearch)&&e.onAfterClose&&(r=n.advancedSearch.onAfterClose,n.advancedSearch.onAfterClose=function(){r(),a.setState({advancedSearchPanelCollapse:!1})}),this.advancedSearchConfig=(0,lodash_merge_1.default)({rowCount:"auto",showStrategy:"remaining",renderTitleLabel:null,renderCollapse:null,renderSearchButton:null,insertSearchButton:null,advancedSearch:{className:"",style:{},width:"60%",mask:!0,zIndex:19999,time:300,direction:"right",collapse:!0,onBeforeShow:function(){},onBeforeClose:function(){},onAfterShow:function(){},onAfterClose:function(){a.setState({advancedSearchPanelCollapse:!1})},getPopupContainer:function(){return document.body}}},null!=n?n:{}),react_1.default.createElement(adhere_ui_configprovider_1.default.Context.Consumer,null,function(e){e=e.media;return renderGridSearchFormGroup(t,i,e)}));if(this.advancedSearchConfig&&"auto"!==this.advancedSearchConfig.rowCount||this.advancedSearchConfig&&!("rowCount"in this.advancedSearchConfig)&&this.hasAdvancedSearch()||this.advancedSearchConfig&&"rowCount"in this.advancedSearchConfig&&!this.advancedSearchConfig.rowCount||!this.advancedSearchConfig&&this.hasAdvancedSearch()){var n=adhere_ui_tablegridlayout_1.default.getRenderDetail(t,i),o=n.rowCount,l=n.detail;if(o>this.advancedSearchConfig.rowCount){for(var u=[],c=[],s=this.advancedSearchConfig.rowCount,d=0;0!==s;){var h=t[d],p=l[d];p.rowCount<=s?(u.push(__assign({},h)),s-=p.rowCount):(p=p.detail.slice(0,s),u.push(__assign(__assign({},h),{data:h.data.slice(p[0].startIndex,p[p.length-1].endIndex+1)})),c.push(__assign(__assign({},h),{data:h.data.slice(p[p.length-1].endIndex+1)})),s=0),d+=1}for(var f=d;f<t.length;f++)c.push(__assign({},t[f]));return this.hasAdvancedSearchPanel=!0,this.advancedSearchConfig.advancedSearch.collapse=this.state.advancedSearchPanelCollapse,react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-grid-search-form-group-wrap")},react_1.default.createElement(adhere_ui_configprovider_1.default.Context.Consumer,null,function(e){e=e.media;return renderGridSearchFormGroup(u,i,e)}),react_1.default.createElement(AdvancedSearchPanel_1.default,{groupData:t,tableGridLayoutConfig:i,remainingGroupData:c,advancedSearchConfig:this.advancedSearchConfig,onSearch:function(){return new Promise(function(e){a.search().then(function(){return e()})})},onReset:function(){return a.onClear()},onCollapse:function(e){return a.setState({advancedSearchPanelCollapse:e})}},function(e){return a.renderAdvancedSearchPanel(e)}))}}return this.hasAdvancedSearchPanel=!1,react_1.default.createElement("div",{className:"".concat(_selectorPrefix,"-grid-search-form-group-wrap")},e)},t.prototype.renderAdvancedSearchPanel=function(e){return null},t.prototype.renderOptionColumn=function(e,t){return e.map(function(e){return e.value}).filter(function(e){return!!e})},(e=t).displayName="",e;function t(e){var e=a.call(this,e)||this,t=(e.pathname=e.getPathName(),{search:{},page:1,limit:e.getLimit()}),n=("openSearchParamsMemory"in(null!=(n=e.props)?n:{})&&!("openSearchParamsMemory"in(null!=(n=e.props)?n:{})&&e.props.openSearchParamsMemory)||(t=e.initSearchAndPaginParams()),e.state=__assign(__assign(__assign({},e.state),t.search),{page:t.page,limit:t.limit,searchParams:__assign(__assign({},e.state.searchParams),t.search)}),e.state=__assign(__assign(__assign({},e.state),e.getDateState((0,omit_js_1.default)(e.state,["searchParams"]))),{searchParams:__assign(__assign({},e.state.searchParams),e.getDateState(e.state.searchParams)),advancedSearchPanelCollapse:!1}),e.hasAdvancedSearchPanel=!1,e.advancedSearchConfig=null,routeListen_1.default.getCode());return n&&n(),e}};
//# sourceMappingURL=ProTableFactory.js.map
