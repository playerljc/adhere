{"version":3,"file":"SearchEditableCellFactory.js","sources":["Editable/SearchEditableCellFactory.js"],"sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar dayjs_1 = __importDefault(require(\"dayjs\"));\r\nfunction default_1(SuperClass) {\r\n    return /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1(props) {\r\n            var _this = _super.call(this, props) || this;\r\n            /**\r\n             * valueToFormItemValueMap\r\n             * @description 值和表单控件值之间的转换，现在只涉及到时间控件\r\n             */\r\n            _this.valueToFormItemValueMap = new Map([\r\n                [\r\n                    'rangePicker',\r\n                    function (_a) {\r\n                        var record = _a.record, dataIndex = _a.dataIndex;\r\n                        var value = record === null || record === void 0 ? void 0 : record[dataIndex];\r\n                        return Array.isArray(value) && value.length === 2\r\n                            ? [(0, dayjs_1.default)(value[0]), (0, dayjs_1.default)(value[1])]\r\n                            : [(0, dayjs_1.default)(), (0, dayjs_1.default)()];\r\n                    },\r\n                ],\r\n                [\r\n                    'datePicker',\r\n                    function (_a) {\r\n                        var record = _a.record, dataIndex = _a.dataIndex;\r\n                        var value = record === null || record === void 0 ? void 0 : record[dataIndex];\r\n                        return (0, dayjs_1.default)(value);\r\n                    },\r\n                ],\r\n                [\r\n                    'timePicker',\r\n                    function (_a) {\r\n                        var record = _a.record, dataIndex = _a.dataIndex;\r\n                        var value = record === null || record === void 0 ? void 0 : record[dataIndex];\r\n                        return (0, dayjs_1.default)(value);\r\n                    },\r\n                ],\r\n            ]);\r\n            _this.state = __assign(__assign({}, _this.state), { activeValue: '' });\r\n            _this.cellConfigReducers = __spreadArray(__spreadArray([], _this.cellConfigReducers, true), [_this.cellEditableReducer], false);\r\n            return _this;\r\n        }\r\n        /**\r\n         * onTableRowComponentReducers\r\n         * @param columns\r\n         */\r\n        class_1.prototype.onTableRowComponentReducers = function (columns) {\r\n            var existsEditable = columns.some(function (column) { var _a; return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable); });\r\n            if (existsEditable) {\r\n                return __spreadArray(__spreadArray([], this.tableRowComponentReducers, true), ['useEditableRow'], false);\r\n            }\r\n            return this.tableRowComponentReducers;\r\n        };\r\n        /**\r\n         * onTableCellComponentReducers\r\n         * @param columns\r\n         */\r\n        class_1.prototype.onTableCellComponentReducers = function (columns) {\r\n            var existsEditor = columns.some(function (column) { var _a; return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable); });\r\n            if (existsEditor) {\r\n                return __spreadArray(__spreadArray([], this.tableCellComponentReducers, true), ['useEditableCell'], false);\r\n            }\r\n            return this.tableCellComponentReducers;\r\n        };\r\n        class_1.prototype.onEditorRow = function (params) {\r\n            return {\r\n                editable: false,\r\n            };\r\n        };\r\n        class_1.prototype.onEditorCell = function (params) { };\r\n        /**\r\n         * cellEditableReducer\r\n         * @description 可编辑单元格的onCell处理\r\n         * @param params\r\n         */\r\n        class_1.prototype.cellEditableReducer = function (params) {\r\n            var _a;\r\n            var rowIndex = params.rowIndex, column = params.column, record = params.record;\r\n            // 如果设置了$editable则调用onEditorCell方法对每个cell进行props注入\r\n            if ('$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable) && this.onEditorCell) {\r\n                this.onEditorCell({\r\n                    rowIndex: rowIndex,\r\n                    editorConfig: column.$editable,\r\n                    record: __assign({}, record),\r\n                });\r\n                return column;\r\n            }\r\n            return column;\r\n        };\r\n        /**\r\n         * valueToFormItemValue\r\n         * @description 值和表单值的转换\r\n         */\r\n        class_1.prototype.valueToFormItemValue = function (_a) {\r\n            var type = _a.type, record = _a.record, dataIndex = _a.dataIndex;\r\n            var item = this.valueToFormItemValueMap.get(type);\r\n            return item ? item === null || item === void 0 ? void 0 : item({ record: record, dataIndex: dataIndex }) : record === null || record === void 0 ? void 0 : record[dataIndex];\r\n        };\r\n        /**\r\n         * setActiveValue\r\n         * @param activeValue\r\n         */\r\n        class_1.prototype.setActiveValue = function (activeValue) {\r\n            var _this = this;\r\n            return new Promise(function (resolve) {\r\n                _this.setState({\r\n                    activeValue: activeValue,\r\n                }, function () { return resolve(); });\r\n            });\r\n        };\r\n        /**\r\n         * getActiveValue\r\n         */\r\n        class_1.prototype.getActiveValue = function () {\r\n            return this.state.activeValue;\r\n        };\r\n        return class_1;\r\n    }(SuperClass));\r\n}\r\nexports.default = default_1;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","ar","l","slice","concat","__importDefault","mod","__esModule","default","dayjs_1","defineProperty","exports","value","require","default_1","SuperClass","class_1","_super","onTableRowComponentReducers","columns","some","column","_a","$editable","editable","tableRowComponentReducers","onTableCellComponentReducers","tableCellComponentReducers","onEditorRow","params","onEditorCell","cellEditableReducer","rowIndex","record","editorConfig","valueToFormItemValue","type","dataIndex","item","valueToFormItemValueMap","get","setActiveValue","activeValue","_this","Promise","resolve","setState","getActiveValue","state","props","Map","isArray","cellConfigReducers"],"mappings":"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"}