{"version":3,"file":"SearchEditableCellFactory.js","sources":["Editable/SearchEditableCellFactory.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/esnext.map.delete-all.js\");\n\nrequire(\"core-js/modules/esnext.map.every.js\");\n\nrequire(\"core-js/modules/esnext.map.filter.js\");\n\nrequire(\"core-js/modules/esnext.map.find.js\");\n\nrequire(\"core-js/modules/esnext.map.find-key.js\");\n\nrequire(\"core-js/modules/esnext.map.includes.js\");\n\nrequire(\"core-js/modules/esnext.map.key-of.js\");\n\nrequire(\"core-js/modules/esnext.map.map-keys.js\");\n\nrequire(\"core-js/modules/esnext.map.map-values.js\");\n\nrequire(\"core-js/modules/esnext.map.merge.js\");\n\nrequire(\"core-js/modules/esnext.map.reduce.js\");\n\nrequire(\"core-js/modules/esnext.map.some.js\");\n\nrequire(\"core-js/modules/esnext.map.update.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.promise.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar moment_1 = tslib_1.__importDefault(require(\"moment\"));\n\nfunction default_1(SuperClass) {\n  return (\n    /** @class */\n    function (_super) {\n      tslib_1.__extends(class_1, _super);\n\n      function class_1(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * valueToFormItemValueMap\n         * @description 值和表单控件值之间的转换，现在只涉及到时间控件\n         */\n\n\n        _this.valueToFormItemValueMap = new Map([['rangePicker', function (_a) {\n          var record = _a.record,\n              dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return Array.isArray(value) && value.length === 2 ? [(0, moment_1.default)(value[0]), (0, moment_1.default)(value[1])] : [(0, moment_1.default)(), (0, moment_1.default)()];\n        }], ['datePicker', function (_a) {\n          var record = _a.record,\n              dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return (0, moment_1.default)(value);\n        }], ['timePicker', function (_a) {\n          var record = _a.record,\n              dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return (0, moment_1.default)(value);\n        }]]);\n        _this.state = tslib_1.__assign(tslib_1.__assign({}, _this.state), {\n          activeValue: ''\n        });\n        _this.cellConfigReducers = tslib_1.__spreadArray(tslib_1.__spreadArray([], _this.cellConfigReducers, true), [_this.cellEditableReducer], false);\n        return _this;\n      }\n      /**\n       * onTableRowComponentReducers\n       * @param columns\n       */\n\n\n      class_1.prototype.onTableRowComponentReducers = function (columns) {\n        var existsEditable = columns.some(function (column) {\n          var _a;\n\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n\n        if (existsEditable) {\n          return tslib_1.__spreadArray(tslib_1.__spreadArray([], this.tableRowComponentReducers, true), ['useEditableRow'], false);\n        }\n\n        return this.tableRowComponentReducers;\n      };\n      /**\n       * onTableCellComponentReducers\n       * @param columns\n       */\n\n\n      class_1.prototype.onTableCellComponentReducers = function (columns) {\n        var existsEditor = columns.some(function (column) {\n          var _a;\n\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n\n        if (existsEditor) {\n          return tslib_1.__spreadArray(tslib_1.__spreadArray([], this.tableCellComponentReducers, true), ['useEditableCell'], false);\n        }\n\n        return this.tableCellComponentReducers;\n      };\n\n      class_1.prototype.onEditorRow = function (params) {\n        return {\n          editable: false\n        };\n      };\n\n      class_1.prototype.onEditorCell = function (params) {};\n      /**\n       * cellEditableReducer\n       * @description 可编辑单元格的onCell处理\n       * @param params\n       */\n\n\n      class_1.prototype.cellEditableReducer = function (params) {\n        var _a;\n\n        var rowIndex = params.rowIndex,\n            column = params.column,\n            record = params.record; // 如果设置了$editable则调用onEditorCell方法对每个cell进行props注入\n\n        if ('$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable) && this.onEditorCell) {\n          this.onEditorCell({\n            rowIndex: rowIndex,\n            editorConfig: column.$editable,\n            record: tslib_1.__assign({}, record)\n          });\n          return column;\n        }\n\n        return column;\n      };\n      /**\n       * valueToFormItemValue\n       * @description 值和表单值的转换\n       */\n\n\n      class_1.prototype.valueToFormItemValue = function (_a) {\n        var type = _a.type,\n            record = _a.record,\n            dataIndex = _a.dataIndex;\n        var item = this.valueToFormItemValueMap.get(type);\n        return item ? item === null || item === void 0 ? void 0 : item({\n          record: record,\n          dataIndex: dataIndex\n        }) : record === null || record === void 0 ? void 0 : record[dataIndex];\n      };\n      /**\n       * setActiveValue\n       * @param activeValue\n       */\n\n\n      class_1.prototype.setActiveValue = function (activeValue) {\n        var _this = this;\n\n        return new Promise(function (resolve) {\n          _this.setState({\n            activeValue: activeValue\n          }, function () {\n            return resolve();\n          });\n        });\n      };\n      /**\n       * getActiveValue\n       */\n\n\n      class_1.prototype.getActiveValue = function () {\n        return this.state.activeValue;\n      };\n\n      return class_1;\n    }(SuperClass)\n  );\n}\n\nexports.default = default_1;"],"names":["require","Object","defineProperty","exports","value","tslib_1","moment_1","__importDefault","default_1","SuperClass","_super","__extends","class_1","prototype","onTableRowComponentReducers","columns","some","column","_a","$editable","editable","__spreadArray","this","tableRowComponentReducers","onTableCellComponentReducers","tableCellComponentReducers","onEditorRow","params","onEditorCell","cellEditableReducer","rowIndex","record","editorConfig","__assign","valueToFormItemValue","type","dataIndex","item","valueToFormItemValueMap","get","setActiveValue","activeValue","_this","Promise","resolve","setState","getActiveValue","state","props","call","Map","Array","isArray","length","default","cellConfigReducers"],"mappings":"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"}