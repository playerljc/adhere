{"version":3,"file":"SearchEditableCellFactory.js","sources":["Editable/SearchEditableCellFactory.js"],"sourcesContent":["\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = void 0 && (void 0).__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar dayjs_1 = __importDefault(require(\"dayjs\"));\nfunction default_1(SuperClass) {\n  return (/** @class */function (_super) {\n      __extends(class_1, _super);\n      function class_1(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * valueToFormItemValueMap\n         * @description 值和表单控件值之间的转换，现在只涉及到时间控件\n         */\n        _this.valueToFormItemValueMap = new Map([['rangePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return Array.isArray(value) && value.length === 2 ? [(0, dayjs_1.default)(value[0]), (0, dayjs_1.default)(value[1])] : [(0, dayjs_1.default)(), (0, dayjs_1.default)()];\n        }], ['datePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return (0, dayjs_1.default)(value);\n        }], ['timePicker', function (_a) {\n          var record = _a.record,\n            dataIndex = _a.dataIndex;\n          var value = record === null || record === void 0 ? void 0 : record[dataIndex];\n          return (0, dayjs_1.default)(value);\n        }]]);\n        _this.state = __assign(__assign({}, _this.state), {\n          activeValue: ''\n        });\n        _this.cellConfigReducers = __spreadArray(__spreadArray([], _this.cellConfigReducers, true), [_this.cellEditableReducer], false);\n        return _this;\n      }\n      /**\n       * onTableRowComponentReducers\n       * @param columns\n       */\n      class_1.prototype.onTableRowComponentReducers = function (columns) {\n        var existsEditable = columns.some(function (column) {\n          var _a;\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n        if (existsEditable) {\n          return __spreadArray(__spreadArray([], this.tableRowComponentReducers, true), ['useEditableRow'], false);\n        }\n        return this.tableRowComponentReducers;\n      };\n      /**\n       * onTableCellComponentReducers\n       * @param columns\n       */\n      class_1.prototype.onTableCellComponentReducers = function (columns) {\n        var existsEditor = columns.some(function (column) {\n          var _a;\n          return '$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable);\n        });\n        if (existsEditor) {\n          return __spreadArray(__spreadArray([], this.tableCellComponentReducers, true), ['useEditableCell'], false);\n        }\n        return this.tableCellComponentReducers;\n      };\n      class_1.prototype.onEditorRow = function (params) {\n        return {\n          editable: false\n        };\n      };\n      class_1.prototype.onEditorCell = function (params) {};\n      /**\n       * cellEditableReducer\n       * @description 可编辑单元格的onCell处理\n       * @param params\n       */\n      class_1.prototype.cellEditableReducer = function (params) {\n        var _a;\n        var rowIndex = params.rowIndex,\n          column = params.column,\n          record = params.record;\n        // 如果设置了$editable则调用onEditorCell方法对每个cell进行props注入\n        if ('$editable' in column && ((_a = column.$editable) === null || _a === void 0 ? void 0 : _a.editable) && this.onEditorCell) {\n          this.onEditorCell({\n            rowIndex: rowIndex,\n            editorConfig: column.$editable,\n            record: __assign({}, record)\n          });\n          return column;\n        }\n        return column;\n      };\n      /**\n       * valueToFormItemValue\n       * @description 值和表单值的转换\n       */\n      class_1.prototype.valueToFormItemValue = function (_a) {\n        var type = _a.type,\n          record = _a.record,\n          dataIndex = _a.dataIndex;\n        var item = this.valueToFormItemValueMap.get(type);\n        return item ? item === null || item === void 0 ? void 0 : item({\n          record: record,\n          dataIndex: dataIndex\n        }) : record === null || record === void 0 ? void 0 : record[dataIndex];\n      };\n      /**\n       * setActiveValue\n       * @param activeValue\n       */\n      class_1.prototype.setActiveValue = function (activeValue) {\n        var _this = this;\n        return new Promise(function (resolve) {\n          _this.setState({\n            activeValue: activeValue\n          }, function () {\n            return resolve();\n          });\n        });\n      };\n      /**\n       * getActiveValue\n       */\n      class_1.prototype.getActiveValue = function () {\n        return this.state.activeValue;\n      };\n      return class_1;\n    }(SuperClass)\n  );\n}\nexports.default = default_1;"],"names":["__extends","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","ar","l","slice","concat","__importDefault","mod","__esModule","default","dayjs_1","defineProperty","exports","value","require","default_1","SuperClass","class_1","_super","onTableRowComponentReducers","columns","some","column","_a","$editable","editable","tableRowComponentReducers","onTableCellComponentReducers","tableCellComponentReducers","onEditorRow","params","onEditorCell","cellEditableReducer","rowIndex","record","editorConfig","valueToFormItemValue","type","dataIndex","item","valueToFormItemValueMap","get","setActiveValue","activeValue","_this","Promise","resolve","setState","getActiveValue","state","props","Map","isArray","cellConfigReducers"],"mappings":"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"}