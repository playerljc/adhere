"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};return function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;for(var r=Array(e),n=0,t=0;t<a;t++)for(var l=arguments[t],i=0,s=l.length;i<s;i++,n++)r[n]=l[i];return r},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(require("react")),prop_types_1=__importDefault(require("prop-types")),classnames_1=__importDefault(require("classnames")),antd_1=require("antd"),adhere_ui_flexlayout_1=__importDefault(require("@baifendian/adhere-ui-flexlayout")),adhere_ui_suspense_1=__importDefault(require("@baifendian/adhere-ui-suspense")),adhere_util_intl_1=__importDefault(require("@baifendian/adhere-util-intl")),adhere_ui_conditionalrender_1=__importDefault(require("@baifendian/adhere-ui-conditionalrender")),searchform_1=__importDefault(require("./searchform")),selectorPrefix="adhere-ui-searchtable",Fixed=adhere_ui_flexlayout_1.default.Fixed,Auto=adhere_ui_flexlayout_1.default.Auto,SearchTable=function(t){function i(e){var n=t.call(this,e)||this;return n.onTableChange=function(e,t,a){var r;n.setState(((r={})[n.getOrderFieldProp()]=a.field,r[n.getOrderProp()]=a.order,r),function(){a.order&&(n.fetchData(),n.onSubTableChange(e,t,a))})},n.onClear=function(){n.setState({page:1,limit:10},function(){n.clear().then(function(){n.fetchData()})})},n.state={page:1,limit:10,expand:!0},n}return __extends(i,t),i.prototype.getPagination=function(){var a=this;return{onChange:function(e,t){a.setState({page:e,limit:t},function(){a.fetchData()})},onShowSizeChange:function(e,t){a.setState({page:e,limit:t},function(){a.fetchData()})},total:this.getTotal(),current:this.state.page,pageSize:this.state.limit,showQuickJumper:!0,showTotal:function(e){return adhere_util_intl_1.default.v("当前 {page}-{pageSize}/共 {total}条",{page:a.state.page,pageSize:a.state.limit,total:e})}}},i.prototype.sortOrder=function(e){return this.state[this.getOrderFieldProp()]===e?this.state[this.getOrderProp()]:""},i.prototype.getTableColumns=function(){var e=this.isShowNumber(),t=this.getTableNumberColumnWidth();if(e){var r=null!==(e=this.getNumberGeneratorRule())&&void 0!==e?e:i.NUMBER_GENERATOR_RULE_ALONE,e=this.state,n=e.page,l=e.limit;return[{title:adhere_util_intl_1.default.v("序号"),dataIndex:"number",key:"number",align:"center",width:null!=t?t:80,render:function(e,t,a){return react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:r===i.NUMBER_GENERATOR_RULE_ALONE,noMatch:function(){return react_1.default.createElement("span",null,(n-1)*l+(a+1))}},function(){return react_1.default.createElement("span",null,a+1)})}}].concat(this.getColumns())}return this.getColumns()},i.prototype.renderSearchFooter=function(){var e=this,t=this.renderSearchFooterItems()||[];return react_1.default.createElement("div",{className:selectorPrefix+"-SearchFooterWrapper"},react_1.default.createElement(antd_1.Button,{className:selectorPrefix+"-SearchFooterItem",type:"primary",icon:react_1.default.createElement("i",{className:"iconfont iconsousuo"}),onClick:function(){e.setState({page:1},function(){e.onSearch()})}},adhere_util_intl_1.default.v("查询")),react_1.default.createElement(antd_1.Button,{className:selectorPrefix+"-SearchFooterItem",onClick:this.onClear},adhere_util_intl_1.default.v("重置")),t.map(function(e){return react_1.default.createElement("div",{className:selectorPrefix+"-SearchFooterItem"},e)}))},i.prototype.renderInner=function(){var e=this.props,t=e.className,a=e.style,r=e.tableClassName,n=e.tableStyle,l=e.searchClassName,e=e.searchStyle;return react_1.default.createElement(adhere_ui_flexlayout_1.default,{direction:"vertical",className:classnames_1.default.apply(void 0,__spreadArrays([selectorPrefix],(t||"").split(" "))),style:__assign({},a||{})},react_1.default.createElement(Fixed,{className:classnames_1.default.apply(void 0,__spreadArrays([selectorPrefix+"-SearchWrapper"],(l||"").split(" "))),style:__assign({},e||{})},react_1.default.createElement(adhere_ui_flexlayout_1.default,null,react_1.default.createElement(Fixed,null,this.renderSearchForm()),react_1.default.createElement(Fixed,null,this.renderSearchFooter()))),react_1.default.createElement(Auto,{className:classnames_1.default.apply(void 0,__spreadArrays([selectorPrefix+"-TableWrapper"],(r||"").split(" "))),style:__assign({},n||{})},react_1.default.createElement(antd_1.Table,{rowKey:this.getRowKey(),dataSource:this.getData(),columns:this.getTableColumns(),onChange:this.onTableChange,pagination:this.getPagination(),rowSelection:this.getRowSelection()})))},i.SearchForm=searchform_1.default,i.NUMBER_GENERATOR_RULE_ALONE=Symbol(),i.NUMBER_GENERATOR_RULE_CONTINUITY=Symbol(),i}(adhere_ui_suspense_1.default);SearchTable.defaultProps={className:"",style:{},tableClassName:"",tableStyle:{},searchClassName:"",searchStyle:{},isFirst:!0,isFirstLoading:null},SearchTable.propTypes={className:prop_types_1.default.string,style:prop_types_1.default.object,tableClassName:prop_types_1.default.string,tableStyle:prop_types_1.default.object,searchClassName:prop_types_1.default.string,searchStyle:prop_types_1.default.object,reset:prop_types_1.default.bool,firstLoading:prop_types_1.default.node},exports.default=SearchTable;
//# sourceMappingURL=searchtable.js.map
