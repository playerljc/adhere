var __extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var a=Array(e),n=0,t=0;t<r;t++)for(var o=arguments[t],s=0,i=o.length;s<i;s++,n++)a[n]=o[s];return a};import React from"react";import PropTypes from"prop-types";import classNames from"classnames";import{Table as Table,Button as Button}from"antd";import FlexLayout from"@baifendian/adhere-ui-flexlayout";import Suspense from"@baifendian/adhere-ui-suspense";import Intl from"@baifendian/adhere-util-intl";import ConditionalRender from"@baifendian/adhere-ui-conditionalrender";import SearchForm from"./searchform";var selectorPrefix="adhere-ui-searchtable",Fixed=FlexLayout.Fixed,Auto=FlexLayout.Auto,SearchTable=function(t){function s(e){var n=t.call(this,e)||this;return n.onTableChange=function(e,t,r){var a;n.setState(((a={})[n.getOrderFieldProp()]=r.field,a[n.getOrderProp()]=r.order,a),function(){r.order&&(n.fetchData(),n.onSubTableChange(e,t,r))})},n.onClear=function(){n.setState({page:1,limit:10},function(){n.clear().then(function(){n.fetchData()})})},n.state={page:1,limit:10,expand:!0},n}return __extends(s,t),s.prototype.getPagination=function(){var r=this;return{onChange:function(e,t){r.setState({page:e,limit:t},function(){r.fetchData()})},onShowSizeChange:function(e,t){r.setState({page:e,limit:t},function(){r.fetchData()})},total:this.getTotal(),current:this.state.page,pageSize:this.state.limit,showQuickJumper:!0,showTotal:function(e){return Intl.v("当前 {page}-{pageSize}/共 {total}条",{page:r.state.page,pageSize:r.state.limit,total:e})}}},s.prototype.sortOrder=function(e){return this.state[this.getOrderFieldProp()]===e?this.state[this.getOrderProp()]:""},s.prototype.getTableColumns=function(){var e=this.isShowNumber(),t=this.getTableNumberColumnWidth();if(e){var a=null!==(e=this.getNumberGeneratorRule())&&void 0!==e?e:s.NUMBER_GENERATOR_RULE_ALONE,e=this.state,n=e.page,o=e.limit;return[{title:Intl.v("序号"),dataIndex:"number",key:"number",align:"center",width:null!=t?t:80,render:function(e,t,r){return React.createElement(ConditionalRender,{conditional:a===s.NUMBER_GENERATOR_RULE_ALONE,noMatch:function(){return React.createElement("span",null,(n-1)*o+(r+1))}},function(){return React.createElement("span",null,r+1)})}}].concat(this.getColumns())}return this.getColumns()},s.prototype.renderSearchFooter=function(){var e=this,t=this.renderSearchFooterItems()||[];return React.createElement("div",{className:selectorPrefix+"-SearchFooterWrapper"},React.createElement(Button,{className:selectorPrefix+"-SearchFooterItem",type:"primary",icon:React.createElement("i",{className:"iconfont iconsousuo"}),onClick:function(){e.setState({page:1},function(){e.onSearch()})}},Intl.v("查询")),React.createElement(Button,{className:selectorPrefix+"-SearchFooterItem",onClick:this.onClear},Intl.v("重置")),t.map(function(e){return React.createElement("div",{className:selectorPrefix+"-SearchFooterItem"},e)}))},s.prototype.renderInner=function(){var e=this.props,t=e.className,r=e.style,a=e.tableClassName,n=e.tableStyle,o=e.searchClassName,e=e.searchStyle;return React.createElement(FlexLayout,{direction:"vertical",className:classNames.apply(void 0,__spreadArrays([selectorPrefix],(t||"").split(" "))),style:__assign({},r||{})},React.createElement(Fixed,{className:classNames.apply(void 0,__spreadArrays([selectorPrefix+"-SearchWrapper"],(o||"").split(" "))),style:__assign({},e||{})},React.createElement(FlexLayout,null,React.createElement(Fixed,null,this.renderSearchForm()),React.createElement(Fixed,null,this.renderSearchFooter()))),React.createElement(Auto,{className:classNames.apply(void 0,__spreadArrays([selectorPrefix+"-TableWrapper"],(a||"").split(" "))),style:__assign({},n||{})},React.createElement(Table,{rowKey:this.getRowKey(),dataSource:this.getData(),columns:this.getTableColumns(),onChange:this.onTableChange,pagination:this.getPagination(),rowSelection:this.getRowSelection()})))},s.SearchForm=SearchForm,s.NUMBER_GENERATOR_RULE_ALONE=Symbol(),s.NUMBER_GENERATOR_RULE_CONTINUITY=Symbol(),s}(Suspense);SearchTable.defaultProps={className:"",style:{},tableClassName:"",tableStyle:{},searchClassName:"",searchStyle:{},isFirst:!0,isFirstLoading:null},SearchTable.propTypes={className:PropTypes.string,style:PropTypes.object,tableClassName:PropTypes.string,tableStyle:PropTypes.object,searchClassName:PropTypes.string,searchStyle:PropTypes.object,reset:PropTypes.bool,firstLoading:PropTypes.node};export default SearchTable;
//# sourceMappingURL=searchtable.js.map
