{"version":3,"file":"TreeNode.js","sources":["TreeNode.js"],"sourcesContent":["import _AddOutline from \"antd-mobile-icons/es/AddOutline\";\nimport _MinusOutline from \"antd-mobile-icons/es/MinusOutline\";\nimport _Checkbox from \"antd-mobile/es/components/checkbox\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport classNames from 'classnames';\nimport React, { memo, useContext, useMemo } from 'react';\nimport Space from '@baifendian/adhere-ui-space';\nimport { DEFAULT_DISABLED, DEFAULT_SELECTABLE, DEFAULT_TREE_NODE_CHECKABLE } from './Constant';\nimport TreeContext from './TreeContext';\nimport TreeNodeContext from './TreeNodeContext';\nimport useChecked from './useChecked';\nvar selectorPrefix = 'adhere-mobile-ui-tree-node';\n/**\n * TreeNode\n * @description TreeNode\n */\nvar TreeNode = /*#__PURE__*/memo(function (_a) {\n  var _b, _c;\n  var _d, _e, _f;\n  var id = _a.id,\n    level = _a.level,\n    isLeaf = _a.isLeaf,\n    icon = _a.icon,\n    title = _a.title,\n    checkable = _a.checkable,\n    disabled = _a.disabled,\n    selectable = _a.selectable,\n    children = _a.children,\n    titleRender = _a.titleRender;\n  var _g = useContext(TreeContext),\n    setSelectedKeys = _g.setSelectedKeys,\n    setExpandedKeys = _g.setExpandedKeys,\n    setCheckedKeys = _g.setCheckedKeys,\n    selectedKeys = _g.selectedKeys,\n    expandedKeys = _g.expandedKeys,\n    checkedKeys = _g.checkedKeys,\n    rowGap = _g.rowGap,\n    size = _g.size,\n    multiple = _g.multiple,\n    treeCheckable = _g.checkable;\n  var next = useContext(TreeNodeContext).updateParentChecked;\n  // 是否可用\n  var targetDisabled = useMemo(function () {\n    if (disabled === undefined || disabled === null) return DEFAULT_DISABLED;\n    return disabled;\n  }, [disabled]);\n  // 是否可选中\n  var targetSelectable = useMemo(function () {\n    if (selectable === undefined || selectable === null) return DEFAULT_SELECTABLE;\n    return selectable;\n  }, [selectable]);\n  // 是否可勾选\n  var targetCheckable = useMemo(function () {\n    if (checkable === undefined || checkable === null) return DEFAULT_TREE_NODE_CHECKABLE;\n    return checkable;\n  }, [checkable]);\n  var targetChildrenData = useMemo(function () {\n    return children !== null && children !== void 0 ? children : [];\n  }, [children]);\n  var hasChildren = useMemo(function () {\n    return !!targetChildrenData.length;\n  }, [targetChildrenData]);\n  var _h = useChecked(),\n    handleCheck = _h.handleCheck,\n    updateParentChecked = _h.updateParentChecked;\n  // 1\n  //  1.1\n  //    1.1.1\n  //    1.1.2\n  var childrenElement = useMemo(function () {\n    return targetChildrenData.map(function (_treeNodeData) {\n      return /*#__PURE__*/React.createElement(TreeNodeContext.Provider, {\n        value: {\n          updateParentChecked: function (_a) {\n            var key = _a.key,\n              checked = _a.checked,\n              checkedKeys = _a.checkedKeys;\n            updateParentChecked({\n              key: key,\n              checked: checked,\n              checkedKeys: checkedKeys,\n              childrenData: targetChildrenData,\n              parentId: id,\n              next: next\n            });\n          }\n        }\n      }, /*#__PURE__*/React.createElement(TreeNode, __assign({\n        level: level + 1,\n        icon: icon,\n        titleRender: titleRender,\n        id: _treeNodeData.key\n      }, _treeNodeData)));\n    });\n  }, [targetChildrenData]);\n  var checked = useMemo(function () {\n    return checkedKeys().includes(id);\n  }, [checkedKeys(), id]);\n  var isExpanded = expandedKeys().includes(id);\n  var isSelected = selectedKeys().includes(id);\n  /**\n   * onExpanded\n   */\n  function onExpanded() {\n    if (isExpanded) {\n      // 关闭\n      setExpandedKeys(function (_expandedKeys) {\n        return (_expandedKeys !== null && _expandedKeys !== void 0 ? _expandedKeys : []).filter(function (_id) {\n          return _id !== id;\n        });\n      });\n      return;\n    }\n    // 展开\n    setExpandedKeys(function (_expandedKeys) {\n      return __spreadArray(__spreadArray([], _expandedKeys !== null && _expandedKeys !== void 0 ? _expandedKeys : [], true), [id], false);\n    });\n  }\n  /**\n   * onSelected\n   */\n  function onSelected() {\n    // 如果不能选中\n    if (!targetSelectable) return;\n    // 多选\n    if (multiple()) {\n      if (isSelected) {\n        // 关闭\n        setSelectedKeys(function (_selectedKeys) {\n          return (_selectedKeys !== null && _selectedKeys !== void 0 ? _selectedKeys : []).filter(function (_id) {\n            return _id !== id;\n          });\n        });\n        return;\n      }\n      // 展开\n      setSelectedKeys(function (_selectedKeys) {\n        return __spreadArray(__spreadArray([], _selectedKeys !== null && _selectedKeys !== void 0 ? _selectedKeys : [], true), [id], false);\n      });\n      return;\n    }\n    // 单选\n    if (isSelected) {\n      setSelectedKeys([]);\n      return;\n    }\n    setSelectedKeys([id]);\n  }\n  /**\n   * onChecked\n   * @param {boolean} _checked\n   */\n  function onChecked(_checked) {\n    var _checkedKeys = checkedKeys();\n    handleCheck({\n      checkedKeys: _checkedKeys,\n      checked: _checked,\n      node: {\n        key: id,\n        children: children\n      },\n      next: next\n    });\n    setCheckedKeys(__spreadArray([], _checkedKeys, true));\n  }\n  return (\n    /*#__PURE__*/\n    /* 一个Tree节点 */\n    React.createElement(\"li\", {\n      key: id,\n      className: classNames(selectorPrefix, \"\".concat(selectorPrefix, \"-\").concat(size()), (_b = {}, _b[\"\".concat(selectorPrefix, \"-disabled\")] = targetDisabled, _b))\n    }, /*#__PURE__*/React.createElement(Space.Group, {\n      direction: \"vertical\",\n      size: rowGap()\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-info\")\n    }, treeCheckable() && targetCheckable && ( /*#__PURE__*/React.createElement(\"span\", {\n      className: classNames(\"\".concat(selectorPrefix, \"-info-checkbox\"))\n    }, /*#__PURE__*/React.createElement(_Checkbox, {\n      value: id,\n      checked: checked,\n      disabled: targetDisabled,\n      onChange: onChecked\n    }))), hasChildren && ( /*#__PURE__*/React.createElement(\"span\", {\n      className: \"\".concat(selectorPrefix, \"-info-expanded\"),\n      onClick: onExpanded\n    }, isExpanded && ((_d = icon === null || icon === void 0 ? void 0 : icon(isExpanded)) !== null && _d !== void 0 ? _d : /*#__PURE__*/React.createElement(_MinusOutline, null)), !isExpanded && ((_e = icon === null || icon === void 0 ? void 0 : icon(isExpanded)) !== null && _e !== void 0 ? _e : /*#__PURE__*/React.createElement(_AddOutline, null)))), /*#__PURE__*/React.createElement(\"span\", {\n      className: classNames(\"\".concat(selectorPrefix, \"-info-title\"), (_c = {}, _c[\"\".concat(selectorPrefix, \"-info-title-selected\")] = targetSelectable && isSelected, _c)),\n      onClick: onSelected\n    }, (_f = titleRender === null || titleRender === void 0 ? void 0 : titleRender({\n      key: id,\n      title: title,\n      disabled: disabled,\n      selectable: selectable,\n      checkable: checkable,\n      children: children\n    })) !== null && _f !== void 0 ? _f : title)), hasChildren && isExpanded && ( /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"\".concat(selectorPrefix, \"-children\")\n    }, /*#__PURE__*/React.createElement(Space.Group, {\n      direction: \"vertical\",\n      size: rowGap()\n    }, childrenElement)))))\n  );\n});\nTreeNode.displayName = 'TreeNode';\nexport default TreeNode;"],"names":["_AddOutline","_MinusOutline","_Checkbox","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","ar","l","Array","slice","concat","classNames","React","memo","useContext","useMemo","Space","DEFAULT_DISABLED","DEFAULT_SELECTABLE","DEFAULT_TREE_NODE_CHECKABLE","TreeContext","TreeNodeContext","useChecked","selectorPrefix","TreeNode","_a","id","level","icon","isLeaf","title","checkable","disabled","selectable","children","titleRender","_g","setSelectedKeys","setExpandedKeys","setCheckedKeys","selectedKeys","expandedKeys","checkedKeys","rowGap","size","multiple","treeCheckable","next","updateParentChecked","targetDisabled","targetSelectable","targetCheckable","targetChildrenData","hasChildren","_h","handleCheck","childrenElement","map","_treeNodeData","createElement","Provider","value","key","checked","childrenData","parentId","includes","isExpanded","isSelected","className","_b","Group","direction","onChange","_checked","_checkedKeys","node","onClick","_expandedKeys","filter","_id","_d","_e","_c","_selectedKeys","_f","displayName"],"mappings":"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"}