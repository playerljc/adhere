"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__createBinding=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__spreadArray=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,l=t.length;a<l;a++)!n&&a in t||((n=n||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},antd_mobile_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("antd-mobile")),antd_mobile_icons_1=require("antd-mobile-icons"),classnames_1=__importDefault(require("classnames")),react_1=__importStar(require("react")),adhere_ui_space_1=__importDefault(require("@baifendian/adhere-ui-space")),adhere_util_1=__importDefault(require("@baifendian/adhere-util")),Constant_1=require("./Constant"),TreeContext_1=__importDefault(require("./TreeContext")),TreeNodeContext_1=__importDefault(require("./TreeNodeContext")),useChecked_1=__importDefault(require("./useChecked")),useUtil_1=__importDefault(require("./useUtil")),selectorPrefix="adhere-mobile-ui-tree-node",TreeNode=(0,react_1.memo)(function(e){var a=e.id,t=e.level,r=(e.isLeaf,e.title),n=e.checkable,l=e.disabled,c=e.selectable,u=e.children,e=(0,react_1.useContext)(TreeContext_1.default),i=e.setSelectedKeys,S=e.setExpandedKeys,w=e.setCheckedKeys,o=e.selectedKeys,d=e.expandedKeys,s=e.checkedKeys,_=e.rowGap,f=e.size,B=e.multiple,m=e.checkable,p=e.checkStrictly,h=e.treeData,y=e.icon,k=e.titleRender,b=e.switcherIcon,C=e.onSelect,x=e.onExpand,v=e.onCheck,E=(0,react_1.useMemo)(function(){return{key:a,level:t,disabled:l,selectable:c,checkable:n,isLeaf:!(null!=u&&u.length)}},[a,t,l,c,n,u]),e=(0,react_1.useMemo)(function(){return null==y?void 0:y(E)},[E]),N=(0,react_1.useContext)(TreeNodeContext_1.default),P=N.updateParentChecked,N=N.hasCheckableNodeInParentChildren,D=(0,react_1.useMemo)(function(){return adhere_util_1.default.isEmpty(l)?Constant_1.DEFAULT_DISABLED:l},[l]),g=(0,react_1.useMemo)(function(){return adhere_util_1.default.isEmpty(c)?Constant_1.DEFAULT_SELECTABLE:c},[c]),T=(0,react_1.useMemo)(function(){return adhere_util_1.default.isEmpty(n)?Constant_1.DEFAULT_TREE_NODE_CHECKABLE:n},[n]),A=(0,react_1.useMemo)(function(){return null!=u?u:[]},[u]),M=(0,react_1.useMemo)(function(){return!!A.length},[A]),O=(0,useChecked_1.default)(),I=O.handleCheck,U=O.updateParentChecked,z=O.hasCheckableNodeInParentChildren,O=(0,useUtil_1.default)(),K=O.getTreeNodesByKeys,F=O.getLeafKeys,O=(0,react_1.useMemo)(function(){return A.map(function(e){return react_1.default.createElement(TreeNodeContext_1.default.Provider,{value:{updateParentChecked:function(e){var t=e.key,r=e.checked,e=e.checkedKeys;U({key:t,checked:r,checkedKeys:e,childrenData:A,parentId:a,next:P})},hasCheckableNodeInParentChildren:function(){return z(A)}}},react_1.default.createElement(TreeNode,__assign({level:t+1,id:e.key},e)))})},[A]),q=(0,react_1.useMemo)(function(){return s().includes(a)},[s(),a]),L=d().includes(a),j=o().includes(a);return react_1.default.createElement("li",{key:a,className:(0,classnames_1.default)(selectorPrefix,"".concat(selectorPrefix,"-").concat(f()),((d={})["".concat(selectorPrefix,"-disabled")]=D,d))},react_1.default.createElement(adhere_ui_space_1.default.Group,{direction:"vertical",size:_()},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-info")},m()&&T&&react_1.default.createElement("span",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-info-checkbox"))},react_1.default.createElement(antd_mobile_1.Checkbox,{value:a,checked:q,disabled:D,onChange:function(e){var t,r=s(),n=(I({node:{key:a,children:u},checked:e,checkedKeys:r,checkStrictly:p(),next:P}),w(__spreadArray([],r,!0)),__spreadArray([],r,!0));v&&p()&&(n=F({treeData:null!=(t=h())?t:[],keys:r})),null!=v&&v(n,{checked:e,checkedNodes:K({treeData:null!=(t=h())?t:[],keys:n}),node:E})}})),m()&&!T&&N()&&react_1.default.createElement("span",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-info-checkbox"))}),M&&react_1.default.createElement("span",{className:"".concat(selectorPrefix,"-info-expanded"),onClick:function(r){function t(e){var t;return{expanded:!L,expandedNodes:K({treeData:null!=(t=h())?t:[],keys:e}),node:E,event:r}}S(L?function(e){e=(null!=e?e:[]).filter(function(e){return e!==a});return null!=x&&x(e,t(e)),e}:function(e){e=__spreadArray(__spreadArray([],null!=e?e:[],!0),[a],!1);return null!=x&&x(e,t(e)),e})}},L&&(null!=(o=null==b?void 0:b(L,E))?o:react_1.default.createElement(antd_mobile_icons_1.MinusOutline,null)),!L&&(null!=(f=null==b?void 0:b(L,E))?f:react_1.default.createElement(antd_mobile_icons_1.AddOutline,null))),react_1.default.createElement("span",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-info-title-wrapper"),((d={})["".concat(selectorPrefix,"-info-title-selected")]=g&&j,d))},!!e&&react_1.default.createElement("span",{className:"".concat(selectorPrefix,"-info-icon")},e),react_1.default.createElement("span",{className:"".concat(selectorPrefix,"-info-title"),onClick:function(r){if(g)return B()?j?void i(function(e){e=(null!=e?e:[]).filter(function(e){return e!==a});return null!=C&&C(e,t(e)),e}):void i(function(e){e=__spreadArray(__spreadArray([],null!=e?e:[],!0),[a],!1);return null!=C&&C(e,t(e)),e}):void(j?(i([]),null!=C&&C([],t([]))):(i([a]),null!=C&&C([a],t([a]))));function t(e){var t;return{selected:!j,selectedNodes:K({treeData:null!=(t=h())?t:[],keys:e}),node:E,event:r}}}},null!=(q=null==k?void 0:k(E))?q:r))),M&&L&&react_1.default.createElement("ul",{className:"".concat(selectorPrefix,"-children")},react_1.default.createElement(adhere_ui_space_1.default.Group,{direction:"vertical",size:_()},O))))});TreeNode.displayName="TreeNode",exports.default=TreeNode;
//# sourceMappingURL=TreeNode.js.map
