{"version":3,"file":"useChecked.js","sources":["useChecked.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * useChecked\n */\nfunction useChecked() {\n  /**\n   * getChildrenKeys\n   * @description 递归获取所有子节点的key\n   * @param {{key: string; children: any[]}} node\n   * @return {string[]}\n   */\n  function getChildrenKeys(node) {\n    var keys = [node.key];\n    if (node.children) {\n      node.children.forEach(function (child) {\n        keys = keys.concat(getChildrenKeys(child));\n      });\n    }\n    return keys;\n  }\n  /**\n   * updateParentChecked\n   * @description 向上处理\n   * @param key 触发checked的节点key\n   * @param checked 触发的时候选中状态\n   * @param checkedKeys 存放所有checked的keys\n   * @param parentId key的父亲key\n   * @param treeNodeData key父亲的孩子\n   * @param next updateParentChecked\n   */\n  function updateParentChecked(_a) {\n    // console.log('key', key);\n    // console.log('parentId', parentId);\n    // console.log('childrenData', childrenData);\n    // console.log('checked', checked);\n    var key = _a.key,\n      checked = _a.checked,\n      checkedKeys = _a.checkedKeys,\n      parentId = _a.parentId,\n      childrenData = _a.childrenData,\n      next = _a.next;\n    var selfChecked = false;\n    if (checked) {\n      var childrenKeys = childrenData === null || childrenData === void 0 ? void 0 : childrenData.filter(function (_a) {\n        var itemKey = _a.key;\n        return itemKey !== key;\n      }).map(function (_a) {\n        var key = _a.key;\n        return key;\n      });\n      selfChecked = childrenKeys.every(function (key) {\n        return checkedKeys.includes(key);\n      });\n      if (selfChecked) {\n        if (!checkedKeys.includes(parentId)) {\n          checkedKeys.push(parentId);\n        }\n      }\n    } else {\n      if (checkedKeys.includes(parentId)) {\n        checkedKeys.splice(checkedKeys.findIndex(function (itemKey) {\n          return itemKey === parentId;\n        }), 1);\n      }\n    }\n    // 调用parent的updateParentChecked\n    next === null || next === void 0 ? void 0 : next({\n      key: parentId,\n      checked: selfChecked,\n      checkedKeys: checkedKeys\n    });\n  }\n  /**\n   * handleCheck\n   * @description 处理选中逻辑\n   * @param {string[]} checkedKeys\n   * @param {boolean} checked\n   * @param node\n   * @param next\n   */\n  function handleCheck(_a) {\n    var checkedKeys = _a.checkedKeys,\n      checked = _a.checked,\n      node = _a.node,\n      next = _a.next;\n    // 获取当前节点子孙的keys\n    var childrenKeys = getChildrenKeys(node);\n    if (checked) {\n      // 添加当前节点及其子节点\n      childrenKeys.forEach(function (key) {\n        if (!checkedKeys.includes(key)) {\n          checkedKeys.push(key);\n        }\n      });\n    } else {\n      // 移除当前节点及其子节点\n      childrenKeys.forEach(function (key) {\n        var index = checkedKeys.indexOf(key);\n        if (index > -1) {\n          checkedKeys.splice(index, 1);\n        }\n      });\n    }\n    // 更新父节点的状态\n    next === null || next === void 0 ? void 0 : next({\n      key: node.key,\n      checked: checked,\n      checkedKeys: checkedKeys\n    });\n  }\n  return {\n    handleCheck: handleCheck,\n    updateParentChecked: updateParentChecked\n  };\n}\nexports.default = useChecked;"],"names":["useChecked","handleCheck","_a","checkedKeys","checked","node","next","childrenKeys","getChildrenKeys","keys","key","children","forEach","child","concat","includes","push","index","indexOf","splice","updateParentChecked","parentId","childrenData","selfChecked","filter","map","every","findIndex","itemKey","Object","defineProperty","exports","value","default"],"mappings":"AAAA,aAQA,SAASA,aA0GP,MAAO,CACLC,YA/BF,SAAqBC,GACnB,IAAIC,EAAcD,EAAGC,YACnBC,EAAUF,EAAGE,QACbC,EAAOH,EAAGG,KACVC,EAAOJ,EAAGI,KAERC,EA3EN,SAASC,EAAgBH,GACvB,IAAII,EAAO,CAACJ,EAAKK,KAMjB,OALIL,EAAKM,UACPN,EAAKM,SAASC,QAAQ,SAAUC,GAC9BJ,EAAOA,EAAKK,OAAON,EAAgBK,CAAK,CAAC,CAC3C,CAAC,EAEIJ,CACT,EAmEqCJ,CAAI,EACnCD,EAEFG,EAAaK,QAAQ,SAAUF,GACxBP,EAAYY,SAASL,CAAG,GAC3BP,EAAYa,KAAKN,CAAG,CAExB,CAAC,EAGDH,EAAaK,QAAQ,SAAUF,GACzBO,EAAQd,EAAYe,QAAQR,CAAG,EACvB,CAAC,EAATO,GACFd,EAAYgB,OAAOF,EAAO,CAAC,CAE/B,CAAC,EAGHX,MAAAA,GAA4CA,EAAK,CAC/CI,IAAKL,EAAKK,IACVN,QAASA,EACTD,YAAaA,CACf,CAAC,CACH,EAGEiB,oBAlFF,SAA6BlB,GAK3B,IAAIQ,EAAMR,EAAGQ,IACXN,EAAUF,EAAGE,QACbD,EAAcD,EAAGC,YACjBkB,EAAWnB,EAAGmB,SACdC,EAAepB,EAAGoB,aAClBhB,EAAOJ,EAAGI,KACRiB,EAAc,CAAA,EACdnB,GAWEmB,GAVeD,MAAAA,EAAmD,KAAA,EAASA,EAAaE,OAAO,SAAUtB,GAE3G,OADcA,EAAGQ,MACEA,CACrB,CAAC,EAAEe,IAAI,SAAUvB,GAEf,OADUA,EAAGQ,GAEf,CAAC,GAC0BgB,MAAM,SAAUhB,GACzC,OAAOP,EAAYY,SAASL,CAAG,CACjC,CAAC,IAEMP,CAAAA,EAAYY,SAASM,CAAQ,GAChClB,EAAYa,KAAKK,CAAQ,EAIzBlB,EAAYY,SAASM,CAAQ,GAC/BlB,EAAYgB,OAAOhB,EAAYwB,UAAU,SAAUC,GACjD,OAAOA,IAAYP,CACrB,CAAC,EAAG,CAAC,EAITf,MAAAA,GAA4CA,EAAK,CAC/CI,IAAKW,EACLjB,QAASmB,EACTpB,YAAaA,CACf,CAAC,CACH,CA0CA,CACF,CApHA0B,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EAmHDD,QAAQE,QAAUjC"}