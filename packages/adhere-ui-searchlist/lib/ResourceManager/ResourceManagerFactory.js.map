{"version":3,"file":"ResourceManagerFactory.js","sources":["ResourceManager/ResourceManagerFactory.js"],"sourcesContent":["\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar react_1 = require(\"react\");\n/**\n * ResourceManagerFactory\n * @param SuperClass\n */\nfunction default_1(SuperClass) {\n  return (/** @class */function (_super) {\n      __extends(class_1, _super);\n      function class_1(props) {\n        var _this = _super.call(this, props) || this;\n        _this.viewRenders = new Map([['info', _this.renderInfoView], ['thumbnail', _this.renderThumbnailView]]);\n        // 存储view的引用\n        _this.ref = (0, react_1.createRef)();\n        return _this;\n      }\n      class_1.prototype.onSearch = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n          var view = _this.ref.current;\n          view.setState({\n            page: 1,\n            selectedRows: [],\n            selectedRowKeys: []\n          }, function () {\n            _super.prototype.onSearch.call(_this).then(function () {\n              return resolve();\n            });\n          });\n        });\n      };\n      class_1.prototype.onClear = function () {\n        var view = this.ref.current;\n        return _super.prototype.clear.call(this).then(function () {\n          return view.onClear();\n        });\n      };\n      class_1.prototype.fetchData = function () {\n        return _super.prototype.fetchData.call(this);\n      };\n      class_1.prototype.getColumns = function () {\n        var _a, _b;\n        var view = this.ref.current;\n        return (_b = (_a = view === null || view === void 0 ? void 0 : view.getColumns) === null || _a === void 0 ? void 0 : _a.call(view)) !== null && _b !== void 0 ? _b : [];\n      };\n      class_1.prototype.getDefaultValues = function () {\n        var view = this.ref.current;\n        return view ? {\n          page: view.state.page,\n          limit: view.state.limit,\n          selectedRowKeys: view.state.selectedRowKeys,\n          selectedRows: view.state.selectedRows\n        } : {\n          page: 1,\n          limit: this.getLimit(),\n          selectedRowKeys: [],\n          selectedRows: []\n        };\n      };\n      class_1.prototype.getSearchParams = function () {\n        var searchParams = _super.prototype.getSearchParams.call(this);\n        var view = this.ref.current;\n        if (!view || !view.state) {\n          return __assign({}, searchParams);\n        }\n        var viewSearchParams = view === null || view === void 0 ? void 0 : view.getSearchParams();\n        return __assign(__assign({}, viewSearchParams || {}), searchParams);\n      };\n      class_1.prototype.renderView = function () {\n        var _a, _b;\n        var viewType = this.state.viewType;\n        return (_b = (_a = this.viewRenders.get(viewType)) === null || _a === void 0 ? void 0 : _a.call) === null || _b === void 0 ? void 0 : _b.call(_a, this);\n      };\n      class_1.prototype.renderBody = function () {\n        return this.renderView();\n      };\n      return class_1;\n    }(SuperClass)\n  );\n}\nexports.default = default_1;"],"names":["__extends","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","react_1","defineProperty","exports","value","require","default_1","SuperClass","class_1","_super","onSearch","_this","Promise","resolve","ref","current","setState","page","selectedRows","selectedRowKeys","then","onClear","view","clear","fetchData","getColumns","_b","_a","getDefaultValues","state","limit","getLimit","getSearchParams","searchParams","viewSearchParams","renderView","viewType","viewRenders","get","renderBody","props","Map","renderInfoView","renderThumbnailView","createRef","default"],"mappings":"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"}