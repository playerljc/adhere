{"version":3,"file":"ResourceManagerFactory.js","sources":["ResourceManager/ResourceManagerFactory.js"],"sourcesContent":["var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport { createRef } from 'react';\n/**\n * ResourceManagerFactory\n * @param SuperClass\n */\nexport default function (SuperClass) {\n  return (/** @class */function (_super) {\n      __extends(class_1, _super);\n      function class_1(props) {\n        var _this = _super.call(this, props) || this;\n        _this.viewRenders = new Map([['info', _this.renderInfoView], ['thumbnail', _this.renderThumbnailView]]);\n        // 存储view的引用\n        _this.ref = /*#__PURE__*/createRef();\n        return _this;\n      }\n      class_1.prototype.onSearch = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n          var view = _this.ref.current;\n          view.setState({\n            page: 1,\n            selectedRows: [],\n            selectedRowKeys: []\n          }, function () {\n            _super.prototype.onSearch.call(_this).then(function () {\n              return resolve();\n            });\n          });\n        });\n      };\n      class_1.prototype.onClear = function () {\n        var view = this.ref.current;\n        return _super.prototype.clear.call(this).then(function () {\n          return view.onClear();\n        });\n      };\n      class_1.prototype.fetchData = function () {\n        return _super.prototype.fetchData.call(this);\n      };\n      class_1.prototype.getColumns = function () {\n        var _a, _b;\n        var view = this.ref.current;\n        return (_b = (_a = view === null || view === void 0 ? void 0 : view.getColumns) === null || _a === void 0 ? void 0 : _a.call(view)) !== null && _b !== void 0 ? _b : [];\n      };\n      class_1.prototype.getDefaultValues = function () {\n        var view = this.ref.current;\n        return view ? {\n          page: view.state.page,\n          limit: view.state.limit,\n          selectedRowKeys: view.state.selectedRowKeys,\n          selectedRows: view.state.selectedRows\n        } : {\n          page: 1,\n          limit: this.getLimit(),\n          selectedRowKeys: [],\n          selectedRows: []\n        };\n      };\n      class_1.prototype.getSearchParams = function () {\n        var searchParams = _super.prototype.getSearchParams.call(this);\n        var view = this.ref.current;\n        if (!view || !view.state) {\n          return __assign({}, searchParams);\n        }\n        var viewSearchParams = view === null || view === void 0 ? void 0 : view.getSearchParams();\n        return __assign(__assign({}, viewSearchParams !== null && viewSearchParams !== void 0 ? viewSearchParams : {}), searchParams);\n      };\n      class_1.prototype.renderView = function () {\n        var _a, _b;\n        var viewType = this.state.viewType;\n        return (_b = (_a = this.viewRenders.get(viewType)) === null || _a === void 0 ? void 0 : _a.call) === null || _b === void 0 ? void 0 : _b.call(_a, this);\n      };\n      class_1.prototype.renderBody = function () {\n        return this.renderView();\n      };\n      return class_1;\n    }(SuperClass)\n  );\n}"],"names":["__extends","this","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","createRef","SuperClass","class_1","_super","onSearch","_this","Promise","resolve","ref","current","setState","page","selectedRows","selectedRowKeys","then","onClear","view","clear","fetchData","getColumns","_b","_a","getDefaultValues","state","limit","getLimit","getSearchParams","searchParams","viewSearchParams","renderView","viewType","viewRenders","get","renderBody","props","Map","renderInfoView","renderThumbnailView"],"mappings":"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"}