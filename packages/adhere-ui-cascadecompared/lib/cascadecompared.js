"use strict";var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};return function(e,t){function a(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(require("react")),prop_types_1=__importDefault(require("prop-types")),classnames_1=__importDefault(require("classnames")),iscroll_probe_1=__importDefault(require("iscroll/build/iscroll-probe")),adhere_ui_stickuplayout_1=__importDefault(require("@baifendian/adhere-ui-stickuplayout")),selectorPrefix="adhere-ui-cascadecompared",defaultCellWidth=120;function initTouch(){document.addEventListener("touchmove",function(e){e.preventDefault()},!!function(){var e=!1;try{addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){e=!0}}))}catch(e){}return e}()&&{capture:!1,passive:!1})}initTouch();var CascadeCompared=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrolls=[],e}return __extends(e,t),e.prototype.componentDidMount=function(){this.stickup.refresh(),this.initScroll()},e.prototype.componentDidUpdate=function(){this.stickup.refresh(),this.initScroll()},e.prototype.initScroll=function(){for(var a=this,s=this.el.querySelectorAll("."+selectorPrefix+"-autoWrap"),e=0;e<this.scrolls.length;e++)this.scrolls[e].destroy();this.scrolls=[];for(var r=this,e=0;e<s.length;e++)!function(e){var t=new iscroll_probe_1.default(s[e],{probeType:3,eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1});r.scrolls.push(t),t.on("scroll",function(){for(var e=0;e<a.scrolls.length;e++)a.scrolls[e]!==t&&a.scrolls[e].scrollTo(t.x,t.y)})}(e)},e.prototype.getFixedColumnConfig=function(e){var t=e.find(function(e){return e.isFixed});return t||(e.length?e[0]:null)},e.prototype.renderCell=function(e,t){return e.render?e.render(t[e.dataIndex],t):t[e.dataIndex]},e.prototype.renderIndicator=function(){var t=this,e=this.props,a=e.indicatorClassName,s=void 0===a?"":a,r=e.indicatorStyle,l=void 0===r?{}:r,i=e.indicatorFixedWrapClassName,o=void 0===i?"":i,n=e.indicatorFixedWrapStyle,a=void 0===n?{}:n,r=e.indicatorAutoWrapClassName,i=void 0===r?"":r,n=e.indicatorAutoWrapStyle,r=void 0===n?{}:n,n=e.indicator,e=n.columns,e=void 0===e?[]:e,n=n.dataSource,p=void 0===n?{}:n,d=this.getFixedColumnConfig(e);return react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-indicator",(s||"").split(/\s+/)),style:__assign({},l)},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-fixedWrap",(o||"").split(/\s+/)),style:__assign(__assign({},a||{}),{width:(null==d?void 0:d.width)||defaultCellWidth})},react_1.default.createElement("div",{className:selectorPrefix+"-item"},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-cell",(d.className||"").split(/\s+/)),style:__assign({},d.style||{})},this.renderCell(d,p)))),react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-autoWrap",(i||"").split(/\s+/)),style:__assign({},r||{})},react_1.default.createElement("div",{className:selectorPrefix+"-item"},e.filter(function(e){return e!==d}).map(function(e){return react_1.default.createElement("div",{key:e.dataIndex,className:classnames_1.default(selectorPrefix+"-cell",(e.className||"").split(/\s+/)),style:__assign(__assign({},e.style||{}),{width:(null==e?void 0:e.width)||defaultCellWidth})},t.renderCell(e,p))}))))},e.prototype.renderMasterGroupContent=function(e){var a=this,t=e.dataSource,s=void 0===t?[]:t,r=e.columns,l=void 0===r?[]:r,i=e.fixedWrapClassName,o=void 0===i?"":i,n=e.fixedWrapStyle,t=void 0===n?{}:n,r=e.autoWrapClassName,i=void 0===r?"":r,n=e.autoWrapStyle,r=void 0===n?{}:n,n=e.autoInnerClassName,n=void 0===n?"":n,e=e.autoInnerStyle,e=void 0===e?{}:e,p=this.getFixedColumnConfig(l);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-fixedWrap",(o||"").split(/\s+/)),style:__assign(__assign({},t||{}),{width:(null==p?void 0:p.width)||defaultCellWidth})},s.map(function(e,t){return react_1.default.createElement("div",{key:t,className:selectorPrefix+"-item"},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-cell",(p.className||"").split(/\s+/)),style:__assign({},p.style||{})},a.renderCell(p,e)))})),react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-autoWrap",(i||"").split(/\s+/)),style:__assign({},r||{})},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-autoInner",(n||"").split(/\s+/)),style:__assign({},e)},s.map(function(t,e){return react_1.default.createElement("div",{key:e,className:selectorPrefix+"-item"},l.filter(function(e){return e!==p}).map(function(e){return react_1.default.createElement("div",{key:e.dataIndex,className:classnames_1.default(selectorPrefix+"-cell",(e.className||"").split(/\s+/)),style:__assign(__assign({},e.style||{}),{width:(null==e?void 0:e.width)||defaultCellWidth})},a.renderCell(e,t))}))}))))},e.prototype.renderMasterGroup=function(e,t){var a=e.title,s=void 0===a?null:a,r=e.className,a=void 0===r?"":r,r=e.style,r=void 0===r?{}:r;return react_1.default.createElement(adhere_ui_stickuplayout_1.default.Item,{key:t,className:classnames_1.default((a||"").split(/\s+/)),style:__assign({},r||{}),title:s,content:this.renderMasterGroupContent(e)})},e.prototype.renderMaster=function(){var a=this,e=this.props,t=e.masterClassName,s=void 0===t?"":t,r=e.masterStyle,l=void 0===r?{}:r,i=e.masterInnerClassName,o=void 0===i?"":i,n=e.masterInnerStyle,p=void 0===n?{}:n,d=e.masterStickFixedClassName,t=void 0===d?"":d,r=e.masterStickFixedStyle,i=void 0===r?{}:r,n=e.masterStickInnerClassName,d=void 0===n?"":n,r=e.masterStickInnerStyle,n=void 0===r?{}:r,r=e.master,r=void 0===r?[]:r,e=e.onStickChange;return react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-master",(s||"").split(/\s+/)),style:__assign({},l||{})},react_1.default.createElement(adhere_ui_stickuplayout_1.default,{ref:function(e){return a.stickup=e},className:classnames_1.default(selectorPrefix+"-master-inner",(o||"").split(/\s+/)),style:__assign({},p||{}),fixedClassName:classnames_1.default((t||"").split(/\s+/)),fixedStyle:__assign({},i||{}),innerClassName:classnames_1.default((d||"").split(/\s+/)),innerStyle:__assign({},n||{}),onChange:e},r.map(function(e,t){return a.renderMasterGroup(e,t)})))},e.prototype.scrollToByIndex=function(e,t){this.stickup.scrollToByIndex(e,t=void 0===t?300:t)},e.prototype.scrollToByHeaderEl=function(e,t){this.stickup.scrollToByHeaderEl(e,t=void 0===t?300:t)},e.prototype.scrollToByColumn=function(e){var t=this.scrolls[0],e=t.wrapper.querySelector("."+selectorPrefix+"-item ."+selectorPrefix+"-cell:nth-of-type("+e+")");t.scrollToElement(e)},e.prototype.render=function(){var t=this,e=this.props,a=e.className,a=void 0===a?"":a,e=e.style,e=void 0===e?{}:e;return react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,(a||"").split(/\s+/)),style:__assign({},e||{}),ref:function(e){return t.el=e}},this.renderIndicator(),this.renderMaster())},e}(react_1.default.Component);CascadeCompared.defaultProps={className:"",style:{},indicatorClassName:"",indicatorStyle:{},indicatorFixedWrapClassName:"",indicatorFixedWrapStyle:{},indicatorAutoWrapClassName:"",indicatorAutoWrapStyle:{},masterClassName:"",masterStyle:{},masterInnerClassName:"",masterInnerStyle:{},masterStickFixedClassName:"",masterStickFixedStyle:{},masterStickInnerClassName:"",masterStickInnerStyle:{},indicator:{columns:[],dataSource:[]},master:[],defaultCellWidth:defaultCellWidth},CascadeCompared.propTypes={className:prop_types_1.default.string,style:prop_types_1.default.object,indicatorClassName:prop_types_1.default.string,indicatorStyle:prop_types_1.default.object,indicatorFixedWrapClassName:prop_types_1.default.string,indicatorFixedWrapStyle:prop_types_1.default.object,indicatorAutoWrapClassName:prop_types_1.default.string,indicatorAutoWrapStyle:prop_types_1.default.object,masterClassName:prop_types_1.default.string,masterStyle:prop_types_1.default.object,masterInnerClassName:prop_types_1.default.string,masterInnerStyle:prop_types_1.default.object,masterStickFixedClassName:prop_types_1.default.string,masterStickFixedStyle:prop_types_1.default.object,masterStickInnerClassName:prop_types_1.default.string,masterStickInnerStyle:prop_types_1.default.object,indicator:prop_types_1.default.shape({columns:prop_types_1.default.arrayOf(prop_types_1.default.shape({dataIndex:prop_types_1.default.string.isRequired,isFixed:prop_types_1.default.bool,width:prop_types_1.default.oneOfType([prop_types_1.default.string,prop_types_1.default.number]),render:prop_types_1.default.func,className:prop_types_1.default.string,style:prop_types_1.default.object})),dataSource:prop_types_1.default.object.isRequired}).isRequired,master:prop_types_1.default.arrayOf(prop_types_1.default.shape({title:prop_types_1.default.node,columns:prop_types_1.default.arrayOf(prop_types_1.default.shape({dataIndex:prop_types_1.default.string.isRequired,isFixed:prop_types_1.default.bool,render:prop_types_1.default.func,className:prop_types_1.default.string,style:prop_types_1.default.object})),dataSource:prop_types_1.default.arrayOf(prop_types_1.default.object).isRequired,className:prop_types_1.default.string,style:prop_types_1.default.object,fixedWrapClassName:prop_types_1.default.string,fixedWrapStyle:prop_types_1.default.object,autoWrapClassName:prop_types_1.default.string,autoWrapStyle:prop_types_1.default.object,autoInnerClassName:prop_types_1.default.string,autoInnerStyle:prop_types_1.default.object})).isRequired,onStickChange:prop_types_1.default.func,defaultCellWidth:prop_types_1.default.oneOfType([prop_types_1.default.number,prop_types_1.default.string])},exports.default=CascadeCompared;
//# sourceMappingURL=cascadecompared.js.map
