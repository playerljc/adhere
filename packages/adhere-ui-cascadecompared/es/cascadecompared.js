var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};import React,{forwardRef,useImperativeHandle,useLayoutEffect,useRef}from"react";import classNames from"classnames";import IScroll from"iscroll/build/iscroll-probe";import StickupLayout from"@baifendian/adhere-ui-stickuplayout";var selectorPrefix="adhere-ui-cascadecompared",defaultCellWidth=120,Item=StickupLayout.Item,StickupLayoutItem=Item;function initTouch(){document.addEventListener("touchmove",function(e){e.preventDefault()},!!function(){var e=!1;try{addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){e=!0}}))}catch(e){}return e}()&&{capture:!1,passive:!1})}initTouch();var CascadeCompared=function(e,t){var a,s=e.className,r=void 0===s?"":s,l=e.style,i=void 0===l?{}:l,n=e.indicatorClassName,c=void 0===n?"":n,o=e.indicatorStyle,d=void 0===o?{}:o,u=e.indicatorFixedWrapClassName,m=void 0===u?"":u,f=e.indicatorFixedWrapStyle,v=void 0===f?{}:f,y=e.indicatorAutoWrapClassName,N=void 0===y?"":y,p=e.indicatorAutoWrapStyle,_=void 0===p?{}:p,x=e.indicator,g=x.columns,s=void 0===g?[]:g,l=x.dataSource,h=void 0===l?{}:l,n=e.masterClassName,o=void 0===n?"":n,u=e.masterStyle,f=void 0===u?{}:u,y=e.masterInnerClassName,p=void 0===y?"":y,g=e.masterInnerStyle,x=void 0===g?{}:g,l=e.masterStickFixedClassName,n=void 0===l?"":l,u=e.masterStickFixedStyle,y=void 0===u?{}:u,g=e.masterStickInnerClassName,l=void 0===g?"":g,u=e.masterStickInnerStyle,g=void 0===u?{}:u,u=e.master,u=void 0===u?[]:u,e=e.onStickChange,S=useRef(null),R=useRef(null),E=useRef([]);function C(){for(var a=S.current.querySelectorAll("."+selectorPrefix+"-autoWrap"),e=0;e<E.current.length;e++)E.current[e].destroy();E.current=[];for(e=0;e<a.length;e++)!function(e){var t=new IScroll(a[e],{probeType:3,eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1});E.current.push(t),t.on("scroll",function(){for(var e=0;e<E.current.length;e++)E.current[e]!==t&&E.current[e].scrollTo(t.x,t.y)})}(e)}function P(e){var t=e.find(function(e){return e.isFixed});return t||(e.length?e[0]:null)}function I(e,t){return e?e.render?e.render(t[e.dataIndex],t):t[e.dataIndex]:null}function W(e,t){var a,s,r=e.title,l=void 0===r?void 0:r,i=e.className,n=void 0===i?"":i,c=e.style,r=void 0===c?{}:c;return React.createElement(StickupLayoutItem,{key:t,className:classNames(n||""),style:__assign({},r||{}),title:l,content:(t=void 0===(c=(i=e).dataSource)?[]:c,a=void 0===(n=i.columns)?[]:n,l=void 0===(r=i.fixedWrapClassName)?"":r,c=void 0===(e=i.fixedWrapStyle)?{}:e,r=void 0===(n=i.autoWrapClassName)?"":n,n=void 0===(e=i.autoWrapStyle)?{}:e,e=void 0===(e=i.autoInnerClassName)?"":e,i=void 0===(i=i.autoInnerStyle)?{}:i,s=P(a),React.createElement(React.Fragment,null,React.createElement("div",{className:classNames(selectorPrefix+"-fixedWrap",l||""),style:__assign(__assign({},c||{}),{width:(null==s?void 0:s.width)||defaultCellWidth})},t.map(function(e,t){return React.createElement("div",{key:t,className:selectorPrefix+"-item"},React.createElement("div",{className:classNames(selectorPrefix+"-cell",(null==s?void 0:s.className)||""),style:__assign({},(null==s?void 0:s.style)||{})},I(s,e)))})),React.createElement("div",{className:classNames(selectorPrefix+"-autoWrap",r||""),style:__assign({},n||{})},React.createElement("div",{className:classNames(selectorPrefix+"-autoInner",e||""),style:__assign({},i)},t.map(function(t,e){return React.createElement("div",{key:e,className:selectorPrefix+"-item"},a.filter(function(e){return e!==s}).map(function(e){return React.createElement("div",{key:e.dataIndex,className:classNames(selectorPrefix+"-cell",e.className||""),style:__assign(__assign({},e.style||{}),{width:(null==e?void 0:e.width)||defaultCellWidth})},I(e,t))}))})))))})}return useImperativeHandle(t,function(){return{scrollToByIndex:function(e,t){R.current.scrollToByIndex(e,t=void 0===t?300:t)},scrollToByHeaderEl:function(e,t){R.current.scrollToByHeaderEl(e,t=void 0===t?300:t)},scrollToByColumn:function(e){var t=E.current[0],e=t.wrapper.querySelector("."+selectorPrefix+"-item ."+selectorPrefix+"-cell:nth-of-type("+e+")");t.scrollToElement(e)}}}),useLayoutEffect(function(){R.current.refresh(),C()}),React.createElement("div",{className:classNames(selectorPrefix,r||""),style:__assign({},i||{}),ref:S},(a=P(s),React.createElement("div",{className:classNames(selectorPrefix+"-indicator",c||""),style:__assign({},d)},React.createElement("div",{className:classNames(selectorPrefix+"-fixedWrap",m||""),style:__assign(__assign({},v||{}),{width:(null==a?void 0:a.width)||defaultCellWidth})},React.createElement("div",{className:selectorPrefix+"-item"},React.createElement("div",{className:classNames(selectorPrefix+"-cell",(null==a?void 0:a.className)||""),style:__assign({},(null==a?void 0:a.style)||{})},I(a,h)))),React.createElement("div",{className:classNames(selectorPrefix+"-autoWrap",N||""),style:__assign({},_||{})},React.createElement("div",{className:selectorPrefix+"-item"},s.filter(function(e){return e!==a}).map(function(e){return React.createElement("div",{key:e.dataIndex,className:classNames(selectorPrefix+"-cell",e.className||""),style:__assign(__assign({},e.style||{}),{width:(null==e?void 0:e.width)||defaultCellWidth})},I(e,h))}))))),(e={ref:R,className:classNames(selectorPrefix+"-master-inner",p||""),style:__assign({},x||{}),fixedClassName:classNames(n||""),fixedStyle:__assign({},y||{}),innerClassName:classNames(l||""),innerStyle:__assign({},g||{}),onChange:e},React.createElement("div",{className:classNames(selectorPrefix+"-master",o||""),style:__assign({},f||{})},React.createElement(StickupLayout,__assign({},e),u.map(W)))))};export default forwardRef(CascadeCompared);
//# sourceMappingURL=cascadecompared.js.map
