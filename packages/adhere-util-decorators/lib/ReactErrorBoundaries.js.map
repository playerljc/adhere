{"version":3,"file":"ReactErrorBoundaries.js","sources":["ReactErrorBoundaries.js"],"sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar antd_1 = require(\"antd\");\r\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\r\n// import errorIcon from './component_error.svg';\r\nvar errorIcon = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTkyNzM0NTgwMDkxIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMzODMiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTM1OC4zMjUzODYgNTYzLjA3MzczMW0tNzYuNzgyNzgxIDBhNzYuNzgyNzgxIDc2Ljc4Mjc4MSAwIDEgMCAxNTMuNTY1NTYzIDAgNzYuNzgyNzgxIDc2Ljc4Mjc4MSAwIDEgMC0xNTMuNTY1NTYzIDBaIiBmaWxsPSIjMTM5MjdEIiBwLWlkPSIzMzg0Ij48L3BhdGg+PHBhdGggZD0iTTY2NS40NTY1MTIgNTYzLjA3MzczMW0tNzYuNzgyNzgxIDBhNzYuNzgyNzgxIDc2Ljc4Mjc4MSAwIDEgMCAxNTMuNTY1NTYzIDAgNzYuNzgyNzgxIDc2Ljc4Mjc4MSAwIDEgMC0xNTMuNTY1NTYzIDBaIiBmaWxsPSIjMTM5MjdEIiBwLWlkPSIzMzg1Ij48L3BhdGg+PHBhdGggZD0iTTUxMS44OTA5NDkgMGMyNjguNTYwNTc1IDAgNDg2LjI5MDk0OSAyMTcuNzMwMzc0IDQ4Ni4yOTA5NSA0ODYuMjkwOTQ5IDAgMTE5LjYyNzU3NC00My40NTkwNTQgMjMyLjQ3MjY2OC0xMjAuMjY3NDMxIDMyMC4xODQxOTlsLTcuNzAzODcyIDguNTc0MDc3Vjk3Mi41ODE4OTlhNTEuMTg4NTIxIDUxLjE4ODUyMSAwIDAgMS00Ny4zNzQ5NzYgNTEuMDYwNTQ5bC0zLjgzOTEzOSAwLjEyNzk3MWE1MS4xODg1MjEgNTEuMTg4NTIxIDAgMCAxLTUxLjAzNDk1Ni00Ny4zNzQ5NzZsLTAuMTI3OTcxLTMuODM5MTM5di0xNzguMDg0ODY0YTUxLjE4ODUyMSA1MS4xODg1MjEgMCAwIDEgMTUuMDc1MDItMzYuMjY3MDY3QTM4Mi40ODA2MjkgMzgyLjQ4MDYyOSAwIDAgMCA4OTUuODA0ODU3IDQ4Ni4yOTA5NDljMC0yMTIuMDIyODU0LTE3MS44OTEwNTMtMzgzLjkxMzkwNy0zODMuOTEzOTA4LTM4My45MTM5MDctMjEyLjAyMjg1NCAwLTM4My45MTM5MDcgMTcxLjg5MTA1My0zODMuOTEzOTA3IDM4My45MTM5MDcgMCAxMDMuNDc3NTk1IDQxLjA3ODc4OCAyMDAuMzI2Mjc3IDExMi45MjE4NzcgMjcxLjkzOTAxOGE1MS4xODg1MjEgNTEuMTg4NTIxIDAgMCAxIDE0Ljg0NDY3MSAzMS43MzY4ODNsMC4yMDQ3NTQgNC41MzAxODRWOTcyLjU4MTg5OWE1MS4xODg1MjEgNTEuMTg4NTIxIDAgMCAxLTEwMi4yNDkwNyAzLjgzOTEzOUwxNTMuNTcxMzAyIDk3Mi41ODE4OTl2LTE1Ny41MzI2NzRBNDg0LjY1MjkxNyA0ODQuNjUyOTE3IDAgMCAxIDI1LjcyNzk3MSA0OTcuNTAxMjM1TDI1LjYgNDg2LjI5MDk0OUMyNS42IDIxNy43MzAzNzQgMjQzLjMzMDM3NCAwIDUxMS44OTA5NDkgMHoiIGZpbGw9IiMxMzkyN0QiIHAtaWQ9IjMzODYiPjwvcGF0aD48cGF0aCBkPSJNNTExLjg5MDk0OSA3OTMuNDIyMDc1YTUxLjE4ODUyMSA1MS4xODg1MjEgMCAwIDEgNTEuMDYwNTUgNDcuMzQ5MzgyTDU2My4wNzk0NyA4NDQuNjEwNTk2djEyNy45NzEzMDNhNTEuMTg4NTIxIDUxLjE4ODUyMSAwIDAgMS0xMDIuMjQ5MDcgMy44MzkxMzlMNDYwLjcwMjQyOCA5NzIuNTgxODk5di0xMjcuOTcxMzAzYTUxLjE4ODUyMSA1MS4xODg1MjEgMCAwIDEgNTEuMTg4NTIxLTUxLjE4ODUyMXoiIGZpbGw9IiMxMzkyN0QiIHAtaWQ9IjMzODciPjwvcGF0aD48L3N2Zz4=';\r\n/**\r\n * React的边界错误捕获\r\n * @param Component\r\n */\r\nexports.default = (function (Component) {\r\n    var ReactErrorBoundaries = /** @class */ (function (_super) {\r\n        __extends(ReactErrorBoundaries, _super);\r\n        function ReactErrorBoundaries() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.state = {\r\n                hasError: false,\r\n            };\r\n            return _this;\r\n        }\r\n        ReactErrorBoundaries.getDerivedStateFromError = function (error) {\r\n            console.error(error);\r\n            // 更新 state 使下一次渲染能够显示降级后的 UI\r\n            return {\r\n                hasError: true,\r\n            };\r\n        };\r\n        ReactErrorBoundaries.prototype.componentDidCatch = function (error, errorInfo) {\r\n            // 你同样可以将错误日志上报给服务器\r\n            console.error(error, errorInfo);\r\n        };\r\n        ReactErrorBoundaries.prototype.render = function () {\r\n            if (this.state.hasError) {\r\n                return (react_1.default.createElement(antd_1.Empty, { image: errorIcon, imageStyle: {\r\n                        height: 60,\r\n                    }, description: adhere_util_intl_1.default.v('糟糕！，出了些问题') }));\r\n            }\r\n            var _a = this.props, forwardedRef = _a.forwardedRef, props = __rest(_a, [\"forwardedRef\"]);\r\n            var allProps = __assign({}, props);\r\n            // 如果 Component 是 FunctionComponent 就不赋值ref了\r\n            if (adhere_util_1.default.isArray(Component)) {\r\n                if (Component.prototype.isReactComponent) {\r\n                    allProps.ref = this.props.forwardedRef || react_1.default.createRef();\r\n                }\r\n            }\r\n            else if (adhere_util_1.default.isObject(Component)) {\r\n                if (Component.constructor.prototype.isReactComponent) {\r\n                    allProps.ref = this.props.forwardedRef || react_1.default.createRef();\r\n                }\r\n            }\r\n            return react_1.default.createElement(Component, __assign({}, allProps));\r\n        };\r\n        return ReactErrorBoundaries;\r\n    }(react_1.default.Component));\r\n    return react_1.default.forwardRef(function (props, ref) {\r\n        return react_1.default.createElement(ReactErrorBoundaries, __assign({}, props, { forwardedRef: ref }));\r\n    });\r\n});\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","mod","__esModule","default","defineProperty","exports","value","react_1","require","antd_1","adhere_util_intl_1","adhere_util_1","errorIcon","Component","_super","ReactErrorBoundaries","getDerivedStateFromError","error","console","hasError","componentDidCatch","errorInfo","render","state","createElement","Empty","image","imageStyle","height","description","v","_a","props","forwardedRef","allProps","isArray","isReactComponent","ref","createRef","isObject","_this","forwardRef"],"mappings":"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"}