{"version":3,"file":"scrollload.js","sources":["scrollload.js"],"sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\r\nvar classnames_1 = __importDefault(require(\"classnames\"));\r\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar selectorPrefix = 'adhere-ui-scrollload';\r\n/**\r\n * ScrollLoad\r\n * @class ScrollLoad\r\n * @classdesc ScrollLoad\r\n */\r\nvar ScrollLoad = /** @class */ (function (_super) {\r\n    __extends(ScrollLoad, _super);\r\n    function ScrollLoad(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.lock = false; // 锁\r\n        _this.onScroll = _this.onScroll.bind(_this);\r\n        _this.onEmptyClick = _this.onEmptyClick.bind(_this);\r\n        _this.onErrorClick = _this.onErrorClick.bind(_this);\r\n        return _this;\r\n    }\r\n    ScrollLoad.prototype.componentDidMount = function () {\r\n        this.initEvents();\r\n    };\r\n    ScrollLoad.prototype.getScrollContainer = function () {\r\n        return this.props.getScrollContainer ? this.props.getScrollContainer() : this.el;\r\n    };\r\n    ScrollLoad.prototype.initEvents = function () {\r\n        this.getScrollContainer().addEventListener('scroll', this.onScroll);\r\n        this.emptyEl.addEventListener('click', this.onEmptyClick);\r\n        this.errorEl.addEventListener('click', this.onErrorClick);\r\n    };\r\n    ScrollLoad.prototype.onScroll = function () {\r\n        var _this = this;\r\n        var _a = this, loadEl = _a.loadEl, errorEl = _a.errorEl, emptyEl = _a.emptyEl, _b = _a.props, distance = _b.distance, onScrollBottom = _b.onScrollBottom;\r\n        var el = this.getScrollContainer();\r\n        var bottomHeight = el.scrollHeight - el.offsetHeight;\r\n        var scrollTop = el.scrollTop;\r\n        /**\r\n         * 条件完全相等或误差值在1之间\r\n         */\r\n        if (onScrollBottom && Math.abs(scrollTop - bottomHeight) <= distance) {\r\n            if (this.lock)\r\n                return;\r\n            this.lock = true;\r\n            // 先显示loading\r\n            loadEl.style.display = 'flex';\r\n            /**\r\n             * 完成\r\n             * @param {string} status [empty(没有数据) | error(有错误) | normal(正常)]\r\n             */\r\n            onScrollBottom(function (status) {\r\n                loadEl.style.display = 'none';\r\n                if (status === ScrollLoad.EMPTY) {\r\n                    emptyEl.style.display = 'block';\r\n                }\r\n                else if (status === ScrollLoad.ERROR) {\r\n                    errorEl.style.display = 'block';\r\n                }\r\n                _this.lock = false;\r\n            });\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onEmptyClick = function () {\r\n        var onEmptyClick = this.props.onEmptyClick;\r\n        if (onEmptyClick) {\r\n            onEmptyClick();\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onErrorClick = function () {\r\n        var onErrorClick = this.props.onErrorClick;\r\n        if (onErrorClick) {\r\n            onErrorClick();\r\n        }\r\n    };\r\n    /**\r\n     * hideAll\r\n     */\r\n    ScrollLoad.prototype.hideAll = function () {\r\n        this.loadEl.style.display = 'none';\r\n        this.errorEl.style.display = 'none';\r\n        this.emptyEl.style.display = 'none';\r\n    };\r\n    ScrollLoad.prototype.renderLoading = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderLoading = _a.renderLoading, loadClassName = _a.loadClassName, loadStyle = _a.loadStyle;\r\n        if (renderLoading) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-load\", loadClassName.split(/\\s+/)), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, renderLoading()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-load\", 'standard', loadClassName.split(/\\s+/)), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, adhere_util_intl_1.default.v('数据加载中')));\r\n    };\r\n    ScrollLoad.prototype.renderEmpty = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderEmpty = _a.renderEmpty, emptyClassName = _a.emptyClassName, emptyStyle = _a.emptyStyle;\r\n        if (renderEmpty) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-empty\", emptyClassName.split(/\\s+/)), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } }, renderEmpty()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-empty\", emptyClassName.split(/\\s+/)), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } },\r\n            \"~\",\r\n            adhere_util_intl_1.default.v('没有更多')));\r\n    };\r\n    ScrollLoad.prototype.renderError = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderError = _a.renderError, errorClassName = _a.errorClassName, errorStyle = _a.errorStyle;\r\n        if (renderError) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-error\", errorClassName.split(/\\s+/)), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, renderError()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-error\", errorClassName.split(/\\s+/)), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, adhere_util_intl_1.default.v('出现错误')));\r\n    };\r\n    ScrollLoad.prototype.render = function () {\r\n        var _this = this;\r\n        var _a = this.props, className = _a.className, style = _a.style, children = _a.children;\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix, (className || '').split(/\\s+/)), style: __assign(__assign({}, style), { overflowY: this.getScrollContainer() === this.el ? 'auto' : 'initial' }), ref: function (el) { return (_this.el = el); } },\r\n            children,\r\n            this.renderLoading(),\r\n            this.renderEmpty(),\r\n            this.renderError()));\r\n    };\r\n    ScrollLoad.EMPTY = 'empty';\r\n    ScrollLoad.ERROR = 'error';\r\n    ScrollLoad.NORMAL = 'normal';\r\n    return ScrollLoad;\r\n}(react_1.default.Component));\r\nScrollLoad.defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    loadClassName: '',\r\n    loadStyle: {},\r\n    emptyClassName: '',\r\n    emptyStyle: {},\r\n    errorClassName: '',\r\n    errorStyle: {},\r\n    distance: 50,\r\n    onScrollBottom: function () { },\r\n    onEmptyClick: function () { },\r\n    onErrorClick: function () { },\r\n    renderLoading: undefined,\r\n    renderEmpty: undefined,\r\n    renderError: undefined,\r\n};\r\nScrollLoad.propTypes = {\r\n    getScrollContainer: prop_types_1.default.func,\r\n    className: prop_types_1.default.string,\r\n    style: prop_types_1.default.object,\r\n    loadClassName: prop_types_1.default.string,\r\n    loadStyle: prop_types_1.default.object,\r\n    emptyClassName: prop_types_1.default.string,\r\n    emptyStyle: prop_types_1.default.object,\r\n    errorClassName: prop_types_1.default.string,\r\n    errorStyle: prop_types_1.default.object,\r\n    distance: prop_types_1.default.number,\r\n    onScrollBottom: Function,\r\n    onEmptyClick: Function,\r\n    onErrorClick: Function,\r\n    renderLoading: Function,\r\n    renderEmpty: Function,\r\n    renderError: Function,\r\n};\r\nexports.default = ScrollLoad;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__importDefault","mod","__esModule","default","defineProperty","exports","value","react_1","require","prop_types_1","classnames_1","adhere_util_intl_1","selectorPrefix","ScrollLoad","_super","props","_this","lock","onScroll","bind","onEmptyClick","onErrorClick","componentDidMount","initEvents","getScrollContainer","el","addEventListener","emptyEl","errorEl","_a","loadEl","_b","distance","onScrollBottom","bottomHeight","scrollHeight","offsetHeight","scrollTop","Math","abs","style","display","status","EMPTY","ERROR","hideAll","renderLoading","loadClassName","loadStyle","createElement","className","split","ref","v","renderEmpty","emptyClassName","emptyStyle","renderError","errorClassName","errorStyle","render","children","overflowY","NORMAL","Component","defaultProps","undefined","propTypes","func","string","object","number","Function"],"mappings":"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"}