{"version":3,"file":"scrollload.js","sources":["scrollload.js"],"sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\r\nvar classnames_1 = __importDefault(require(\"classnames\"));\r\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar selectorPrefix = 'adhere-ui-scrollload';\r\n/**\r\n * ScrollLoad\r\n * @class ScrollLoad\r\n * @classdesc ScrollLoad\r\n */\r\nvar ScrollLoad = /** @class */ (function (_super) {\r\n    __extends(ScrollLoad, _super);\r\n    function ScrollLoad(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.lock = false; // 锁\r\n        // @ts-ignore\r\n        _this.onScroll = _this.onScroll.bind(_this);\r\n        // @ts-ignore\r\n        _this.onEmptyClick = _this.onEmptyClick.bind(_this);\r\n        // @ts-ignore\r\n        _this.onErrorClick = _this.onErrorClick.bind(_this);\r\n        return _this;\r\n    }\r\n    ScrollLoad.prototype.componentDidMount = function () {\r\n        this.initEvents();\r\n    };\r\n    ScrollLoad.prototype.initEvents = function () {\r\n        // @ts-ignore\r\n        this.el.addEventListener('scroll', this.onScroll);\r\n        // @ts-ignore\r\n        this.emptyEl.addEventListener('click', this.onEmptyClick);\r\n        // @ts-ignore\r\n        this.errorEl.addEventListener('click', this.onErrorClick);\r\n    };\r\n    ScrollLoad.prototype.onScroll = function () {\r\n        var _this = this;\r\n        var _a = this, el = _a.el, loadEl = _a.loadEl, errorEl = _a.errorEl, emptyEl = _a.emptyEl, _b = _a.props, distance = _b.distance, onScrollBottom = _b.onScrollBottom;\r\n        // @ts-ignore\r\n        var bottomHeight = el.scrollHeight - el.offsetHeight;\r\n        // @ts-ignore\r\n        var scrollTop = el.scrollTop;\r\n        /**\r\n         * 条件完全相等或误差值在1之间\r\n         */\r\n        if (onScrollBottom && Math.abs(scrollTop - bottomHeight) <= distance) {\r\n            if (this.lock)\r\n                return;\r\n            this.lock = true;\r\n            // 先显示loading\r\n            // @ts-ignore\r\n            loadEl.style.display = 'flex';\r\n            /**\r\n             * 完成\r\n             * @param {string} status [empty(没有数据) | error(有错误) | normal(正常)]\r\n             */\r\n            onScrollBottom(function (status) {\r\n                // @ts-ignore\r\n                loadEl.style.display = 'none';\r\n                if (status === ScrollLoad.EMPTY) {\r\n                    // @ts-ignore\r\n                    emptyEl.style.display = 'block';\r\n                }\r\n                else if (status === ScrollLoad.ERROR) {\r\n                    // @ts-ignore\r\n                    errorEl.style.display = 'block';\r\n                }\r\n                _this.lock = false;\r\n            });\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onEmptyClick = function () {\r\n        var onEmptyClick = this.props.onEmptyClick;\r\n        if (onEmptyClick) {\r\n            onEmptyClick();\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onErrorClick = function () {\r\n        var onErrorClick = this.props.onErrorClick;\r\n        if (onErrorClick) {\r\n            onErrorClick();\r\n        }\r\n    };\r\n    /**\r\n     * hideAll\r\n     */\r\n    ScrollLoad.prototype.hideAll = function () {\r\n        // @ts-ignore\r\n        this.loadEl.style.display = 'none';\r\n        // @ts-ignore\r\n        this.errorEl.style.display = 'none';\r\n        // @ts-ignore\r\n        this.emptyEl.style.display = 'none';\r\n    };\r\n    ScrollLoad.prototype.renderLoading = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderLoading = _a.renderLoading, loadClassName = _a.loadClassName, loadStyle = _a.loadStyle;\r\n        if (renderLoading) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-load\", \r\n                // @ts-ignore\r\n                loadClassName.split(' ')), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, renderLoading()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-load\", 'standard', \r\n            // @ts-ignore\r\n            loadClassName.split(' ')), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, adhere_util_intl_1.default.v('数据加载中')));\r\n    };\r\n    ScrollLoad.prototype.renderEmpty = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderEmpty = _a.renderEmpty, emptyClassName = _a.emptyClassName, emptyStyle = _a.emptyStyle;\r\n        if (renderEmpty) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-empty\", \r\n                // @ts-ignore\r\n                emptyClassName.split(' ')), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } }, renderEmpty()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-empty\", \r\n            // @ts-ignore\r\n            emptyClassName.split(' ')), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } },\r\n            \"~\",\r\n            adhere_util_intl_1.default.v('没有更多')));\r\n    };\r\n    ScrollLoad.prototype.renderError = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderError = _a.renderError, errorClassName = _a.errorClassName, errorStyle = _a.errorStyle;\r\n        if (renderError) {\r\n            return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-error\", \r\n                // @ts-ignore\r\n                errorClassName.split(' ')), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, renderError()));\r\n        }\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-error\", \r\n            // @ts-ignore\r\n            errorClassName.split(' ')), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, adhere_util_intl_1.default.v('出现错误')));\r\n    };\r\n    ScrollLoad.prototype.render = function () {\r\n        var _this = this;\r\n        // @ts-ignore\r\n        var _a = this.props, className = _a.className, style = _a.style, children = _a.children;\r\n        // @ts-ignore\r\n        return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix, \r\n            // @ts-ignore\r\n            className.split(' ')), style: __assign({}, style), ref: function (el) { return (_this.el = el); } },\r\n            children,\r\n            this.renderLoading(),\r\n            this.renderEmpty(),\r\n            this.renderError()));\r\n    };\r\n    ScrollLoad.EMPTY = 'empty';\r\n    ScrollLoad.ERROR = 'error';\r\n    ScrollLoad.NORMAL = 'normal';\r\n    return ScrollLoad;\r\n}(react_1.default.Component));\r\nScrollLoad.defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    loadClassName: '',\r\n    loadStyle: {},\r\n    emptyClassName: '',\r\n    emptyStyle: {},\r\n    errorClassName: '',\r\n    errorStyle: {},\r\n    distance: 50,\r\n    onScrollBottom: function () { },\r\n    onEmptyClick: function () { },\r\n    onErrorClick: function () { },\r\n    renderLoading: undefined,\r\n    renderEmpty: undefined,\r\n    renderError: undefined,\r\n};\r\nScrollLoad.propTypes = {\r\n    className: prop_types_1.default.string,\r\n    style: prop_types_1.default.object,\r\n    loadClassName: prop_types_1.default.string,\r\n    loadStyle: prop_types_1.default.object,\r\n    emptyClassName: prop_types_1.default.string,\r\n    emptyStyle: prop_types_1.default.object,\r\n    errorClassName: prop_types_1.default.string,\r\n    errorStyle: prop_types_1.default.object,\r\n    distance: prop_types_1.default.number,\r\n    onScrollBottom: Function,\r\n    onEmptyClick: Function,\r\n    onErrorClick: Function,\r\n    renderLoading: Function,\r\n    renderEmpty: Function,\r\n    renderError: Function,\r\n};\r\nexports.default = ScrollLoad;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__importDefault","mod","__esModule","default","defineProperty","exports","value","react_1","require","prop_types_1","classnames_1","adhere_util_intl_1","selectorPrefix","ScrollLoad","_super","props","_this","lock","onScroll","bind","onEmptyClick","onErrorClick","componentDidMount","initEvents","el","addEventListener","emptyEl","errorEl","_a","loadEl","_b","distance","onScrollBottom","bottomHeight","scrollHeight","offsetHeight","scrollTop","Math","abs","style","display","status","EMPTY","ERROR","hideAll","renderLoading","loadClassName","loadStyle","createElement","className","split","ref","v","renderEmpty","emptyClassName","emptyStyle","renderError","errorClassName","errorStyle","render","children","NORMAL","Component","defaultProps","undefined","propTypes","string","object","number","Function"],"mappings":"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"}