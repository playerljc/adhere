{"version":3,"file":"scrollload.js","sources":["scrollload.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport Intl from '@baifendian/adhere-util-intl';\r\nvar selectorPrefix = 'adhere-ui-scrollload';\r\n/**\r\n * ScrollLoad\r\n * @class ScrollLoad\r\n * @classdesc ScrollLoad\r\n */\r\nvar ScrollLoad = /** @class */ (function (_super) {\r\n    __extends(ScrollLoad, _super);\r\n    function ScrollLoad(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.lock = false; // 锁\r\n        _this.onScroll = _this.onScroll.bind(_this);\r\n        _this.onEmptyClick = _this.onEmptyClick.bind(_this);\r\n        _this.onErrorClick = _this.onErrorClick.bind(_this);\r\n        return _this;\r\n    }\r\n    ScrollLoad.prototype.componentDidMount = function () {\r\n        this.initEvents();\r\n    };\r\n    ScrollLoad.prototype.initEvents = function () {\r\n        this.el.addEventListener('scroll', this.onScroll);\r\n        this.emptyEl.addEventListener('click', this.onEmptyClick);\r\n        this.errorEl.addEventListener('click', this.onErrorClick);\r\n    };\r\n    ScrollLoad.prototype.onScroll = function () {\r\n        var _this = this;\r\n        var _a = this, el = _a.el, loadEl = _a.loadEl, errorEl = _a.errorEl, emptyEl = _a.emptyEl, _b = _a.props, distance = _b.distance, onScrollBottom = _b.onScrollBottom;\r\n        var bottomHeight = el.scrollHeight - el.offsetHeight;\r\n        var scrollTop = el.scrollTop;\r\n        /**\r\n         * 条件完全相等或误差值在1之间\r\n         */\r\n        if (onScrollBottom && Math.abs(scrollTop - bottomHeight) <= distance) {\r\n            if (this.lock)\r\n                return;\r\n            this.lock = true;\r\n            // 先显示loading\r\n            loadEl.style.display = 'flex';\r\n            /**\r\n             * 完成\r\n             * @param {string} status [empty(没有数据) | error(有错误) | normal(正常)]\r\n             */\r\n            onScrollBottom(function (status) {\r\n                loadEl.style.display = 'none';\r\n                if (status === ScrollLoad.EMPTY) {\r\n                    emptyEl.style.display = 'block';\r\n                }\r\n                else if (status === ScrollLoad.ERROR) {\r\n                    errorEl.style.display = 'block';\r\n                }\r\n                _this.lock = false;\r\n            });\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onEmptyClick = function () {\r\n        var onEmptyClick = this.props.onEmptyClick;\r\n        if (onEmptyClick) {\r\n            onEmptyClick();\r\n        }\r\n    };\r\n    ScrollLoad.prototype.onErrorClick = function () {\r\n        var onErrorClick = this.props.onErrorClick;\r\n        if (onErrorClick) {\r\n            onErrorClick();\r\n        }\r\n    };\r\n    /**\r\n     * hideAll\r\n     */\r\n    ScrollLoad.prototype.hideAll = function () {\r\n        this.loadEl.style.display = 'none';\r\n        this.errorEl.style.display = 'none';\r\n        this.emptyEl.style.display = 'none';\r\n    };\r\n    ScrollLoad.prototype.renderLoading = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderLoading = _a.renderLoading, loadClassName = _a.loadClassName, loadStyle = _a.loadStyle;\r\n        if (renderLoading) {\r\n            return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-load\", loadClassName.split(/\\s+/)), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, renderLoading()));\r\n        }\r\n        return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-load\", 'standard', loadClassName.split(/\\s+/)), style: __assign({}, loadStyle), ref: function (el) { return (_this.loadEl = el); } }, Intl.v('数据加载中')));\r\n    };\r\n    ScrollLoad.prototype.renderEmpty = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderEmpty = _a.renderEmpty, emptyClassName = _a.emptyClassName, emptyStyle = _a.emptyStyle;\r\n        if (renderEmpty) {\r\n            return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-empty\", emptyClassName.split(/\\s+/)), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } }, renderEmpty()));\r\n        }\r\n        return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-empty\", emptyClassName.split(/\\s+/)), style: __assign({}, emptyStyle), ref: function (el) { return (_this.emptyEl = el); } },\r\n            \"~\",\r\n            Intl.v('没有更多')));\r\n    };\r\n    ScrollLoad.prototype.renderError = function () {\r\n        var _this = this;\r\n        var _a = this.props, renderError = _a.renderError, errorClassName = _a.errorClassName, errorStyle = _a.errorStyle;\r\n        if (renderError) {\r\n            return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-error\", errorClassName.split(/\\s+/)), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, renderError()));\r\n        }\r\n        return (React.createElement(\"div\", { className: classNames(selectorPrefix + \"-error\", errorClassName.split(/\\s+/)), style: __assign({}, errorStyle), ref: function (el) { return (_this.errorEl = el); } }, Intl.v('出现错误')));\r\n    };\r\n    ScrollLoad.prototype.render = function () {\r\n        var _this = this;\r\n        var _a = this.props, className = _a.className, style = _a.style, children = _a.children;\r\n        return (React.createElement(\"div\", { className: classNames(selectorPrefix, (className || '').split(/\\s+/)), style: __assign({}, style), ref: function (el) { return (_this.el = el); } },\r\n            children,\r\n            this.renderLoading(),\r\n            this.renderEmpty(),\r\n            this.renderError()));\r\n    };\r\n    ScrollLoad.EMPTY = 'empty';\r\n    ScrollLoad.ERROR = 'error';\r\n    ScrollLoad.NORMAL = 'normal';\r\n    return ScrollLoad;\r\n}(React.Component));\r\nScrollLoad.defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    loadClassName: '',\r\n    loadStyle: {},\r\n    emptyClassName: '',\r\n    emptyStyle: {},\r\n    errorClassName: '',\r\n    errorStyle: {},\r\n    distance: 50,\r\n    onScrollBottom: function () { },\r\n    onEmptyClick: function () { },\r\n    onErrorClick: function () { },\r\n    renderLoading: undefined,\r\n    renderEmpty: undefined,\r\n    renderError: undefined,\r\n};\r\nScrollLoad.propTypes = {\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    loadClassName: PropTypes.string,\r\n    loadStyle: PropTypes.object,\r\n    emptyClassName: PropTypes.string,\r\n    emptyStyle: PropTypes.object,\r\n    errorClassName: PropTypes.string,\r\n    errorStyle: PropTypes.object,\r\n    distance: PropTypes.number,\r\n    onScrollBottom: Function,\r\n    onEmptyClick: Function,\r\n    onErrorClick: Function,\r\n    renderLoading: Function,\r\n    renderEmpty: Function,\r\n    renderError: Function,\r\n};\r\nexport default ScrollLoad;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","React","PropTypes","classNames","Intl","selectorPrefix","ScrollLoad","_super","props","_this","lock","onScroll","bind","onEmptyClick","onErrorClick","componentDidMount","initEvents","el","addEventListener","emptyEl","errorEl","_a","loadEl","_b","distance","onScrollBottom","bottomHeight","scrollHeight","offsetHeight","scrollTop","Math","abs","style","display","status","EMPTY","ERROR","hideAll","renderLoading","loadClassName","loadStyle","createElement","className","split","ref","v","renderEmpty","emptyClassName","emptyStyle","renderError","errorClassName","errorStyle","render","children","NORMAL","Component","defaultProps","undefined","propTypes","string","object","number","Function"],"mappings":"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"}