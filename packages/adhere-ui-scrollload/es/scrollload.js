var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,l=1,t=arguments.length;l<t;l++)for(var n in r=arguments[l])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,r){var l={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(l[n[t]]=e[n[t]]);return l};import{useUpdateEffect}from"ahooks";import classNames from"classnames";import React,{forwardRef,memo,useCallback,useImperativeHandle,useLayoutEffect,useRef}from"react";import Intl from"@baifendian/adhere-util-intl";var selectorPrefix="adhere-ui-scroll-load",EMPTY="empty",HIDE_EMPTY="hide_empty",ERROR="error",NORMAL="normal",InternalScrollLoad=memo(forwardRef(function(e,r){var l=e.className,l=void 0===l?"":l,t=e.style,t=void 0===t?{}:t,n=e.loadClassName,a=void 0===n?"":n,n=e.loadStyle,o=void 0===n?{}:n,n=e.emptyClassName,s=void 0===n?"":n,n=e.emptyStyle,c=void 0===n?{}:n,n=e.errorClassName,i=void 0===n?"":n,n=e.errorStyle,u=void 0===n?{}:n,d=e.getScrollContainer,n=e.distance,f=void 0===n?50:n,m=e.renderLoading,y=e.renderEmpty,v=e.renderError,E=e.onScrollBottom,p=e.onEmptyClick,R=e.onErrorClick,n=e.disabled,L=void 0!==n&&n,n=e.children,e=__rest(e,["className","style","loadClassName","loadStyle","emptyClassName","emptyStyle","errorClassName","errorStyle","getScrollContainer","distance","renderLoading","renderEmpty","renderError","onScrollBottom","onEmptyClick","onErrorClick","disabled","children"]),N=useRef(NORMAL),_=useRef(!1),S=useRef(null),P=useRef(null),O=useRef(null),b=useRef(null);function h(){return d?d():S.current}function g(){var e=h(),r=e.scrollHeight-e.offsetHeight,e=e.scrollTop;E&&Math.abs(e-r)<=f&&([EMPTY,HIDE_EMPTY].includes(N.current)||_.current||(_.current=!0,P.current.style.display="flex",E(function(e){N.current=e,P.current.style.display="none",N.current===EMPTY?O.current.style.display="block":N.current===ERROR?b.current.style.display="block":N.current===HIDE_EMPTY&&(O.current.style.display="none"),_.current=!1})))}function C(){p&&p()}function M(){R&&R()}function k(){N.current=NORMAL,P.current.style.display="none",b.current.style.display="none",O.current.style.display="none"}var I=useCallback(function(){return m?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),a),style:null!=o?o:{},ref:P},m()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),"standard",a),style:null!=o?o:{},ref:P},Intl.v("数据加载中"))},[m,a,o]),x=useCallback(function(){return y?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:O},y()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:O},"~",Intl.v("没有更多"))},[y,s,c]),T=useCallback(function(){return v?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:b},v()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:b},Intl.v("出现错误"))},[v,i,u]);return useImperativeHandle(r,function(){return{hideAll:k,getScrollContainer:h}}),useLayoutEffect(function(){var e;return L||null!=(e=h())&&e.addEventListener("scroll",g),null!=(e=O.current)&&e.addEventListener("click",C),null!=(e=b.current)&&e.addEventListener("click",M),function(){var e;L||null!=(e=h())&&e.removeEventListener("scroll",g),null!=(e=O.current)&&e.removeEventListener("click",C),null!=(e=b.current)&&e.removeEventListener("click",M)}}),useUpdateEffect(function(){var e;return L?null!=(e=h())&&e.removeEventListener("scroll",g):(null!=(e=h())&&e.removeEventListener("scroll",g),null!=(e=h())&&e.addEventListener("scroll",g)),function(){var e;null!=(e=h())&&e.removeEventListener("scroll",g)}},[L]),React.createElement("div",__assign({},e,{className:classNames(selectorPrefix,l),style:__assign(__assign({},null!=t?t:{}),{overflowY:h()===S.current?"auto":"initial"}),ref:S}),n,I(),x(),T())})),ScrollLoad=InternalScrollLoad;ScrollLoad.displayName="ScrollLoad",ScrollLoad.EMPTY=EMPTY,ScrollLoad.ERROR=ERROR,ScrollLoad.NORMAL=NORMAL,ScrollLoad.HIDE_EMPTY=HIDE_EMPTY;export default ScrollLoad;
//# sourceMappingURL=ScrollLoad.js.map
