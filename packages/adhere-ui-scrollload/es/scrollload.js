var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,l=1,t=arguments.length;l<t;l++)for(var n in r=arguments[l])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,r){var l={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(l[n[t]]=e[n[t]]);return l};import{useUpdateEffect}from"ahooks";import classNames from"classnames";import React,{forwardRef,memo,useCallback,useImperativeHandle,useLayoutEffect,useRef}from"react";import Intl from"@baifendian/adhere-util-intl";var selectorPrefix="adhere-ui-scroll-load",EMPTY="empty",ERROR="error",NORMAL="normal",InternalScrollLoad=memo(forwardRef(function(e,r){var l=e.className,l=void 0===l?"":l,t=e.style,t=void 0===t?{}:t,n=e.loadClassName,a=void 0===n?"":n,n=e.loadStyle,o=void 0===n?{}:n,n=e.emptyClassName,s=void 0===n?"":n,n=e.emptyStyle,c=void 0===n?{}:n,n=e.errorClassName,i=void 0===n?"":n,n=e.errorStyle,u=void 0===n?{}:n,d=e.getScrollContainer,n=e.distance,m=void 0===n?50:n,f=e.renderLoading,y=e.renderEmpty,v=e.renderError,p=e.onScrollBottom,E=e.onEmptyClick,R=e.onErrorClick,n=e.disabled,N=void 0!==n&&n,n=e.children,e=__rest(e,["className","style","loadClassName","loadStyle","emptyClassName","emptyStyle","errorClassName","errorStyle","getScrollContainer","distance","renderLoading","renderEmpty","renderError","onScrollBottom","onEmptyClick","onErrorClick","disabled","children"]),L=useRef(!1),S=useRef(null),b=useRef(null),g=useRef(null),h=useRef(null);function _(){return d?d():S.current}function C(){var e=_(),r=e.scrollHeight-e.offsetHeight,e=e.scrollTop;p&&Math.abs(e-r)<=m&&(L.current||(L.current=!0,b.current.style.display="flex",p(function(e){b.current.style.display="none",e===EMPTY?g.current.style.display="block":e===ERROR&&(h.current.style.display="block"),L.current=!1})))}function O(){E&&E()}function k(){R&&R()}function P(){b.current.style.display="none",h.current.style.display="none",g.current.style.display="none"}var x=useCallback(function(){return f?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),a),style:null!=o?o:{},ref:b},f()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),"standard",a),style:null!=o?o:{},ref:b},Intl.v("数据加载中"))},[f,a,o]),I=useCallback(function(){return y?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:g},y()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:g},"~",Intl.v("没有更多"))},[y,s,c]),w=useCallback(function(){return v?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:h},v()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:h},Intl.v("出现错误"))},[v,i,u]);return useImperativeHandle(r,function(){return{hideAll:P,getScrollContainer:_}}),useLayoutEffect(function(){var e;return N||null!=(e=_())&&e.addEventListener("scroll",C),null!=(e=g.current)&&e.addEventListener("click",O),null!=(e=h.current)&&e.addEventListener("click",k),function(){var e;N||null!=(e=_())&&e.removeEventListener("scroll",C),null!=(e=g.current)&&e.removeEventListener("click",O),null!=(e=h.current)&&e.removeEventListener("click",k)}}),useUpdateEffect(function(){var e;return N?null!=(e=_())&&e.removeEventListener("scroll",C):(null!=(e=_())&&e.removeEventListener("scroll",C),null!=(e=_())&&e.addEventListener("scroll",C)),function(){var e;null!=(e=_())&&e.removeEventListener("scroll",C)}},[N]),React.createElement("div",__assign({},e,{className:classNames(selectorPrefix,l),style:__assign(__assign({},null!=t?t:{}),{overflowY:_()===S.current?"auto":"initial"}),ref:S}),n,x(),I(),w())})),ScrollLoad=InternalScrollLoad;ScrollLoad.displayName="ScrollLoad",ScrollLoad.EMPTY="empty",ScrollLoad.ERROR="error",ScrollLoad.NORMAL="normal";export default ScrollLoad;
//# sourceMappingURL=ScrollLoad.js.map
