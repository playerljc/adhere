var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,l=1,t=arguments.length;l<t;l++)for(var n in r=arguments[l])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,r){var l={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(l[n[t]]=e[n[t]]);return l};import classNames from"classnames";import React,{forwardRef,memo,useCallback,useImperativeHandle,useLayoutEffect,useRef}from"react";import Intl from"@baifendian/adhere-util-intl";var selectorPrefix="adhere-ui-scroll-load",EMPTY="empty",ERROR="error",NORMAL="normal",InternalScrollLoad=memo(forwardRef(function(e,r){var l=e.className,l=void 0===l?"":l,t=e.style,t=void 0===t?{}:t,n=e.loadClassName,a=void 0===n?"":n,n=e.loadStyle,o=void 0===n?{}:n,n=e.emptyClassName,s=void 0===n?"":n,n=e.emptyStyle,c=void 0===n?{}:n,n=e.errorClassName,i=void 0===n?"":n,n=e.errorStyle,u=void 0===n?{}:n,d=e.getScrollContainer,n=e.distance,m=void 0===n?50:n,f=e.renderLoading,y=e.renderEmpty,p=e.renderError,v=e.onScrollBottom,E=e.onEmptyClick,R=e.onErrorClick,n=e.children,e=__rest(e,["className","style","loadClassName","loadStyle","emptyClassName","emptyStyle","errorClassName","errorStyle","getScrollContainer","distance","renderLoading","renderEmpty","renderError","onScrollBottom","onEmptyClick","onErrorClick","children"]),N=useRef(!1),S=useRef(null),L=useRef(null),g=useRef(null),_=useRef(null);function b(){return d?d():S.current}function h(){var e=b(),r=e.scrollHeight-e.offsetHeight,e=e.scrollTop;v&&Math.abs(e-r)<=m&&(N.current||(N.current=!0,L.current.style.display="flex",v(function(e){L.current.style.display="none",e===EMPTY?g.current.style.display="block":e===ERROR&&(_.current.style.display="block"),N.current=!1})))}function C(){E&&E()}function O(){R&&R()}function P(){L.current.style.display="none",_.current.style.display="none",g.current.style.display="none"}var k=useCallback(function(){return f?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),a),style:null!=o?o:{},ref:L},f()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-load"),"standard",a),style:null!=o?o:{},ref:L},Intl.v("数据加载中"))},[f,a,o]),x=useCallback(function(){return y?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:g},y()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-empty"),s),style:null!=c?c:{},ref:g},"~",Intl.v("没有更多"))},[y,s,c]),I=useCallback(function(){return p?React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:_},p()):React.createElement("div",{className:classNames("".concat(selectorPrefix,"-error"),i),style:null!=u?u:{},ref:_},Intl.v("出现错误"))},[p,i,u]);return useImperativeHandle(r,function(){return{hideAll:P,getScrollContainer:b}}),useLayoutEffect(function(){var e;return null!=(e=b())&&e.addEventListener("scroll",h),null!=(e=g.current)&&e.addEventListener("click",C),null!=(e=_.current)&&e.addEventListener("click",O),function(){var e;null!=(e=b())&&e.removeEventListener("scroll",h),null!=(e=g.current)&&e.removeEventListener("click",C),null!=(e=_.current)&&e.removeEventListener("click",O)}}),React.createElement("div",__assign({},e,{className:classNames(selectorPrefix,l),style:__assign(__assign({},null!=t?t:{}),{overflowY:b()===S.current?"auto":"initial"}),ref:S}),n,k(),x(),I())})),ScrollLoad=InternalScrollLoad;ScrollLoad.displayName="ScrollLoad",ScrollLoad.EMPTY="empty",ScrollLoad.ERROR="error",ScrollLoad.NORMAL="normal";export default ScrollLoad;
//# sourceMappingURL=ScrollLoad.js.map
