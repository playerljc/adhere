"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){e[n=void 0===n?t:n]=r[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},classnames_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("classnames"))),react_1=__importStar(require("react")),adhere_ui_flexlayout_1=__importDefault(require("@baifendian/adhere-ui-flexlayout")),FlexContext=adhere_ui_flexlayout_1.default.Context,flexLayoutSelectorPrefix=adhere_ui_flexlayout_1.default.selectorPrefix,directionProp={horizontal:{page:"pageX",dimension:"width",offset:"offsetWidth"},vertical:{page:"pageY",dimension:"height",offset:"offsetHeight"}},selectorPrefix="adhere-ui-splitlayout";function toPoint(e){return Number(e.replace("%",""))/100}var SplitLayout=function(e){var r=e.className,r=void 0===r?"":r,t=e.style,t=void 0===t?{}:t,n=e.maxSize,c=void 0===n?"100%":n,n=e.minSize,i=void 0===n?10:n,u=e.onCanDrag,o=e.onDragStarted,l=e.onDragFinished,s=(e.onOut,e.onChange),a=react_1.useContext(FlexContext).direction,v=react_1.useRef(null),m=react_1.useRef(),f=react_1.useRef(),d=react_1.useRef(),F=react_1.useRef(new Map([[flexLayoutSelectorPrefix+"-fixed_"+flexLayoutSelectorPrefix+"-auto",!0],[flexLayoutSelectorPrefix+"-auto_"+flexLayoutSelectorPrefix+"-fixed",!0]])),L=react_1.useRef(!1),_=react_1.useRef(!1),E=react_1.useRef(!1),p=react_1.useRef(!1),x=react_1.useRef(0),y=react_1.useRef(0),g=react_1.useRef(0),P=react_1.useRef(0),S=react_1.useRef(0);function h(){var e=v.current,t=e.previousElementSibling,n=e.nextElementSibling;return Array.from(F.current.keys()).some(function(e){var e=e.split("_"),r=e[0],e=e[1];return(null==t?void 0:t.classList.contains(r))&&(null==n?void 0:n.classList.contains(e))})}function b(){var e=v.current,r=e.previousElementSibling,e=e.nextElementSibling;return null!=r&&r.classList.contains(flexLayoutSelectorPrefix+"-fixed")?r:e}function R(){var e=v.current,r=e.previousElementSibling,e=e.nextElementSibling;return null!=r&&r.classList.contains(flexLayoutSelectorPrefix+"-auto")?r:e}function D(){return"vertical"===a?"rowResize":"colResize"}function w(){return directionProp[a]}function O(){var e,r,t;return S.current||(e=b(),r=R(),t=w().offset,S.current=e[t]+r[t]),S.current}function M(e){var r;null!=(r=v.current)&&r.classList.add(selectorPrefix+"-"+D()),_.current=!1,L.current=!0,u&&u(e)}function j(e){var r;null!=(r=v.current)&&r.classList.remove(selectorPrefix+"-"+D()),L.current&&(E.current=!0,x.current=e[w().page],P.current=null==(r=m.current)?void 0:r[w().offset],o&&o(e))}function C(e){var r;null!=(r=v.current)&&r.classList.add(selectorPrefix+"-"+D()),E.current&&(E.current=!1,p.current=!1,L.current=!_,x.current=0,g.current=g.current+y.current,l&&l(e))}function z(e){E.current&&(E.current=!1,p.current=!1,L.current=!1,x.current=0,g.current+=y.current,l&&l(e))}function q(e){var r,t,n,u,o,l;L.current&&E.current&&(p.current=!0,l=e[w().page],y.current=l-x.current,l="prev"==(null!=(l=v.current.previousElementSibling)&&l.classList.contains(flexLayoutSelectorPrefix+"-fixed")?"prev":"next")?P.current+y.current:P.current-y.current,r=void 0,u=0,o=O(),"string"==typeof c?u=o*toPoint(c):"number"==typeof c&&(u=c),o=o<u?o:u,u=0,t=O(),n=w().offset,n=v[n],"string"==typeof i?u=t*toPoint(i):"number"==typeof i&&(u=i),t=u<n?n:u,o<=l||l<=t?o<=l?r=o:l<=t&&(r=t):r=l,m.current.style[w().dimension]=r+"px",s&&s(e))}function B(e){_.current=!0,E.current||(L.current=!1,s&&s(e))}function N(){var e;null!=(e=v.current)&&e.removeEventListener("mouseenter",M),null!=(e=v.current)&&e.addEventListener("mouseenter",M),null!=(e=v.current)&&e.removeEventListener("mousedown",j),null!=(e=v.current)&&e.addEventListener("mousedown",j),null!=(e=m.current)&&e.removeEventListener("mousemove",q),null!=(e=v.current)&&e.removeEventListener("mousemove",q),null!=(e=f.current)&&e.removeEventListener("mousemove",q),null!=(e=m.current)&&e.addEventListener("mousemove",q),null!=(e=v.current)&&e.addEventListener("mousemove",q),null!=(e=f.current)&&e.addEventListener("mousemove",q),null!=(e=m.current)&&e.removeEventListener("mouseout",B),null!=(e=v.current)&&e.removeEventListener("mouseout",B),null!=(e=f.current)&&e.removeEventListener("mouseout",B),null!=(e=m.current)&&e.addEventListener("mouseout",B),null!=(e=v.current)&&e.addEventListener("mouseout",B),null!=(e=f.current)&&e.addEventListener("mouseout",B),null!=(e=m.current)&&e.removeEventListener("mouseup",C),null!=(e=v.current)&&e.removeEventListener("mouseup",C),null!=(e=f.current)&&e.removeEventListener("mouseup",C),null!=(e=m.current)&&e.addEventListener("mouseup",C),null!=(e=v.current)&&e.addEventListener("mouseup",C),null!=(e=f.current)&&e.addEventListener("mouseup",C),null!=(e=d.current)&&e.removeEventListener("mouseleave",z),null!=(e=d.current)&&e.addEventListener("mouseleave",z)}function k(){var e;null!=(e=v.current)&&e.removeEventListener("mouseenter",M),null!=(e=v.current)&&e.removeEventListener("mouseenter",M),null!=(e=v.current)&&e.removeEventListener("mousedown",j),null!=(e=v.current)&&e.removeEventListener("mousedown",j),null!=(e=m.current)&&e.removeEventListener("mousemove",q),null!=(e=v.current)&&e.removeEventListener("mousemove",q),null!=(e=f.current)&&e.removeEventListener("mousemove",q),null!=(e=m.current)&&e.removeEventListener("mousemove",q),null!=(e=v.current)&&e.removeEventListener("mousemove",q),null!=(e=f.current)&&e.removeEventListener("mousemove",q),null!=(e=m.current)&&e.removeEventListener("mouseout",B),null!=(e=v.current)&&e.removeEventListener("mouseout",B),null!=(e=f.current)&&e.removeEventListener("mouseout",B),null!=(e=m.current)&&e.removeEventListener("mouseout",B),null!=(e=v.current)&&e.removeEventListener("mouseout",B),null!=(e=f.current)&&e.removeEventListener("mouseout",B),null!=(e=m.current)&&e.removeEventListener("mouseup",C),null!=(e=v.current)&&e.removeEventListener("mouseup",C),null!=(e=f.current)&&e.removeEventListener("mouseup",C),null!=(e=m.current)&&e.removeEventListener("mouseup",C),null!=(e=v.current)&&e.removeEventListener("mouseup",C),null!=(e=f.current)&&e.removeEventListener("mouseup",C),null!=(e=d.current)&&e.removeEventListener("mouseleave",z),null!=(e=d.current)&&e.removeEventListener("mouseleave",z)}return react_1.useLayoutEffect(function(){var e;return h()&&(m.current=b(),f.current=R(),d.current=null==(e=v.current)?void 0:e.parentElement,d.current.classList.add(selectorPrefix+"-noSelect"),N()),k},[]),react_1.useLayoutEffect(function(){return h()&&(L.current=!1,_.current=!1,E.current=!1,p.current=!1,x.current=0,y.current=0,g.current=0,P.current=0,S.current=0,m.current=b(),f.current=R(),N()),k}),react_1.default.createElement("div",{ref:v,className:classnames_1.default(selectorPrefix,selectorPrefix+"-"+a,r||""),style:t||{}})};exports.default=react_1.memo(SplitLayout);
//# sourceMappingURL=splitlayout.js.map
