import React,{useContext,useLayoutEffect,useRef}from"react";import classNames from"classnames";import FlexLayout from"@baifendian/adhere-ui-flexlayout";var FlexContext=FlexLayout.Context,flexLayoutSelectorPrefix=FlexLayout.selectorPrefix,directionProp={horizontal:{page:"pageX",dimension:"width",offset:"offsetWidth"},vertical:{page:"pageY",dimension:"height",offset:"offsetHeight"}},selectorPrefix="adhere-ui-splitlayout";function toPoint(e){return Number(e.replace("%",""))/100}var SplitLayout=function(e){var r=e.className,n=void 0===r?"":r,t=e.style,r=void 0===t?{}:t,t=e.maxSize,l=void 0===t?"100%":t,t=e.minSize,s=void 0===t?10:t,u=e.onCanDrag,o=e.onDragStarted,i=e.onDragFinished,v=(e.onOut,e.onChange),c=useContext(FlexContext).direction,m=useRef(null),d=useRef(),a=useRef(),f=useRef(),L=useRef(new Map([[flexLayoutSelectorPrefix+"-fixed_"+flexLayoutSelectorPrefix+"-auto",!0],[flexLayoutSelectorPrefix+"-auto_"+flexLayoutSelectorPrefix+"-fixed",!0]])),E=useRef(!1),x=useRef(!1),p=useRef(!1),y=useRef(!1),g=useRef(0),P=useRef(0),S=useRef(0),R=useRef(0),b=useRef(0);function h(){var e=m.current,n=e.previousElementSibling,t=e.nextElementSibling;return Array.from(L.current.keys()).some(function(e){var r=e.split("_"),e=r[0],r=r[1];return(null==n?void 0:n.classList.contains(e))&&(null==t?void 0:t.classList.contains(r))})}function w(){var e=m.current,r=e.previousElementSibling,e=e.nextElementSibling;return null!=r&&r.classList.contains(flexLayoutSelectorPrefix+"-fixed")?r:e}function C(){var e=m.current,r=e.previousElementSibling,e=e.nextElementSibling;return null!=r&&r.classList.contains(flexLayoutSelectorPrefix+"-auto")?r:e}function F(){return"vertical"===c?"rowResize":"colResize"}function z(){return directionProp[c]}function N(){if(b.current)return b.current;var e=w(),r=C(),n=z().offset;return b.current=e[n]+r[n],b.current}function D(e){var r;null!==(r=m.current)&&void 0!==r&&r.classList.add(selectorPrefix+"-"+F()),x.current=!1,E.current=!0,u&&u(e)}function _(e){var r;null!==(r=m.current)&&void 0!==r&&r.classList.remove(selectorPrefix+"-"+F()),E.current&&(p.current=!0,g.current=e[z().page],R.current=null===(r=d.current)||void 0===r?void 0:r[z().offset],o&&o(e))}function k(e){var r;null!==(r=m.current)&&void 0!==r&&r.classList.add(selectorPrefix+"-"+F()),p.current&&(p.current=!1,y.current=!1,E.current=!x,g.current=0,S.current=S.current+P.current,i&&i(e))}function A(e){p.current&&(p.current=!1,y.current=!1,E.current=!1,g.current=0,S.current+=P.current,i&&i(e))}function H(e){var r,n,t,u,o,i;E.current&&p.current&&(y.current=!0,t=e[z().page],P.current=t-g.current,r="prev"==(null!=(i=m.current.previousElementSibling)&&i.classList.contains(flexLayoutSelectorPrefix+"-fixed")?"prev":"next")?R.current+P.current:R.current-P.current,n=void 0,u=0,o=N(),"string"==typeof l?u=o*toPoint(l):"number"==typeof l&&(u=l),t=o<u?o:u,i=0,o=N(),u=z().offset,u=m[u],"string"==typeof s?i=o*toPoint(s):"number"==typeof s&&(i=s),i=i<u?u:i,t<=r||r<=i?t<=r?n=t:r<=i&&(n=i):n=r,d.current.style[z().dimension]=n+"px",v&&v(e))}function M(e){x.current=!0,p.current||(E.current=!1,v&&v(e))}function O(){var e;null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseenter",D),null!==(e=m.current)&&void 0!==e&&e.addEventListener("mouseenter",D),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousedown",_),null!==(e=m.current)&&void 0!==e&&e.addEventListener("mousedown",_),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=d.current)&&void 0!==e&&e.addEventListener("mousemove",H),null!==(e=m.current)&&void 0!==e&&e.addEventListener("mousemove",H),null!==(e=a.current)&&void 0!==e&&e.addEventListener("mousemove",H),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=d.current)&&void 0!==e&&e.addEventListener("mouseout",M),null!==(e=m.current)&&void 0!==e&&e.addEventListener("mouseout",M),null!==(e=a.current)&&void 0!==e&&e.addEventListener("mouseout",M),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=d.current)&&void 0!==e&&e.addEventListener("mouseup",k),null!==(e=m.current)&&void 0!==e&&e.addEventListener("mouseup",k),null!==(e=a.current)&&void 0!==e&&e.addEventListener("mouseup",k),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseleave",A),null!==(e=f.current)&&void 0!==e&&e.addEventListener("mouseleave",A)}function W(){var e;null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseenter",D),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseenter",D),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousedown",_),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousedown",_),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mousemove",H),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseout",M),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=d.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=m.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=a.current)&&void 0!==e&&e.removeEventListener("mouseup",k),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseleave",A),null!==(e=f.current)&&void 0!==e&&e.removeEventListener("mouseleave",A)}return useLayoutEffect(function(){var e;return h()&&(d.current=w(),a.current=C(),f.current=null===(e=m.current)||void 0===e?void 0:e.parentElement,f.current.classList.add(selectorPrefix+"-noSelect"),O()),W},[]),useLayoutEffect(function(){return h()&&(E.current=!1,x.current=!1,p.current=!1,y.current=!1,g.current=0,P.current=0,S.current=0,R.current=0,b.current=0,d.current=w(),a.current=C(),O()),W}),React.createElement("div",{ref:m,className:classNames(selectorPrefix,selectorPrefix+"-"+c,n||""),style:r||{}})};export default SplitLayout;
//# sourceMappingURL=splitlayout.js.map
