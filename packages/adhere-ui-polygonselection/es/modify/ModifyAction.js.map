{"version":3,"file":"ModifyAction.js","sources":["modify/ModifyAction.js"],"sourcesContent":["var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport MathUtil from '@baifendian/adhere-util';\nimport Emitter from '@baifendian/adhere-util-emitter';\nimport defaultAnchorStyle from '../defaultAnchorStyle';\nimport defaultMoveGemStyle from '../defaultMoveGemStyle';\nimport defaultStyle from '../defaultStyle';\nimport { ActionEvents, ActionStatus, ActionType } from '../types';\n/**\n * ModifyAction\n * @class ModifyAction\n * @classdesc ModifyAction\n */\nvar ModifyAction = /** @class */function (_super) {\n  __extends(ModifyAction, _super);\n  /**\n   * constructor\n   * @param data\n   */\n  function ModifyAction(data) {\n    var _this = _super.call(this) || this;\n    // 上下文对象\n    _this.context = null;\n    // 起始点\n    _this.startPoint = null;\n    // 起始点的索引\n    _this.startIndex = -1;\n    // 数据\n    _this.data = null;\n    // 当前状态\n    _this.status = ActionStatus.UnStart;\n    // EmitActions\n    _this.EmitActions = {\n      CONTEXT: 'CONTEXT'\n    };\n    // anchor的半径\n    _this.anchorRadius = 5;\n    // anchorWidth\n    _this.anchorLineWidth = 2;\n    // 移动的以第一个点\n    _this.moveStartPoint = null;\n    // 是否可以移动\n    _this.canMove = false;\n    // 是都已经移动\n    _this.isMoved = false;\n    // 样式对象\n    _this.style = __assign({}, defaultStyle);\n    // 修改样式对象\n    _this.anchorStyle = __assign({}, defaultAnchorStyle);\n    // 移动样式对象\n    _this.moveGemStyle = __assign({}, defaultMoveGemStyle);\n    _this.data = data;\n    _this.onContext = _this.onContext.bind(_this);\n    // 修改相关的\n    _this.onCanvasMousedown = _this.onCanvasMousedown.bind(_this);\n    _this.onCanvasMousemove = _this.onCanvasMousemove.bind(_this);\n    _this.onCanvasMouseup = _this.onCanvasMouseup.bind(_this);\n    // 是否可以修改的移动\n    _this.onCanvasIsModifyMousemove = _this.onCanvasIsModifyMousemove.bind(_this);\n    // move的相关事件\n    _this.onMoveMousedown = _this.onMoveMousedown.bind(_this);\n    _this.onMoveMousemove = _this.onMoveMousemove.bind(_this);\n    _this.onMoveMouseup = _this.onMoveMouseup.bind(_this);\n    _this.on(_this.EmitActions.CONTEXT, _this.onContext);\n    return _this;\n  }\n  ModifyAction.prototype.getAnchorStyle = function () {\n    return __assign({}, this.anchorStyle);\n  };\n  ModifyAction.prototype.getStyle = function () {\n    return __assign({}, this.style);\n  };\n  ModifyAction.prototype.getMoveGemStyle = function () {\n    return __assign({}, this.moveGemStyle);\n  };\n  ModifyAction.prototype.setAnchorStyle = function (style) {\n    this.anchorStyle = __assign(__assign({}, defaultAnchorStyle), style !== null && style !== void 0 ? style : {});\n  };\n  ModifyAction.prototype.setStyle = function (style) {\n    this.style = __assign(__assign({}, defaultStyle), style !== null && style !== void 0 ? style : {});\n  };\n  ModifyAction.prototype.setMoveGemStyle = function (style) {\n    this.moveGemStyle = __assign(__assign({}, defaultMoveGemStyle), style !== null && style !== void 0 ? style : {});\n  };\n  /**\n   * setAnchorCircleStyle\n   */\n  ModifyAction.prototype.setAnchorCircleStyle = function () {\n    if (!this.context) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    // anchor上下文\n    ctx.strokeStyle = this.anchorStyle.strokeStyle;\n    ctx.fillStyle = this.anchorStyle.fillStyle;\n    ctx.lineWidth = this.anchorStyle.lineWidth;\n    ctx.globalAlpha = this.anchorStyle.globalAlpha;\n  };\n  /**\n   * setAnchorLineStyle\n   */\n  ModifyAction.prototype.setAnchorLineStyle = function () {\n    if (!this.context) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    // anchor上下文\n    ctx.strokeStyle = this.anchorStyle.strokeStyle;\n    ctx.lineWidth = this.anchorStyle.lineWidth;\n    ctx.setLineDash(this.anchorStyle.lineDash);\n    ctx.lineDashOffset = this.anchorStyle.lineDashOffset;\n  };\n  /**\n   * onContext\n   */\n  ModifyAction.prototype.onContext = function () {\n    this.drawAnchors();\n  };\n  /**\n   * onCanvasMousedown\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMousedown = function (e) {\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    if (!canvasEl) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    var point = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    // 判断按下的startPoint是否为anchor点\n    // 用isPointInPath判断只能判断出point在路径中，但是不能获取anchor的中心点\n    // 需要判断point在那个anchor里才可以，这样可以获取命中的圆形中心点\n    var findPoint = this.getPointInAnchor(point);\n    if (!findPoint) return;\n    // this.startPoint需要赋值为anchor圆形的中心点\n    this.startPoint = findPoint.point;\n    this.startIndex = findPoint.index;\n    canvasEl.addEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.addEventListener('mouseup', this.onCanvasMouseup);\n  };\n  /**\n   * onCanvasMousemove\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMousemove = function (e) {\n    // console.log('onCanvasMousemove');\n    e.stopPropagation();\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    if (!canvasEl) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    if (!this.startPoint) return;\n    // target点\n    var targetPoint = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    this.drawModify(targetPoint);\n    this.trigger(ActionEvents.Modifying, this.data);\n  };\n  /**\n   * onCanvasMouseup\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMouseup = function (e) {\n    this.end(e);\n    e.stopPropagation();\n  };\n  /**\n   * onCanvasIsModifyMousemove\n   * @description 这个事件主要是用来控制移动到anchor点上的时候鼠标指针显示为可以修改的形状\n   * ew-resize\n     ns-resize\n     nesw-resize\n     nwse-resize\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasIsModifyMousemove = function (e) {\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    var assistCanvasEl = this.context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    // 如果已经进入了修改模式则不执行其他操作\n    if (this.startPoint || this.moveStartPoint) return;\n    // console.log('modify-mousemove');\n    var point = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    // 判断按下的startPoint是否为anchor点\n    // 用isPointInPath判断只能判断出point在路径中，但是不能获取anchor的中心点\n    // 需要判断point在那个anchor里才可以，这样可以获取命中的圆形中心点\n    var findPoint = this.getPointInAnchor(point);\n    if (findPoint) {\n      this.setResizeCursorByIndex(findPoint.index);\n    } else {\n      canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    }\n  };\n  /**\n   * initMoveEvents\n   * @description 注册移动相关的事件\n   */\n  ModifyAction.prototype.initMoveEvents = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.addEventListener('mousedown', this.onMoveMousedown);\n    canvasEl.addEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.addEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.addEventListener('mouseup', this.onMoveMouseup);\n  };\n  /**\n   * clearMoveEvents\n   * @description - 清除移动相关的事件\n   */\n  ModifyAction.prototype.clearMoveEvents = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.removeEventListener('mousedown', this.onMoveMousedown);\n    canvasEl.removeEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.removeEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.removeEventListener('mouseup', this.onMoveMouseup);\n  };\n  /**\n   * onMoveMouseup\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMousedown = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    if (!this.canMove) return;\n    // console.log('onMoveMousedown', this.canMove);\n    // assistCanvas置顶\n    context.setFrontCanvas(assistCanvasEl);\n    this.moveStartPoint = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    // TODO: 绘制一个移动的图形\n    this.drawMoveGeometry();\n  };\n  /**\n   * onMoveMousedown\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMousemove = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    var targetPoint = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    // 开始移动了\n    if (this.moveStartPoint) {\n      // console.log('onMoveMousemove', this.moveStartPoint);\n      this.isMoved = true;\n      // TODO: 移动移动的图形\n      context.clearAssistDraw();\n      var moveData = this.drawMoveGeometry(this.moveStartPoint, targetPoint);\n      this.trigger(ActionEvents.Moving, {\n        selectType: this.getSelectType(),\n        actionType: ActionType.Move,\n        data: moveData\n      });\n      return;\n    }\n    // 查看是否可以移动从而改变光标的样式，查看targetPoint是否在Anchors的多边形区域中，不包括anchor的控制点\n    this.canMove = this.isCanMove(targetPoint);\n    var curCursor = assistCanvasEl.style.cursor;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = this.canMove ? 'move' : curCursor;\n  };\n  /**\n   * onMoveMousemove\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMouseup = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    if (!this.canMove || !this.isMoved || !this.moveStartPoint) {\n      // assistCanvas置部\n      context.setBackCanvas(assistCanvasEl);\n      this.canMove = false;\n      this.isMoved = false;\n      this.moveStartPoint = null;\n      return;\n    }\n    // console.log('onMoveMouseup');\n    // assistCanvas置部\n    context.setBackCanvas(assistCanvasEl);\n    // TODO: 移动真正的图形，擦除移动的图形\n    var targetPoint = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    context.clearAssistDraw();\n    this.drawMove(this.moveStartPoint, targetPoint);\n    this.canMove = false;\n    this.isMoved = false;\n    this.moveStartPoint = null;\n    e.stopPropagation();\n    this.trigger(ActionEvents.MoveEnd, this.data);\n  };\n  /**\n   * start\n   */\n  ModifyAction.prototype.start = function () {\n    var _a, _b;\n    if (!this.context || [ActionStatus.Running, ActionStatus.Destroy].includes(this.status)) return;\n    var context = this.context;\n    var canvasEl = (_a = context === null || context === void 0 ? void 0 : context.getCanvasEl) === null || _a === void 0 ? void 0 : _a.call(context);\n    var assistCanvasEl = (_b = context === null || context === void 0 ? void 0 : context.getAssistCanvasEl) === null || _b === void 0 ? void 0 : _b.call(context);\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    // 触发开始之前事件\n    this.trigger(ActionEvents.ModifyBeforeStart, {\n      selectType: this.getSelectType(),\n      actionType: ActionType.Modify\n    });\n    // 注册事件按下事件\n    canvasEl.addEventListener('mousedown', this.onCanvasMousedown);\n    // 注册监控是否可以修改的移动事件\n    canvasEl.addEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.initMoveEvents();\n    // 修改状态\n    this.status = ActionStatus.Running;\n    // 触发开始事件\n    this.trigger(ActionEvents.ModifyStart, {\n      selectType: this.getSelectType(),\n      actionType: ActionType.Modify\n    });\n  };\n  /**\n   * end\n   * @param e\n   */\n  ModifyAction.prototype.end = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    canvasEl.removeEventListener('mousedown', this.onCanvasMousedown);\n    canvasEl.removeEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.removeEventListener('mouseup', this.onCanvasMouseup);\n    canvasEl.removeEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.clearMoveEvents();\n    var targetPoint = MathUtil.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    this.drawModify(targetPoint);\n    this.status = ActionStatus.End;\n    this.startPoint = null;\n    this.trigger(ActionEvents.ModifyEnd, this.data);\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n  };\n  /**\n   * destroy\n   */\n  ModifyAction.prototype.destroy = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    this.remove(this.EmitActions.CONTEXT, this.onContext);\n    canvasEl.removeEventListener('mousedown', this.onCanvasMousedown);\n    canvasEl.removeEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.removeEventListener('mouseup', this.onCanvasMouseup);\n    canvasEl.removeEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.clearMoveEvents();\n    context.clearDraw();\n    context.drawHistoryData();\n    this.status = ActionStatus.Destroy;\n    this.startPoint = null;\n    this.trigger(ActionEvents.Destroy, {\n      selectType: this.getSelectType(),\n      actionType: ActionType.Modify\n    });\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n  };\n  /**\n   * setContext\n   * @param context\n   */\n  ModifyAction.prototype.setContext = function (context) {\n    this.context = context;\n    this.trigger(this.EmitActions.CONTEXT);\n  };\n  /**\n   * getStatus - 获取状态\n   */\n  ModifyAction.prototype.getStatus = function () {\n    return this.status;\n  };\n  return ModifyAction;\n}(Emitter.Events);\nexport default ModifyAction;"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","MathUtil","Emitter","defaultAnchorStyle","defaultMoveGemStyle","defaultStyle","ActionEvents","ActionStatus","ActionType","ModifyAction","_super","data","_this","context","startPoint","startIndex","status","UnStart","EmitActions","CONTEXT","anchorRadius","anchorLineWidth","moveStartPoint","canMove","isMoved","style","anchorStyle","moveGemStyle","onContext","bind","onCanvasMousedown","onCanvasMousemove","onCanvasMouseup","onCanvasIsModifyMousemove","onMoveMousedown","onMoveMousemove","onMoveMouseup","on","getAnchorStyle","getStyle","getMoveGemStyle","setAnchorStyle","setStyle","setMoveGemStyle","setAnchorCircleStyle","ctx","getCtx","strokeStyle","fillStyle","lineWidth","globalAlpha","setAnchorLineStyle","setLineDash","lineDash","lineDashOffset","drawAnchors","e","canvasEl","getCanvasEl","point","clientToCtxPoint","event","rect","getBoundingClientRect","findPoint","getPointInAnchor","index","addEventListener","stopPropagation","targetPoint","drawModify","trigger","Modifying","end","assistCanvasEl","getAssistCanvasEl","setResizeCursorByIndex","cursor","initMoveEvents","clearMoveEvents","removeEventListener","setFrontCanvas","drawMoveGeometry","curCursor","clearAssistDraw","moveData","Moving","selectType","getSelectType","actionType","Move","isCanMove","setBackCanvas","drawMove","MoveEnd","start","Running","Destroy","includes","_a","_b","ModifyBeforeStart","Modify","ModifyStart","End","ModifyEnd","destroy","remove","clearDraw","drawHistoryData","setContext","getStatus","Events"],"mappings":"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"}