{"version":3,"file":"ModifyAction.js","sources":["modify/ModifyAction.js"],"sourcesContent":["\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\nvar adhere_util_emitter_1 = __importDefault(require(\"@baifendian/adhere-util-emitter\"));\nvar defaultAnchorStyle_1 = __importDefault(require(\"../defaultAnchorStyle\"));\nvar defaultMoveGemStyle_1 = __importDefault(require(\"../defaultMoveGemStyle\"));\nvar defaultStyle_1 = __importDefault(require(\"../defaultStyle\"));\nvar types_1 = require(\"../types\");\n/**\n * ModifyAction\n * @class ModifyAction\n * @classdesc ModifyAction\n */\nvar ModifyAction = /** @class */function (_super) {\n  __extends(ModifyAction, _super);\n  /**\n   * constructor\n   * @param data\n   */\n  function ModifyAction(data) {\n    var _this = _super.call(this) || this;\n    // 上下文对象\n    _this.context = null;\n    // 起始点\n    _this.startPoint = null;\n    // 起始点的索引\n    _this.startIndex = -1;\n    // 数据\n    _this.data = null;\n    // 当前状态\n    _this.status = types_1.ActionStatus.UnStart;\n    // EmitActions\n    _this.EmitActions = {\n      CONTEXT: 'CONTEXT'\n    };\n    // anchor的半径\n    _this.anchorRadius = 5;\n    // anchorWidth\n    _this.anchorLineWidth = 2;\n    // 移动的以第一个点\n    _this.moveStartPoint = null;\n    // 是否可以移动\n    _this.canMove = false;\n    // 是都已经移动\n    _this.isMoved = false;\n    // 样式对象\n    _this.style = __assign({}, defaultStyle_1.default);\n    // 修改样式对象\n    _this.anchorStyle = __assign({}, defaultAnchorStyle_1.default);\n    // 移动样式对象\n    _this.moveGemStyle = __assign({}, defaultMoveGemStyle_1.default);\n    _this.data = data;\n    _this.onContext = _this.onContext.bind(_this);\n    // 修改相关的\n    _this.onCanvasMousedown = _this.onCanvasMousedown.bind(_this);\n    _this.onCanvasMousemove = _this.onCanvasMousemove.bind(_this);\n    _this.onCanvasMouseup = _this.onCanvasMouseup.bind(_this);\n    // 是否可以修改的移动\n    _this.onCanvasIsModifyMousemove = _this.onCanvasIsModifyMousemove.bind(_this);\n    // move的相关事件\n    _this.onMoveMousedown = _this.onMoveMousedown.bind(_this);\n    _this.onMoveMousemove = _this.onMoveMousemove.bind(_this);\n    _this.onMoveMouseup = _this.onMoveMouseup.bind(_this);\n    _this.on(_this.EmitActions.CONTEXT, _this.onContext);\n    return _this;\n  }\n  ModifyAction.prototype.getAnchorStyle = function () {\n    return __assign({}, this.anchorStyle);\n  };\n  ModifyAction.prototype.getStyle = function () {\n    return __assign({}, this.style);\n  };\n  ModifyAction.prototype.getMoveGemStyle = function () {\n    return __assign({}, this.moveGemStyle);\n  };\n  ModifyAction.prototype.setAnchorStyle = function (style) {\n    this.anchorStyle = __assign(__assign({}, defaultAnchorStyle_1.default), style !== null && style !== void 0 ? style : {});\n  };\n  ModifyAction.prototype.setStyle = function (style) {\n    this.style = __assign(__assign({}, defaultStyle_1.default), style !== null && style !== void 0 ? style : {});\n  };\n  ModifyAction.prototype.setMoveGemStyle = function (style) {\n    this.moveGemStyle = __assign(__assign({}, defaultMoveGemStyle_1.default), style !== null && style !== void 0 ? style : {});\n  };\n  /**\n   * setAnchorCircleStyle\n   */\n  ModifyAction.prototype.setAnchorCircleStyle = function () {\n    if (!this.context) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    // anchor上下文\n    ctx.strokeStyle = this.anchorStyle.strokeStyle;\n    ctx.fillStyle = this.anchorStyle.fillStyle;\n    ctx.lineWidth = this.anchorStyle.lineWidth;\n    ctx.globalAlpha = this.anchorStyle.globalAlpha;\n  };\n  /**\n   * setAnchorLineStyle\n   */\n  ModifyAction.prototype.setAnchorLineStyle = function () {\n    if (!this.context) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    // anchor上下文\n    ctx.strokeStyle = this.anchorStyle.strokeStyle;\n    ctx.lineWidth = this.anchorStyle.lineWidth;\n    ctx.setLineDash(this.anchorStyle.lineDash);\n    ctx.lineDashOffset = this.anchorStyle.lineDashOffset;\n  };\n  /**\n   * onContext\n   */\n  ModifyAction.prototype.onContext = function () {\n    this.drawAnchors();\n  };\n  /**\n   * onCanvasMousedown\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMousedown = function (e) {\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    if (!canvasEl) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    var point = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    // 判断按下的startPoint是否为anchor点\n    // 用isPointInPath判断只能判断出point在路径中，但是不能获取anchor的中心点\n    // 需要判断point在那个anchor里才可以，这样可以获取命中的圆形中心点\n    var findPoint = this.getPointInAnchor(point);\n    if (!findPoint) return;\n    // this.startPoint需要赋值为anchor圆形的中心点\n    this.startPoint = findPoint.point;\n    this.startIndex = findPoint.index;\n    canvasEl.addEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.addEventListener('mouseup', this.onCanvasMouseup);\n  };\n  /**\n   * onCanvasMousemove\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMousemove = function (e) {\n    // console.log('onCanvasMousemove');\n    e.stopPropagation();\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    if (!canvasEl) return;\n    var ctx = this.context.getCtx();\n    if (!ctx) return;\n    if (!this.startPoint) return;\n    // target点\n    var targetPoint = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    this.drawModify(targetPoint);\n    this.trigger(types_1.ActionEvents.Modifying, this.data);\n  };\n  /**\n   * onCanvasMouseup\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasMouseup = function (e) {\n    this.end(e);\n    e.stopPropagation();\n  };\n  /**\n   * onCanvasIsModifyMousemove\n   * @description 这个事件主要是用来控制移动到anchor点上的时候鼠标指针显示为可以修改的形状\n   * ew-resize\n     ns-resize\n     nesw-resize\n     nwse-resize\n   * @param e\n   */\n  ModifyAction.prototype.onCanvasIsModifyMousemove = function (e) {\n    if (!this.context) return;\n    var canvasEl = this.context.getCanvasEl();\n    var assistCanvasEl = this.context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    // 如果已经进入了修改模式则不执行其他操作\n    if (this.startPoint || this.moveStartPoint) return;\n    // console.log('modify-mousemove');\n    var point = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    // 判断按下的startPoint是否为anchor点\n    // 用isPointInPath判断只能判断出point在路径中，但是不能获取anchor的中心点\n    // 需要判断point在那个anchor里才可以，这样可以获取命中的圆形中心点\n    var findPoint = this.getPointInAnchor(point);\n    if (findPoint) {\n      this.setResizeCursorByIndex(findPoint.index);\n    } else {\n      canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    }\n  };\n  /**\n   * initMoveEvents\n   * @description 注册移动相关的事件\n   */\n  ModifyAction.prototype.initMoveEvents = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.addEventListener('mousedown', this.onMoveMousedown);\n    canvasEl.addEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.addEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.addEventListener('mouseup', this.onMoveMouseup);\n  };\n  /**\n   * clearMoveEvents\n   * @description - 清除移动相关的事件\n   */\n  ModifyAction.prototype.clearMoveEvents = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.removeEventListener('mousedown', this.onMoveMousedown);\n    canvasEl.removeEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.removeEventListener('mousemove', this.onMoveMousemove);\n    assistCanvasEl.removeEventListener('mouseup', this.onMoveMouseup);\n  };\n  /**\n   * onMoveMouseup\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMousedown = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    if (!this.canMove) return;\n    // console.log('onMoveMousedown', this.canMove);\n    // assistCanvas置顶\n    context.setFrontCanvas(assistCanvasEl);\n    this.moveStartPoint = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    // TODO: 绘制一个移动的图形\n    this.drawMoveGeometry();\n  };\n  /**\n   * onMoveMousedown\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMousemove = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    var targetPoint = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    // 开始移动了\n    if (this.moveStartPoint) {\n      // console.log('onMoveMousemove', this.moveStartPoint);\n      this.isMoved = true;\n      // TODO: 移动移动的图形\n      context.clearAssistDraw();\n      var moveData = this.drawMoveGeometry(this.moveStartPoint, targetPoint);\n      this.trigger(types_1.ActionEvents.Moving, {\n        selectType: this.getSelectType(),\n        actionType: types_1.ActionType.Move,\n        data: moveData\n      });\n      return;\n    }\n    // 查看是否可以移动从而改变光标的样式，查看targetPoint是否在Anchors的多边形区域中，不包括anchor的控制点\n    this.canMove = this.isCanMove(targetPoint);\n    var curCursor = assistCanvasEl.style.cursor;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = this.canMove ? 'move' : curCursor;\n  };\n  /**\n   * onMoveMousemove\n   * @description\n   * @param e\n   */\n  ModifyAction.prototype.onMoveMouseup = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    if (!this.canMove || !this.isMoved || !this.moveStartPoint) {\n      // assistCanvas置部\n      context.setBackCanvas(assistCanvasEl);\n      this.canMove = false;\n      this.isMoved = false;\n      this.moveStartPoint = null;\n      return;\n    }\n    // console.log('onMoveMouseup');\n    // assistCanvas置部\n    context.setBackCanvas(assistCanvasEl);\n    // TODO: 移动真正的图形，擦除移动的图形\n    var targetPoint = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl.getBoundingClientRect()\n    });\n    context.clearAssistDraw();\n    this.drawMove(this.moveStartPoint, targetPoint);\n    this.canMove = false;\n    this.isMoved = false;\n    this.moveStartPoint = null;\n    e.stopPropagation();\n    this.trigger(types_1.ActionEvents.MoveEnd, this.data);\n  };\n  /**\n   * start\n   */\n  ModifyAction.prototype.start = function () {\n    var _a, _b;\n    if (!this.context || [types_1.ActionStatus.Running, types_1.ActionStatus.Destroy].includes(this.status)) return;\n    var context = this.context;\n    var canvasEl = (_a = context === null || context === void 0 ? void 0 : context.getCanvasEl) === null || _a === void 0 ? void 0 : _a.call(context);\n    var assistCanvasEl = (_b = context === null || context === void 0 ? void 0 : context.getAssistCanvasEl) === null || _b === void 0 ? void 0 : _b.call(context);\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    // 触发开始之前事件\n    this.trigger(types_1.ActionEvents.ModifyBeforeStart, {\n      selectType: this.getSelectType(),\n      actionType: types_1.ActionType.Modify\n    });\n    // 注册事件按下事件\n    canvasEl.addEventListener('mousedown', this.onCanvasMousedown);\n    // 注册监控是否可以修改的移动事件\n    canvasEl.addEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.initMoveEvents();\n    // 修改状态\n    this.status = types_1.ActionStatus.Running;\n    // 触发开始事件\n    this.trigger(types_1.ActionEvents.ModifyStart, {\n      selectType: this.getSelectType(),\n      actionType: types_1.ActionType.Modify\n    });\n  };\n  /**\n   * end\n   * @param e\n   */\n  ModifyAction.prototype.end = function (e) {\n    if (!e) return;\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    canvasEl.removeEventListener('mousedown', this.onCanvasMousedown);\n    canvasEl.removeEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.removeEventListener('mouseup', this.onCanvasMouseup);\n    canvasEl.removeEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.clearMoveEvents();\n    var targetPoint = adhere_util_1.default.clientToCtxPoint({\n      event: e,\n      rect: canvasEl === null || canvasEl === void 0 ? void 0 : canvasEl.getBoundingClientRect()\n    });\n    this.drawModify(targetPoint);\n    this.status = types_1.ActionStatus.End;\n    this.startPoint = null;\n    this.trigger(types_1.ActionEvents.ModifyEnd, this.data);\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n  };\n  /**\n   * destroy\n   */\n  ModifyAction.prototype.destroy = function () {\n    var context = this.context;\n    if (!context) return;\n    var canvasEl = context.getCanvasEl();\n    var assistCanvasEl = context.getAssistCanvasEl();\n    if (!canvasEl || !assistCanvasEl) return;\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n    this.remove(this.EmitActions.CONTEXT, this.onContext);\n    canvasEl.removeEventListener('mousedown', this.onCanvasMousedown);\n    canvasEl.removeEventListener('mousemove', this.onCanvasMousemove);\n    canvasEl.removeEventListener('mouseup', this.onCanvasMouseup);\n    canvasEl.removeEventListener('mousemove', this.onCanvasIsModifyMousemove);\n    this.clearMoveEvents();\n    context.clearDraw();\n    context.drawHistoryData();\n    this.status = types_1.ActionStatus.Destroy;\n    this.startPoint = null;\n    this.trigger(types_1.ActionEvents.Destroy, {\n      selectType: this.getSelectType(),\n      actionType: types_1.ActionType.Modify\n    });\n    canvasEl.style.cursor = assistCanvasEl.style.cursor = 'default';\n  };\n  /**\n   * setContext\n   * @param context\n   */\n  ModifyAction.prototype.setContext = function (context) {\n    this.context = context;\n    this.trigger(this.EmitActions.CONTEXT);\n  };\n  /**\n   * getStatus - 获取状态\n   */\n  ModifyAction.prototype.getStatus = function () {\n    return this.status;\n  };\n  return ModifyAction;\n}(adhere_util_emitter_1.default.Events);\nexports.default = ModifyAction;"],"names":["__extends","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__importDefault","mod","__esModule","default","adhere_util_1","defineProperty","exports","value","require","adhere_util_emitter_1","defaultAnchorStyle_1","defaultMoveGemStyle_1","defaultStyle_1","types_1","ModifyAction","_super","data","_this","context","startPoint","startIndex","status","ActionStatus","UnStart","EmitActions","CONTEXT","anchorRadius","anchorLineWidth","moveStartPoint","canMove","isMoved","style","anchorStyle","moveGemStyle","onContext","bind","onCanvasMousedown","onCanvasMousemove","onCanvasMouseup","onCanvasIsModifyMousemove","onMoveMousedown","onMoveMousemove","onMoveMouseup","on","getAnchorStyle","getStyle","getMoveGemStyle","setAnchorStyle","setStyle","setMoveGemStyle","setAnchorCircleStyle","ctx","getCtx","strokeStyle","fillStyle","lineWidth","globalAlpha","setAnchorLineStyle","setLineDash","lineDash","lineDashOffset","drawAnchors","e","canvasEl","getCanvasEl","point","clientToCtxPoint","event","rect","getBoundingClientRect","findPoint","getPointInAnchor","index","addEventListener","stopPropagation","targetPoint","drawModify","trigger","ActionEvents","Modifying","end","assistCanvasEl","getAssistCanvasEl","setResizeCursorByIndex","cursor","initMoveEvents","clearMoveEvents","removeEventListener","setFrontCanvas","drawMoveGeometry","curCursor","clearAssistDraw","moveData","Moving","selectType","getSelectType","actionType","ActionType","Move","isCanMove","setBackCanvas","drawMove","MoveEnd","start","Running","Destroy","includes","_a","_b","ModifyBeforeStart","Modify","ModifyStart","End","ModifyEnd","destroy","remove","clearDraw","drawHistoryData","setContext","getStatus","Events"],"mappings":"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"}