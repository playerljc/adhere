{"version":3,"file":"pullrefresh.js","sources":["pullrefresh.js"],"sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importStar(require(\"react\"));\r\nvar classnames_1 = __importDefault(require(\"classnames\"));\r\nvar moment_1 = __importDefault(require(\"moment\"));\r\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\r\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\r\nvar adhere_util_resource_1 = __importDefault(require(\"@baifendian/adhere-util-resource\"));\r\nvar adhere_ui_hooks_1 = __importDefault(require(\"@baifendian/adhere-ui-hooks\"));\r\nvar selectorPrefix = 'adhere-ui-pullrefresh';\r\nvar defaultImg = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHN0eWxlPSJ3aWR0aDozMDhweDtoZWlnaHQ6MzA4cHg7IiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lvaIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMTAyNHB4IiBoZWlnaHQ9IjEwMjRweCIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAyNCAxMDI0IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCiAgPHBhdGggY2xhc3M9InN2Z3BhdGgiIGRhdGEtaW5kZXg9InBhdGhfMCIgZmlsbD0iI2VjZjBmMSIgZD0iTTc5Ny43NjQ0MiAzMjYuNTU4NDFjLTguODg0MTk5LTE1LjU2MzMyNy0yNTIuODgwMS0yODYuODE5MDE5LTI2OC4zNzk1MTItMzEzLjU2NzQ4OS0xMC4xMzA1NDQtMTcuNDQ4ODIzLTM0LjI1ODQ5NS0xNy4xOTMxNjItNDQuMzg5MDM4IDBDNDczLjY1MDkzOSAzMi4yNjEzMjQgMjMwLjk5NzI1NSAzMDQuNjM1NTMgMjE4LjM3NDAyMyAzMjcuNDIxMjY0Yy05LjIzNTczMiAxNi41NTQwMTEgMC45NTg3MjcgMzguMzgxMDE5IDIxLjk1NDgzNyAzOC4zODEwMTlsMTE5LjkwNDczMSAwIDAgMjU2LjQ5MTMwMyAwIDM2Ljc4MzE0MSAyOTEuODM2MzU0IDAgMC0yOTMuMzA2NDAyIDEyMy41Nzk4NDkgMEM3OTQuNjk2NDk1IDM2NS43NzAzMjUgODA4Ljk0OTU2MiAzNDYuMTE2NDMxIDc5Ny43NjQ0MiAzMjYuNTU4NDF6IiAvPg0KPHBhdGggY2xhc3M9InN2Z3BhdGgiIGRhdGEtaW5kZXg9InBhdGhfMSIgZmlsbD0iI2VjZjBmMSIgZD0iTTM2MC4yMDE2MzMgNjg5LjY5MjA2MWwyOTIuMzE1NzE4IDAgMCA5MC45MTkyMzItMjkyLjMxNTcxOCAwIDAtOTAuOTE5MjMyWiIgLz4NCjxwYXRoIGNsYXNzPSJzdmdwYXRoIiBkYXRhLWluZGV4PSJwYXRoXzIiIGZpbGw9IiNlY2YwZjEiIGQ9Ik0zNjAuMjAxNjMzIDg0MC45MTUxOTFsMjkyLjMxNTcxOCAwIDAgNjAuNTkxNTE2LTI5Mi4zMTU3MTggMCAwLTYwLjU5MTUxNloiIC8+DQo8cGF0aCBjbGFzcz0ic3ZncGF0aCIgZGF0YS1pbmRleD0icGF0aF8zIiBmaWxsPSIjZWNmMGYxIiBkPSJNMzYwLjIwMTYzMyA5OTIuMzkzOTgybDI5MC40MzAyMjIgMCAwIDMwLjI5NTc1OC0yOTAuNDMwMjIyIDAgMC0zMC4yOTU3NThaIiAvPg0KDQo8L3N2Zz4NCg==';\r\nvar useSetState = adhere_ui_hooks_1.default.useSetState;\r\nvar PullRefresh = function (props, ref) {\r\n    var _a = props.className, className = _a === void 0 ? '' : _a, _b = props.style, style = _b === void 0 ? {} : _b, _c = props.scrollClassName, scrollClassName = _c === void 0 ? '' : _c, _d = props.scrollStyle, scrollStyle = _d === void 0 ? {} : _d, renderIcon = props.renderIcon, _e = props.renderLabel, renderLabel = _e === void 0 ? function () { return adhere_util_intl_1.default.v('下拉刷新'); } : _e, _f = props.renderCanLabel, renderCanLabel = _f === void 0 ? function () { return adhere_util_intl_1.default.v('松开刷新'); } : _f, _g = props.renderLoadingAnimation, renderLoadingAnimation = _g === void 0 ? 'la-ball-circus la-dark' : _g, _h = props.isShowUpdateTime, isShowUpdateTime = _h === void 0 ? true : _h, _j = props.updateTimeFormat, updateTimeFormat = _j === void 0 ? adhere_util_resource_1.default.Dict.value.ResourceMomentFormat18.value() : _j, children = props.children;\r\n    var _k = useSetState(false), isCan = _k[0], setCan = _k[1];\r\n    var _l = useSetState(moment_1.default().valueOf()), preUpdateTime = _l[0], setPreUpdateTime = _l[1];\r\n    var elRef = react_1.useRef(null);\r\n    var scrollElRef = react_1.useRef(null);\r\n    var iconElRef = react_1.useRef(null);\r\n    var refreshElRef = react_1.useRef(null);\r\n    var triggerInnerElRef = react_1.useRef(null);\r\n    var el = react_1.useRef(null);\r\n    var scrollEl = react_1.useRef(null);\r\n    var iconEl = react_1.useRef(null);\r\n    var triggerInnerEl = react_1.useRef(null);\r\n    var maskEl = react_1.useRef(null);\r\n    // 是否到顶了\r\n    var isTop = react_1.useRef(true);\r\n    var pullHeight = react_1.useRef(200);\r\n    var startPageY = react_1.useRef(-1);\r\n    var isDownPull = react_1.useRef(false);\r\n    var refreshHeight = react_1.useRef(0);\r\n    /**\r\n     * renderIcon\r\n     */\r\n    function _renderIcon() {\r\n        return (react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: !!renderIcon, noMatch: function () { return (react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger-icon\" },\r\n                react_1.default.createElement(\"img\", { className: selectorPrefix + \"-trigger-icon-inner\", src: defaultImg, alt: \"\", ref: iconElRef }))); } }, function () { return (react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger-icon\" },\r\n            react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger-icon-inner\", ref: iconElRef }, renderIcon === null || renderIcon === void 0 ? void 0 : renderIcon()))); }));\r\n    }\r\n    function _renderLabel() {\r\n        return (react_1.default.createElement(\"p\", { className: selectorPrefix + \"-trigger-label\" },\r\n            react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: isCan, noMatch: function () { return renderLabel === null || renderLabel === void 0 ? void 0 : renderLabel(); } }, function () { return renderCanLabel === null || renderCanLabel === void 0 ? void 0 : renderCanLabel(); })));\r\n    }\r\n    /**\r\n     * renderUpdateTime\r\n     */\r\n    function renderUpdateTime() {\r\n        return (react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: isShowUpdateTime }, function () { return (react_1.default.createElement(\"p\", { className: selectorPrefix + \"-trigger-update\" },\r\n            adhere_util_intl_1.default.v('更新时间'),\r\n            \"\\uFF1A\",\r\n            react_1.default.createElement(\"span\", { className: selectorPrefix + \"-trigger-update-label\" }, moment_1.default(preUpdateTime).format(updateTimeFormat)))); }));\r\n    }\r\n    function _renderLoadingAnimation() {\r\n        return (react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: !!renderLoadingAnimation }, function () { return (react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: adhere_util_1.default.isString(renderLoadingAnimation), noMatch: function () { return (react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger-refresh\", ref: refreshElRef }, renderLoadingAnimation())); } }, function () { return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-trigger-refresh\", renderLoadingAnimation), ref: refreshElRef },\r\n            react_1.default.createElement(\"div\", null),\r\n            react_1.default.createElement(\"div\", null),\r\n            react_1.default.createElement(\"div\", null),\r\n            react_1.default.createElement(\"div\", null),\r\n            react_1.default.createElement(\"div\", null))); })); }));\r\n    }\r\n    /**\r\n     * renderMask\r\n     */\r\n    function renderMask() {\r\n        maskEl.current = document.querySelector(\".\" + selectorPrefix + \"-mask\");\r\n        if (!maskEl.current) {\r\n            maskEl.current = document.createElement('div');\r\n            maskEl.current.className = selectorPrefix + \"-mask\";\r\n            document.body.appendChild(maskEl.current);\r\n        }\r\n    }\r\n    /**\r\n     * getPullHeight\r\n     */\r\n    function getPullHeight() {\r\n        var _a = props.pullHeight, pullHeight = _a === void 0 ? 200 : _a;\r\n        if ((pullHeight || 200) <= 0) {\r\n            return 200;\r\n        }\r\n        else {\r\n            if ((pullHeight || 200) > scrollEl.current.clientHeight) {\r\n                return scrollEl.current.clientHeight;\r\n            }\r\n            else {\r\n                return pullHeight || 200;\r\n            }\r\n        }\r\n    }\r\n    function initEvents() {\r\n        var _a, _b, _c;\r\n        (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.addEventListener('touchstart', onTouchStart);\r\n        (_b = scrollEl.current) === null || _b === void 0 ? void 0 : _b.addEventListener('mousedown', onTouchStart);\r\n        (_c = scrollEl.current) === null || _c === void 0 ? void 0 : _c.addEventListener('scroll', onScroll);\r\n    }\r\n    /**\r\n     * trigger\r\n     * @param action\r\n     * @param params\r\n     */\r\n    function trigger(action, params) {\r\n        if (props[action]) {\r\n            props[action](params);\r\n        }\r\n    }\r\n    /**\r\n     * translateY - Y平移\r\n     * @param el\r\n     * @param y\r\n     * @param duration\r\n     * @private\r\n     */\r\n    function translateY(el, y, duration) {\r\n        if (duration === void 0) { duration = 0; }\r\n        el.style.transition = el.style.webkitTransition = \"transform \" + duration + \"ms ease\";\r\n        el.style.transform = el.style.webkitTransform = \"translate3d(0,\" + y + \",0)\";\r\n    }\r\n    /**\r\n     * clear\r\n     */\r\n    function clear() {\r\n        removeEvents();\r\n        isDownPull.current = false;\r\n        isTop.current = true;\r\n        el.current.style.display = 'flex';\r\n        refreshElRef.current.style.display = 'none';\r\n        triggerInnerEl.current.style.display = 'flex';\r\n        rotateIcon(iconEl.current, 180, 0);\r\n        scrollEl.current.style.overflowY = 'auto';\r\n        maskEl.current.style.display = 'none';\r\n    }\r\n    /**\r\n     * removeEvents\r\n     */\r\n    function removeEvents() {\r\n        var _a, _b, _c, _d;\r\n        (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('mousemove', onTouchMove);\r\n        (_b = scrollEl.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('mouseup', onTouchEnd);\r\n        (_c = scrollEl.current) === null || _c === void 0 ? void 0 : _c.removeEventListener('touchmove', onTouchMove);\r\n        (_d = scrollEl.current) === null || _d === void 0 ? void 0 : _d.removeEventListener('touchend', onTouchEnd);\r\n    }\r\n    /**\r\n     * refresh\r\n     */\r\n    function refresh() {\r\n        var _a;\r\n        function onTransitionEnd() {\r\n            var _a;\r\n            triggerInnerEl.current.style.display = 'none';\r\n            refreshElRef.current.style.display = 'block';\r\n            trigger('onPullRefresh');\r\n            (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('transitionend', onTransitionEnd);\r\n            setPreUpdateTime(moment_1.default().valueOf());\r\n        }\r\n        maskEl.current.style.display = 'block';\r\n        removeEvents();\r\n        (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.addEventListener('transitionend', onTransitionEnd);\r\n        translateY(scrollEl.current, refreshHeight.current + \"px\", 500);\r\n        translateY(el.current, \"calc(-100% + \" + refreshHeight.current + \"px)\", 500);\r\n        rotateIcon(iconEl.current, 180, 300);\r\n    }\r\n    /**\r\n     * reset\r\n     */\r\n    function reset() {\r\n        var _a;\r\n        function onTransitionEnd() {\r\n            var _a;\r\n            (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('transitionend', onTransitionEnd);\r\n            triggerInnerEl.current.style.display = 'flex';\r\n        }\r\n        clear();\r\n        (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.addEventListener('transitionend', onTransitionEnd);\r\n        translateY(scrollEl.current, '0px', 200);\r\n        translateY(el.current, 'calc(-100% + 0px)', 200);\r\n    }\r\n    /**\r\n     * resetUpdateTime\r\n     * @param updateTime\r\n     * @return Promise\r\n     */\r\n    function resetUpdateTime(updateTime) {\r\n        return new Promise(function (resolve) {\r\n            return setPreUpdateTime(updateTime || moment_1.default().valueOf(), function () { return resolve(); });\r\n        });\r\n    }\r\n    /**\r\n     * getUpdateTime\r\n     * @return number\r\n     */\r\n    function getUpdateTime() {\r\n        return preUpdateTime;\r\n    }\r\n    /**\r\n     * rotateIcon\r\n     * @param el\r\n     * @param distance\r\n     * @param duration\r\n     * @private\r\n     */\r\n    function rotateIcon(el, distance, duration) {\r\n        if (duration === void 0) { duration = 0; }\r\n        var deg = distance;\r\n        el.style.transition = el.style.webkitTransition = \"transform \" + duration + \"ms linear\";\r\n        el.style.transform = el.style.webkitTransform = \"rotate(\" + deg + \"deg)\";\r\n    }\r\n    /**\r\n     * onTouchStart\r\n     */\r\n    function onTouchStart(e) {\r\n        var _a, _b, _c, _d;\r\n        trigger('onPullStart');\r\n        startPageY.current = e.changedTouches ? e.changedTouches[0].pageY : e.pageY;\r\n        (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.addEventListener('touchmove', onTouchMove);\r\n        (_b = scrollEl.current) === null || _b === void 0 ? void 0 : _b.addEventListener('mousemove', onTouchMove);\r\n        (_c = scrollEl.current) === null || _c === void 0 ? void 0 : _c.addEventListener('touchend', onTouchEnd);\r\n        (_d = scrollEl.current) === null || _d === void 0 ? void 0 : _d.addEventListener('mouseup', onTouchEnd);\r\n    }\r\n    /**\r\n     * onTouchMove\r\n     * @param e\r\n     */\r\n    function onTouchMove(e) {\r\n        scrollEl.current.style.overflow = 'hidden';\r\n        var targetY = e.changedTouches ? e.changedTouches[0].pageY : e.pageY;\r\n        var difference = targetY - startPageY.current;\r\n        var distance = Math.abs(difference);\r\n        // 中线下\r\n        if (difference > 0) {\r\n            e.preventDefault();\r\n            isDownPull.current = true;\r\n            // 正常拉\r\n            if (distance < pullHeight.current) {\r\n                translateY(scrollEl.current, distance + \"px\", 0);\r\n                translateY(el.current, \"calc(-100% + \" + distance + \"px)\", 0);\r\n                // 具备刷新条件\r\n                if (distance >= refreshHeight.current + 80) {\r\n                    // console.log('3.具备刷新条件');\r\n                    rotateIcon(iconEl.current, 0, 150);\r\n                    setCan(true, function () { return trigger('onPullCanRefresh'); });\r\n                }\r\n                // 不具备刷新条件\r\n                else {\r\n                    rotateIcon(iconEl.current, 180, 150);\r\n                    setCan(false);\r\n                }\r\n                el.current.style.display = 'flex';\r\n            }\r\n            // 越界了\r\n            else {\r\n                translateY(scrollEl.current, pullHeight.current + \"px\", 0);\r\n                translateY(el.current, \"calc(-100% + \" + pullHeight.current + \"px)\", 0);\r\n                rotateIcon(iconEl.current, 0, 150);\r\n                // console.log('4.拉动到了底部');\r\n                setCan(true, function () { return trigger('onPullBottom'); });\r\n            }\r\n        }\r\n        // 中线上\r\n        else if (isDownPull.current) {\r\n            e.preventDefault();\r\n            translateY(scrollEl.current, '0px', 0);\r\n            translateY(el.current, 'calc(-100% + 0px)', 0);\r\n            rotateIcon(iconEl.current, 180, 0);\r\n        }\r\n        // 其他\r\n        else {\r\n            clear();\r\n        }\r\n    }\r\n    function onTouchEnd(e) {\r\n        var targetY = e.changedTouches ? e.changedTouches[0].pageY : e.pageY;\r\n        var difference = targetY - startPageY.current;\r\n        var distance = Math.abs(difference);\r\n        // 中线下\r\n        if (difference > 0) {\r\n            // 正常拉\r\n            if (distance < pullHeight.current) {\r\n                if (distance >= refreshHeight.current + 80) {\r\n                    refresh();\r\n                }\r\n                else {\r\n                    // console.log('2.没有具备刷新条件弹回');\r\n                    // self.events.trigger('pullRebound');\r\n                    trigger('onPullRebound');\r\n                    reset();\r\n                }\r\n            }\r\n            // 越界了\r\n            else {\r\n                refresh();\r\n            }\r\n        }\r\n        // 中线上\r\n        else {\r\n            clear();\r\n        }\r\n    }\r\n    function onScroll(e) {\r\n        var _a, _b, _c, _d;\r\n        if (e.target.scrollTop === 0) {\r\n            isTop.current = true;\r\n            (_a = scrollEl.current) === null || _a === void 0 ? void 0 : _a.addEventListener('touchstart', onTouchStart);\r\n            (_b = scrollEl.current) === null || _b === void 0 ? void 0 : _b.addEventListener('mousedown', onTouchStart);\r\n        }\r\n        else if (isTop.current) {\r\n            isTop.current = false;\r\n            (_c = scrollEl.current) === null || _c === void 0 ? void 0 : _c.removeEventListener('touchstart', onTouchStart);\r\n            (_d = scrollEl.current) === null || _d === void 0 ? void 0 : _d.removeEventListener('mousedown', onTouchStart);\r\n        }\r\n    }\r\n    react_1.useImperativeHandle(ref, function () { return ({\r\n        refresh: refresh,\r\n        reset: reset,\r\n        resetUpdateTime: resetUpdateTime,\r\n        getUpdateTime: getUpdateTime,\r\n    }); });\r\n    react_1.useEffect(function () {\r\n        setPreUpdateTime(props.updateTime || moment_1.default().valueOf());\r\n    }, [props.updateTime]);\r\n    react_1.useEffect(function () {\r\n        renderMask();\r\n    }, []);\r\n    react_1.useLayoutEffect(function () {\r\n        el.current = elRef.current;\r\n        iconEl.current = iconElRef.current;\r\n        scrollEl.current = scrollElRef.current;\r\n        triggerInnerEl.current = triggerInnerElRef.current;\r\n        pullHeight.current = getPullHeight();\r\n        refreshHeight.current = el.current.clientHeight;\r\n    }, []);\r\n    react_1.useLayoutEffect(function () {\r\n        initEvents();\r\n        return function () { return removeEvents(); };\r\n    });\r\n    return (react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix, className || ''), style: style || {} },\r\n        react_1.default.createElement(\"div\", { className: classnames_1.default(selectorPrefix + \"-scroll\", scrollClassName || ''), style: scrollStyle || {}, ref: scrollElRef }, children),\r\n        react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger\", ref: elRef },\r\n            react_1.default.createElement(\"div\", { className: selectorPrefix + \"-trigger-inner\", ref: triggerInnerElRef },\r\n                _renderIcon(),\r\n                _renderLabel(),\r\n                renderUpdateTime()),\r\n            _renderLoadingAnimation())));\r\n};\r\nexports.default = react_1.forwardRef(PullRefresh);\r\n"],"names":["__createBinding","this","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","hasOwnProperty","call","__importDefault","default","exports","react_1","require","classnames_1","moment_1","adhere_util_intl_1","adhere_ui_conditionalrender_1","adhere_util_1","adhere_util_resource_1","adhere_ui_hooks_1","selectorPrefix","defaultImg","useSetState","PullRefresh","props","ref","_a","className","_b","style","_c","scrollClassName","_d","scrollStyle","renderIcon","_e","renderLabel","_f","renderCanLabel","_g","renderLoadingAnimation","_h","isShowUpdateTime","_j","updateTimeFormat","Dict","ResourceMomentFormat18","children","_k","isCan","setCan","_l","valueOf","preUpdateTime","setPreUpdateTime","elRef","useRef","scrollElRef","iconElRef","refreshElRef","triggerInnerElRef","el","scrollEl","iconEl","triggerInnerEl","maskEl","isTop","pullHeight","startPageY","isDownPull","refreshHeight","trigger","action","params","translateY","y","duration","transition","webkitTransition","transform","webkitTransform","clear","removeEvents","current","display","rotateIcon","overflowY","removeEventListener","onTouchMove","onTouchEnd","refresh","addEventListener","onTransitionEnd","reset","resetUpdateTime","updateTime","Promise","resolve","getUpdateTime","distance","deg","onTouchStart","e","changedTouches","pageY","overflow","difference","Math","abs","preventDefault","onScroll","target","scrollTop","useImperativeHandle","useEffect","document","querySelector","createElement","body","appendChild","useLayoutEffect","clientHeight","conditional","noMatch","src","alt","format","isString","forwardRef"],"mappings":"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"}