{"version":3,"file":"permission.js","sources":["permission.js"],"sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PermissionFun = exports.Permission = exports.checkPermission = exports.getPermission = exports.setPermission = void 0;\r\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\r\n// 所有的权限\r\nvar permissions = [];\r\n/**\r\n * setPermission - 设置拥有的所有权限\r\n * @param {Array<String>} permission\r\n */\r\nexports.setPermission = function (permission) {\r\n    permissions = permission;\r\n};\r\n/**\r\n * getPermission - 获取拥有的所有权限\r\n * @return\r\n */\r\nexports.getPermission = function () { return JSON.parse(JSON.stringify(permissions)); };\r\n/**\r\n * checkPermission - 判断是否有权限方法\r\n * @param {Array<String>} allPermission\r\n * @param {String | Array<String>} currentPermissions 当前组件或者页面对应得权限key\r\n * @return boolean\r\n */\r\nexports.checkPermission = function (allPermission, currentPermissions) {\r\n    if (allPermission === void 0) { allPermission = exports.getPermission(); }\r\n    allPermission = allPermission || exports.getPermission();\r\n    // 所有的权限\r\n    if (!allPermission || !Array.isArray(allPermission) || !currentPermissions) {\r\n        return true;\r\n    }\r\n    if (Array.isArray(currentPermissions)) {\r\n        return currentPermissions.every(function (curPermissions) { return allPermission.indexOf(curPermissions) !== -1; });\r\n    }\r\n    return allPermission.indexOf(currentPermissions) !== -1;\r\n};\r\n/**\r\n * Permission - 组件或者某一个模块的权限渲染方式\r\n * @param {Array<String>} allPermission\r\n * @param {String | Array<String>} permissions 当前组件或者某一个模块对应得权限key\r\n * @param {String | ReactElement} children 想要渲染的部分\r\n * @param {String | ReactElement} noMatch 没有权限是想要提示的部分\r\n * @return {String | ReactElement}\r\n */\r\nexports.Permission = function (_a) {\r\n    var _b = _a.allPermission, allPermission = _b === void 0 ? exports.getPermission() : _b, permissions = _a.permissions, children = _a.children, noMatch = _a.noMatch;\r\n    return (react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: exports.checkPermission(allPermission, permissions), noMatch: noMatch }, children));\r\n};\r\n/**\r\n * PermissionFun - 函数方式实现\r\n * @param allPermission\r\n * @param permissions\r\n * @param match\r\n * @param noMatch\r\n * @constructor\r\n */\r\nfunction PermissionFun(_a) {\r\n    var _b = _a.allPermission, allPermission = _b === void 0 ? exports.getPermission() : _b, permissions = _a.permissions, match = _a.match, noMatch = _a.noMatch;\r\n    return adhere_ui_conditionalrender_1.default.conditionalRender({\r\n        conditional: exports.checkPermission(allPermission, permissions),\r\n        match: match,\r\n        noMatch: noMatch,\r\n    });\r\n}\r\nexports.PermissionFun = PermissionFun;\r\nexports.Permission.defaultProps = {\r\n    allPermission: undefined,\r\n    permissions: '',\r\n    noMatch: null,\r\n    children: null,\r\n};\r\nexports.Permission.propTypes = {\r\n    allPermission: prop_types_1.default.array,\r\n    permissions: prop_types_1.default.oneOfType([prop_types_1.default.array, prop_types_1.default.string]),\r\n    noMatch: prop_types_1.default.node,\r\n    children: prop_types_1.default.node,\r\n};\r\n"],"names":["__importDefault","this","mod","__esModule","default","prop_types_1","Object","defineProperty","exports","value","PermissionFun","Permission","checkPermission","getPermission","setPermission","require","react_1","adhere_ui_conditionalrender_1","permissions","_a","_b","allPermission","match","noMatch","conditionalRender","conditional","permission","JSON","parse","stringify","currentPermissions","Array","isArray","every","curPermissions","indexOf","children","createElement","defaultProps","undefined","propTypes","array","oneOfType","string","node"],"mappings":"AAAA,aACA,IAAIA,gBAAmBC,MAAQA,KAAKD,iBAAoB,SAAUE,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAEE,QAAWF,CAAI,CAC5D,EAGIG,cAFJC,OAAOC,eAAeC,QAAS,aAAc,CAAEC,MAAO,CAAA,CAAK,CAAC,EAC5DD,QAAQE,cAAgBF,QAAQG,WAAaH,QAAQI,gBAAkBJ,QAAQK,cAAgBL,QAAQM,cAAgB,KAAA,EACpGd,gBAAgBe,QAAQ,YAAY,CAAC,GACpDC,QAAUhB,gBAAgBe,QAAQ,OAAO,CAAC,EAC1CE,8BAAgCjB,gBAAgBe,QAAQ,yCAAyC,CAAC,EAElGG,YAAc,GAmDlB,SAASR,cAAcS,GACnB,IAAIC,EAAKD,EAAGE,cAAeA,EAAuB,KAAA,IAAPD,EAAgBZ,QAAQK,cAAc,EAAIO,EAAIF,EAAcC,EAAGD,YAAaI,EAAQH,EAAGG,MAAOC,EAAUJ,EAAGI,QACtJ,OAAON,8BAA8Bb,QAAQoB,kBAAkB,CAC3DC,YAAajB,QAAQI,gBAAgBS,EAAeH,CAAW,EAC/DI,MAAOA,EACPC,QAASA,CACb,CAAC,CACL,CArDAf,QAAQM,cAAgB,SAAUY,GAC9BR,YAAcQ,CAClB,EAKAlB,QAAQK,cAAgB,WAAc,OAAOc,KAAKC,MAAMD,KAAKE,UAAUX,WAAW,CAAC,CAAG,EAOtFV,QAAQI,gBAAkB,SAAUS,EAAeS,GAI/C,MAAI,GAFJT,GADgCA,EAAV,KAAA,IAAlBA,EAA4Cb,QAAQK,cAAc,EACtDQ,IAAiBb,QAAQK,cAAc,IAEhCkB,MAAMC,QAAQX,CAAa,GAAMS,KAGpDC,MAAMC,QAAQF,CAAkB,EACzBA,EAAmBG,MAAM,SAAUC,GAAkB,MAAiD,CAAC,IAA3Cb,EAAcc,QAAQD,CAAc,CAAU,CAAC,EAEjE,CAAC,IAA/Cb,EAAcc,QAAQL,CAAkB,EACnD,EASAtB,QAAQG,WAAa,SAAUQ,GAC3B,IAAIC,EAAKD,EAAGE,cAAeA,EAAuB,KAAA,IAAPD,EAAgBZ,QAAQK,cAAc,EAAIO,EAAIF,EAAcC,EAAGD,YAAakB,EAAWjB,EAAGiB,SAAUb,EAAUJ,EAAGI,QAC5J,OAAQP,QAAQZ,QAAQiC,cAAcpB,8BAA8Bb,QAAS,CAAEqB,YAAajB,QAAQI,gBAAgBS,EAAeH,CAAW,EAAGK,QAASA,CAAQ,EAAGa,CAAS,CAClL,EAiBA5B,QAAQE,cAAgBA,cACxBF,QAAQG,WAAW2B,aAAe,CAC9BjB,cAAekB,KAAAA,EACfrB,YAAa,GACbK,QAAS,KACTa,SAAU,IACd,EACA5B,QAAQG,WAAW6B,UAAY,CAC3BnB,cAAehB,aAAaD,QAAQqC,MACpCvB,YAAab,aAAaD,QAAQsC,UAAU,CAACrC,aAAaD,QAAQqC,MAAOpC,aAAaD,QAAQuC,OAAO,EACrGpB,QAASlB,aAAaD,QAAQwC,KAC9BR,SAAU/B,aAAaD,QAAQwC,IACnC"}