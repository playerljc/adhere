"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof"),_empty=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,_interopRequireDefault(require("antd/lib/empty"))),_react=_interopRequireWildcard(require("react")),_adhereUiConditionalrender=_interopRequireDefault(require("@baifendian/adhere-ui-conditionalrender")),_adhereUiFlexlayout=_interopRequireDefault(require("@baifendian/adhere-ui-flexlayout")),_adhereUiScrollload=_interopRequireDefault(require("@baifendian/adhere-ui-scrollload")),_List=_interopRequireDefault(require("../List"));function _getRequireWildcardCache(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(_getRequireWildcardCache=function(e){return e?r:t})(e))}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};t=_getRequireWildcardCache(t);if(t&&t.has(e))return t.get(e);var r,a,n={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((a=l?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]);return n.default=e,t&&t.set(e,n),n}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__spreadArray=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,l=t.length;n<l;n++)!a&&n in t||((a=a||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},VerticalFlexLayout=_adhereUiFlexlayout.default.VerticalFlexLayout,selectorPrefix="adhere-ui-comment-list-standard",ListStandard=(0,_react.memo)(function(r){var e=r.limit,t=void 0===e?10:e,e=r.dataKeys,n=void 0===e?{current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}:e,e=r.listProps,a=void 0===e?{}:e,e=r.flexLayoutProps,e=void 0===e?{}:e,l=r.renderFirstLoading,i=r.renderEmpty,u=void 0===i?function(){return _react.default.createElement(_empty.default,null)}:i,o=r.renderList,c=r.getScrollWrapContainer,d=(0,_react.useRef)({page:1,limit:t}),f=(0,_react.useRef)(),s=(0,_react.useRef)(_adhereUiScrollload.default.NORMAL),i=(0,_react.useRef)(null),_=(0,_react.useState)(((_={})[n.current]=1,_[n.totalPage]=0,_[n.list]=[],_[n.totalCount]=0,_)),p=_[0],y=_[1],_=(0,_react.useState)(!0),g=_[0],h=_[1];function v(t){var e;return null==(e=null==r?void 0:r.fetchData)?void 0:e.call(r,null==d?void 0:d.current).then(function(e){return t(e),h(!1),e}).catch(function(e){var t;return h(!1),f.current&&(s.current=_adhereUiScrollload.default.ERROR,null!=(t=null==f?void 0:f.current))&&t.call(f,s.current),e})}var m=(0,_react.useCallback)(function(e){s.current===_adhereUiScrollload.default.EMPTY?(s.current=_adhereUiScrollload.default.EMPTY,e(_adhereUiScrollload.default.EMPTY)):(f.current=e,setTimeout(function(){return h(!0),d.current.page=d.current.page+1,a=n.list,v(function(r){y(function(e){var t;return __assign(__assign({},r),((t={})[n.list]=__spreadArray(__spreadArray([],e[a],!0),r[a],!0),t))})});var a},100))},[]),R=(0,_react.useCallback)(function(){return 1===d.current.page&&0===p[n.list].length},[p,n,d.current.page]),_=(0,_react.useMemo)(function(){return _react.default.createElement(_List.default,__assign({getScrollWrapContainer:c,isLoading:g,hasMore:p[n.list].length<=p[n.totalCount],onLoadMore:m,renderFirstLoading:l},null!=a?a:{}),_react.default.createElement(_adhereUiConditionalrender.default,{conditional:!R(),noMatch:function(){return u()}},function(){return null==o?void 0:o(p)}))},[c,g,p,n.totalCount,n.list,l,a,u]);return(0,_react.useEffect)(function(){h(!0),d.current={page:1,limit:t},v(function(e){y(e)})},[]),(0,_react.useLayoutEffect)(function(){f.current&&(s.current=d.current.page<p[n.totalPage]?_adhereUiScrollload.default.NORMAL:_adhereUiScrollload.default.EMPTY,null!=f)&&f.current(s.current)},[p]),_react.default.createElement(VerticalFlexLayout,__assign({},null!=e?e:{},{className:"".concat(selectorPrefix),renderMain:_react.default.createElement("div",{className:"".concat(selectorPrefix,"-auto"),ref:i},_)}))}),_default=(ListStandard.displayName="ListStandard",exports.default=ListStandard);
//# sourceMappingURL=index.js.map
