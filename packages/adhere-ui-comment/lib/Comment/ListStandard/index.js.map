{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar prop_types_1 = tslib_1.__importDefault(require(\"prop-types\"));\n\nvar antd_1 = require(\"antd\");\n\nvar adhere_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\n\nvar adhere_ui_scrollload_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-scrollload\"));\n\nvar adhere_ui_flexlayout_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\n\nvar List_1 = tslib_1.__importStar(require(\"../List\"));\n\nvar VerticalFlexLayout = adhere_ui_flexlayout_1.default.VerticalFlexLayout,\n    VerticalFlexLayoutDefaultProps = adhere_ui_flexlayout_1.default.VerticalFlexLayoutDefaultProps,\n    VerticalFlexLayoutPropTypes = adhere_ui_flexlayout_1.default.VerticalFlexLayoutPropTypes;\nvar selectorPrefix = 'adhere-ui-comment-list-standard';\n/**\n * ListStandard\n * @param props\n * @return {JSX.Element}\n * @constructor\n * @classdesc 上拉下拽\n */\n\nfunction ListStandard(props) {\n  var _a;\n\n  var paging = (0, react_1.useRef)({\n    page: 1,\n    limit: props.limit\n  });\n  var callbackHandler = (0, react_1.useRef)();\n  var status = (0, react_1.useRef)(adhere_ui_scrollload_1.default.NORMAL);\n  var mainRef = (0, react_1.useRef)();\n\n  var _b = tslib_1.__read((0, react_1.useState)((_a = {}, _a[props.dataKeys.current] = 1, _a[props.dataKeys.totalPage] = 0, _a[props.dataKeys.list] = [], _a[props.dataKeys.totalCount] = 0, _a)), 2),\n      data = _b[0],\n      setData = _b[1];\n\n  var _c = tslib_1.__read((0, react_1.useState)(true), 2),\n      loading = _c[0],\n      setLoading = _c[1];\n  /**\n   * loadData\n   * @description 重新加载数据\n   * @return {*}\n   */\n\n\n  function loadData() {\n    setLoading(true);\n    paging.current = {\n      page: 1,\n      limit: props.limit\n    };\n    return fetchData(function (res) {\n      setData(res);\n    });\n  }\n  /**\n   * appendData\n   * @description 加载更多\n   * @return {*}\n   */\n\n\n  function appendData() {\n    setLoading(true);\n    paging.current.page = paging.current.page + 1;\n    var list = props.dataKeys.list;\n    return fetchData(function (res) {\n      var _a;\n\n      setData(tslib_1.__assign(tslib_1.__assign({}, res), (_a = {}, _a[props.dataKeys.list] = tslib_1.__spreadArray(tslib_1.__spreadArray([], tslib_1.__read(data[list]), false), tslib_1.__read(res[list]), false), _a)));\n    });\n  }\n  /**\n   * fetchData\n   * @description 调用接口\n   */\n\n\n  function fetchData(callback) {\n    var _a;\n\n    return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging === null || paging === void 0 ? void 0 : paging.current).then(function (data) {\n      callback(data);\n      setLoading(false);\n      return data;\n    }).catch(function (error) {\n      var _a;\n\n      setLoading(false);\n\n      if (callbackHandler.current) {\n        status.current = adhere_ui_scrollload_1.default.ERROR; // @ts-ignore\n\n        (_a = callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current) === null || _a === void 0 ? void 0 : _a.call(callbackHandler, status.current);\n      }\n\n      return error;\n    });\n  }\n  /**\n   * onLoadMore\n   * @param callback\n   */\n\n\n  function onLoadMore(callback) {\n    if (status.current === adhere_ui_scrollload_1.default.EMPTY) {\n      status.current = adhere_ui_scrollload_1.default.EMPTY;\n      callback(adhere_ui_scrollload_1.default.EMPTY);\n      return;\n    }\n\n    callbackHandler.current = callback;\n    setTimeout(function () {\n      return appendData();\n    }, 100);\n  }\n  /**\n   * isEmpty\n   * @return {boolean}\n   */\n\n\n  function isEmpty() {\n    return paging.current.page === 1 && data[props.dataKeys.list].length === 0;\n  }\n\n  (0, react_1.useEffect)(function () {\n    loadData();\n  }, []);\n  (0, react_1.useLayoutEffect)(function () {\n    if (callbackHandler.current) {\n      status.current = paging.current.page < data[props.dataKeys.totalPage] ? adhere_ui_scrollload_1.default.NORMAL : adhere_ui_scrollload_1.default.EMPTY; // @ts-ignore\n\n      callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current(status.current);\n    }\n  }, [data]);\n  return react_1.default.createElement(VerticalFlexLayout, tslib_1.__assign({}, props.flexLayoutProps, {\n    className: \"\".concat(selectorPrefix),\n    renderMain: // @ts-ignore\n    react_1.default.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-auto\"),\n      ref: mainRef\n    }, react_1.default.createElement(List_1.default, tslib_1.__assign({\n      getScrollWrapContainer: props.getScrollWrapContainer,\n      isLoading: loading,\n      hasMore: data[props.dataKeys.list].length <= data[props.dataKeys.totalCount],\n      onLoadMore: onLoadMore,\n      renderFirstLoading: props.renderFirstLoading\n    }, props.listProps), react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        var _a;\n\n        return (_a = props === null || props === void 0 ? void 0 : props.renderEmpty) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }, function () {\n      var _a;\n\n      return (_a = props === null || props === void 0 ? void 0 : props.renderList) === null || _a === void 0 ? void 0 : _a.call(props, data);\n    })))\n  }));\n}\n\nListStandard.defaultProps = {\n  flexLayoutProps: tslib_1.__assign({}, VerticalFlexLayoutDefaultProps),\n  listProps: tslib_1.__assign({}, List_1.defaultProps),\n  limit: 10,\n  renderEmpty: function renderEmpty() {\n    return react_1.default.createElement(antd_1.Empty, null);\n  },\n  dataKeys: {\n    current: 'current',\n    totalPage: 'totalPage',\n    list: 'list',\n    totalCount: 'totalCount'\n  }\n};\nListStandard.propTypes = {\n  getScrollWrapContainer: prop_types_1.default.func,\n  flexLayoutProps: prop_types_1.default.shape(tslib_1.__assign({}, VerticalFlexLayoutPropTypes)),\n  listProps: prop_types_1.default.shape(tslib_1.__assign({}, List_1.propTypes)),\n  limit: prop_types_1.default.number,\n  renderList: prop_types_1.default.func,\n  renderEmpty: prop_types_1.default.func,\n  renderFirstLoading: prop_types_1.default.func,\n  fetchData: prop_types_1.default.func,\n  dataKeys: prop_types_1.default.shape({\n    current: prop_types_1.default.string,\n    totalPage: prop_types_1.default.string,\n    list: prop_types_1.default.string,\n    totalCount: prop_types_1.default.string\n  }),\n  scrollLoadProps: prop_types_1.default.shape({\n    className: prop_types_1.default.string,\n    style: prop_types_1.default.object,\n    loadClassName: prop_types_1.default.string,\n    loadStyle: prop_types_1.default.object,\n    emptyClassName: prop_types_1.default.string,\n    emptyStyle: prop_types_1.default.object,\n    errorClassName: prop_types_1.default.string,\n    errorStyle: prop_types_1.default.object,\n    distance: prop_types_1.default.number,\n    onScrollBottom: prop_types_1.default.func,\n    onEmptyClick: prop_types_1.default.func,\n    onErrorClick: prop_types_1.default.func,\n    renderLoading: prop_types_1.default.func,\n    renderEmpty: prop_types_1.default.func,\n    renderError: prop_types_1.default.func\n  })\n};\nexports.default = ListStandard;"],"names":["require","Object","defineProperty","exports","value","tslib_1","react_1","__importStar","prop_types_1","__importDefault","antd_1","adhere_ui_conditionalrender_1","adhere_ui_scrollload_1","adhere_ui_flexlayout_1","List_1","VerticalFlexLayout","default","VerticalFlexLayoutDefaultProps","VerticalFlexLayoutPropTypes","selectorPrefix","ListStandard","props","paging","useRef","page","limit","callbackHandler","status","NORMAL","mainRef","_b","__read","useState","_a","dataKeys","current","totalPage","list","totalCount","data","setData","_c","loading","setLoading","fetchData","callback","call","then","catch","error","ERROR","useEffect","res","useLayoutEffect","EMPTY","createElement","__assign","flexLayoutProps","className","concat","renderMain","ref","getScrollWrapContainer","isLoading","hasMore","length","onLoadMore","setTimeout","__spreadArray","renderFirstLoading","listProps","conditional","noMatch","renderEmpty","renderList","defaultProps","Empty","propTypes","func","shape","number","string","scrollLoadProps","style","object","loadClassName","loadStyle","emptyClassName","emptyStyle","errorClassName","errorStyle","distance","onScrollBottom","onEmptyClick","onErrorClick","renderLoading","renderError"],"mappings":"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"}