{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _empty = _interopRequireDefault(require(\"antd/lib/empty\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _adhereUiConditionalrender = _interopRequireDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\nvar _adhereUiFlexlayout = _interopRequireDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\nvar _adhereUiScrollload = _interopRequireDefault(require(\"@baifendian/adhere-ui-scrollload\"));\nvar _List = _interopRequireDefault(require(\"../List\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = void 0 && (void 0).__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar VerticalFlexLayout = _adhereUiFlexlayout.default.VerticalFlexLayout;\nvar selectorPrefix = 'adhere-ui-comment-list-standard';\n/**\n * ListStandard\n * @param props\n * @return {JSX.Element}\n * @constructor\n * @classdesc 上拉下拽\n */\nvar ListStandard = function ListStandard(props) {\n  var _a;\n  var _b = props.limit,\n    limit = _b === void 0 ? 10 : _b,\n    _c = props.dataKeys,\n    dataKeys = _c === void 0 ? {\n      current: 'current',\n      totalPage: 'totalPage',\n      list: 'list',\n      totalCount: 'totalCount'\n    } : _c,\n    _d = props.listProps,\n    listProps = _d === void 0 ? {} : _d,\n    _e = props.flexLayoutProps,\n    flexLayoutProps = _e === void 0 ? {} : _e,\n    renderFirstLoading = props.renderFirstLoading,\n    _f = props.renderEmpty,\n    renderEmpty = _f === void 0 ? function () {\n      return /*#__PURE__*/_react.default.createElement(_empty.default, null);\n    } : _f,\n    renderList = props.renderList,\n    getScrollWrapContainer = props.getScrollWrapContainer;\n  var paging = (0, _react.useRef)({\n    page: 1,\n    limit: limit\n  });\n  var callbackHandler = (0, _react.useRef)();\n  var status = (0, _react.useRef)(_adhereUiScrollload.default.NORMAL);\n  var mainRef = (0, _react.useRef)(null);\n  var _g = (0, _react.useState)((_a = {}, _a[dataKeys.current] = 1, _a[dataKeys.totalPage] = 0, _a[dataKeys.list] = [], _a[dataKeys.totalCount] = 0, _a)),\n    data = _g[0],\n    setData = _g[1];\n  var _h = (0, _react.useState)(true),\n    loading = _h[0],\n    setLoading = _h[1];\n  /**\n   * loadData\n   * @description 重新加载数据\n   * @return {*}\n   */\n  function loadData() {\n    setLoading(true);\n    paging.current = {\n      page: 1,\n      limit: limit\n    };\n    return fetchData(function (res) {\n      return setData(res);\n    });\n  }\n  /**\n   * appendData\n   * @description 加载更多\n   * @return {*}\n   */\n  function appendData() {\n    setLoading(true);\n    paging.current.page = paging.current.page + 1;\n    var list = dataKeys.list;\n    return fetchData(function (res) {\n      setData(function (_data) {\n        var _a;\n        return __assign(__assign({}, res), (_a = {}, _a[dataKeys.list] = __spreadArray(__spreadArray([], _data[list], true), res[list], true), _a));\n      });\n    });\n  }\n  /**\n   * fetchData\n   * @description 调用接口\n   */\n  function fetchData(callback) {\n    var _a;\n    return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging === null || paging === void 0 ? void 0 : paging.current).then(function (data) {\n      callback(data);\n      setLoading(false);\n      return data;\n    }).catch(function (error) {\n      var _a;\n      setLoading(false);\n      if (callbackHandler.current) {\n        status.current = _adhereUiScrollload.default.ERROR;\n        (_a = callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current) === null || _a === void 0 ? void 0 : _a.call(callbackHandler, status.current);\n      }\n      return error;\n    });\n  }\n  /**\n   * onLoadMore\n   * @param callback\n   */\n  var onLoadMore = (0, _react.useCallback)(function (callback) {\n    if (status.current === _adhereUiScrollload.default.EMPTY) {\n      status.current = _adhereUiScrollload.default.EMPTY;\n      callback(_adhereUiScrollload.default.EMPTY);\n      return;\n    }\n    callbackHandler.current = callback;\n    setTimeout(function () {\n      return appendData();\n    }, 100);\n  }, []);\n  /**\n   * isEmpty\n   * @return {boolean}\n   */\n  var isEmpty = (0, _react.useCallback)(function () {\n    return paging.current.page === 1 && data[dataKeys.list].length === 0;\n  }, [data, dataKeys, paging.current.page]);\n  var _CommentList = (0, _react.useMemo)(function () {\n    return /*#__PURE__*/_react.default.createElement(_List.default, __assign({\n      getScrollWrapContainer: getScrollWrapContainer,\n      isLoading: loading,\n      hasMore: data[dataKeys.list].length <= data[dataKeys.totalCount],\n      onLoadMore: onLoadMore,\n      renderFirstLoading: renderFirstLoading\n    }, listProps || {}), /*#__PURE__*/_react.default.createElement(_adhereUiConditionalrender.default, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty();\n      }\n    }, function () {\n      return renderList === null || renderList === void 0 ? void 0 : renderList(data);\n    }));\n  }, [getScrollWrapContainer, loading, data, dataKeys.totalCount, dataKeys.list, renderFirstLoading, listProps, renderEmpty]);\n  (0, _react.useEffect)(function () {\n    loadData();\n  }, []);\n  (0, _react.useLayoutEffect)(function () {\n    if (callbackHandler.current) {\n      status.current = paging.current.page < data[dataKeys.totalPage] ? _adhereUiScrollload.default.NORMAL : _adhereUiScrollload.default.EMPTY;\n      callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current(status.current);\n    }\n  }, [data]);\n  return /*#__PURE__*/_react.default.createElement(VerticalFlexLayout, __assign({}, flexLayoutProps || {}, {\n    className: \"\".concat(selectorPrefix),\n    renderMain: /*#__PURE__*/_react.default.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-auto\"),\n      ref: mainRef\n    }, _CommentList)\n  }));\n};\nvar _default = /*#__PURE__*/(0, _react.memo)(ListStandard);\nexports.default = _default;"],"names":["_interopRequireDefault","require","_typeof","_empty","Object","defineProperty","exports","value","default","_react","_interopRequireWildcard","_adhereUiConditionalrender","_adhereUiFlexlayout","_adhereUiScrollload","_List","_getRequireWildcardCache","nodeInterop","cacheBabelInterop","cacheNodeInterop","WeakMap","obj","__esModule","cache","has","get","key","desc","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","prototype","hasOwnProperty","call","set","__assign","assign","t","s","i","n","arguments","length","p","apply","this","__spreadArray","to","from","pack","ar","l","Array","slice","concat","VerticalFlexLayout","selectorPrefix","ListStandard","props","_b","limit","_c","dataKeys","current","totalPage","list","totalCount","_d","listProps","_e","flexLayoutProps","renderFirstLoading","_f","renderEmpty","createElement","renderList","getScrollWrapContainer","paging","useRef","page","callbackHandler","status","NORMAL","mainRef","_g","useState","_a","data","setData","_h","loading","setLoading","fetchData","callback","then","catch","error","ERROR","onLoadMore","useCallback","EMPTY","setTimeout","res","_data","isEmpty","_CommentList","useMemo","isLoading","hasMore","conditional","noMatch","useEffect","useLayoutEffect","className","renderMain","ref","_default","memo"],"mappings":"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"}