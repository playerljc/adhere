{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _empty = _interopRequireDefault(require(\"antd/lib/empty\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _adhereUiConditionalrender = _interopRequireDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\nvar _adhereUiFlexlayout = _interopRequireDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\nvar _adhereUiScrollload = _interopRequireDefault(require(\"@baifendian/adhere-ui-scrollload\"));\nvar _List = _interopRequireDefault(require(\"../List\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = void 0 && (void 0).__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar VerticalFlexLayout = _adhereUiFlexlayout.default.VerticalFlexLayout;\nvar selectorPrefix = 'adhere-ui-comment-list-standard';\n/**\n * ListStandard\n * @param props\n * @return {JSX.Element}\n * @constructor\n * @classdesc 上拉下拽\n */\nvar ListStandard = /*#__PURE__*/(0, _react.memo)(function (props) {\n  var _a;\n  var _b = props.limit,\n    limit = _b === void 0 ? 10 : _b,\n    _c = props.dataKeys,\n    dataKeys = _c === void 0 ? {\n      current: 'current',\n      totalPage: 'totalPage',\n      list: 'list',\n      totalCount: 'totalCount'\n    } : _c,\n    _d = props.listProps,\n    listProps = _d === void 0 ? {} : _d,\n    _e = props.flexLayoutProps,\n    flexLayoutProps = _e === void 0 ? {} : _e,\n    renderFirstLoading = props.renderFirstLoading,\n    _f = props.renderEmpty,\n    renderEmpty = _f === void 0 ? function () {\n      return /*#__PURE__*/_react.default.createElement(_empty.default, null);\n    } : _f,\n    renderList = props.renderList,\n    getScrollWrapContainer = props.getScrollWrapContainer;\n  var paging = (0, _react.useRef)({\n    page: 1,\n    limit: limit\n  });\n  var callbackHandler = (0, _react.useRef)();\n  var status = (0, _react.useRef)(_adhereUiScrollload.default.NORMAL);\n  var mainRef = (0, _react.useRef)(null);\n  var _g = (0, _react.useState)((_a = {}, _a[dataKeys.current] = 1, _a[dataKeys.totalPage] = 0, _a[dataKeys.list] = [], _a[dataKeys.totalCount] = 0, _a)),\n    data = _g[0],\n    setData = _g[1];\n  var _h = (0, _react.useState)(true),\n    loading = _h[0],\n    setLoading = _h[1];\n  /**\n   * loadData\n   * @description 重新加载数据\n   * @return {*}\n   */\n  function loadData() {\n    setLoading(true);\n    paging.current = {\n      page: 1,\n      limit: limit\n    };\n    return fetchData(function (res) {\n      return setData(res);\n    });\n  }\n  /**\n   * appendData\n   * @description 加载更多\n   * @return {*}\n   */\n  function appendData() {\n    setLoading(true);\n    paging.current.page = paging.current.page + 1;\n    var list = dataKeys.list;\n    return fetchData(function (res) {\n      setData(function (_data) {\n        var _a;\n        return __assign(__assign({}, res), (_a = {}, _a[dataKeys.list] = __spreadArray(__spreadArray([], _data[list], true), res[list], true), _a));\n      });\n    });\n  }\n  /**\n   * fetchData\n   * @description 调用接口\n   */\n  function fetchData(callback) {\n    var _a;\n    return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging === null || paging === void 0 ? void 0 : paging.current).then(function (data) {\n      callback(data);\n      setLoading(false);\n      return data;\n    }).catch(function (error) {\n      var _a;\n      setLoading(false);\n      if (callbackHandler.current) {\n        status.current = _adhereUiScrollload.default.ERROR;\n        (_a = callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current) === null || _a === void 0 ? void 0 : _a.call(callbackHandler, status.current);\n      }\n      return error;\n    });\n  }\n  /**\n   * onLoadMore\n   * @param callback\n   */\n  var onLoadMore = (0, _react.useCallback)(function (callback) {\n    if (status.current === _adhereUiScrollload.default.EMPTY) {\n      status.current = _adhereUiScrollload.default.EMPTY;\n      callback(_adhereUiScrollload.default.EMPTY);\n      return;\n    }\n    callbackHandler.current = callback;\n    setTimeout(function () {\n      return appendData();\n    }, 100);\n  }, []);\n  /**\n   * isEmpty\n   * @return {boolean}\n   */\n  var isEmpty = (0, _react.useCallback)(function () {\n    return paging.current.page === 1 && data[dataKeys.list].length === 0;\n  }, [data, dataKeys, paging.current.page]);\n  var _CommentList = (0, _react.useMemo)(function () {\n    return /*#__PURE__*/_react.default.createElement(_List.default, __assign({\n      getScrollWrapContainer: getScrollWrapContainer,\n      isLoading: loading,\n      // @ts-ignore\n      hasMore: data[dataKeys.list].length <= data[dataKeys.totalCount],\n      onLoadMore: onLoadMore,\n      renderFirstLoading: renderFirstLoading\n    }, listProps !== null && listProps !== void 0 ? listProps : {}), /*#__PURE__*/_react.default.createElement(_adhereUiConditionalrender.default, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty();\n      }\n    }, function () {\n      return renderList === null || renderList === void 0 ? void 0 : renderList(data);\n    }));\n  }, [getScrollWrapContainer, loading, data, dataKeys.totalCount, dataKeys.list, renderFirstLoading, listProps, renderEmpty]);\n  (0, _react.useEffect)(function () {\n    loadData();\n  }, []);\n  (0, _react.useLayoutEffect)(function () {\n    if (callbackHandler.current) {\n      status.current =\n      // @ts-ignore\n      paging.current.page < data[dataKeys.totalPage] ? _adhereUiScrollload.default.NORMAL : _adhereUiScrollload.default.EMPTY;\n      callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current(status.current);\n    }\n  }, [data]);\n  return /*#__PURE__*/_react.default.createElement(VerticalFlexLayout, __assign({}, flexLayoutProps !== null && flexLayoutProps !== void 0 ? flexLayoutProps : {}, {\n    className: \"\".concat(selectorPrefix),\n    renderMain: /*#__PURE__*/_react.default.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-auto\"),\n      ref: mainRef\n    }, _CommentList)\n  }));\n});\nvar _default = exports.default = ListStandard;"],"names":["_interopRequireDefault","require","_typeof","_empty","Object","defineProperty","exports","value","default","_react","_interopRequireWildcard","_adhereUiConditionalrender","_adhereUiFlexlayout","_adhereUiScrollload","_List","_getRequireWildcardCache","e","r","t","WeakMap","__esModule","has","get","u","i","n","__proto__","a","getOwnPropertyDescriptor","prototype","hasOwnProperty","call","set","__assign","assign","s","arguments","length","p","apply","this","__spreadArray","to","from","pack","ar","l","Array","slice","concat","VerticalFlexLayout","selectorPrefix","ListStandard","memo","props","_b","limit","_c","dataKeys","current","totalPage","list","totalCount","_d","listProps","_e","flexLayoutProps","renderFirstLoading","_f","renderEmpty","createElement","renderList","getScrollWrapContainer","paging","useRef","page","callbackHandler","status","NORMAL","mainRef","_g","useState","_a","data","setData","_h","loading","setLoading","fetchData","callback","then","catch","error","ERROR","onLoadMore","useCallback","EMPTY","setTimeout","res","_data","isEmpty","_CommentList","useMemo","isLoading","hasMore","conditional","noMatch","useEffect","useLayoutEffect","className","renderMain","ref","_default"],"mappings":"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"}