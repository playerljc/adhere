{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __read = (this && this.__read) || function (o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar antd_1 = require(\"antd\");\r\nvar react_1 = __importStar(require(\"react\"));\r\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\r\nvar adhere_ui_flexlayout_1 = __importDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\r\nvar adhere_ui_scrollload_1 = __importDefault(require(\"@baifendian/adhere-ui-scrollload\"));\r\nvar List_1 = __importDefault(require(\"../List\"));\r\nvar VerticalFlexLayout = adhere_ui_flexlayout_1.default.VerticalFlexLayout;\r\nvar selectorPrefix = 'adhere-ui-comment-list-standard';\r\n/**\r\n * ListStandard\r\n * @param props\r\n * @return {JSX.Element}\r\n * @constructor\r\n * @classdesc 上拉下拽\r\n */\r\nvar ListStandard = function (props) {\r\n    var _a;\r\n    var _b = props.limit, limit = _b === void 0 ? 10 : _b, _c = props.dataKeys, dataKeys = _c === void 0 ? {\r\n        current: 'current',\r\n        totalPage: 'totalPage',\r\n        list: 'list',\r\n        totalCount: 'totalCount',\r\n    } : _c, _d = props.listProps, listProps = _d === void 0 ? {} : _d, _e = props.flexLayoutProps, flexLayoutProps = _e === void 0 ? {} : _e, renderFirstLoading = props.renderFirstLoading, _f = props.renderEmpty, renderEmpty = _f === void 0 ? function () { return react_1.default.createElement(antd_1.Empty, null); } : _f, renderList = props.renderList, getScrollWrapContainer = props.getScrollWrapContainer;\r\n    var paging = (0, react_1.useRef)({\r\n        page: 1,\r\n        limit: limit,\r\n    });\r\n    var callbackHandler = (0, react_1.useRef)();\r\n    var status = (0, react_1.useRef)(adhere_ui_scrollload_1.default.NORMAL);\r\n    var mainRef = (0, react_1.useRef)(null);\r\n    var _g = __read((0, react_1.useState)((_a = {},\r\n        _a[dataKeys.current] = 1,\r\n        _a[dataKeys.totalPage] = 0,\r\n        _a[dataKeys.list] = [],\r\n        _a[dataKeys.totalCount] = 0,\r\n        _a)), 2), data = _g[0], setData = _g[1];\r\n    var _h = __read((0, react_1.useState)(true), 2), loading = _h[0], setLoading = _h[1];\r\n    /**\r\n     * loadData\r\n     * @description 重新加载数据\r\n     * @return {*}\r\n     */\r\n    function loadData() {\r\n        setLoading(true);\r\n        paging.current = {\r\n            page: 1,\r\n            limit: limit,\r\n        };\r\n        return fetchData(function (res) { return setData(res); });\r\n    }\r\n    /**\r\n     * appendData\r\n     * @description 加载更多\r\n     * @return {*}\r\n     */\r\n    function appendData() {\r\n        setLoading(true);\r\n        paging.current.page = paging.current.page + 1;\r\n        var list = dataKeys.list;\r\n        return fetchData(function (res) {\r\n            setData(function (_data) {\r\n                var _a;\r\n                return __assign(__assign({}, res), (_a = {}, _a[dataKeys.list] = __spreadArray(__spreadArray([], __read(_data[list]), false), __read(res[list]), false), _a));\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * fetchData\r\n     * @description 调用接口\r\n     */\r\n    function fetchData(callback) {\r\n        var _a;\r\n        return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging === null || paging === void 0 ? void 0 : paging.current).then(function (data) {\r\n            callback(data);\r\n            setLoading(false);\r\n            return data;\r\n        }).catch(function (error) {\r\n            var _a;\r\n            setLoading(false);\r\n            if (callbackHandler.current) {\r\n                status.current = adhere_ui_scrollload_1.default.ERROR;\r\n                (_a = callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current) === null || _a === void 0 ? void 0 : _a.call(callbackHandler, status.current);\r\n            }\r\n            return error;\r\n        });\r\n    }\r\n    /**\r\n     * onLoadMore\r\n     * @param callback\r\n     */\r\n    var onLoadMore = (0, react_1.useCallback)(function (callback) {\r\n        if (status.current === adhere_ui_scrollload_1.default.EMPTY) {\r\n            status.current = adhere_ui_scrollload_1.default.EMPTY;\r\n            callback(adhere_ui_scrollload_1.default.EMPTY);\r\n            return;\r\n        }\r\n        callbackHandler.current = callback;\r\n        setTimeout(function () { return appendData(); }, 100);\r\n    }, []);\r\n    /**\r\n     * isEmpty\r\n     * @return {boolean}\r\n     */\r\n    var isEmpty = (0, react_1.useCallback)(function () { return paging.current.page === 1 && data[dataKeys.list].length === 0; }, [data, dataKeys, paging.current.page]);\r\n    var _CommentList = (0, react_1.useMemo)(function () { return (react_1.default.createElement(List_1.default, __assign({ getScrollWrapContainer: getScrollWrapContainer, isLoading: loading, hasMore: data[dataKeys.list].length <= data[dataKeys.totalCount], onLoadMore: onLoadMore, renderFirstLoading: renderFirstLoading }, (listProps || {})),\r\n        react_1.default.createElement(adhere_ui_conditionalrender_1.default, { conditional: !isEmpty(), noMatch: function () { return renderEmpty(); } }, function () { return renderList === null || renderList === void 0 ? void 0 : renderList(data); }))); }, [\r\n        getScrollWrapContainer,\r\n        loading,\r\n        data,\r\n        dataKeys.totalCount,\r\n        dataKeys.list,\r\n        renderFirstLoading,\r\n        listProps,\r\n        renderEmpty,\r\n    ]);\r\n    (0, react_1.useEffect)(function () {\r\n        loadData();\r\n    }, []);\r\n    (0, react_1.useLayoutEffect)(function () {\r\n        if (callbackHandler.current) {\r\n            status.current =\r\n                paging.current.page < data[dataKeys.totalPage] ? adhere_ui_scrollload_1.default.NORMAL : adhere_ui_scrollload_1.default.EMPTY;\r\n            callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler.current(status.current);\r\n        }\r\n    }, [data]);\r\n    return (react_1.default.createElement(VerticalFlexLayout, __assign({}, (flexLayoutProps || {}), { className: \"\".concat(selectorPrefix), renderMain: react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-auto\"), ref: mainRef }, _CommentList) })));\r\n};\r\nexports.default = (0, react_1.memo)(ListStandard);\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__read","Symbol","iterator","r","e","ar","next","done","push","error","__spreadArray","to","from","pack","l","Array","slice","concat","__importDefault","default","antd_1","exports","require","react_1","adhere_ui_conditionalrender_1","adhere_ui_flexlayout_1","adhere_ui_scrollload_1","List_1","VerticalFlexLayout","selectorPrefix","ListStandard","props","_b","limit","_c","dataKeys","current","totalPage","list","totalCount","_d","listProps","_e","flexLayoutProps","renderFirstLoading","_f","renderEmpty","createElement","Empty","renderList","getScrollWrapContainer","paging","useRef","page","callbackHandler","status","NORMAL","mainRef","_g","useState","_a","data","setData","_h","loading","setLoading","fetchData","callback","then","catch","ERROR","onLoadMore","useCallback","EMPTY","setTimeout","res","_data","isEmpty","_CommentList","useMemo","isLoading","hasMore","conditional","noMatch","useEffect","useLayoutEffect","className","renderMain","ref","memo"],"mappings":"AAAA,aACA,IAAIA,SAAYC,MAAQA,KAAKD,UAAa,WAStC,OARAA,SAAWE,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE7C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAC1DN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,CACX,GACgBU,MAAMb,KAAMO,SAAS,CACzC,EACIO,gBAAmBd,MAAQA,KAAKc,kBAAqBb,OAAOc,OAAS,SAAUC,EAAGC,EAAGC,EAAGC,GAC7EC,KAAAA,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOpB,OAAOqB,yBAAyBL,EAAGC,CAAC,EAC1CG,IAAS,QAASA,EAAQJ,EAAEM,WAAaF,CAAAA,EAAKG,UAAYH,CAAAA,EAAKI,gBAClEJ,EAAO,CAAEK,WAAY,CAAA,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,CAAE,GAE9DjB,OAAO2B,eAAeZ,EAAGG,EAAIE,CAAI,CACpC,EAAI,SAAUL,EAAGC,EAAGC,EAAGC,GAEpBH,EADsBG,EAAXC,KAAAA,IAAPD,EAAuBD,EACzBC,GAAMF,EAAEC,EACb,GACGW,mBAAsB7B,MAAQA,KAAK6B,qBAAwB5B,OAAOc,OAAS,SAAUC,EAAGc,GACxF7B,OAAO2B,eAAeZ,EAAG,UAAW,CAAEU,WAAY,CAAA,EAAMK,MAAOD,CAAE,CAAC,CACrE,EAAI,SAASd,EAAGc,GACbd,EAAW,QAAIc,CACnB,GACIE,aAAgBhC,MAAQA,KAAKgC,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,GACb,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBjB,OAAOS,UAAUC,eAAeC,KAAKqB,EAAKf,CAAC,GAAGJ,gBAAgBoB,EAAQD,EAAKf,CAAC,EAEvI,OADAW,mBAAmBK,EAAQD,CAAG,EACvBC,CACX,EACIC,OAAUnC,MAAQA,KAAKmC,QAAW,SAAUnB,EAAGV,GAC/C,IAAIW,EAAsB,YAAlB,OAAOmB,QAAyBpB,EAAEoB,OAAOC,UACjD,GAAI,CAACpB,EAAG,OAAOD,EACf,IAAmBsB,EAAYC,EAA3BlC,EAAIY,EAAEL,KAAKI,CAAC,EAAMwB,EAAK,GAC3B,IACI,MAAc,KAAA,IAANlC,GAAsB,EAANA,CAAC,KAAW,EAAEgC,EAAIjC,EAAEoC,KAAK,GAAGC,MAAMF,EAAGG,KAAKL,EAAEP,KAAK,CAQ7E,CANA,MAAOa,GAASL,EAAI,CAAEK,MAAOA,CAAM,CAAG,CACtC,QACI,IACQN,GAAK,CAACA,EAAEI,OAASzB,EAAIZ,EAAU,SAAIY,EAAEL,KAAKP,CAAC,CAEnB,CAAhC,QAAU,GAAIkC,EAAG,MAAMA,EAAEK,KAAO,CACpC,CACA,OAAOJ,CACX,EACIK,cAAiB7C,MAAQA,KAAK6C,eAAkB,SAAUC,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBzC,UAAUC,OAAc,IAAK,IAA4BgC,EAAxBnC,EAAI,EAAG4C,EAAIF,EAAKvC,OAAYH,EAAI4C,EAAG5C,CAAC,GACzEmC,CAAAA,GAAQnC,KAAK0C,KACJP,EAAJA,GAASU,MAAMxC,UAAUyC,MAAMvC,KAAKmC,EAAM,EAAG1C,CAAC,GAChDA,GAAK0C,EAAK1C,IAGrB,OAAOyC,EAAGM,OAAOZ,GAAMU,MAAMxC,UAAUyC,MAAMvC,KAAKmC,CAAI,CAAC,CAC3D,EACIM,gBAAmBrD,MAAQA,KAAKqD,iBAAoB,SAAUpB,GAC9D,OAAQA,GAAOA,EAAIV,WAAcU,EAAM,CAAEqB,QAAWrB,CAAI,CAC5D,EAEIsB,QADJtD,OAAO2B,eAAe4B,QAAS,aAAc,CAAEzB,MAAO,CAAA,CAAK,CAAC,EAC/C0B,QAAQ,MAAM,GACvBC,QAAU1B,aAAayB,QAAQ,OAAO,CAAC,EACvCE,8BAAgCN,gBAAgBI,QAAQ,yCAAyC,CAAC,EAClGG,uBAAyBP,gBAAgBI,QAAQ,kCAAkC,CAAC,EACpFI,uBAAyBR,gBAAgBI,QAAQ,kCAAkC,CAAC,EACpFK,OAAST,gBAAgBI,QAAQ,SAAS,CAAC,EAC3CM,mBAAqBH,uBAAuBN,QAAQS,mBACpDC,eAAiB,kCAQjBC,aAAe,SAAUC,GACzB,IACIC,EAAKD,EAAME,MAAOA,EAAe,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAKH,EAAMI,SAAUA,EAAkB,KAAA,IAAPD,EAAgB,CACnGE,QAAS,UACTC,UAAW,YACXC,KAAM,OACNC,WAAY,YAChB,EAAIL,EAAIM,EAAKT,EAAMU,UAAWA,EAAmB,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAKX,EAAMY,gBAAiBA,EAAyB,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAqBb,EAAMa,mBAAoBC,EAAKd,EAAMe,YAAaA,EAAqB,KAAA,IAAPD,EAAgB,WAAc,OAAOtB,QAAQJ,QAAQ4B,cAAc3B,OAAO4B,MAAO,IAAI,CAAG,EAAIH,EAAII,EAAalB,EAAMkB,WAAYC,EAAyBnB,EAAMmB,uBACzXC,GAAS,EAAI5B,QAAQ6B,QAAQ,CAC7BC,KAAM,EACNpB,MAAOA,CACX,CAAC,EACGqB,GAAkB,EAAI/B,QAAQ6B,QAAQ,EACtCG,GAAS,EAAIhC,QAAQ6B,QAAQ1B,uBAAuBP,QAAQqC,MAAM,EAClEC,GAAU,EAAIlC,QAAQ6B,QAAQ,IAAI,EAClCM,EAAK1D,QAAO,EAAIuB,QAAQoC,YAAWC,EAAK,IACrCzB,EAASC,SAAW,EACvBwB,EAAGzB,EAASE,WAAa,EACzBuB,EAAGzB,EAASG,MAAQ,GACpBsB,EAAGzB,EAASI,YAAc,EAC1BqB,EAAG,EAAG,CAAC,EAAGC,EAAOH,EAAG,GAAII,EAAUJ,EAAG,GACrCK,EAAK/D,QAAO,EAAIuB,QAAQoC,UAAU,CAAA,CAAI,EAAG,CAAC,EAAGK,EAAUD,EAAG,GAAIE,EAAaF,EAAG,GAkClF,SAASG,EAAUC,GACf,IAAIP,EACJ,OAAO,OAACA,EAAK7B,MAAAA,EAAqC,KAAA,EAASA,EAAMmC,WAAuC,KAAA,EAASN,EAAGnF,KAAKsD,EAAOoB,MAAAA,EAAuC,KAAA,EAASA,EAAOf,OAAO,EAAEgC,KAAK,SAAUP,GAG3M,OAFAM,EAASN,CAAI,EACbI,EAAW,CAAA,CAAK,EACTJ,CACX,CAAC,EAAEQ,MAAM,SAAU5D,GACf,IAAImD,EAMJ,OALAK,EAAW,CAAA,CAAK,EACZX,EAAgBlB,UAChBmB,EAAOnB,QAAUV,uBAAuBP,QAAQmD,MAChD,OAACV,EAAKN,MAAAA,EAAyD,KAAA,EAASA,EAAgBlB,UAA8CwB,EAAGnF,KAAK6E,EAAiBC,EAAOnB,OAAO,GAE1K3B,CACX,CAAC,CACL,CAKA,IAAI8D,GAAa,EAAIhD,QAAQiD,aAAa,SAAUL,GAC5CZ,EAAOnB,UAAYV,uBAAuBP,QAAQsD,OAClDlB,EAAOnB,QAAUV,uBAAuBP,QAAQsD,MAChDN,EAASzC,uBAAuBP,QAAQsD,KAAK,IAGjDnB,EAAgBlB,QAAU+B,EAC1BO,WAAW,WAAc,OAzCzBT,EAAW,CAAA,CAAI,EACfd,EAAOf,QAAQiB,KAAOF,EAAOf,QAAQiB,KAAO,EACxCf,EAAOH,EAASG,KACb4B,EAAU,SAAUS,GACvBb,EAAQ,SAAUc,GACd,IAAIhB,EACJ,OAAOhG,SAASA,SAAS,GAAI+G,CAAG,IAAIf,EAAK,IAAOzB,EAASG,MAAQ5B,cAAcA,cAAc,GAAIV,OAAO4E,EAAMtC,EAAK,EAAG,CAAA,CAAK,EAAGtC,OAAO2E,EAAIrC,EAAK,EAAG,CAAA,CAAK,EAAGsB,EAAG,CAChK,CAAC,CACL,CAAC,EATL,IAGQtB,CAuC0C,EAAG,GAAG,EACxD,EAAG,EAAE,EAKDuC,GAAU,EAAItD,QAAQiD,aAAa,WAAc,OAA+B,IAAxBrB,EAAOf,QAAQiB,MAA6C,IAA/BQ,EAAK1B,EAASG,MAAMjE,MAAc,EAAG,CAACwF,EAAM1B,EAAUgB,EAAOf,QAAQiB,KAAK,EAC/JyB,GAAe,EAAIvD,QAAQwD,SAAS,WAAc,OAAQxD,QAAQJ,QAAQ4B,cAAcpB,OAAOR,QAASvD,SAAS,CAAEsF,uBAAwBA,EAAwB8B,UAAWhB,EAASiB,QAASpB,EAAK1B,EAASG,MAAMjE,QAAUwF,EAAK1B,EAASI,YAAagC,WAAYA,EAAY3B,mBAAoBA,CAAmB,EAAIH,GAAa,EAAG,EAC5UlB,QAAQJ,QAAQ4B,cAAcvB,8BAA8BL,QAAS,CAAE+D,YAAa,CAACL,EAAQ,EAAGM,QAAS,WAAc,OAAOrC,EAAY,CAAG,CAAE,EAAG,WAAc,OAAOG,MAAAA,EAA+C,KAAA,EAASA,EAAWY,CAAI,CAAG,CAAC,CAAE,CAAG,EAAG,CAC1PX,EACAc,EACAH,EACA1B,EAASI,WACTJ,EAASG,KACTM,EACAH,EACAK,EACH,EAWD,OAVA,EAAIvB,QAAQ6D,WAAW,WAxEnBnB,EAAW,CAAA,CAAI,EACfd,EAAOf,QAAU,CACbiB,KAAM,EACNpB,MAAOA,CACX,EACOiC,EAAU,SAAUS,GAAcb,EAAQa,CAAG,CAAG,CAAC,CAqE5D,EAAG,EAAE,GACL,EAAIpD,QAAQ8D,iBAAiB,WACrB/B,EAAgBlB,UAChBmB,EAAOnB,QACHe,EAAOf,QAAQiB,KAAOQ,EAAK1B,EAASE,WAAaX,uBAAuBP,QAAQqC,OAAS9B,uBAAuBP,QAAQsD,MAC5HnB,MAAAA,GAAkEA,EAAgBlB,QAAQmB,EAAOnB,OAAO,EAEhH,EAAG,CAACyB,EAAK,EACDtC,QAAQJ,QAAQ4B,cAAcnB,mBAAoBhE,SAAS,GAAK+E,GAAmB,GAAK,CAAE2C,UAAW,GAAGrE,OAAOY,cAAc,EAAG0D,WAAYhE,QAAQJ,QAAQ4B,cAAc,MAAO,CAAEuC,UAAW,GAAGrE,OAAOY,eAAgB,OAAO,EAAG2D,IAAK/B,CAAQ,EAAGqB,CAAY,CAAE,CAAC,CAAE,CAC/Q,EACAzD,QAAQF,SAAU,EAAII,QAAQkE,MAAM3D,YAAY"}