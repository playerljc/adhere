"use strict";require("core-js/modules/es.object.define-property.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),react_1=tslib_1.__importStar(require("react")),prop_types_1=tslib_1.__importDefault(require("prop-types")),antd_1=require("antd"),adhere_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-conditionalrender")),adhere_ui_scrollload_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-scrollload")),adhere_ui_flexlayout_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-flexlayout")),selectorPrefix="adhere-ui-comment-comment-list",List_1=tslib_1.__importStar(require("../List")),VerticalFlexLayout=adhere_ui_flexlayout_1.default.VerticalFlexLayout,VerticalFlexLayoutDefaultProps=adhere_ui_flexlayout_1.default.VerticalFlexLayoutDefaultProps,VerticalFlexLayoutPropTypes=adhere_ui_flexlayout_1.default.VerticalFlexLayoutPropTypes;function ListStandard(a){var l=(0,react_1.useRef)({page:1,limit:a.limit}),r=(0,react_1.useRef)(),i=(0,react_1.useRef)(adhere_ui_scrollload_1.default.NORMAL),e=(0,react_1.useRef)(),t=(0,react_1.useState)(((o={})[a.dataKeys.current]=1,o[a.dataKeys.totalPage]=0,o[a.dataKeys.list]=[],o[a.dataKeys.totalCount]=0,o)),u=t[0],n=t[1],o=(0,react_1.useState)(!0),t=o[0],s=o[1];function _(t){var e;return null===(e=null==a?void 0:a.fetchData)||void 0===e?void 0:e.call(a,null==l?void 0:l.current).then(function(e){return t(e),s(!1),e}).catch(function(e){var t;return s(!1),r.current&&(i.current=adhere_ui_scrollload_1.default.ERROR,null!==(t=null==r?void 0:r.current)&&void 0!==t&&t.call(r,i.current)),e})}return(0,react_1.useEffect)(function(){s(!0),l.current={page:1,limit:a.limit},_(function(e){n(e)})},[]),(0,react_1.useLayoutEffect)(function(){r.current&&(i.current=l.current.page<u[a.dataKeys.totalPage]?adhere_ui_scrollload_1.default.NORMAL:adhere_ui_scrollload_1.default.EMPTY,null!=r&&r.current(i.current))},[u]),react_1.default.createElement(VerticalFlexLayout,tslib_1.__assign({},a.flexLayoutProps,{className:"".concat(selectorPrefix),renderMain:react_1.default.createElement("div",{className:styles.Auto,ref:e},react_1.default.createElement(List_1.default,tslib_1.__assign({getScrollWrapContainer:a.getScrollWrapContainer,isLoading:t,renderLoading:a.renderLoading,hasMore:u[a.dataKeys.list].length<=u[a.dataKeys.totalCount],onLoadMore:function(e){if(i.current===adhere_ui_scrollload_1.default.EMPTY)return i.current=adhere_ui_scrollload_1.default.EMPTY,void e(adhere_ui_scrollload_1.default.EMPTY);r.current=e,setTimeout(function(){s(!0),l.current.page=l.current.page+1;var r=a.dataKeys.list;return _(function(e){var t;n(tslib_1.__assign(tslib_1.__assign({},e),((t={})[a.dataKeys.list]=tslib_1.__spreadArray(tslib_1.__spreadArray([],u[r],!0),e[r],!0),t)))})},100)},renderFirstLoading:a.renderFirstLoading},a.listProps),react_1.default.createElement(adhere_ui_conditionalrender_1.default,{conditional:!(1===l.current.page&&0===u[a.dataKeys.list].length),noMatch:function(){var e;return null===(e=null==a?void 0:a.renderEmpty)||void 0===e?void 0:e.call(a)}},function(){var e;return null===(e=null==a?void 0:a.renderList)||void 0===e?void 0:e.call(a,u)})))}))}ListStandard.defaultProps={flexLayoutProps:tslib_1.__assign({},VerticalFlexLayoutDefaultProps),listProps:tslib_1.__assign({},List_1.defaultProps),limit:10,renderEmpty:function(){return react_1.default.createElement(antd_1.Empty,null)},dataKeys:{current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}},ListStandard.propTypes={getScrollWrapContainer:prop_types_1.default.func,flexLayoutProps:prop_types_1.default.shape(tslib_1.__assign({},VerticalFlexLayoutPropTypes)),listProps:prop_types_1.default.shape(tslib_1.__assign({},List_1.propTypes)),limit:prop_types_1.default.number,renderList:prop_types_1.default.func,renderEmpty:prop_types_1.default.func,renderFirstLoading:prop_types_1.default.func,fetchData:prop_types_1.default.func,renderLoading:prop_types_1.default.func,dataKeys:prop_types_1.default.shape({current:prop_types_1.default.string,totalPage:prop_types_1.default.string,list:prop_types_1.default.string,totalCount:prop_types_1.default.string})},exports.default=ListStandard;
//# sourceMappingURL=index.js.map
