"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,r){void 0===r&&(r=a);var n=Object.getOwnPropertyDescriptor(t,a);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,r,n)}:function(e,t,a,r){e[r=void 0===r?a:r]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var r,n,o=a.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)i.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},antd_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("antd")),react_1=__importStar(require("react")),adhere_ui_hooks_1=__importDefault(require("@baifendian/adhere-ui-hooks")),adhere_util_intl_1=__importDefault(require("@baifendian/adhere-util-intl")),data_1=__importDefault(require("@emoji-mart/data")),ar_json_1=__importDefault(require("@emoji-mart/data/i18n/ar.json")),de_json_1=__importDefault(require("@emoji-mart/data/i18n/de.json")),en_json_1=__importDefault(require("@emoji-mart/data/i18n/en.json")),es_json_1=__importDefault(require("@emoji-mart/data/i18n/es.json")),fa_json_1=__importDefault(require("@emoji-mart/data/i18n/fa.json")),fr_json_1=__importDefault(require("@emoji-mart/data/i18n/fr.json")),it_json_1=__importDefault(require("@emoji-mart/data/i18n/it.json")),ja_json_1=__importDefault(require("@emoji-mart/data/i18n/ja.json")),nl_json_1=__importDefault(require("@emoji-mart/data/i18n/nl.json")),pl_json_1=__importDefault(require("@emoji-mart/data/i18n/pl.json")),pt_json_1=__importDefault(require("@emoji-mart/data/i18n/pt.json")),ru_json_1=__importDefault(require("@emoji-mart/data/i18n/ru.json")),uk_json_1=__importDefault(require("@emoji-mart/data/i18n/uk.json")),zh_json_1=__importDefault(require("@emoji-mart/data/i18n/zh.json")),react_2=__importDefault(require("@emoji-mart/react")),emoji_1=__importDefault(require("./emoji")),TextArea=antd_1.Input.TextArea,useSetState=adhere_ui_hooks_1.default.useSetState,selectorPrefix="adhere-ui-comment-reply",LOCAL_MAP=new Map([["ar",ar_json_1.default],["de",de_json_1.default],["en",en_json_1.default],["es",es_json_1.default],["fa",fa_json_1.default],["fr",fr_json_1.default],["it",it_json_1.default],["ja",ja_json_1.default],["nl",nl_json_1.default],["pl",pl_json_1.default],["pt",pt_json_1.default],["ru",ru_json_1.default],["uk",uk_json_1.default],["zh",zh_json_1.default]]),Reply=function(e){var t=e.local,a=void 0===t?"zh":t,t=e.emojiPickerProps,r=void 0===t?{}:t,n=e.onResult,o=e.onCancel,t=__read(useSetState(""),2),i=t[0],l=t[1],u=(0,react_1.useRef)(null),_=(0,react_1.useRef)(null),e=__read((0,react_1.useState)(!1),2),t=e[0],c=e[1],s=(0,react_1.useCallback)(function(e){var t=e.native,a=null==(e=null==u?void 0:u.current)?void 0:e.querySelector("textarea"),r=a.selectionStart;l("".concat(i.substring(0,r)).concat(t).concat(i.substring(r)),function(){a.focus(),a.setSelectionRange(r+t.length,r+t.length)})},[i]),e=(0,react_1.useMemo)(function(){return react_1.default.createElement(react_2.default,__assign({data:data_1.default,i18n:LOCAL_MAP.get(a||"zh"),onEmojiSelect:s},r||{}))},[data_1.default,a,r]);return(0,react_1.useLayoutEffect)(function(){var e,t;function a(e){e=e.target;[(null==u?void 0:u.current).querySelector("textarea")].includes(e)||c(!1)}function r(e){e.stopPropagation()}return document.body.addEventListener("click",a),null!=(t=null==(e=null==_?void 0:_.current)?void 0:e.addEventListener)&&t.call(e,"click",r),function(){var e,t;document.body.removeEventListener("click",a),null!=(t=null==(e=null==_?void 0:_.current)?void 0:e.removeEventListener)&&t.call(e,"click",r)}}),react_1.default.createElement("div",{className:"".concat(selectorPrefix)},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-textarea-wrap"),ref:u},react_1.default.createElement(TextArea,{className:"".concat(selectorPrefix,"-textarea"),placeholder:adhere_util_intl_1.default.v("请输入回复内容"),autoFocus:!0,value:i,onChange:function(e){return l(e.target.value)},showCount:!0,maxLength:100})),react_1.default.createElement("div",{ref:_,className:"".concat(selectorPrefix,"-toolbar-emoji-wrap")}),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-toolbar")},react_1.default.createElement(antd_1.Popover,{placement:"bottomLeft",getPopupContainer:function(){return _.current},content:e,open:t},react_1.default.createElement("div",{onClick:function(e){e.stopPropagation(),c(function(e){return!e})}},react_1.default.createElement(emoji_1.default,{className:"".concat(selectorPrefix,"-toolbar-item-emoji")}))),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-toolbar-inner")},react_1.default.createElement(antd_1.Button,{type:"primary",className:"".concat(selectorPrefix,"-toolbar-item"),disabled:!i,onClick:function(){return null==n?void 0:n(i.trim())}},adhere_util_intl_1.default.v("添加")),react_1.default.createElement(antd_1.Button,{className:"".concat(selectorPrefix,"-toolbar-item"),onClick:function(){return null==o?void 0:o()}},adhere_util_intl_1.default.v("取消")))))};exports.default=(0,react_1.memo)(Reply);
//# sourceMappingURL=index.js.map
