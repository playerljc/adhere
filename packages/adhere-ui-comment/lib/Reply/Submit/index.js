"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),antd_1=require("antd"),react_1=tslib_1.__importStar(require("react")),adhere_ui_hooks_1=tslib_1.__importDefault(require("@baifendian/adhere-ui-hooks")),adhere_util_intl_1=tslib_1.__importDefault(require("@baifendian/adhere-util-intl")),data_1=tslib_1.__importDefault(require("@emoji-mart/data")),ar_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/ar.json")),de_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/de.json")),en_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/en.json")),es_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/es.json")),fa_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/fa.json")),fr_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/fr.json")),it_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/it.json")),ja_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/ja.json")),nl_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/nl.json")),pl_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/pl.json")),pt_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/pt.json")),ru_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/ru.json")),uk_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/uk.json")),zh_json_1=tslib_1.__importDefault(require("@emoji-mart/data/i18n/zh.json")),react_2=tslib_1.__importDefault(require("@emoji-mart/react")),emoji_1=tslib_1.__importDefault(require("./emoji")),TextArea=antd_1.Input.TextArea,useSetState=adhere_ui_hooks_1.default.useSetState,selectorPrefix="adhere-ui-comment-reply",LOCAL_MAP=new Map([["ar",ar_json_1.default],["de",de_json_1.default],["en",en_json_1.default],["es",es_json_1.default],["fa",fa_json_1.default],["fr",fr_json_1.default],["it",it_json_1.default],["ja",ja_json_1.default],["nl",nl_json_1.default],["pl",pl_json_1.default],["pt",pt_json_1.default],["ru",ru_json_1.default],["uk",uk_json_1.default],["zh",zh_json_1.default]]),Reply=function(e){var t=e.local,a=void 0===t?"zh":t,t=e.emojiPickerProps,r=void 0===t?{}:t,n=e.onResult,i=e.onCancel,t=tslib_1.__read(useSetState(""),2),o=t[0],l=t[1],_=(0,react_1.useRef)(null),u=(0,react_1.useRef)(null),e=tslib_1.__read((0,react_1.useState)(!1),2),t=e[0],s=e[1],c=(0,react_1.useCallback)(function(e){var t=e.native,a=null==(e=null==_?void 0:_.current)?void 0:e.querySelector("textarea"),r=a.selectionStart;l("".concat(o.substring(0,r)).concat(t).concat(o.substring(r)),function(){a.focus(),a.setSelectionRange(r+t.length,r+t.length)})},[o]),e=(0,react_1.useMemo)(function(){return react_1.default.createElement(react_2.default,tslib_1.__assign({data:data_1.default,i18n:LOCAL_MAP.get(a||"zh"),onEmojiSelect:c},r||{}))},[data_1.default,a,r]);return(0,react_1.useLayoutEffect)(function(){var e,t;function a(e){e=e.target;[(null==_?void 0:_.current).querySelector("textarea")].includes(e)||s(!1)}function r(e){e.stopPropagation()}return document.body.addEventListener("click",a),null!=(t=null==(e=null==u?void 0:u.current)?void 0:e.addEventListener)&&t.call(e,"click",r),function(){var e,t;document.body.removeEventListener("click",a),null!=(t=null==(e=null==u?void 0:u.current)?void 0:e.removeEventListener)&&t.call(e,"click",r)}}),react_1.default.createElement("div",{className:"".concat(selectorPrefix)},react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-textarea-wrap"),ref:_},react_1.default.createElement(TextArea,{className:"".concat(selectorPrefix,"-textarea"),placeholder:adhere_util_intl_1.default.v("请输入回复内容"),autoFocus:!0,value:o,onChange:function(e){return l(e.target.value)},showCount:!0,maxLength:100})),react_1.default.createElement("div",{ref:u,className:"".concat(selectorPrefix,"-toolbar-emoji-wrap")}),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-toolbar")},react_1.default.createElement(antd_1.Popover,{placement:"bottomLeft",getPopupContainer:function(){return u.current},content:e,open:t},react_1.default.createElement("div",{onClick:function(e){e.stopPropagation(),s(function(e){return!e})}},react_1.default.createElement(emoji_1.default,{className:"".concat(selectorPrefix,"-toolbar-item-emoji")}))),react_1.default.createElement("div",{className:"".concat(selectorPrefix,"-toolbar-inner")},react_1.default.createElement(antd_1.Button,{type:"primary",className:"".concat(selectorPrefix,"-toolbar-item"),disabled:!o,onClick:function(){return null==n?void 0:n(o.trim())}},adhere_util_intl_1.default.v("添加")),react_1.default.createElement(antd_1.Button,{className:"".concat(selectorPrefix,"-toolbar-item"),onClick:function(){return null==i?void 0:i()}},adhere_util_intl_1.default.v("取消")))))};exports.default=(0,react_1.memo)(Reply);
//# sourceMappingURL=index.js.map
