{"version":3,"file":"index.js","sources":["Reply/Submit/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/esnext.map.delete-all.js\");\n\nrequire(\"core-js/modules/esnext.map.every.js\");\n\nrequire(\"core-js/modules/esnext.map.filter.js\");\n\nrequire(\"core-js/modules/esnext.map.find.js\");\n\nrequire(\"core-js/modules/esnext.map.find-key.js\");\n\nrequire(\"core-js/modules/esnext.map.includes.js\");\n\nrequire(\"core-js/modules/esnext.map.key-of.js\");\n\nrequire(\"core-js/modules/esnext.map.map-keys.js\");\n\nrequire(\"core-js/modules/esnext.map.map-values.js\");\n\nrequire(\"core-js/modules/esnext.map.merge.js\");\n\nrequire(\"core-js/modules/esnext.map.reduce.js\");\n\nrequire(\"core-js/modules/esnext.map.some.js\");\n\nrequire(\"core-js/modules/esnext.map.update.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar antd_1 = require(\"antd\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar adhere_ui_hooks_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-hooks\"));\n\nvar adhere_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-util-intl\"));\n\nvar data_1 = tslib_1.__importDefault(require(\"@emoji-mart/data\"));\n\nvar ar_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ar.json\"));\n\nvar de_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/de.json\"));\n\nvar en_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/en.json\"));\n\nvar es_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/es.json\"));\n\nvar fa_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/fa.json\"));\n\nvar fr_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/fr.json\"));\n\nvar it_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/it.json\"));\n\nvar ja_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ja.json\"));\n\nvar nl_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/nl.json\"));\n\nvar pl_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/pl.json\"));\n\nvar pt_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/pt.json\"));\n\nvar ru_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ru.json\"));\n\nvar uk_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/uk.json\"));\n\nvar zh_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/zh.json\"));\n\nvar react_2 = tslib_1.__importDefault(require(\"@emoji-mart/react\"));\n\nvar emoji_1 = tslib_1.__importDefault(require(\"./emoji\"));\n\nvar TextArea = antd_1.Input.TextArea;\nvar useSetState = adhere_ui_hooks_1.default.useSetState;\nvar selectorPrefix = 'adhere-ui-comment-reply';\nvar LOCAL_MAP = new Map([['ar', ar_json_1.default], ['de', de_json_1.default], ['en', en_json_1.default], ['es', es_json_1.default], ['fa', fa_json_1.default], ['fr', fr_json_1.default], ['it', it_json_1.default], ['ja', ja_json_1.default], ['nl', nl_json_1.default], ['pl', pl_json_1.default], ['pt', pt_json_1.default], ['ru', ru_json_1.default], ['uk', uk_json_1.default], ['zh', zh_json_1.default]]);\n/**\n * Reply\n * @param props\n * @constructor\n * @classdesc 回复\n */\n\nvar Reply = function Reply(props) {\n  var _a = props.local,\n      local = _a === void 0 ? 'zh' : _a,\n      _b = props.emojiPickerProps,\n      emojiPickerProps = _b === void 0 ? {} : _b,\n      onResult = props.onResult,\n      onCancel = props.onCancel;\n\n  var _c = tslib_1.__read(useSetState(''), 2),\n      value = _c[0],\n      setValue = _c[1]; // 回复内容的textarea\n\n\n  var textAreaRef = (0, react_1.useRef)(null);\n  var emojiWrapRef = (0, react_1.useRef)(null);\n\n  var _d = tslib_1.__read((0, react_1.useState)(false), 2),\n      emojiIconWrapVisible = _d[0],\n      setEmojiIconWrapVisible = _d[1];\n  /**\n   * onEmojiSelect\n   * @param native\n   */\n\n\n  var onEmojiSelect = (0, react_1.useCallback)(function (_a) {\n    var _b;\n\n    var native = _a.native; // 获取textarea的dom\n\n    var textareaEl = (_b = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current) === null || _b === void 0 ? void 0 : _b.querySelector('textarea'); // 光标开始索引\n\n    var selectionStart = textareaEl.selectionStart; // (0) 1 (1) 2 (2) 3 (3)\n\n    setValue(\"\".concat(value.substring(0, selectionStart)).concat(native).concat(value.substring(selectionStart)), function () {\n      textareaEl.focus();\n      textareaEl.setSelectionRange(selectionStart + native.length, selectionStart + native.length);\n    });\n  }, [value]);\n  var PopoverContent = (0, react_1.useMemo)(function () {\n    return react_1.default.createElement(react_2.default, tslib_1.__assign({\n      data: data_1.default,\n      i18n: LOCAL_MAP.get(local || 'zh'),\n      onEmojiSelect: onEmojiSelect\n    }, emojiPickerProps || {}));\n  }, [data_1.default, local, emojiPickerProps]);\n  (0, react_1.useLayoutEffect)(function () {\n    var _a, _b;\n\n    function onDocBodyClick(e) {\n      var target = e.target;\n      var textareaEl = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current;\n\n      if (![textareaEl.querySelector('textarea')].includes(target)) {\n        setEmojiIconWrapVisible(false);\n      }\n    }\n\n    function onEmojiWrapClick(e) {\n      e.stopPropagation();\n    }\n\n    document.body.addEventListener('click', onDocBodyClick);\n    (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    return function () {\n      var _a, _b;\n\n      document.body.removeEventListener('click', onDocBodyClick);\n      (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    };\n  });\n  return react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix)\n  }, react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-textarea-wrap\"),\n    ref: textAreaRef\n  }, react_1.default.createElement(TextArea, {\n    className: \"\".concat(selectorPrefix, \"-textarea\"),\n    placeholder: adhere_util_intl_1.default.v('请输入回复内容'),\n    autoFocus: true,\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.target.value);\n    },\n    showCount: true,\n    maxLength: 100\n  })), react_1.default.createElement(\"div\", {\n    ref: emojiWrapRef,\n    className: \"\".concat(selectorPrefix, \"-emoji-wrap\")\n  }), react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-toolbar\")\n  }, react_1.default.createElement(antd_1.Popover, {\n    placement: \"bottomLeft\",\n    getPopupContainer: function getPopupContainer() {\n      return emojiWrapRef.current;\n    },\n    content: PopoverContent,\n    visible: emojiIconWrapVisible\n  }, react_1.default.createElement(\"div\", {\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      setEmojiIconWrapVisible(function (v) {\n        return !v;\n      });\n    }\n  }, react_1.default.createElement(emoji_1.default, {\n    className: \"\".concat(selectorPrefix, \"-toolbar-item-emoji\")\n  }))), react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-toolbar-inner\")\n  }, react_1.default.createElement(antd_1.Button, {\n    type: \"primary\",\n    className: \"\".concat(selectorPrefix, \"-toolbar-item\"),\n    disabled: !value,\n    onClick: function onClick() {\n      return onResult === null || onResult === void 0 ? void 0 : onResult(value.trim());\n    }\n  }, adhere_util_intl_1.default.v('添加')), react_1.default.createElement(antd_1.Button, {\n    className: \"\".concat(selectorPrefix, \"-toolbar-item\"),\n    onClick: function onClick() {\n      return onCancel === null || onCancel === void 0 ? void 0 : onCancel();\n    }\n  }, adhere_util_intl_1.default.v('取消')))));\n};\n\nexports.default = (0, react_1.memo)(Reply);"],"names":["require","Object","defineProperty","exports","value","tslib_1","antd_1","react_1","__importStar","adhere_ui_hooks_1","__importDefault","adhere_util_intl_1","data_1","ar_json_1","de_json_1","en_json_1","es_json_1","fa_json_1","fr_json_1","it_json_1","ja_json_1","nl_json_1","pl_json_1","pt_json_1","ru_json_1","uk_json_1","zh_json_1","react_2","emoji_1","TextArea","Input","useSetState","default","selectorPrefix","LOCAL_MAP","Map","Reply","props","_a","local","_b","emojiPickerProps","onResult","onCancel","_c","__read","setValue","textAreaRef","useRef","emojiWrapRef","_d","useState","emojiIconWrapVisible","setEmojiIconWrapVisible","onEmojiSelect","useCallback","native","textareaEl","current","querySelector","selectionStart","concat","substring","focus","setSelectionRange","length","PopoverContent","useMemo","createElement","__assign","data","i18n","get","useLayoutEffect","onDocBodyClick","e","target","includes","onEmojiWrapClick","stopPropagation","document","body","addEventListener","call","removeEventListener","className","ref","placeholder","v","autoFocus","onChange","showCount","maxLength","Popover","placement","getPopupContainer","content","visible","onClick","Button","type","disabled","trim","memo"],"mappings":"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"}