{"version":3,"file":"index.js","sources":["Reply/Submit/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/esnext.map.delete-all.js\");\n\nrequire(\"core-js/modules/esnext.map.every.js\");\n\nrequire(\"core-js/modules/esnext.map.filter.js\");\n\nrequire(\"core-js/modules/esnext.map.find.js\");\n\nrequire(\"core-js/modules/esnext.map.find-key.js\");\n\nrequire(\"core-js/modules/esnext.map.includes.js\");\n\nrequire(\"core-js/modules/esnext.map.key-of.js\");\n\nrequire(\"core-js/modules/esnext.map.map-keys.js\");\n\nrequire(\"core-js/modules/esnext.map.map-values.js\");\n\nrequire(\"core-js/modules/esnext.map.merge.js\");\n\nrequire(\"core-js/modules/esnext.map.reduce.js\");\n\nrequire(\"core-js/modules/esnext.map.some.js\");\n\nrequire(\"core-js/modules/esnext.map.update.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.string.trim.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importStar(require(\"react\"));\n\nvar prop_types_1 = tslib_1.__importDefault(require(\"prop-types\")); // @ts-ignore\n\n\nvar data_1 = tslib_1.__importDefault(require(\"@emoji-mart/data\"));\n\nvar react_2 = tslib_1.__importDefault(require(\"@emoji-mart/react\"));\n\nvar antd_1 = require(\"antd\");\n\nvar adhere_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-util-intl\"));\n\nvar adhere_ui_hooks_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-hooks\"));\n\nvar ar_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ar.json\"));\n\nvar de_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/de.json\"));\n\nvar en_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/en.json\"));\n\nvar es_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/es.json\"));\n\nvar fa_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/fa.json\"));\n\nvar fr_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/fr.json\"));\n\nvar it_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/it.json\"));\n\nvar ja_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ja.json\"));\n\nvar nl_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/nl.json\"));\n\nvar pl_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/pl.json\"));\n\nvar pt_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/pt.json\"));\n\nvar ru_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/ru.json\"));\n\nvar uk_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/uk.json\"));\n\nvar zh_json_1 = tslib_1.__importDefault(require(\"@emoji-mart/data/i18n/zh.json\"));\n\nvar emoji_1 = tslib_1.__importDefault(require(\"./emoji\"));\n\nvar TextArea = antd_1.Input.TextArea;\nvar useSetState = adhere_ui_hooks_1.default.useSetState;\nvar selectorPrefix = 'adhere-ui-comment-reply';\nvar LOCAL_MAP = new Map([['ar', ar_json_1.default], ['de', de_json_1.default], ['en', en_json_1.default], ['es', es_json_1.default], ['fa', fa_json_1.default], ['fr', fr_json_1.default], ['it', it_json_1.default], ['ja', ja_json_1.default], ['nl', nl_json_1.default], ['pl', pl_json_1.default], ['pt', pt_json_1.default], ['ru', ru_json_1.default], ['uk', uk_json_1.default], ['zh', zh_json_1.default]]);\n/**\n * Reply\n * @param props\n * @constructor\n * @classdesc 回复\n */\n\nfunction Reply(props) {\n  var _a = tslib_1.__read(useSetState(''), 2),\n      value = _a[0],\n      setValue = _a[1]; // 回复内容的textarea\n\n\n  var textAreaRef = (0, react_1.useRef)();\n  var emojiWrapRef = (0, react_1.useRef)();\n\n  var _b = tslib_1.__read((0, react_1.useState)(false), 2),\n      emojiIconWrapVisible = _b[0],\n      setEmojiIconWrapVisible = _b[1];\n  /**\n   * onEmojiSelect\n   * @param native\n   */\n\n\n  function onEmojiSelect(_a) {\n    var _b;\n\n    var native = _a.native; // 获取textarea的dom\n\n    var textareaEl = (_b = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current) === null || _b === void 0 ? void 0 : _b.querySelector('textarea'); // 光标开始索引\n\n    var selectionStart = textareaEl.selectionStart; // (0) 1 (1) 2 (2) 3 (3)\n\n    setValue(\"\".concat(value.substring(0, selectionStart)).concat(native).concat(value.substring(selectionStart)), function () {\n      textareaEl.focus();\n      textareaEl.setSelectionRange(selectionStart + native.length, selectionStart + native.length);\n    });\n  }\n\n  (0, react_1.useLayoutEffect)(function () {\n    var _a, _b;\n\n    function onDocBodyClick(e) {\n      // console.log('onDocBodyClick');\n      var target = e.target;\n      var textareaEl = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current; // console.log('target', target);\n      // console.log('textAreaRef.current', textareaEl);\n\n      if (![textareaEl.querySelector('textarea')].includes(target)) {\n        setEmojiIconWrapVisible(false);\n      }\n    }\n\n    function onEmojiWrapClick(e) {\n      // console.log('onEmojiIconWrapClick');\n      e.stopPropagation();\n    }\n\n    document.body.addEventListener('click', onDocBodyClick);\n    (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    return function () {\n      var _a, _b;\n\n      document.body.removeEventListener('click', onDocBodyClick);\n      (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    };\n  }, []);\n  return react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix)\n  }, react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-textarea-wrap\"),\n    ref: textAreaRef\n  }, react_1.default.createElement(TextArea, {\n    className: \"\".concat(selectorPrefix, \"-textarea\"),\n    placeholder: adhere_util_intl_1.default.v('请输入回复内容'),\n    autoFocus: true,\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.target.value);\n    },\n    showCount: true,\n    maxLength: 100\n  })), react_1.default.createElement(\"div\", {\n    ref: emojiWrapRef,\n    className: \"\".concat(selectorPrefix, \"-emoji-wrap\")\n  }), react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-toolbar\")\n  }, react_1.default.createElement(antd_1.Popover, {\n    placement: \"bottomLeft\",\n    // trigger=\"click\"\n    // @ts-ignore\n    getPopupContainer: function getPopupContainer() {\n      return emojiWrapRef.current;\n    },\n    content: react_1.default.createElement(react_2.default, tslib_1.__assign({\n      data: data_1.default,\n      i18n: LOCAL_MAP.get(props.local || 'zh'),\n      onEmojiSelect: onEmojiSelect\n    }, props.emojiPickerProps || {})),\n    visible: emojiIconWrapVisible\n  }, react_1.default.createElement(\"div\", {\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      setEmojiIconWrapVisible(!emojiIconWrapVisible);\n    }\n  }, react_1.default.createElement(emoji_1.default, {\n    className: \"\".concat(selectorPrefix, \"-toolbar-item-emoji\")\n  }))), react_1.default.createElement(\"div\", {\n    className: \"\".concat(selectorPrefix, \"-toolbar-inner\")\n  }, react_1.default.createElement(antd_1.Button, {\n    type: \"primary\",\n    className: \"\".concat(selectorPrefix, \"-toolbar-item\"),\n    disabled: !value,\n    onClick: function onClick() {\n      var _a;\n\n      (_a = props === null || props === void 0 ? void 0 : props.onResult) === null || _a === void 0 ? void 0 : _a.call(props, value.trim());\n    }\n  }, adhere_util_intl_1.default.v('添加')), react_1.default.createElement(antd_1.Button, {\n    className: \"\".concat(selectorPrefix, \"-toolbar-item\"),\n    onClick: function onClick() {\n      var _a;\n\n      return (_a = props === null || props === void 0 ? void 0 : props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, adhere_util_intl_1.default.v('取消')))));\n}\n\nReply.defaultProps = {};\nReply.propTypes = {\n  onCancel: prop_types_1.default.func,\n  onResult: prop_types_1.default.func,\n  local: prop_types_1.default.string,\n  emojiPickerProps: prop_types_1.default.object\n};\nexports.default = Reply;"],"names":["require","Object","defineProperty","exports","value","tslib_1","react_1","__importStar","prop_types_1","__importDefault","data_1","react_2","antd_1","adhere_util_intl_1","adhere_ui_hooks_1","ar_json_1","de_json_1","en_json_1","es_json_1","fa_json_1","fr_json_1","it_json_1","ja_json_1","nl_json_1","pl_json_1","pt_json_1","ru_json_1","uk_json_1","zh_json_1","emoji_1","TextArea","Input","useSetState","default","selectorPrefix","LOCAL_MAP","Map","Reply","props","_a","__read","setValue","textAreaRef","useRef","emojiWrapRef","_b","useState","emojiIconWrapVisible","setEmojiIconWrapVisible","useLayoutEffect","onDocBodyClick","e","target","current","querySelector","includes","onEmojiWrapClick","stopPropagation","document","body","addEventListener","call","removeEventListener","createElement","className","concat","ref","placeholder","v","autoFocus","onChange","showCount","maxLength","Popover","placement","getPopupContainer","content","__assign","data","i18n","get","local","onEmojiSelect","native","textareaEl","selectionStart","substring","focus","setSelectionRange","length","emojiPickerProps","visible","onClick","Button","type","disabled","onResult","trim","onCancel","defaultProps","propTypes","func","string","object"],"mappings":"aAEAA,QAAQ,gDAERA,QAAQ,wCAERA,QAAQ,6BAERA,QAAQ,0CAERA,QAAQ,yCAERA,QAAQ,4CAERA,QAAQ,uCAERA,QAAQ,wCAERA,QAAQ,sCAERA,QAAQ,0CAERA,QAAQ,0CAERA,QAAQ,wCAERA,QAAQ,0CAERA,QAAQ,4CAERA,QAAQ,uCAERA,QAAQ,wCAERA,QAAQ,sCAERA,QAAQ,wCAERA,QAAQ,mDAERA,QAAQ,sCAERA,QAAQ,wCAERA,QAAQ,yCAERA,QAAQ,qCAERC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAGT,IAAIC,QAAUL,QAAQ,SAElBM,QAAUD,QAAQE,aAAaP,QAAQ,UAEvCQ,aAAeH,QAAQI,gBAAgBT,QAAQ,eAG/CU,OAASL,QAAQI,gBAAgBT,QAAQ,qBAEzCW,QAAUN,QAAQI,gBAAgBT,QAAQ,sBAE1CY,OAASZ,QAAQ,QAEjBa,mBAAqBR,QAAQI,gBAAgBT,QAAQ,iCAErDc,kBAAoBT,QAAQI,gBAAgBT,QAAQ,gCAEpDe,UAAYV,QAAQI,gBAAgBT,QAAQ,kCAE5CgB,UAAYX,QAAQI,gBAAgBT,QAAQ,kCAE5CiB,UAAYZ,QAAQI,gBAAgBT,QAAQ,kCAE5CkB,UAAYb,QAAQI,gBAAgBT,QAAQ,kCAE5CmB,UAAYd,QAAQI,gBAAgBT,QAAQ,kCAE5CoB,UAAYf,QAAQI,gBAAgBT,QAAQ,kCAE5CqB,UAAYhB,QAAQI,gBAAgBT,QAAQ,kCAE5CsB,UAAYjB,QAAQI,gBAAgBT,QAAQ,kCAE5CuB,UAAYlB,QAAQI,gBAAgBT,QAAQ,kCAE5CwB,UAAYnB,QAAQI,gBAAgBT,QAAQ,kCAE5CyB,UAAYpB,QAAQI,gBAAgBT,QAAQ,kCAE5C0B,UAAYrB,QAAQI,gBAAgBT,QAAQ,kCAE5C2B,UAAYtB,QAAQI,gBAAgBT,QAAQ,kCAE5C4B,UAAYvB,QAAQI,gBAAgBT,QAAQ,kCAE5C6B,QAAUxB,QAAQI,gBAAgBT,QAAQ,YAE1C8B,SAAWlB,OAAOmB,MAAMD,SACxBE,YAAclB,kBAAkBmB,QAAQD,YACxCE,eAAiB,0BACjBC,UAAY,IAAIC,IAAI,CAAC,CAAC,KAAMrB,UAAUkB,SAAU,CAAC,KAAMjB,UAAUiB,SAAU,CAAC,KAAMhB,UAAUgB,SAAU,CAAC,KAAMf,UAAUe,SAAU,CAAC,KAAMd,UAAUc,SAAU,CAAC,KAAMb,UAAUa,SAAU,CAAC,KAAMZ,UAAUY,SAAU,CAAC,KAAMX,UAAUW,SAAU,CAAC,KAAMV,UAAUU,SAAU,CAAC,KAAMT,UAAUS,SAAU,CAAC,KAAMR,UAAUQ,SAAU,CAAC,KAAMP,UAAUO,SAAU,CAAC,KAAMN,UAAUM,SAAU,CAAC,KAAML,UAAUK,WAQzY,SAASI,MAAMC,GACb,IAAIC,EAAKlC,QAAQmC,OAAOR,YAAY,IAAK,GACrC5B,EAAQmC,EAAG,GACXE,EAAWF,EAAG,GAGdG,GAAc,EAAIpC,QAAQqC,UAC1BC,GAAe,EAAItC,QAAQqC,UAE3BE,EAAKxC,QAAQmC,QAAO,EAAIlC,QAAQwC,WAAU,GAAQ,GAClDC,EAAuBF,EAAG,GAC1BG,EAA0BH,EAAG,GAkDjC,OA5BA,EAAIvC,QAAQ2C,iBAAiB,WAC3B,IAAIV,EAAIM,EAER,SAASK,EAAeC,GAElBC,EAASD,EAAEC,OAIV,EAHYV,MAAAA,OAAiD,EAASA,EAAYW,SAGtEC,cAAc,aAAaC,SAASH,IACnDJ,GAAwB,GAI5B,SAASQ,EAAiBL,GAExBA,EAAEM,kBAKJ,OAFAC,SAASC,KAAKC,iBAAiB,QAASV,GACoH,QAA3JL,EAAiG,QAA3FN,EAAKK,MAAAA,OAAmD,EAASA,EAAaS,eAA4B,IAAPd,OAAgB,EAASA,EAAGqB,wBAAqC,IAAPf,GAAyBA,EAAGgB,KAAKtB,EAAI,QAASiB,GAC3M,WACL,IAAIjB,EAAIM,EAERa,SAASC,KAAKG,oBAAoB,QAASZ,GACoH,QAA9JL,EAAiG,QAA3FN,EAAKK,MAAAA,OAAmD,EAASA,EAAaS,eAA4B,IAAPd,OAAgB,EAASA,EAAGuB,2BAAwC,IAAPjB,GAAyBA,EAAGgB,KAAKtB,EAAI,QAASiB,KAEtN,IACIlD,QAAQ2B,QAAQ8B,cAAc,MAAO,CAC1CC,UAAW,GAAGC,OAAO/B,iBACpB5B,QAAQ2B,QAAQ8B,cAAc,MAAO,CACtCC,UAAW,GAAGC,OAAO/B,eAAgB,kBACrCgC,IAAKxB,GACJpC,QAAQ2B,QAAQ8B,cAAcjC,SAAU,CACzCkC,UAAW,GAAGC,OAAO/B,eAAgB,aACrCiC,YAAatD,mBAAmBoB,QAAQmC,EAAE,WAC1CC,WAAW,EACXjE,MAAOA,EACPkE,SAAU,SAAkBnB,GAC1B,OAAOV,EAASU,EAAEC,OAAOhD,QAE3BmE,WAAW,EACXC,UAAW,OACRlE,QAAQ2B,QAAQ8B,cAAc,MAAO,CACxCG,IAAKtB,EACLoB,UAAW,GAAGC,OAAO/B,eAAgB,iBACnC5B,QAAQ2B,QAAQ8B,cAAc,MAAO,CACvCC,UAAW,GAAGC,OAAO/B,eAAgB,aACpC5B,QAAQ2B,QAAQ8B,cAAcnD,OAAO6D,QAAS,CAC/CC,UAAW,aAGXC,kBAAmB,WACjB,OAAO/B,EAAaS,SAEtBuB,QAAStE,QAAQ2B,QAAQ8B,cAAcpD,QAAQsB,QAAS5B,QAAQwE,SAAS,CACvEC,KAAMpE,OAAOuB,QACb8C,KAAM5C,UAAU6C,IAAI1C,EAAM2C,OAAS,MACnCC,cAzEJ,SAAuB3C,GACrB,IAEI4C,EAAS5C,EAAG4C,OAEZC,EAAsG,QAAxFvC,EAAKH,MAAAA,OAAiD,EAASA,EAAYW,eAA4B,IAAPR,OAAgB,EAASA,EAAGS,cAAc,YAExJ+B,EAAiBD,EAAWC,eAEhC5C,EAAS,GAAGwB,OAAO7D,EAAMkF,UAAU,EAAGD,IAAiBpB,OAAOkB,GAAQlB,OAAO7D,EAAMkF,UAAUD,IAAkB,WAC7GD,EAAWG,QACXH,EAAWI,kBAAkBH,EAAiBF,EAAOM,OAAQJ,EAAiBF,EAAOM,YA+DpFnD,EAAMoD,kBAAoB,KAC7BC,QAAS5C,GACRzC,QAAQ2B,QAAQ8B,cAAc,MAAO,CACtC6B,QAAS,SAAiBzC,GACxBA,EAAEM,kBACFT,GAAyBD,KAE1BzC,QAAQ2B,QAAQ8B,cAAclC,QAAQI,QAAS,CAChD+B,UAAW,GAAGC,OAAO/B,eAAgB,2BACjC5B,QAAQ2B,QAAQ8B,cAAc,MAAO,CACzCC,UAAW,GAAGC,OAAO/B,eAAgB,mBACpC5B,QAAQ2B,QAAQ8B,cAAcnD,OAAOiF,OAAQ,CAC9CC,KAAM,UACN9B,UAAW,GAAGC,OAAO/B,eAAgB,iBACrC6D,UAAW3F,EACXwF,QAAS,WACP,IAAIrD,EAEoE,QAAvEA,EAAKD,MAAAA,OAAqC,EAASA,EAAM0D,gBAA6B,IAAPzD,GAAyBA,EAAGsB,KAAKvB,EAAOlC,EAAM6F,UAE/HpF,mBAAmBoB,QAAQmC,EAAE,OAAQ9D,QAAQ2B,QAAQ8B,cAAcnD,OAAOiF,OAAQ,CACnF7B,UAAW,GAAGC,OAAO/B,eAAgB,iBACrC0D,QAAS,WACP,IAAIrD,EAEJ,OAA+E,QAAvEA,EAAKD,MAAAA,OAAqC,EAASA,EAAM4D,gBAA6B,IAAP3D,OAAgB,EAASA,EAAGsB,KAAKvB,KAEzHzB,mBAAmBoB,QAAQmC,EAAE,UAGlC/B,MAAM8D,aAAe,GACrB9D,MAAM+D,UAAY,CAChBF,SAAU1F,aAAayB,QAAQoE,KAC/BL,SAAUxF,aAAayB,QAAQoE,KAC/BpB,MAAOzE,aAAayB,QAAQqE,OAC5BZ,iBAAkBlF,aAAayB,QAAQsE,QAEzCpG,QAAQ8B,QAAUI"}