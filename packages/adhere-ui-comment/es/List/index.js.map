{"version":3,"file":"index.js","sources":["List/index.js"],"sourcesContent":["import _Skeleton from \"antd/es/skeleton\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport { __assign, __extends } from \"tslib\";\nimport React, { forwardRef, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\nimport ScrollLoad from '@baifendian/adhere-ui-scrollload';\nimport BackTopAnimation from '@baifendian/adhere-ui-backtopanimation';\nvar selectorPrefix = 'adhere-ui-comment-list';\n\nvar BackTopAnimationImpl =\n/** @class */\nfunction (_super) {\n  __extends(BackTopAnimationImpl, _super);\n\n  function BackTopAnimationImpl() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  BackTopAnimationImpl.prototype.componentWillUnmount = function () {\n    try {\n      _super.prototype.componentWillUnmount.call(this);\n    } catch (e) {}\n  };\n\n  return BackTopAnimationImpl;\n}(BackTopAnimation);\n/**\n * CommentList\n * @constructor\n */\n\n\nfunction CommentList(_a) {\n  var className = _a.className,\n      style = _a.style,\n      isLoading = _a.isLoading,\n      hasMore = _a.hasMore,\n      onLoadMore = _a.onLoadMore,\n      scrollLoadProps = _a.scrollLoadProps,\n      renderFirstLoading = _a.renderFirstLoading,\n      getScrollWrapContainer = _a.getScrollWrapContainer,\n      children = _a.children; // 第一次\n\n  var isFirst = useRef(true); // 第一次加载\n\n  var isFirstLoading = useRef(false);\n  var wrapRef = useRef();\n  /**\n   * renderDispatch\n   * @description 渲染的一个分配\n   * @return {*}\n   */\n\n  function renderDispatch() {\n    var loading = isLoading;\n\n    if (isFirst.current && !isFirstLoading.current && loading) {\n      isFirstLoading.current = true;\n    }\n\n    if (isFirst.current && isFirstLoading.current && !loading) {\n      isFirst.current = false;\n      isFirstLoading.current = false;\n    }\n\n    if (isFirst.current) {\n      return _renderFirstLoading();\n    }\n\n    return renderNormal();\n  }\n  /**\n   * _renderFirstLoading\n   * @description 渲染第一次的UI\n   * @return {JSX.Element}\n   */\n\n\n  function _renderFirstLoading() {\n    if (renderFirstLoading) {\n      return renderFirstLoading();\n    }\n\n    var result = [];\n\n    for (var i = 0; i < 15; i++) {\n      // @ts-ignore\n      result.push( /*#__PURE__*/React.createElement(_Skeleton, {\n        key: i + 1,\n        loading: true,\n        active: true,\n        avatar: true\n      }));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-first-loading-wrap\")\n    }, result);\n  }\n  /**\n   * renderNormal\n   * @description 渲染真正的UI\n   * @return {JSX.Element}\n   */\n\n\n  function renderNormal() {\n    var defaultScrollLoadProps = {\n      getScrollContainer: function getScrollContainer() {\n        var _a;\n\n        return (_a = getScrollWrapContainer === null || getScrollWrapContainer === void 0 ? void 0 : getScrollWrapContainer()) === null || _a === void 0 ? void 0 : _a.firstElementChild;\n      },\n      style: {\n        height: '100%'\n      },\n      onScrollBottom: onLoadMore\n    };\n    return /*#__PURE__*/React.createElement(ConditionalRender, {\n      conditional: hasMore\n    }, function () {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-normal-wrap\")\n      }, /*#__PURE__*/React.createElement(ScrollLoad, __assign({}, defaultScrollLoadProps, scrollLoadProps || {}, {\n        distance: (scrollLoadProps === null || scrollLoadProps === void 0 ? void 0 : scrollLoadProps.distance) || 50\n      }), children), /*#__PURE__*/React.createElement(ConditionalRender, {\n        conditional: !!(getScrollWrapContainer ? getScrollWrapContainer() : null),\n        noMatch: function noMatch() {\n          return /*#__PURE__*/React.createElement(BackTopAnimationImpl, {\n            target: function target() {\n              var _a, _b;\n\n              return (_b = (_a = wrapRef === null || wrapRef === void 0 ? void 0 : wrapRef.current) === null || _a === void 0 ? void 0 : _a.querySelector) === null || _b === void 0 ? void 0 : _b.call(_a, '.adhere-ui-scrollload');\n            },\n            onTrigger: function onTrigger() {\n              return Promise.resolve(null);\n            }\n          });\n        }\n      }, function () {\n        return /*#__PURE__*/ReactDOM.createPortal( /*#__PURE__*/React.createElement(BackTopAnimationImpl, {\n          target: function target() {\n            var _a;\n\n            return (_a = getScrollWrapContainer === null || getScrollWrapContainer === void 0 ? void 0 : getScrollWrapContainer()) === null || _a === void 0 ? void 0 : _a.firstElementChild;\n          },\n          onTrigger: function onTrigger() {\n            return Promise.resolve(null);\n          }\n        }), getScrollWrapContainer === null || getScrollWrapContainer === void 0 ? void 0 : getScrollWrapContainer());\n      }));\n    });\n  }\n\n  return (\n    /*#__PURE__*/\n    // @ts-ignore\n    React.createElement(\"div\", {\n      className: classnames(selectorPrefix, className || ''),\n      style: __assign({}, style),\n      ref: wrapRef\n    }, renderDispatch())\n  );\n}\n\nexport var defaultProps = {};\nexport var propTypes = {\n  getScrollWrapContainer: PropTypes.func,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  // 是否是加载数据\n  isLoading: PropTypes.bool,\n  // 是否还有更多\n  hasMore: PropTypes.bool,\n  // 加载更多\n  onLoadMore: PropTypes.func,\n  renderFirstLoading: PropTypes.func,\n  scrollLoadProps: PropTypes.shape({\n    className: PropTypes.string,\n    style: PropTypes.object,\n    loadClassName: PropTypes.string,\n    loadStyle: PropTypes.object,\n    emptyClassName: PropTypes.string,\n    emptyStyle: PropTypes.object,\n    errorClassName: PropTypes.string,\n    errorStyle: PropTypes.object,\n    distance: PropTypes.number,\n    onScrollBottom: PropTypes.func,\n    onEmptyClick: PropTypes.func,\n    onErrorClick: PropTypes.func,\n    renderLoading: PropTypes.func,\n    renderEmpty: PropTypes.func,\n    renderError: PropTypes.func\n  })\n};\nCommentList.defaultProps = defaultProps;\nCommentList.propTypes = propTypes; // @ts-ignore\n\nexport default /*#__PURE__*/forwardRef(CommentList);"],"names":["_Skeleton","__assign","__extends","React","forwardRef","useRef","ReactDOM","PropTypes","classnames","ConditionalRender","ScrollLoad","BackTopAnimation","selectorPrefix","BackTopAnimationImpl","_super","apply","this","arguments","prototype","componentWillUnmount","call","e","CommentList","_a","defaultScrollLoadProps","className","style","isLoading","hasMore","onLoadMore","scrollLoadProps","renderFirstLoading","getScrollWrapContainer","children","isFirst","isFirstLoading","wrapRef","createElement","ref","loading","current","result","i","push","key","active","avatar","concat","_renderFirstLoading","getScrollContainer","firstElementChild","height","onScrollBottom","conditional","distance","noMatch","target","_b","querySelector","onTrigger","Promise","resolve","createPortal","defaultProps","propTypes","func","string","object","bool","shape","loadClassName","loadStyle","emptyClassName","emptyStyle","errorClassName","errorStyle","number","onEmptyClick","onErrorClick","renderLoading","renderEmpty","renderError"],"mappings":"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"}