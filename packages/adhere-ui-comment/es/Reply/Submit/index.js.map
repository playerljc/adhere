{"version":3,"file":"index.js","sources":["Reply/Submit/index.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport { Button, Input, Popover } from 'antd';\r\nimport React, { memo, useCallback, useLayoutEffect, useMemo, useRef, useState } from 'react';\r\nimport Hooks from '@baifendian/adhere-ui-hooks';\r\nimport Intl from '@baifendian/adhere-util-intl';\r\nimport data from '@emoji-mart/data';\r\nimport ar from '@emoji-mart/data/i18n/ar.json';\r\nimport de from '@emoji-mart/data/i18n/de.json';\r\nimport en from '@emoji-mart/data/i18n/en.json';\r\nimport es from '@emoji-mart/data/i18n/es.json';\r\nimport fa from '@emoji-mart/data/i18n/fa.json';\r\nimport fr from '@emoji-mart/data/i18n/fr.json';\r\nimport it from '@emoji-mart/data/i18n/it.json';\r\nimport ja from '@emoji-mart/data/i18n/ja.json';\r\nimport nl from '@emoji-mart/data/i18n/nl.json';\r\nimport pl from '@emoji-mart/data/i18n/pl.json';\r\nimport pt from '@emoji-mart/data/i18n/pt.json';\r\nimport ru from '@emoji-mart/data/i18n/ru.json';\r\nimport uk from '@emoji-mart/data/i18n/uk.json';\r\nimport zh from '@emoji-mart/data/i18n/zh.json';\r\nimport Picker from '@emoji-mart/react';\r\nimport EmojiIcon from './emoji';\r\nvar TextArea = Input.TextArea;\r\nvar useSetState = Hooks.useSetState;\r\nvar selectorPrefix = 'adhere-ui-comment-reply';\r\nvar LOCAL_MAP = new Map([\r\n    ['ar', ar],\r\n    ['de', de],\r\n    ['en', en],\r\n    ['es', es],\r\n    ['fa', fa],\r\n    ['fr', fr],\r\n    ['it', it],\r\n    ['ja', ja],\r\n    ['nl', nl],\r\n    ['pl', pl],\r\n    ['pt', pt],\r\n    ['ru', ru],\r\n    ['uk', uk],\r\n    ['zh', zh],\r\n]);\r\n/**\r\n * Reply\r\n * @param props\r\n * @constructor\r\n * @classdesc 回复\r\n */\r\nvar Reply = function (props) {\r\n    var _a = props.local, local = _a === void 0 ? 'zh' : _a, _b = props.emojiPickerProps, emojiPickerProps = _b === void 0 ? {} : _b, onResult = props.onResult, onCancel = props.onCancel;\r\n    var _c = useSetState(''), value = _c[0], setValue = _c[1];\r\n    // 回复内容的textarea\r\n    var textAreaRef = useRef(null);\r\n    var emojiWrapRef = useRef(null);\r\n    var _d = useState(false), emojiIconWrapVisible = _d[0], setEmojiIconWrapVisible = _d[1];\r\n    /**\r\n     * onEmojiSelect\r\n     * @param native\r\n     */\r\n    var onEmojiSelect = useCallback(function (_a) {\r\n        var _b;\r\n        var native = _a.native;\r\n        // 获取textarea的dom\r\n        var textareaEl = (_b = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current) === null || _b === void 0 ? void 0 : _b.querySelector('textarea');\r\n        // 光标开始索引\r\n        var selectionStart = textareaEl.selectionStart;\r\n        // (0) 1 (1) 2 (2) 3 (3)\r\n        setValue(\"\".concat(value.substring(0, selectionStart)).concat(native).concat(value.substring(selectionStart)), function () {\r\n            textareaEl.focus();\r\n            textareaEl.setSelectionRange(selectionStart + native.length, selectionStart + native.length);\r\n        });\r\n    }, [value]);\r\n    var PopoverContent = useMemo(function () { return (React.createElement(Picker, __assign({ data: data, i18n: LOCAL_MAP.get(local || 'zh'), onEmojiSelect: onEmojiSelect }, (emojiPickerProps || {})))); }, [data, local, emojiPickerProps]);\r\n    useLayoutEffect(function () {\r\n        var _a, _b;\r\n        function onDocBodyClick(e) {\r\n            var target = e.target;\r\n            var textareaEl = textAreaRef === null || textAreaRef === void 0 ? void 0 : textAreaRef.current;\r\n            if (![textareaEl.querySelector('textarea')].includes(target)) {\r\n                setEmojiIconWrapVisible(false);\r\n            }\r\n        }\r\n        function onEmojiWrapClick(e) {\r\n            e.stopPropagation();\r\n        }\r\n        document.body.addEventListener('click', onDocBodyClick);\r\n        (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\r\n        return function () {\r\n            var _a, _b;\r\n            document.body.removeEventListener('click', onDocBodyClick);\r\n            (_b = (_a = emojiWrapRef === null || emojiWrapRef === void 0 ? void 0 : emojiWrapRef.current) === null || _a === void 0 ? void 0 : _a.removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\r\n        };\r\n    });\r\n    return (React.createElement(\"div\", { className: \"\".concat(selectorPrefix) },\r\n        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-textarea-wrap\"), ref: textAreaRef },\r\n            React.createElement(TextArea, { className: \"\".concat(selectorPrefix, \"-textarea\"), placeholder: Intl.v('请输入回复内容'), autoFocus: true, value: value, onChange: function (e) { return setValue(e.target.value); }, showCount: true, maxLength: 100 })),\r\n        React.createElement(\"div\", { ref: emojiWrapRef, className: \"\".concat(selectorPrefix, \"-toolbar-emoji-wrap\") }),\r\n        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-toolbar\") },\r\n            React.createElement(Popover, { placement: \"bottomLeft\", getPopupContainer: function () { return emojiWrapRef.current; }, content: PopoverContent, open: emojiIconWrapVisible },\r\n                React.createElement(\"div\", { onClick: function (e) {\r\n                        e.stopPropagation();\r\n                        setEmojiIconWrapVisible(function (v) { return !v; });\r\n                    } },\r\n                    React.createElement(EmojiIcon, { className: \"\".concat(selectorPrefix, \"-toolbar-item-emoji\") }))),\r\n            React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-toolbar-inner\") },\r\n                React.createElement(Button, { type: \"primary\", className: \"\".concat(selectorPrefix, \"-toolbar-item\"), disabled: !value, onClick: function () { return onResult === null || onResult === void 0 ? void 0 : onResult(value.trim()); } }, Intl.v('添加')),\r\n                React.createElement(Button, { className: \"\".concat(selectorPrefix, \"-toolbar-item\"), onClick: function () { return onCancel === null || onCancel === void 0 ? void 0 : onCancel(); } }, Intl.v('取消'))))));\r\n};\r\nexport default memo(Reply);\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","Button","Input","Popover","React","memo","useCallback","useLayoutEffect","useMemo","useRef","useState","Hooks","Intl","data","ar","de","en","es","fa","fr","it","ja","nl","pl","pt","ru","uk","zh","Picker","EmojiIcon","TextArea","useSetState","selectorPrefix","LOCAL_MAP","Map","Reply","props","_a","local","_b","emojiPickerProps","onResult","onCancel","_c","value","setValue","textAreaRef","emojiWrapRef","_d","emojiIconWrapVisible","setEmojiIconWrapVisible","onEmojiSelect","native","textareaEl","current","querySelector","selectionStart","concat","substring","focus","setSelectionRange","PopoverContent","createElement","i18n","get","onDocBodyClick","e","target","includes","onEmojiWrapClick","stopPropagation","document","body","addEventListener","removeEventListener","className","ref","placeholder","v","autoFocus","onChange","showCount","maxLength","placement","getPopupContainer","content","open","onClick","type","disabled","trim"],"mappings":"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"}