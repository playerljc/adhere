var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(r){for(var n,l=1,i=arguments.length;l<i;l++)for(var e in n=arguments[l])Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e]);return r}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(r,n,l){if(l||2===arguments.length)for(var i,e=0,t=n.length;e<t;e++)!i&&e in n||((i=i||Array.prototype.slice.call(n,0,e))[e]=n[e]);return r.concat(i||Array.prototype.slice.call(n))};import omit from"omit.js";import React,{useMemo}from"react";import Util from"@baifendian/adhere-util";var optionKeys=["value","key","id"],DEFAULT_VALUE_PROP="value";export default function(a){var r,n=a.value,t=a.onChange,o=a.children,l=a.treeData,i=useMemo(function(){return!("isUsePrimaryValue"in a)||a.isUsePrimaryValue},[a.isUsePrimaryValue]);function u(r){var n;if(null!=(n=a.valueProp)?n:DEFAULT_VALUE_PROP in r)return r[null!=(n=a.valueProp)?n:DEFAULT_VALUE_PROP];for(var l=r[DEFAULT_VALUE_PROP],i=0;i<optionKeys.length;i++)if(optionKeys[i]in r){l=r[optionKeys[i]];break}return l}function s(r){var n;return null!=r&&""!==(null==(n=null==r?void 0:r.trim)?void 0:n.call(r))&&Util.isPrimitive(r)}function p(r){var n;return null!=r&&""!==(null==(n=null==r?void 0:r.trim)?void 0:n.call(r))&&Util.isArray(r)&&r.length&&r.flat().some(function(r){return Util.isPrimitive(r)})}function c(r){return r.map(function(r){return s(r)?f(r):Util.isArray(r)?c(r):r})}function f(t){var r;var n=__spreadArray([],null!=l?l:[],!0);return Array.isArray(a.value)?a.value.forEach(function(r){Util.isObject(r)&&n.push(r)}):Util.isObject(a.value)&&n.push(a.value),"treeDataSimpleMode"in o.props&&o.props.treeDataSimpleMode?null!=(r=(null!=n?n:[]).find(function(r){return Object.is(u(r),t)}))?r:t:null!=(r=function r(n){for(var l,i=0;i<n.length;i++){var e=u(n[i]);if(Object.is(e,t)){l=n[i];break}if(l=r(null!=(e=null==(e=n[i])?void 0:e[null!=(e=a.childrenProp)?e:"children"])?e:[]))break}return l}(null!=n?n:[]))?r:t}function e(r){for(var n=r[DEFAULT_VALUE_PROP],l=0;l<optionKeys.length;l++)if(optionKeys[l]in r){n=r[optionKeys[l]];break}return n}return s(n)?null!=t&&t(f(n)):p(n)&&null!=t&&t(c(n)),React.cloneElement(o,__assign(__assign(__assign({},omit(a,["children"])),o.props),{value:i?null!=(i=n)&&""!==(null==(r=null==i?void 0:i.trim)?void 0:r.call(i))&&!Util.isArray(i)&&Util.isRef(i)?e(n):null!=(r=n)&&""!==(null==(i=null==r?void 0:r.trim)?void 0:i.call(r))&&Util.isArray(r)&&r.length&&r.flat().every(function(r){return Util.isRef(r)})?function n(r){return r.map(function(r){return(Util.isArray(r)?n:e)(r)})}(n):n:n,realValue:n,onChange:function(r){for(var n,l,i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];s(r)?null!=t&&t.apply(void 0,__spreadArray([f(r)],i,!1)):p(r)?null!=t&&t.apply(void 0,__spreadArray([c(r)],i,!1)):null!=t&&t.apply(void 0,__spreadArray([r],i,!1)),null!=(l=null==(n=o.props)?void 0:n.onChange)&&l.call.apply(l,__spreadArray([n,r],i,!1))}}))}
//# sourceMappingURL=useTreeEntityValueHOC.js.map
