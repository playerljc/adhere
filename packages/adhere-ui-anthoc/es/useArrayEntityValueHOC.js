var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(r){for(var n,i=1,l=arguments.length;i<l;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e]);return r}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(r,n,i){if(i||2===arguments.length)for(var l,e=0,t=n.length;e<t;e++)!l&&e in n||((l=l||Array.prototype.slice.call(n,0,e))[e]=n[e]);return r.concat(l||Array.prototype.slice.call(n))};import omit from"omit.js";import React,{useMemo}from"react";import Util from"@baifendian/adhere-util";var optionKeys=["value","key","id"],DEFAULT_VALUE_PROP="value";export default function(e){var r,n=e.value,t=e.onChange,a=e.children,l=e.options,i=useMemo(function(){return!("isUsePrimaryValue"in e)||e.isUsePrimaryValue},[e.isUsePrimaryValue]);function o(r){var n;return null!=r&&""!==(null==(n=null==r?void 0:r.trim)?void 0:n.call(r))&&Util.isPrimitive(r)}function u(r){var n;return null!=r&&""!==(null==(n=null==r?void 0:r.trim)?void 0:n.call(r))&&Util.isArray(r)&&r.length&&r.some(function(r){return Util.isPrimitive(r)})}function s(r){return r.map(function(r){return o(r)?p(r):r})}function p(n){var r,i=__spreadArray([],null!=l?l:[],!0);return Array.isArray(e.value)?e.value.forEach(function(r){Util.isObject(r)&&i.push(r)}):Util.isObject(e.value)&&i.push(e.value),null!=(r=(null!=i?i:[]).find(function(r){return Object.is(function(r){var n;if(null!=(n=e.valueProp)?n:DEFAULT_VALUE_PROP in r)return r[null!=(n=e.valueProp)?n:DEFAULT_VALUE_PROP];for(var i=r[DEFAULT_VALUE_PROP],l=0;l<optionKeys.length;l++)if(optionKeys[l]in r){i=r[optionKeys[l]];break}return i}(r),n)}))?r:n}function c(r){for(var n=r[DEFAULT_VALUE_PROP],i=0;i<optionKeys.length;i++)if(optionKeys[i]in r){n=r[optionKeys[i]];break}return n}return o(n)?null!=t&&t(p(n)):u(n)&&null!=t&&t(s(n)),React.cloneElement(a,__assign(__assign(__assign({},omit(e,["children"])),a.props),{value:i?null!=(i=n)&&""!==(null==(r=null==i?void 0:i.trim)?void 0:r.call(i))&&!Util.isArray(i)&&Util.isRef(i)?c(n):null!=(r=n)&&""!==(null==(i=null==r?void 0:r.trim)?void 0:i.call(r))&&Util.isArray(r)&&r.length&&r.every(function(r){return Util.isRef(r)})?n.map(c):n:n,realValue:n,onChange:function(r){for(var n,i,l=[],e=1;e<arguments.length;e++)l[e-1]=arguments[e];o(r)?null!=t&&t.apply(void 0,__spreadArray([p(r)],l,!1)):u(r)?null!=t&&t.apply(void 0,__spreadArray([s(r)],l,!1)):null!=t&&t.apply(void 0,__spreadArray([r],l,!1)),null!=(i=null==(n=a.props)?void 0:n.onChange)&&i.call.apply(i,__spreadArray([n,r],l,!1))}}))}
//# sourceMappingURL=useArrayEntityValueHOC.js.map
