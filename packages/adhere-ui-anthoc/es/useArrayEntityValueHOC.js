var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(n){for(var r,i=1,l=arguments.length;i<l;i++)for(var e in r=arguments[i])Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e]);return n}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(n,r,i){if(i||2===arguments.length)for(var l,e=0,t=r.length;e<t;e++)!l&&e in r||((l=l||Array.prototype.slice.call(r,0,e))[e]=r[e]);return n.concat(l||Array.prototype.slice.call(r))};import omit from"omit.js";import React,{useMemo}from"react";import Util from"@baifendian/adhere-util";var optionKeys=["value","key","id"],DEFAULT_VALUE_PROP="value";export default function(t){var n,r=t.value,a=t.onChange,o=t.children,l=t.options,i=useMemo(function(){return!("isUsePrimaryValue"in t)||t.isUsePrimaryValue},[t.isUsePrimaryValue]);function u(n){var r;return null!=n&&""!==(null==(r=null==n?void 0:n.trim)?void 0:r.call(n))&&Util.isPrimitive(n)}function s(n){var r;return null!=n&&""!==(null==(r=null==n?void 0:n.trim)?void 0:r.call(n))&&Util.isArray(n)&&n.length&&n.some(function(n){return Util.isPrimitive(n)})}function p(n){return n.map(function(n){return u(n)?c(n):n})}function c(r){var n,i=__spreadArray([],null!=l?l:[],!0);return Array.isArray(t.value)?t.value.forEach(function(n){Util.isObject(n)&&i.push(n)}):Util.isObject(t.value)&&i.push(t.value),null!=(n=(null!=i?i:[]).find(function(n){return Object.is(function(n){var r;if(null!=(r=t.valueProp)?r:DEFAULT_VALUE_PROP in n)return n[null!=(r=t.valueProp)?r:DEFAULT_VALUE_PROP];for(var i=n[DEFAULT_VALUE_PROP],l=0;l<optionKeys.length;l++)if(optionKeys[l]in n){i=n[optionKeys[l]];break}return i}(n),r)}))?n:r}function e(n){for(var r=n[DEFAULT_VALUE_PROP],i=0;i<optionKeys.length;i++)if(optionKeys[i]in n){r=n[optionKeys[i]];break}return r}return u(r)?null!=a&&a(c(r)):s(r)&&null!=a&&a(p(r)),React.cloneElement(o,__assign(__assign(__assign({},omit(t,["children","options"])),o.props),{value:i?null!=(i=r)&&""!==(null==(n=null==i?void 0:i.trim)?void 0:n.call(i))&&!Util.isArray(i)&&Util.isRef(i)?e(r):null!=(n=r)&&""!==(null==(i=null==n?void 0:n.trim)?void 0:i.call(n))&&Util.isArray(n)&&n.length&&n.every(function(n){return Util.isRef(n)})?r.map(e):r:r,realValue:r,onChange:function(n){for(var r,i,l=[],e=1;e<arguments.length;e++)l[e-1]=arguments[e];u(n)?null!=a&&a.apply(void 0,__spreadArray([c(n)],l,!1)):s(n)?null!=a&&a.apply(void 0,__spreadArray([p(n)],l,!1)):null!=a&&a.apply(void 0,__spreadArray([n],l,!1)),Object.is(a,null==(r=o.props)?void 0:r.onChange)||"changePropagation"in t&&!t.changePropagation||null!=(i=null==(r=o.props)?void 0:r.onChange)&&i.call.apply(i,__spreadArray([r,n],l,!1))}}))}
//# sourceMappingURL=useArrayEntityValueHOC.js.map
