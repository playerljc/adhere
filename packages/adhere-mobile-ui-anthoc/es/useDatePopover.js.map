{"version":3,"file":"useDatePopover.js","sources":["useDatePopover.js"],"sourcesContent":["var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { useUpdateEffect } from 'ahooks';\nimport { useConfig } from 'antd-mobile/es/components/config-provider/config-provider';\nimport React, { useMemo, useRef } from 'react';\nimport Intl from '@baifendian/adhere-util-intl';\nimport DatePickerView from './date-picker-view';\nvar selectorPrefix = 'adhere-mobile-ui-ant-hoc-date-popover';\nvar useDatePopover = function useDatePopover(_a) {\n  var _b;\n  var popoverTriggerClassName = _a.popoverTriggerClassName,\n    popoverTriggerStyle = _a.popoverTriggerStyle,\n    placeholder = _a.placeholder,\n    value = _a.value,\n    okLabel = _a.okLabel,\n    cancelLabel = _a.cancelLabel,\n    renderDisplay = _a.renderDisplay,\n    locale = _a.locale,\n    datePickerViewProps = __rest(_a, [\"popoverTriggerClassName\", \"popoverTriggerStyle\", \"placeholder\", \"value\", \"okLabel\", \"cancelLabel\", \"renderDisplay\", \"locale\"]);\n  var targetValue = useRef((_b = value !== null && value !== void 0 ? value : datePickerViewProps.defaultValue) !== null && _b !== void 0 ? _b : new Date());\n  var config = useConfig();\n  var formatValue = useMemo(function () {\n    var _a;\n    if (!value) return '';\n    var targetLocale = (_a = locale !== null && locale !== void 0 ? locale : config.locale.locale) !== null && _a !== void 0 ? _a : 'zh';\n    if (renderDisplay) {\n      return renderDisplay(value, targetLocale);\n    }\n    var _b = datePickerViewProps.precision,\n      precision = _b === void 0 ? 'day' : _b;\n    var ymd = value.toLocaleDateString(targetLocale).split(/[-/]/gim);\n    var result = '';\n    switch (precision) {\n      case 'year':\n        result = \"\".concat(value.getFullYear());\n        break;\n      case 'month':\n        result = [ymd[0], ymd[1]].join('/');\n        break;\n      case 'minute':\n        \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat([value.getHours(), value.getMinutes()].join(':'));\n        break;\n      case 'second':\n        result = \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat(value.toLocaleTimeString(targetLocale));\n        break;\n      case 'hour':\n        result = \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat(value.getHours());\n        break;\n      case 'day':\n      case 'week':\n      case 'week-day':\n        result = value.toLocaleDateString(targetLocale);\n        break;\n      default:\n        result = '';\n    }\n    return result;\n  }, [value]);\n  var actions = useMemo(function () {\n    return [{\n      key: 'submit',\n      text: okLabel !== null && okLabel !== void 0 ? okLabel : Intl.v('确定'),\n      primary: true,\n      onClick: function onClick() {\n        return Promise.resolve(targetValue.current);\n      }\n    }, {\n      key: 'close',\n      text: cancelLabel !== null && cancelLabel !== void 0 ? cancelLabel : Intl.v('关闭'),\n      onClick: function onClick() {\n        return Promise.resolve(value);\n      }\n    }];\n  }, [okLabel, cancelLabel, targetValue.current]);\n  useUpdateEffect(function () {\n    targetValue.current = value;\n  }, [value]);\n  return {\n    actions: actions,\n    popoverTriggerProps: {\n      className: popoverTriggerClassName !== null && popoverTriggerClassName !== void 0 ? popoverTriggerClassName : '',\n      style: popoverTriggerStyle !== null && popoverTriggerStyle !== void 0 ? popoverTriggerStyle : {},\n      renderTrigger: function renderTrigger() {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"\".concat(selectorPrefix, \"-trigger\")\n        }, !!value && formatValue, !value && /*#__PURE__*/React.createElement(\"div\", {\n          className: \"\".concat(selectorPrefix, \"-placeholder\")\n        }, placeholder !== null && placeholder !== void 0 ? placeholder : Intl.v('请选择')));\n      }\n    },\n    children: /*#__PURE__*/React.createElement(DatePickerView, __assign({\n      defaultValue: new Date()\n    }, datePickerViewProps, {\n      onChange: function onChange(_value) {\n        targetValue.current = _value;\n      }\n    }))\n  };\n};\nexport default useDatePopover;"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","useUpdateEffect","useConfig","React","useMemo","useRef","Intl","DatePickerView","selectorPrefix","useDatePopover","_a","popoverTriggerClassName","popoverTriggerStyle","placeholder","value","okLabel","cancelLabel","renderDisplay","locale","datePickerViewProps","targetValue","_b","defaultValue","Date","config","formatValue","targetLocale","precision","ymd","toLocaleDateString","split","result","concat","getFullYear","join","getHours","getMinutes","toLocaleTimeString","actions","key","text","v","primary","onClick","Promise","resolve","current","popoverTriggerProps","className","style","renderTrigger","createElement","children","onChange","_value"],"mappings":"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"}