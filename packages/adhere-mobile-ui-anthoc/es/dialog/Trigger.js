import _Dialog from"antd-mobile/es/components/dialog";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var o,l=1,t=arguments.length;l<t;l++)for(var n in o=arguments[l])Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,o){var l={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(l[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)o.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(l[n[t]]=e[n[t]]);return l};import classNames from"classnames";import React,{memo,useCallback,useMemo,useRef,useState}from"react";import{createPortal}from"react-dom";import Intl from"@baifendian/adhere-util-intl";import PopoverTrigger from"../PopoverTrigger";import{ValueHOC}from"../util";import Context from"./Context";var selectorPrefix="adhere-mobile-ui-ant-hoc-dialog-trigger",InternalDialogTrigger=memo(function(e){var o,l=e.showCloseButton,t=void 0===l||l,n=e.closeActionText,r=e.closeActionKey,a=e.value,l=e.disabled,l=void 0!==l&&l,i=e.onChange,s=e.actions,c=e.children,u=e.popoverTriggerProps,g=__rest(e,["showCloseButton","closeActionText","closeActionKey","value","disabled","onChange","actions","children","popoverTriggerProps"]),e=useState(!1),m=e[0],f=e[1],d=useRef();var p=useMemo(function(){var e=(null!=s?s:[]).map(function(o){return __assign(__assign({},o),{onClick:function(){var e;null!=(e=null==(e=o.onClick)?void 0:e())&&e.then(function(e){_(),null!=i&&i(void 0!==e?null===e?void 0:e:null==(e=d.current)?void 0:e.getValue())})}})});return t&&e.push({key:null!=r?r:"close",text:null!=n?n:Intl.v("关闭"),onClick:function(){}}),e},[s,t]),e=useMemo(function(){return __assign(__assign({visible:m,destroyOnClose:!0,closeOnMaskClick:!0,closeOnAction:t},g),{actions:p,content:c&&React.createElement(ValueHOC,{className:"".concat(selectorPrefix,"-value-hoc"),ref:d,defaultFormItemValue:a},c),afterClose:function(){var e;null!=(e=null==g?void 0:g.afterClose)&&e.call(g)},onClose:function(){var e;_(),null!=(e=null==g?void 0:g.onClose)&&e.call(g)}})},[g,p,c,a,i,m]),v=useCallback(function(){f(!0)},[e]);function _(){f(!1)}return React.createElement(Context.Provider,{value:{close:_}},createPortal(React.createElement(_Dialog,__assign({},e,{bodyClassName:classNames("".concat(selectorPrefix,"-modal-body"),e.bodyClassName)})),null!=(o=null==(o=null==e?void 0:e.getContainer)?void 0:o.call(e))?o:document.body),React.createElement(PopoverTrigger,__assign({className:classNames(selectorPrefix,null!=(e=null==u?void 0:u.className)?e:""),value:a,renderPopover:v,disabled:null!=l&&l},null!=u?u:{})))}),DialogTrigger=InternalDialogTrigger;DialogTrigger.displayName="DialogTrigger";export default DialogTrigger;
//# sourceMappingURL=Trigger.js.map
