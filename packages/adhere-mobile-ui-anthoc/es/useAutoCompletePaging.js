import{useUpdateEffect}from"ahooks";import{useCallback,useMemo,useRef,useState}from"react";import{DEFAULT_LIMIT}from"./Paging";function UseAutoCompletePaging(n){var o=n.defaultSearchDataSource,t=n.pagingComponentProps,u=n.loadData,a=n.onDataSourceChange,r=useRef(!1),i=useRef(void 0),n=useState({data:null!=o?o:[],total:(null!=o?o:[]).length}),c=n[0],l=n[1],e=useMemo(function(){var n;return!("isLocal"in(null==t?void 0:t.pagingProps))||(null==(n=null==t?void 0:t.pagingProps)?void 0:n.isLocal)},[null==(n=null==t?void 0:t.pagingProps)?void 0:n.isLocal]),n=useMemo(function(){var n=t;return e||(n.pagingProps.onLoad=function(l,e){return new Promise(function(o){var n,t;r.current?(r.current=!1,o(c)):null!=(t=null==(n=null==u?void 0:u(i.current,l,e))?void 0:n.then)&&t.call(n,function(n){null!=a&&a(i.current,n.data),o(n)})})}),n},[t,e,c,u]),d=useCallback(function(n){r.current=!0;var o,n=[i.current=n,void 0,void 0];return e||n.push(1,null!=(o=null==(o=null==(o=null==t?void 0:t.pagingProps)?void 0:o.defaultPaging)?void 0:o.limit)?o:DEFAULT_LIMIT),null==(n=null==(o=null==u?void 0:u.apply(void 0,n.filter(function(n){return!!n})))?void 0:o.then)?void 0:n.call(o,function(n){return l(n),null!=a&&a(1,n.data),n})},[e,u,t]);return useUpdateEffect(function(){l({data:null!=o?o:[],total:(null!=o?o:[]).length})},[o]),{searchDataSource:c,targetPagingComponentProps:n,autoCompleteLoadData:d}}export default UseAutoCompletePaging;
//# sourceMappingURL=useAutoCompletePaging.js.map
