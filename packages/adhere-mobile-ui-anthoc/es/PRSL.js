import _PullToRefresh from"antd-mobile/es/components/pull-to-refresh";import _DotLoading from"antd-mobile/es/components/dot-loading";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var a in r=arguments[n])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};import{Skeleton}from"antd";import classNames from"classnames";import React,{forwardRef,memo,useCallback,useImperativeHandle,useRef}from"react";import BackTopAnimation from"@baifendian/adhere-ui-backtopanimation";import ScrollLoad from"@baifendian/adhere-ui-scrollload";import Intl from"@baifendian/adhere-util-intl";var selectorPrefix="adhere-mobile-ui-ant-hoc-prsl",PRSL=memo(forwardRef(function(e,r){var n=e.className,t=e.style,a=e.scrollLoadProps,o=e.pullToRefreshProps,l=e.isLoading,c=e.firstLoading,i=e.loading,s=e.pages,u=e.onRefreshBefore,d=e.onRefresh,m=e.onLoadMore,f=e.children;function p(){var e;return null!=(e=null==(e=v.current)?void 0:e.getScrollContainer())?e:document.body}var v=useRef(),e=useRef(!0),R=useRef(!1),g=useCallback(function(){if(c)return c();for(var e=[],r=0;r<15;r++)e.push(React.createElement(Skeleton,{key:r+1,loading:!0,active:!0,avatar:!0}));return React.createElement("div",{className:"".concat(selectorPrefix,"-first-loading")},e)},[c]),h=useCallback(function(){return i?i():React.createElement("div",{className:"".concat(selectorPrefix,"-loading")},React.createElement("div",{className:"".concat(selectorPrefix,"-loading-dot")},React.createElement(_DotLoading,{color:"primary"})),React.createElement("div",null,"".concat(Intl.v("数据加载中")),"..."))},[i]),b=useCallback(function(){var e;return React.createElement(_PullToRefresh,__assign({},null!=o?o:{},{onRefresh:function(){return(u?u():Promise.resolve()).then(function(){return null==d?void 0:d()})}}),React.createElement(ScrollLoad,__assign({ref:v,renderLoading:h,onScrollBottom:m,distance:(null==a?void 0:a.distance)||50,disabled:s<=1},a||{},{className:classNames(null!=(e=null==a?void 0:a.className)?e:"","".concat(selectorPrefix,"-scroll-load"))}),f),React.createElement(BackTopAnimation,{getContainer:p,onTrigger:function(){return Promise.resolve()}}))},[u,d,m,a,o,f]);return useImperativeHandle(r,function(){return{getScrollEl:p,hideAll:function(){var e,r;return null==(r=null==(e=null==v?void 0:v.current)?void 0:e.hideAll)?void 0:r.call(e)}}}),React.createElement("div",{className:classNames(selectorPrefix,null!=n?n:""),style:null!=t?t:{}},(e.current&&!R.current&&l&&(R.current=!0),e.current&&R.current&&!l&&(e.current=!1,R.current=!1),(e.current?g:b)()))}));export default PRSL;
//# sourceMappingURL=PRSL.js.map
