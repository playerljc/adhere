{"version":3,"file":"useDatePopover.js","sources":["useDatePopover.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __rest = void 0 && (void 0).__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar config_provider_1 = require(\"antd-mobile/es/components/config-provider/config-provider\");\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar date_picker_view_1 = __importDefault(require(\"./date-picker-view\"));\nvar selectorPrefix = 'adhere-mobile-ui-ant-hoc-date-popover';\nvar useDatePopover = function useDatePopover(_a) {\n  var _b;\n  var popoverTriggerClassName = _a.popoverTriggerClassName,\n    popoverTriggerStyle = _a.popoverTriggerStyle,\n    placeholder = _a.placeholder,\n    value = _a.value,\n    okLabel = _a.okLabel,\n    cancelLabel = _a.cancelLabel,\n    renderDisplay = _a.renderDisplay,\n    locale = _a.locale,\n    datePickerViewProps = __rest(_a, [\"popoverTriggerClassName\", \"popoverTriggerStyle\", \"placeholder\", \"value\", \"okLabel\", \"cancelLabel\", \"renderDisplay\", \"locale\"]);\n  var targetValue = (0, react_1.useRef)((_b = value !== null && value !== void 0 ? value : datePickerViewProps.defaultValue) !== null && _b !== void 0 ? _b : new Date());\n  var config = (0, config_provider_1.useConfig)();\n  var formatValue = (0, react_1.useMemo)(function () {\n    var _a;\n    if (!value) return '';\n    var targetLocale = (_a = locale !== null && locale !== void 0 ? locale : config.locale.locale) !== null && _a !== void 0 ? _a : 'zh';\n    if (renderDisplay) {\n      return renderDisplay(value, targetLocale);\n    }\n    var _b = datePickerViewProps.precision,\n      precision = _b === void 0 ? 'day' : _b;\n    var ymd = value.toLocaleDateString(targetLocale).split(/[-/]/gim);\n    var result = '';\n    switch (precision) {\n      case 'year':\n        result = \"\".concat(value.getFullYear());\n        break;\n      case 'month':\n        result = [ymd[0], ymd[1]].join('/');\n        break;\n      case 'minute':\n        \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat([value.getHours(), value.getMinutes()].join(':'));\n        break;\n      case 'second':\n        result = \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat(value.toLocaleTimeString(targetLocale));\n        break;\n      case 'hour':\n        result = \"\".concat(value.toLocaleDateString(targetLocale), \" \").concat(value.getHours());\n        break;\n      case 'day':\n      case 'week':\n      case 'week-day':\n        result = value.toLocaleDateString(targetLocale);\n        break;\n      default:\n        result = '';\n    }\n    return result;\n  }, [value]);\n  var actions = (0, react_1.useMemo)(function () {\n    return [{\n      key: 'submit',\n      text: okLabel !== null && okLabel !== void 0 ? okLabel : adhere_util_intl_1.default.v('确定'),\n      primary: true,\n      onClick: function onClick() {\n        return Promise.resolve(targetValue.current);\n      }\n    }, {\n      key: 'close',\n      text: cancelLabel !== null && cancelLabel !== void 0 ? cancelLabel : adhere_util_intl_1.default.v('关闭'),\n      onClick: function onClick() {\n        return Promise.resolve(value);\n      }\n    }];\n  }, [okLabel, cancelLabel, targetValue.current]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    targetValue.current = value;\n  }, [value]);\n  return {\n    actions: actions,\n    popoverTriggerProps: {\n      className: popoverTriggerClassName !== null && popoverTriggerClassName !== void 0 ? popoverTriggerClassName : '',\n      style: popoverTriggerStyle !== null && popoverTriggerStyle !== void 0 ? popoverTriggerStyle : {},\n      renderTrigger: function renderTrigger() {\n        return react_1.default.createElement(\"div\", {\n          className: \"\".concat(selectorPrefix, \"-trigger\")\n        }, !!value && formatValue, !value && react_1.default.createElement(\"div\", {\n          className: \"\".concat(selectorPrefix, \"-placeholder\")\n        }, placeholder !== null && placeholder !== void 0 ? placeholder : adhere_util_intl_1.default.v('请选择')));\n      }\n    },\n    children: react_1.default.createElement(date_picker_view_1.default, __assign({\n      defaultValue: new Date()\n    }, datePickerViewProps, {\n      onChange: function onChange(_value) {\n        targetValue.current = _value;\n      }\n    }))\n  };\n};\nexports.default = useDatePopover;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","default","ahooks_1","exports","require","config_provider_1","react_1","adhere_util_intl_1","date_picker_view_1","selectorPrefix","useDatePopover","_a","popoverTriggerClassName","popoverTriggerStyle","placeholder","okLabel","cancelLabel","renderDisplay","locale","datePickerViewProps","targetValue","useRef","_b","defaultValue","Date","config","useConfig","formatValue","useMemo","targetLocale","precision","ymd","toLocaleDateString","split","concat","getFullYear","join","getHours","getMinutes","toLocaleTimeString","actions","key","text","primary","onClick","Promise","resolve","current","useUpdateEffect","popoverTriggerProps","className","style","renderTrigger","createElement","children","onChange","_value"],"mappings":"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"}