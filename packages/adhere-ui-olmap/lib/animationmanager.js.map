{"version":3,"file":"animationmanager.js","sources":["animationmanager.js"],"sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar uuid_1 = require(\"uuid\");\r\nvar algebra_js_1 = __importDefault(require(\"algebra.js\"));\r\nvar proj_js_1 = require(\"ol/proj.js\");\r\nvar util_1 = __importDefault(require(\"./util\"));\r\n/**\r\n * AnimationManager\r\n * @class AnimationManager\r\n * @classdesc 地图轨迹播放动画\r\n */\r\nvar AnimationManager = /** @class */ (function () {\r\n    // runing: boolean;\r\n    // vectorSource: any;\r\n    // animationMap: {};\r\n    // preAnimations: any[];\r\n    // pointsMapIndex: any;\r\n    // preActiveId: string | undefined;\r\n    // handler: any;\r\n    // lines: any;\r\n    // pref: any;\r\n    // config: {\r\n    //   arrowImg: '';\r\n    //   pointImg: '';\r\n    //   lineWidth: 8,\r\n    //   lineColor: '#FF5D00',\r\n    // };\r\n    function AnimationManager(vectorSource, config) {\r\n        this.runing = false;\r\n        this.vectorSource = vectorSource;\r\n        this.animationMap = [];\r\n        this.preAnimations = [];\r\n        this.config = config;\r\n    }\r\n    AnimationManager.prototype.isRun = function () {\r\n        return this.runing;\r\n    };\r\n    AnimationManager.prototype.getPoints = function (locations) {\r\n        console.log('locations', locations);\r\n        var distance = 0;\r\n        // let speed = 0;\r\n        var addPoints = [];\r\n        this.animationMap = [];\r\n        for (var i = locations.length - 1; i >= 1; i--) {\r\n            var startPoint = proj_js_1.fromLonLat(locations[i]);\r\n            var endPoint = proj_js_1.fromLonLat(locations[i - 1]);\r\n            // 距离\r\n            var xDistance = Math.abs(startPoint[0] - endPoint[0]);\r\n            distance += xDistance;\r\n        }\r\n        var speed = Math.floor(distance / (locations.length * 80));\r\n        if (speed === 0) {\r\n            speed = 0.01;\r\n        }\r\n        this.animationMap[0] = locations.length - 1;\r\n        for (var i = locations.length - 1; i >= 1; i--) {\r\n            var startPoint = proj_js_1.fromLonLat(locations[i]);\r\n            var endPoint = proj_js_1.fromLonLat(locations[i - 1]);\r\n            var xDirection = startPoint[0] < endPoint[0] ? '->' : '<-';\r\n            var yDirection = startPoint[1] < endPoint[1] ? '->' : '<-';\r\n            // 同一个点没有轨迹\r\n            // eslint-disable-next-line no-continue\r\n            if (startPoint[0] === endPoint[0] && startPoint[1] === endPoint[1])\r\n                continue;\r\n            // 垂直的\r\n            if (startPoint[0] === endPoint[0] && startPoint[1] !== endPoint[1]) {\r\n                // 距离\r\n                var xdistance = Math.abs(startPoint[1] - endPoint[1]);\r\n                // 段数\r\n                var interval = Math.floor(xdistance / speed);\r\n                if (xdistance % speed > 0) {\r\n                    interval += 1;\r\n                }\r\n                for (var j = 1; j <= interval; j++) {\r\n                    var x = startPoint[0];\r\n                    var y = void 0;\r\n                    if (yDirection === '->') {\r\n                        if (j * speed > xdistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            y = startPoint[1] + j * speed;\r\n                        }\r\n                    }\r\n                    else if (yDirection === '<-') {\r\n                        if (j * speed > xdistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            y = startPoint[1] - j * speed;\r\n                        }\r\n                    }\r\n                    // @ts-ignore\r\n                    addPoints.push([x, y]);\r\n                }\r\n            }\r\n            else if (startPoint[0] !== endPoint[0] && startPoint[1] === endPoint[1]) {\r\n                // 水平的\r\n                // 距离\r\n                var xDistance = Math.abs(startPoint[0] - endPoint[0]);\r\n                // 段数\r\n                var interval = Math.floor(xDistance / speed);\r\n                if (xDistance % speed > 0) {\r\n                    interval += 1;\r\n                }\r\n                for (var j = 1; j <= interval; j++) {\r\n                    var x = void 0;\r\n                    var y = startPoint[1];\r\n                    if (xDirection === '->') {\r\n                        if (j * speed > xDistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            x = startPoint[0] + j * speed;\r\n                        }\r\n                    }\r\n                    else if (xDirection === '<-') {\r\n                        if (j * speed > xDistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            x = startPoint[0] - j * speed;\r\n                        }\r\n                    }\r\n                    // @ts-ignore\r\n                    addPoints.push([x, y]);\r\n                }\r\n            }\r\n            else {\r\n                // 有角度的\r\n                // 距离\r\n                var time = 5 * 30;\r\n                var xDistance = Math.abs(startPoint[0] - endPoint[0]);\r\n                speed = xDistance / time;\r\n                // 段数\r\n                var interval = Math.floor(xDistance / speed);\r\n                if (xDistance % speed > 0) {\r\n                    interval += 1;\r\n                }\r\n                var Equation = algebra_js_1.default.Equation;\r\n                //= ======================================\r\n                var x1 = algebra_js_1.default.parse(startPoint[1] + \"=\" + startPoint[0] + \"k+b\");\r\n                var answer1 = x1.solveFor('k');\r\n                // console.log(`k = ${answer1.toString()}`);\r\n                var x2 = algebra_js_1.default.parse(endPoint[1] + \"=\" + endPoint[0] + \"k+b\");\r\n                var answer2 = x2.solveFor('k');\r\n                // console.log(`k = ${answer2.toString()}`);\r\n                //= ================================================\r\n                // 解出b值\r\n                var eq = new Equation(answer1, answer2);\r\n                // console.log(`b表达式：${eq.toString()}`);\r\n                var answerX = eq.solveFor('b');\r\n                // console.log(`解出B的值为：${answerX.toString()}`);\r\n                //= ================================================\r\n                // 解出Y值（把x的值代入x1或x2）\r\n                eq = x1.eval({\r\n                    b: answerX,\r\n                });\r\n                // console.log(`k表达式：${eq.toString()}`);\r\n                var answerY = eq.solveFor('k');\r\n                // console.log(`解出k的值为：${answerY.toString()}`);\r\n                // eslint-disable-next-line no-eval\r\n                var b = eval(answerX.toString());\r\n                // eslint-disable-next-line no-eval\r\n                var k = eval(answerY.toString());\r\n                for (var j = 1; j <= interval; j++) {\r\n                    var x = void 0;\r\n                    var y = void 0;\r\n                    if (xDirection === '->') {\r\n                        if (j * speed > xDistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            x = startPoint[0] + j * speed;\r\n                            y = k * x + b;\r\n                        }\r\n                    }\r\n                    else if (xDirection === '<-') {\r\n                        if (j * speed > xDistance) {\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            x = endPoint[0];\r\n                            // eslint-disable-next-line prefer-destructuring\r\n                            y = endPoint[1];\r\n                        }\r\n                        else {\r\n                            x = startPoint[0] - j * speed;\r\n                            y = k * x + b;\r\n                        }\r\n                    }\r\n                    // @ts-ignore\r\n                    addPoints.push([x, y]);\r\n                }\r\n            }\r\n            this.animationMap[addPoints.length - 1] = i - 1;\r\n        }\r\n        return addPoints;\r\n    };\r\n    // eslint-disable-next-line consistent-return\r\n    AnimationManager.prototype.run = function (lineData, pointsMapIndex) {\r\n        var _this = this;\r\n        if (!lineData || this.runing)\r\n            return false;\r\n        this.runing = true;\r\n        this.pointsMapIndex = pointsMapIndex;\r\n        var it = lineData.values();\r\n        this.loopTask(it).then(function () {\r\n            // 所有动画完成\r\n            _this.runing = false;\r\n            console.log('finish');\r\n        });\r\n    };\r\n    AnimationManager.prototype.loopTask = function (it) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var entry = it.next();\r\n            if (entry.done) {\r\n                resolve();\r\n            }\r\n            else {\r\n                var lines = entry.value;\r\n                var points = _this.getPoints(lines);\r\n                _this.runTask(points)\r\n                    .then(function () {\r\n                    _this.loopTask(it).then(function () {\r\n                        resolve();\r\n                    });\r\n                })\r\n                    .catch(function (error) {\r\n                    reject(error);\r\n                });\r\n            }\r\n        });\r\n    };\r\n    AnimationManager.prototype.runTask = function (points) {\r\n        var _this = this;\r\n        this.preActiveId = '';\r\n        // eslint-disable-next-line no-unused-vars,consistent-return\r\n        return new Promise(function (resolve) {\r\n            var self = _this;\r\n            if (!points.length) {\r\n                resolve();\r\n                return false;\r\n            }\r\n            var topIndex = 0;\r\n            _this.pref = null;\r\n            _this.lines = [];\r\n            _this.handler = null;\r\n            // eslint-disable-next-line consistent-return\r\n            function loop() {\r\n                if (topIndex === points.length) {\r\n                    self.stopTask();\r\n                    if (self.preAnimations) {\r\n                        self.preAnimations.forEach(function (p) {\r\n                            self.vectorSource.removeFeature(p);\r\n                        });\r\n                        self.preAnimations = [];\r\n                    }\r\n                    resolve();\r\n                    return false;\r\n                }\r\n                if (self.pref) {\r\n                    self.vectorSource.removeFeature(self.pref);\r\n                }\r\n                var point = points[topIndex];\r\n                var rotation = 0;\r\n                if (topIndex !== 0) {\r\n                    var line = util_1.default.drawLine({\r\n                        points: [points[topIndex - 1], points[topIndex]],\r\n                        width: self.config.lineWidth,\r\n                        color: self.config.lineColor,\r\n                    });\r\n                    self.vectorSource.addFeature(line);\r\n                    self.lines.push(line);\r\n                    var prePoint = points[topIndex - 1];\r\n                    var dx = point[0] - prePoint[0];\r\n                    var dy = point[1] - prePoint[1];\r\n                    rotation = Math.atan2(dy, dx);\r\n                }\r\n                if (self.animationMap[topIndex] || self.animationMap[topIndex] === 0) {\r\n                    if (self.preActiveId) {\r\n                        var preFeature = self.vectorSource.getFeatureById(self.preActiveId);\r\n                        self.vectorSource.removeFeature(preFeature);\r\n                        self.preActiveId = '';\r\n                    }\r\n                    var pointConfig = self.pointsMapIndex[self.animationMap[topIndex]];\r\n                    if (pointConfig) {\r\n                        var id = \"active_\" + pointConfig.id;\r\n                        var node = util_1.default.drawImagePoint(__assign(__assign({}, pointConfig), { id: id, src: self.config.pointImg, zIndex: pointConfig.zIndex + 10 }));\r\n                        self.vectorSource.addFeature(node);\r\n                        self.preActiveId = id;\r\n                    }\r\n                }\r\n                // @ts-ignore\r\n                var f = util_1.default.drawImagePoint({\r\n                    id: uuid_1.v1(),\r\n                    pos: point,\r\n                    src: self.config.arrowImg,\r\n                    scale: 1,\r\n                    zIndex: 1000,\r\n                    rotation: -rotation,\r\n                });\r\n                self.vectorSource.addFeature(f);\r\n                self.pref = f;\r\n                // eslint-disable-next-line no-plusplus\r\n                ++topIndex;\r\n                self.handler = requestAnimationFrame(loop);\r\n            }\r\n            self.handler = requestAnimationFrame(loop);\r\n        });\r\n    };\r\n    // eslint-disable-next-line consistent-return\r\n    AnimationManager.prototype.stopTask = function () {\r\n        if (!this.runing)\r\n            return false;\r\n        if (this.handler) {\r\n            cancelAnimationFrame(this.handler);\r\n        }\r\n        if (this.pref) {\r\n            this.vectorSource.removeFeature(this.pref);\r\n        }\r\n        if (this.lines) {\r\n            for (var i = 0; i < this.lines.length; i++) {\r\n                this.vectorSource.removeFeature(this.lines[i]);\r\n            }\r\n        }\r\n        if (this.preActiveId) {\r\n            var preFeature = this.vectorSource.getFeatureById(this.preActiveId);\r\n            this.vectorSource.removeFeature(preFeature);\r\n            this.preActiveId = '';\r\n        }\r\n    };\r\n    AnimationManager.prototype.stop = function () {\r\n        this.stopTask();\r\n        this.runing = false;\r\n    };\r\n    return AnimationManager;\r\n}());\r\nexports.default = AnimationManager;\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__importDefault","mod","__esModule","default","defineProperty","exports","value","uuid_1","require","algebra_js_1","proj_js_1","util_1","AnimationManager","vectorSource","config","runing","animationMap","preAnimations","isRun","getPoints","locations","console","log","distance","addPoints","startPoint","fromLonLat","endPoint","xDistance","Math","abs","speed","floor","xDirection","yDirection","xdistance","interval","j","x","y","push","time","Equation","x1","parse","answer1","solveFor","x2","answer2","eq","answerX","eval","b","answerY","toString","k","run","lineData","pointsMapIndex","_this","it","values","loopTask","then","Promise","resolve","reject","entry","next","done","lines","points","runTask","catch","error","preActiveId","self","topIndex","pref","handler","requestAnimationFrame","loop","stopTask","forEach","removeFeature","dy","id","node","point","rotation","line","drawLine","width","lineWidth","color","lineColor","addFeature","prePoint","dx","atan2","preFeature","getFeatureById","pointConfig","drawImagePoint","src","pointImg","zIndex","f","v1","pos","arrowImg","scale","cancelAnimationFrame","stop"],"mappings":"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"}