{"version":3,"file":"intl.js","sources":["intl.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport intl from 'react-intl-universal';\r\n// 是否进行过初始化\r\nvar isInit = false;\r\nvar intlMap = {};\r\nvar intlKey = {};\r\nvar localKeys = new Map();\r\nvar mainLocales = {};\r\n/**\r\n * initIntlMap - 初始化以中文为key,intl.get()为值的Map\r\n * @param zh_CN\r\n */\r\nfunction initIntlMap(zh_CN) {\r\n    var propertys = Object.getOwnPropertyNames(zh_CN);\r\n    propertys.forEach(function (p) {\r\n        // 中文key 国际化值为值\r\n        intlMap[zh_CN[p]] = intl.get(p);\r\n        // 中文key 属性是值\r\n        intlKey[zh_CN[p]] = p;\r\n    });\r\n}\r\n/**\r\n * getLocal\r\n * @param prefix\r\n * @param data\r\n */\r\nexport function getLocal(prefix, data) {\r\n    if (prefix === void 0) { prefix = 'local'; }\r\n    // @ts-ignore\r\n    var result = __spreadArrays(Array.from(new Set(data)));\r\n    var local = {};\r\n    for (var i = 0; i < result.length; i++) {\r\n        var key = \"\" + (prefix || 'local') + (i + 1);\r\n        var val = localKeys.get(key);\r\n        if (!val) {\r\n            localKeys.set(key, key);\r\n            val = key;\r\n        }\r\n        local[key] = result[i];\r\n    }\r\n    return local;\r\n}\r\n/**\r\n * getLocales\r\n * @description - 获取系统所有的词条\r\n * @return object\r\n */\r\nexport function getLocales() {\r\n    return __assign({}, mainLocales);\r\n}\r\nexport default {\r\n    /**\r\n     * init\r\n     * @param {String} - prefix\r\n     * @param {String} - currentLocale\r\n     * @param {Object} - locales\r\n     * @param {Object} - ...other\r\n     */\r\n    init: function (_a) {\r\n        var _b = _a.prefix, prefix = _b === void 0 ? 'local' : _b, _c = _a.currentLocale, currentLocale = _c === void 0 ? 'zh_CN' : _c, _d = _a.locales, locales = _d === void 0 ? {} : _d, other = __rest(_a, [\"prefix\", \"currentLocale\", \"locales\"]);\r\n        if (isInit) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject();\r\n            });\r\n        }\r\n        // 系统的国际化资源\r\n        var finallyLocales = {\r\n            en_US: require('./locales/en_US').default,\r\n            zh_CN: require('./locales/zh_CN').default,\r\n            pt_PT: require('./locales/pt_PT').default,\r\n        };\r\n        var finallyLocalesKeys = Object.keys(finallyLocales);\r\n        var localesKeys = Object.keys(locales);\r\n        var masterLocales;\r\n        var slaveLocales;\r\n        if (finallyLocalesKeys.length > localesKeys.length) {\r\n            masterLocales = finallyLocales;\r\n            slaveLocales = locales;\r\n        }\r\n        else if (finallyLocalesKeys.length <= localesKeys.length) {\r\n            masterLocales = locales;\r\n            slaveLocales = finallyLocales;\r\n        }\r\n        // 总的国际化资源(系统的国际化资源 merge 用户的国际化资源)\r\n        // 整合用户的locales\r\n        for (var p in masterLocales) {\r\n            mainLocales[p] = getLocal.apply(void 0, __spreadArrays([prefix], new Set(__spreadArrays(masterLocales[p], (slaveLocales[p] || [])))));\r\n        }\r\n        return intl\r\n            .init(__assign({ currentLocale: currentLocale, locales: mainLocales }, other))\r\n            .then(function () {\r\n            // @ts-ignore\r\n            initIntlMap(mainLocales.zh_CN);\r\n            isInit = true;\r\n        });\r\n    },\r\n    /**\r\n     * v - 以中文获取国际化值\r\n     * @return {String}\r\n     * @param key\r\n     * @param variables\r\n     */\r\n    v: function (key, variables) {\r\n        if (!isInit)\r\n            return '';\r\n        if (variables) {\r\n            return intl.get(intlKey[key], variables);\r\n        }\r\n        return intlMap[key];\r\n    },\r\n    /**\r\n     * v - 以中文获取国际化后的html\r\n     * @param key\r\n     * @param options\r\n     */\r\n    vHtml: function (key, options) {\r\n        if (!isInit)\r\n            return '';\r\n        if (options) {\r\n            return intl.getHTML(intlKey[key], options);\r\n        }\r\n        return intlMap[key];\r\n    },\r\n    /**\r\n     * get\r\n     * @param key\r\n     * @param variables\r\n     */\r\n    get: function (key, variables) {\r\n        return intl.get(key, variables);\r\n    },\r\n    /**\r\n     * getHTML\r\n     * @param key\r\n     * @param options\r\n     */\r\n    getHTML: function (key, options) {\r\n        return intl.getHTML(key, options);\r\n    },\r\n    /**\r\n     * getInitOptions\r\n     */\r\n    getInitOptions: function () {\r\n        return intl.getInitOptions();\r\n    },\r\n    /**\r\n     * formatMessage\r\n     * @param options\r\n     * @param variables\r\n     */\r\n    formatMessage: function (options, variables) {\r\n        return intl.formatMessage(options, variables);\r\n    },\r\n    /**\r\n     * formatHTMLMessage\r\n     * @param options\r\n     * @param variables\r\n     */\r\n    formatHTMLMessage: function (options, variables) {\r\n        return intl.formatHTMLMessage(options, variables);\r\n    },\r\n    /**\r\n     * load - Load more locales after init\r\n     * @param locales\r\n     */\r\n    load: function (locales) {\r\n        intl.load(locales);\r\n    },\r\n    /**\r\n     * getLocal\r\n     * @param prefix\r\n     * @param data\r\n     */\r\n    getLocal: function (prefix, data) {\r\n        if (prefix === void 0) { prefix = 'local'; }\r\n        return getLocal(prefix, data);\r\n    },\r\n};\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","Array","k","a","j","jl","intl","isInit","intlMap","intlKey","localKeys","Map","mainLocales","initIntlMap","zh_CN","getOwnPropertyNames","forEach","get","getLocal","prefix","data","result","from","Set","local","key","set","val","getLocales","init","_a","_b","_c","currentLocale","_d","locales","other","Promise","resolve","reject","masterLocales","slaveLocales","finallyLocales","en_US","require","default","pt_PT","finallyLocalesKeys","keys","localesKeys","then","v","variables","vHtml","options","getHTML","getInitOptions","formatMessage","formatHTMLMessage","load"],"mappings":"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"}