{"version":3,"file":"intl.js","sources":["intl.js"],"sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getLocales = exports.getLocal = void 0;\r\nvar react_intl_universal_1 = __importDefault(require(\"react-intl-universal\"));\r\nvar en_US_1 = __importDefault(require(\"./locales/en_US\"));\r\nvar pt_PT_1 = __importDefault(require(\"./locales/pt_PT\"));\r\nvar zh_CN_1 = __importDefault(require(\"./locales/zh_CN\"));\r\n// 是否进行过初始化\r\nvar isInit = false;\r\nvar intlMap = {};\r\nvar intlKey = {};\r\nvar localKeys = new Map();\r\nvar mainLocales = {};\r\n/**\r\n * initIntlMap - 初始化以中文为key,intl.get()为值的Map\r\n * @param zh_CN\r\n */\r\nfunction initIntlMap(zh_CN) {\r\n    var propertys = Object.getOwnPropertyNames(zh_CN);\r\n    propertys.forEach(function (p) {\r\n        // 中文key 国际化值为值\r\n        intlMap[zh_CN[p]] = react_intl_universal_1.default.get(p);\r\n        // p:local1\r\n        // intlMap.姓名 = '姓名'\r\n        // intlKey.姓名 = local1\r\n        // 中文key 属性是值\r\n        intlKey[zh_CN[p]] = p;\r\n    });\r\n}\r\n/**\r\n * getLocal\r\n * @description 生成k,v的对象\r\n * @param prefix\r\n * @param data\r\n */\r\nfunction getLocal(prefix, data) {\r\n    if (prefix === void 0) { prefix = 'local'; }\r\n    // 先去重\r\n    var result = __spreadArray([], Array.from(new Set(data)), true);\r\n    var local = {};\r\n    for (var i = 0; i < result.length; i++) {\r\n        var key = \"\".concat(prefix || 'local').concat(i + 1);\r\n        var val = localKeys.get(key);\r\n        if (!val) {\r\n            localKeys.set(key, key);\r\n            val = key;\r\n        }\r\n        local[key] = result[i];\r\n    }\r\n    return local;\r\n}\r\nexports.getLocal = getLocal;\r\n/**\r\n * getLocales\r\n * @description - 获取系统所有的词条\r\n * @return object\r\n */\r\nfunction getLocales() {\r\n    return __assign({}, mainLocales);\r\n}\r\nexports.getLocales = getLocales;\r\nexports.default = {\r\n    /**\r\n     * init\r\n     * @param {String} - prefix\r\n     * @param {String} - currentLocale\r\n     * @param {Object} - locales\r\n     * @param {Object} - ...other\r\n     * @param reload 是否是重新载入\r\n     */\r\n    init: function (_a, reload) {\r\n        var _b = _a.prefix, prefix = _b === void 0 ? 'local' : _b, _c = _a.currentLocale, currentLocale = _c === void 0 ? 'zh_CN' : _c, _d = _a.locales, locales = _d === void 0 ? {} : _d, _e = _a.mainLanguage, mainLanguage = _e === void 0 ? 'zh_CN' : _e, other = __rest(_a, [\"prefix\", \"currentLocale\", \"locales\", \"mainLanguage\"]);\r\n        if (reload === void 0) { reload = false; }\r\n        if (!reload && isInit) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject();\r\n            });\r\n        }\r\n        // 系统的国际化资源\r\n        var finallyLocales = {\r\n            en_US: en_US_1.default,\r\n            zh_CN: zh_CN_1.default,\r\n            pt_PT: pt_PT_1.default,\r\n        };\r\n        var finallyLocalesKeys = Object.keys(finallyLocales);\r\n        var localesKeys = Object.keys(locales || {});\r\n        var masterLocales;\r\n        var slaveLocales;\r\n        if (finallyLocalesKeys.length > localesKeys.length) {\r\n            masterLocales = finallyLocales;\r\n            slaveLocales = locales || {};\r\n        }\r\n        else if (finallyLocalesKeys.length <= localesKeys.length) {\r\n            masterLocales = locales || {};\r\n            slaveLocales = finallyLocales;\r\n        }\r\n        var _loop_1 = function (p) {\r\n            // 每一种语言都需要处理成k,v对象\r\n            var all = __spreadArray(__spreadArray([], masterLocales[p], true), (slaveLocales[p] || []), true);\r\n            var stringItems = [];\r\n            var objEntrys = [];\r\n            all.forEach(function (item) {\r\n                if (typeof item === 'string')\r\n                    stringItems.push(item);\r\n                else\r\n                    objEntrys.push(item);\r\n            });\r\n            mainLocales[p] = getLocal(prefix, Array.from(new Set(stringItems)));\r\n            objEntrys.forEach(function (entry) {\r\n                var keys = Object.keys(entry);\r\n                keys.forEach(function (key) {\r\n                    mainLocales[p][key] = entry[key];\r\n                });\r\n            });\r\n        };\r\n        // 总的国际化资源(系统的国际化资源 merge 用户的国际化资源)\r\n        // 整合用户的locales\r\n        for (var p in masterLocales) {\r\n            _loop_1(p);\r\n        }\r\n        return react_intl_universal_1.default\r\n            .init(__assign({ currentLocale: currentLocale, locales: mainLocales }, other))\r\n            .then(function () {\r\n            // @ts-ignore\r\n            initIntlMap(mainLocales[mainLanguage]);\r\n            isInit = true;\r\n        });\r\n    },\r\n    /**\r\n     * isInit\r\n     * @description 是否进行了初始化\r\n     */\r\n    isInit: function () {\r\n        return isInit;\r\n    },\r\n    /**\r\n     * v - 以中文获取国际化值\r\n     * @return {String}\r\n     * @param key\r\n     * @param variables\r\n     */\r\n    v: function (key, variables) {\r\n        if (!isInit)\r\n            return '';\r\n        // p:local1\r\n        // intlMap.姓名 = '姓名'\r\n        // intlKey.姓名 = local1\r\n        if (variables) {\r\n            return react_intl_universal_1.default.get(intlKey[key], variables);\r\n        }\r\n        return intlMap[key];\r\n    },\r\n    /**\r\n     * v - 以中文获取国际化后的html\r\n     * @param key\r\n     * @param options\r\n     */\r\n    vHtml: function (key, options) {\r\n        if (!isInit)\r\n            return '';\r\n        if (options) {\r\n            return react_intl_universal_1.default.getHTML(intlKey[key], options);\r\n        }\r\n        return intlMap[key];\r\n    },\r\n    /**\r\n     * get\r\n     * @param key\r\n     * @param variables\r\n     */\r\n    get: function (key, variables) {\r\n        return react_intl_universal_1.default.get(key, variables);\r\n    },\r\n    /**\r\n     * getHTML\r\n     * @param key\r\n     * @param options\r\n     */\r\n    getHTML: function (key, options) {\r\n        return react_intl_universal_1.default.getHTML(key, options);\r\n    },\r\n    /**\r\n     * getInitOptions\r\n     */\r\n    getInitOptions: function () {\r\n        return react_intl_universal_1.default.getInitOptions();\r\n    },\r\n    /**\r\n     * formatMessage\r\n     * @param options\r\n     * @param variables\r\n     */\r\n    formatMessage: function (options, variables) {\r\n        return react_intl_universal_1.default.formatMessage(options, variables);\r\n    },\r\n    /**\r\n     * formatHTMLMessage\r\n     * @param options\r\n     * @param variables\r\n     */\r\n    formatHTMLMessage: function (options, variables) {\r\n        return react_intl_universal_1.default.formatHTMLMessage(options, variables);\r\n    },\r\n    /**\r\n     * load - Load more locales after init\r\n     * @param locales\r\n     */\r\n    load: function (locales) {\r\n        react_intl_universal_1.default.load(locales);\r\n    },\r\n    /**\r\n     * getLocal\r\n     * @param prefix\r\n     * @param data\r\n     */\r\n    getLocal: function (prefix, data) {\r\n        if (prefix === void 0) { prefix = 'local'; }\r\n        return getLocal(prefix, data);\r\n    },\r\n};\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","from","pack","ar","l","Array","slice","concat","__importDefault","mod","__esModule","default","react_intl_universal_1","defineProperty","exports","value","getLocales","getLocal","require","en_US_1","pt_PT_1","zh_CN_1","isInit","intlMap","intlKey","localKeys","Map","mainLocales","initIntlMap","zh_CN","getOwnPropertyNames","forEach","get","prefix","data","result","Set","local","key","set","val","init","_a","reload","_b","_c","currentLocale","_d","locales","_e","mainLanguage","other","Promise","resolve","reject","masterLocales","slaveLocales","finallyLocales","en_US","pt_PT","finallyLocalesKeys","keys","localesKeys","_loop_1","all","stringItems","objEntrys","item","push","entry","then","v","variables","vHtml","options","getHTML","getInitOptions","formatMessage","formatHTMLMessage","load"],"mappings":"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"}