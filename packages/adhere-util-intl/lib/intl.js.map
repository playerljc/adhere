{"version":3,"file":"intl.js","sources":["intl.js"],"sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getLocales = exports.getLocal = void 0;\nvar react_intl_universal_1 = __importDefault(require(\"react-intl-universal\"));\nvar ar_EG_1 = __importDefault(require(\"./locales/ar_EG\"));\nvar en_US_1 = __importDefault(require(\"./locales/en_US\"));\nvar pt_PT_1 = __importDefault(require(\"./locales/pt_PT\"));\nvar zh_CN_1 = __importDefault(require(\"./locales/zh_CN\"));\n// 是否进行过初始化\nvar isInit = false;\nvar intlMap = {};\nvar intlKey = {};\nvar localKeys = new Map();\nvar mainLocales = {};\n/**\n * initIntlMap - 初始化以中文为key,intl.get()为值的Map\n * @param zh_CN\n */\nfunction initIntlMap(zh_CN) {\n    var properties = Object.getOwnPropertyNames(zh_CN);\n    properties.forEach(function (p) {\n        // 中文key 国际化值为值\n        intlMap[zh_CN[p]] = react_intl_universal_1.default.get(p);\n        // p:local1\n        // intlMap.姓名 = '姓名'\n        // intlKey.姓名 = local1\n        // 中文key 属性是值\n        intlKey[zh_CN[p]] = p;\n    });\n}\n/**\n * getLocal\n * @description 生成k,v的对象\n * @param prefix\n * @param data\n */\nfunction getLocal(prefix, data) {\n    if (prefix === void 0) { prefix = 'local'; }\n    var result = __spreadArray([], data, true);\n    var local = {};\n    for (var i = 0; i < result.length; i++) {\n        var key = \"\".concat(prefix || 'local').concat(i + 1);\n        var val = localKeys.get(key);\n        if (!val) {\n            localKeys.set(key, key);\n            val = key;\n        }\n        local[key] = result[i];\n    }\n    return local;\n}\nexports.getLocal = getLocal;\n/**\n * getLocales\n * @description - 获取系统所有的词条\n * @return object\n */\nfunction getLocales() {\n    return __assign({}, mainLocales);\n}\nexports.getLocales = getLocales;\nexports.default = {\n    /**\n     * init\n     * @param {String} - prefix\n     * @param reload 是否是重新载入\n     */\n    init: function (_a, reload) {\n        var _b = _a.prefix, prefix = _b === void 0 ? 'local' : _b, _c = _a.currentLocale, currentLocale = _c === void 0 ? 'zh_CN' : _c, _d = _a.mainLanguage, mainLanguage = _d === void 0 ? 'zh_CN' : _d, _e = _a.locales, locales = _e === void 0 ? {} : _e, _f = _a.extraLibLocales, extraLibLocales = _f === void 0 ? {} : _f, rest = __rest(_a, [\"prefix\", \"currentLocale\", \"mainLanguage\", \"locales\", \"extraLibLocales\"]);\n        if (reload === void 0) { reload = false; }\n        if (!reload && isInit) {\n            return new Promise(function (resolve, reject) {\n                reject();\n            });\n        }\n        // 库的国际化资源\n        var libLocales = __assign({ en_US: __spreadArray([], en_US_1.default, true), zh_CN: __spreadArray([], zh_CN_1.default, true), pt_PT: __spreadArray([], pt_PT_1.default, true), ar_EG: __spreadArray([], ar_EG_1.default, true) }, extraLibLocales);\n        var duplicateIndex = [];\n        libLocales[mainLanguage].forEach(function (_word, _index) {\n            if (locales[mainLanguage].includes(_word)) {\n                duplicateIndex.push(_index);\n            }\n        });\n        // 如果用户重写了国际化，使用用户的\n        var libLocaleKeys = Object.keys(libLocales);\n        libLocaleKeys.forEach(function (_libLocaleKey) {\n            libLocales[_libLocaleKey] = libLocales[_libLocaleKey].filter(function (_t, _index) { return !duplicateIndex.includes(_index); });\n        });\n        // 最终的国际化资源\n        var targetLocales = libLocaleKeys.reduce(function (_targetLocales, _currentLibLocalKey) {\n            var _a, _b;\n            _targetLocales[_currentLibLocalKey] = __spreadArray(__spreadArray([], ((_a = libLocales[_currentLibLocalKey]) !== null && _a !== void 0 ? _a : []), true), ((_b = locales[_currentLibLocalKey]) !== null && _b !== void 0 ? _b : []), true);\n            return _targetLocales;\n        }, {});\n        // 整合用户的locales\n        libLocaleKeys.forEach(function (_libLocalKey) {\n            // 每一种语言都需要处理成k,v对象\n            var local = targetLocales[_libLocalKey];\n            var stringItems = [];\n            var objEntry = [];\n            local.forEach(function (_item) {\n                if (typeof _item === 'string')\n                    stringItems.push(_item);\n                else\n                    objEntry.push(_item);\n            });\n            mainLocales[_libLocalKey] = getLocal(prefix, stringItems);\n            objEntry.forEach(function (_entry) {\n                Object.keys(_entry).forEach(function (_key) {\n                    mainLocales[_libLocalKey][_key] = _entry[_key];\n                });\n            });\n        });\n        return react_intl_universal_1.default\n            .init(__assign({ currentLocale: currentLocale, locales: mainLocales }, rest))\n            .then(function () {\n            // @ts-ignore\n            initIntlMap(mainLocales[mainLanguage]);\n            isInit = true;\n        });\n    },\n    /**\n     * isInit\n     * @description 是否进行了初始化\n     */\n    isInit: function () {\n        return isInit;\n    },\n    /**\n     * v - 以中文获取国际化值\n     * @return {String}\n     * @param key\n     * @param variables\n     */\n    v: function (key, variables) {\n        if (!isInit)\n            return '';\n        // p:local1\n        // intlMap.姓名 = '姓名'\n        // intlKey.姓名 = local1\n        if (variables) {\n            return react_intl_universal_1.default.get(intlKey[key], variables);\n        }\n        return intlMap[key];\n    },\n    /**\n     * v - 以中文获取国际化后的html\n     * @param key\n     * @param options\n     */\n    vHtml: function (key, options) {\n        if (!isInit)\n            return '';\n        if (options) {\n            return react_intl_universal_1.default.getHTML(intlKey[key], options);\n        }\n        return intlMap[key];\n    },\n    /**\n     * get\n     * @param key\n     * @param variables\n     */\n    get: function (key, variables) {\n        return react_intl_universal_1.default.get(key, variables);\n    },\n    /**\n     * getHTML\n     * @param key\n     * @param options\n     */\n    getHTML: function (key, options) {\n        return react_intl_universal_1.default.getHTML(key, options);\n    },\n    /**\n     * formatMessage\n     * @param options\n     * @param variables\n     */\n    formatMessage: function (options, variables) {\n        return react_intl_universal_1.default.formatMessage(options, variables);\n    },\n    /**\n     * formatHTMLMessage\n     * @param options\n     * @param variables\n     */\n    formatHTMLMessage: function (options, variables) {\n        return react_intl_universal_1.default.formatHTMLMessage(options, variables);\n    },\n    /**\n     * getInitOptions\n     */\n    getInitOptions: function () {\n        return react_intl_universal_1.default.getInitOptions();\n    },\n    /**\n     * load - Load more locales after init\n     * @param locales\n     */\n    load: function (locales) {\n        react_intl_universal_1.default.load(locales);\n    },\n    /**\n     * getLocal\n     * @param prefix\n     * @param data\n     */\n    getLocal: function (prefix, data) {\n        if (prefix === void 0) { prefix = 'local'; }\n        return getLocal(prefix, data);\n    },\n};\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","from","pack","ar","l","Array","slice","concat","__importDefault","mod","__esModule","default","react_intl_universal_1","defineProperty","exports","value","getLocales","getLocal","require","ar_EG_1","en_US_1","pt_PT_1","zh_CN_1","isInit","intlMap","intlKey","localKeys","Map","mainLocales","initIntlMap","zh_CN","getOwnPropertyNames","forEach","get","prefix","data","result","local","key","set","val","init","_a","reload","libLocales","duplicateIndex","targetLocales","_b","_c","currentLocale","_d","mainLanguage","_e","locales","_f","extraLibLocales","rest","Promise","resolve","reject","en_US","pt_PT","ar_EG","_word","_index","includes","push","libLocaleKeys","keys","_libLocaleKey","filter","_t","reduce","_targetLocales","_currentLibLocalKey","_libLocalKey","stringItems","objEntry","_item","_entry","_key","then","v","variables","vHtml","options","getHTML","formatMessage","formatHTMLMessage","getInitOptions","load"],"mappings":"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"}