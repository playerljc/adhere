{"version":3,"file":"intl.js","sources":["intl.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport intl from 'react-intl-universal';\nimport ar_EG from './locales/ar_EG';\nimport en_US from './locales/en_US';\nimport pt_PT from './locales/pt_PT';\nimport zh_CN from './locales/zh_CN';\n// 是否进行过初始化\nvar isInit = false;\nvar intlMap = {};\nvar intlKey = {};\nvar localKeys = new Map();\nvar mainLocales = {};\n/**\n * initIntlMap - 初始化以中文为key,intl.get()为值的Map\n * @param zh_CN\n */\nfunction initIntlMap(zh_CN) {\n    var propertys = Object.getOwnPropertyNames(zh_CN);\n    propertys.forEach(function (p) {\n        // 中文key 国际化值为值\n        intlMap[zh_CN[p]] = intl.get(p);\n        // p:local1\n        // intlMap.姓名 = '姓名'\n        // intlKey.姓名 = local1\n        // 中文key 属性是值\n        intlKey[zh_CN[p]] = p;\n    });\n}\n/**\n * getLocal\n * @description 生成k,v的对象\n * @param prefix\n * @param data\n */\nexport function getLocal(prefix, data) {\n    if (prefix === void 0) { prefix = 'local'; }\n    // 先去重\n    var result = __spreadArray([], Array.from(new Set(data)), true);\n    var local = {};\n    for (var i = 0; i < result.length; i++) {\n        var key = \"\".concat(prefix || 'local').concat(i + 1);\n        var val = localKeys.get(key);\n        if (!val) {\n            localKeys.set(key, key);\n            val = key;\n        }\n        local[key] = result[i];\n    }\n    return local;\n}\n/**\n * getLocales\n * @description - 获取系统所有的词条\n * @return object\n */\nexport function getLocales() {\n    return __assign({}, mainLocales);\n}\nexport default {\n    /**\n     * init\n     * @param {String} - prefix\n     * @param {String} - currentLocale\n     * @param {Object} - locales\n     * @param {Object} - ...other\n     * @param reload 是否是重新载入\n     */\n    init: function (_a, reload) {\n        var _b = _a.prefix, prefix = _b === void 0 ? 'local' : _b, _c = _a.currentLocale, currentLocale = _c === void 0 ? 'zh_CN' : _c, _d = _a.locales, locales = _d === void 0 ? {} : _d, _e = _a.mainLanguage, mainLanguage = _e === void 0 ? 'zh_CN' : _e, other = __rest(_a, [\"prefix\", \"currentLocale\", \"locales\", \"mainLanguage\"]);\n        if (reload === void 0) { reload = false; }\n        if (!reload && isInit) {\n            return new Promise(function (resolve, reject) {\n                reject();\n            });\n        }\n        // 系统的国际化资源\n        var finallyLocales = {\n            en_US: en_US,\n            zh_CN: zh_CN,\n            pt_PT: pt_PT,\n            ar_EG: ar_EG,\n        };\n        var finallyLocalesKeys = Object.keys(finallyLocales);\n        var localesKeys = Object.keys(locales || {});\n        var masterLocales;\n        var slaveLocales;\n        if (finallyLocalesKeys.length > localesKeys.length) {\n            masterLocales = finallyLocales;\n            slaveLocales = locales || {};\n        }\n        else if (finallyLocalesKeys.length <= localesKeys.length) {\n            masterLocales = locales || {};\n            slaveLocales = finallyLocales;\n        }\n        var _loop_1 = function (p) {\n            // 每一种语言都需要处理成k,v对象\n            var all = __spreadArray(__spreadArray([], masterLocales[p], true), (slaveLocales[p] || []), true);\n            var stringItems = [];\n            var objEntrys = [];\n            all.forEach(function (item) {\n                if (typeof item === 'string')\n                    stringItems.push(item);\n                else\n                    objEntrys.push(item);\n            });\n            mainLocales[p] = getLocal(prefix, Array.from(new Set(stringItems)));\n            objEntrys.forEach(function (entry) {\n                var keys = Object.keys(entry);\n                keys.forEach(function (key) {\n                    mainLocales[p][key] = entry[key];\n                });\n            });\n        };\n        // 总的国际化资源(系统的国际化资源 merge 用户的国际化资源)\n        // 整合用户的locales\n        for (var p in masterLocales) {\n            _loop_1(p);\n        }\n        return intl\n            .init(__assign({ currentLocale: currentLocale, locales: mainLocales }, other))\n            .then(function () {\n            // @ts-ignore\n            initIntlMap(mainLocales[mainLanguage]);\n            isInit = true;\n        });\n    },\n    /**\n     * isInit\n     * @description 是否进行了初始化\n     */\n    isInit: function () {\n        return isInit;\n    },\n    /**\n     * v - 以中文获取国际化值\n     * @return {String}\n     * @param key\n     * @param variables\n     */\n    v: function (key, variables) {\n        if (!isInit)\n            return '';\n        // p:local1\n        // intlMap.姓名 = '姓名'\n        // intlKey.姓名 = local1\n        if (variables) {\n            return intl.get(intlKey[key], variables);\n        }\n        return intlMap[key];\n    },\n    /**\n     * v - 以中文获取国际化后的html\n     * @param key\n     * @param options\n     */\n    vHtml: function (key, options) {\n        if (!isInit)\n            return '';\n        if (options) {\n            return intl.getHTML(intlKey[key], options);\n        }\n        return intlMap[key];\n    },\n    /**\n     * get\n     * @param key\n     * @param variables\n     */\n    get: function (key, variables) {\n        return intl.get(key, variables);\n    },\n    /**\n     * getHTML\n     * @param key\n     * @param options\n     */\n    getHTML: function (key, options) {\n        return intl.getHTML(key, options);\n    },\n    /**\n     * getInitOptions\n     */\n    getInitOptions: function () {\n        return intl.getInitOptions();\n    },\n    /**\n     * formatMessage\n     * @param options\n     * @param variables\n     */\n    formatMessage: function (options, variables) {\n        return intl.formatMessage(options, variables);\n    },\n    /**\n     * formatHTMLMessage\n     * @param options\n     * @param variables\n     */\n    formatHTMLMessage: function (options, variables) {\n        return intl.formatHTMLMessage(options, variables);\n    },\n    /**\n     * load - Load more locales after init\n     * @param locales\n     */\n    load: function (locales) {\n        intl.load(locales);\n    },\n    /**\n     * getLocal\n     * @param prefix\n     * @param data\n     */\n    getLocal: function (prefix, data) {\n        if (prefix === void 0) { prefix = 'local'; }\n        return getLocal(prefix, data);\n    },\n};\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","from","pack","ar","l","Array","slice","concat","intl","ar_EG","en_US","pt_PT","zh_CN","isInit","intlMap","intlKey","localKeys","Map","mainLocales","initIntlMap","getOwnPropertyNames","forEach","get","getLocal","prefix","data","result","Set","local","key","set","val","getLocales","init","_a","reload","_b","_c","currentLocale","_d","locales","_e","mainLanguage","other","Promise","resolve","reject","masterLocales","slaveLocales","finallyLocales","finallyLocalesKeys","keys","localesKeys","_loop_1","all","stringItems","objEntrys","item","push","entry","then","v","variables","vHtml","options","getHTML","getInitOptions","formatMessage","formatHTMLMessage","load"],"mappings":"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"}