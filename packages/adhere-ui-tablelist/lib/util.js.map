{"version":3,"file":"util.js","sources":["util.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _tooltip = _interopRequireDefault(require(\"antd/lib/tooltip\"));\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nvar _tslib = require(\"tslib\");\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _adhereUiFormitemcreator = _interopRequireDefault(require(\"@baifendian/adhere-ui-formitemcreator\"));\n\nvar _adhereUtilIntl = _interopRequireDefault(require(\"@baifendian/adhere-util-intl\"));\n\n/*\n * @Description: 表格列表\n * @Author: yumeng.qin\n * @Date: 2021-04-27 16:23:26\n * @LastEditor: yumeng.qin\n * @LastEditTime: 2021-05-21 10:41:27\n */\nvar Util =\n/** @class */\nfunction () {\n  function Util(ins) {\n    var _this = this;\n    /**\n     * 获取对应mode的属性\n     */\n\n\n    this.getModeProps = function () {\n      return (0, _tslib.__assign)({\n        rowKey: 'id'\n      }, _this.ins.props[_this.ins.props.mode || 'table']);\n    };\n    /**\n     * 获取默认显示的列项\n     */\n\n\n    this.getDefaultSelectedColumnKeys = function (columns) {\n      var showNumber = _this.getModeProps().showNumber;\n\n      var result = (columns || []).filter(function (v) {\n        return v.show || !v.hasOwnProperty('show');\n      }).map(function (v) {\n        return v.key;\n      });\n\n      if (showNumber && !result.includes('xuhao')) {\n        result.unshift((showNumber === null || showNumber === void 0 ? void 0 : showNumber.key) || 'xuhao');\n      }\n\n      return result;\n    };\n    /**\n     * 获取rowSelection 默认支持跨页选中，如果想要跨页取消设置clearOnChange为true\n     */\n\n\n    this.getRowSelection = function () {\n      var _a = _this.ins.state,\n          _b = _a.selectedRowKeys,\n          selectedRowKeys = _b === void 0 ? [] : _b,\n          _c = _a.selectedRows,\n          selectedRows = _c === void 0 ? [] : _c,\n          selectAll = _a.selectAll;\n\n      var rowSelection = _this.getModeProps().rowSelection;\n\n      return rowSelection ? (0, _tslib.__assign)((0, _tslib.__assign)({\n        // 在表格变化的时候是否清空选中\n        clearOnChange: false\n      }, rowSelection), {\n        onChange: _this.onSelectChange,\n        selectedRowKeys: rowSelection.selectedRowKeys || selectedRowKeys,\n        // 一下是自定义的变量\n        selectedRows: selectedRows,\n        // 是否选中全部数据\n        selectAll: selectAll\n      }) : null;\n    };\n    /**\n     * 获取排序后的表格数据\n     */\n\n\n    this.getSortDataSource = function () {\n      return _this.ins.SortableTableRef.state.dataSource;\n    };\n    /**\n     * 获取参数\n     */\n\n\n    this.getParams = function () {\n      var params = _this.ins.props.params;\n      var formParams = {};\n\n      if (_this.ins.searchFormRef && _this.ins.searchFormRef.current) {\n        formParams = _this.ins.searchFormRef.current.getFieldsValue();\n      }\n\n      return (0, _tslib.__assign)((0, _tslib.__assign)((0, _tslib.__assign)({}, formParams), _this.ins.state.params), params);\n    };\n    /**\n     * 获取表单统一配置\n     * @param {*} Formcolumns\n     */\n\n\n    this.getFormColumns = function (Formcolumns, size, searchNow) {\n      return Formcolumns.map(function (temp) {\n        var t = temp;\n        t.contentProps = t.contentProps || {};\n        t.contentProps.size = size;\n\n        if (t.type === _adhereUiFormitemcreator.default.RANGEPICKER || t.type === _adhereUiFormitemcreator.default.SELECT) {\n          t.contentProps = (0, _tslib.__assign)({\n            getPopupContainer: function getPopupContainer() {\n              return _this.ins.TableListRef;\n            }\n          }, t.contentProps);\n        }\n\n        if (t.type === _adhereUiFormitemcreator.default.SELECT) {\n          t.contentProps = (0, _tslib.__assign)({\n            style: {\n              width: '150px'\n            },\n            allowClear: true\n          }, t.contentProps);\n        }\n\n        if (searchNow) {\n          t.contentProps = (0, _tslib.__assign)({\n            onSearch: t.type === _adhereUiFormitemcreator.default.SEARCH ? function (v) {\n              var _a;\n\n              return _this.onSearch((_a = {}, _a[t.name] = v, _a));\n            } : null,\n            onPressEnter: t.type !== _adhereUiFormitemcreator.default.SEARCH ? function (e) {\n              var _a;\n\n              return _this.onSearch((_a = {}, _a[t.name] = [_adhereUiFormitemcreator.default.INPUT, _adhereUiFormitemcreator.default.TEXTAREA, _adhereUiFormitemcreator.default.NUMBER].includes(t.type) ? e.target.value : e, _a));\n            } : null\n          }, t.contentProps);\n        }\n\n        return t;\n      });\n    };\n    /**\n     * 获取分页\n     */\n\n\n    this.getPagination = function (pagination) {\n      var params = _this.ins.state.params;\n      return (0, _tslib.__assign)({\n        size: 'default',\n        defaultPageSize: 10,\n        current: params.page,\n        pageSize: params.limit,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '20', '50'],\n        showQuickJumper: true,\n        showTotal: function showTotal(total, _a) {\n          var page = _a[0],\n              pageSize = _a[1];\n          return \"\\u5F53\\u524D \".concat(page, \"-\").concat(pageSize, \"/\\u5171 \").concat(total, \" \\u6761\");\n        },\n        onChange: _this.onPageChange,\n        onShowSizeChange: _this.onPageChange\n      }, pagination);\n    };\n    /**\n     * 获取表格的配置项\n     */\n\n\n    this.getTableColumns = function () {\n      var params = _this.ins.state.params;\n\n      var _a = _this.getModeProps(),\n          columns = _a.columns,\n          showNumber = _a.showNumber;\n\n      var tableColumns = (columns || []).map(function (item) {\n        var _a;\n\n        return (0, _tslib.__assign)((0, _tslib.__assign)({}, item), {\n          render: function render(text, record, index) {\n            var result = '';\n\n            if (item.render) {\n              // 如果有render根据传入的显示\n              result = item.render(text, record, index);\n            } else if (item.valueType === 'date') {\n              // 日期类型默认显示\n              result = text ? (0, _moment.default)(text).format('L') : '-';\n            } else if (item.valueType === 'datetime') {\n              // 带时间的日期类型默认显示\n              result = text ? (0, _moment.default)(text).format('LLL') : '-';\n            } else if (item.valueType === 'map' && item.map) {\n              // 根据数组匹配进行显示\n              var current = text && (item.map || []).find(function (v) {\n                return v.value.toString() === text.toString();\n              });\n              result = text && current ? current.label : '-';\n            } else {\n              // 默认显示\n              result = text;\n            } // ellipsis 超出...\n\n\n            if (item === null || item === void 0 ? void 0 : item.ellipsis) {\n              return /*#__PURE__*/_react.default.createElement(_tooltip.default, {\n                title: result,\n                placement: \"topLeft\"\n              }, result);\n            }\n\n            return result;\n          },\n          filtered: ((_a = item.filters) === null || _a === void 0 ? void 0 : _a.length) && params[item.key]\n        });\n      }); // 如果showNumber 则添加序号列\n\n      if (showNumber && !tableColumns.find(function (v) {\n        return v.key === 'xuhao';\n      })) {\n        tableColumns.unshift((0, _tslib.__assign)({\n          title: _adhereUtilIntl.default.v('序号'),\n          dataIndex: 'xuhao',\n          key: 'xuhao',\n          width: 80,\n          render: function render(v, r, i) {\n            return (params.page - 1) * params.limit + i + 1;\n          }\n        }, showNumber));\n      }\n\n      return tableColumns;\n    };\n    /*\n     * 获取表格或者列表的loading\n     */\n\n\n    this.getLoading = function (loading) {\n      if (loading || _this.ins.state.loading) {\n        return loading && loading.hasOwnProperty('size') ? loading : {\n          size: 'large'\n        };\n      }\n\n      return false;\n    };\n    /**\n     * 发起请求\n     * @param {*} params\n     */\n\n\n    this.fetchList = function (params) {\n      var fetchParams = (0, _tslib.__assign)((0, _tslib.__assign)({}, _this.getParams()), params);\n\n      if (_this.ins.props.request) {\n        _this.ins.setState({\n          loading: true\n        });\n\n        _this.ins.props.request(fetchParams).then(function () {\n          _this.ins.setState({\n            loading: false\n          });\n        });\n      }\n    };\n    /**\n     * 搜索\n     */\n\n\n    this.onSearch = function (searchParams) {\n      var params = _this.ins.state.params; // 当rowSelection.clearOnChange为true 搜索的时候会清空\n\n      var rowSelection = _this.getRowSelection();\n\n      if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\n        rowSelection.onChange([], []);\n      }\n\n      _this.ins.setState({\n        params: (0, _tslib.__assign)((0, _tslib.__assign)((0, _tslib.__assign)({}, params), searchParams), {\n          page: 1\n        })\n      }, function () {\n        _this.fetchList();\n      });\n    };\n    /**\n     * 重置\n     */\n\n\n    this.onResetSearch = function () {\n      var params = _this.ins.state.params;\n\n      var rowSelection = _this.getRowSelection();\n\n      if (_this.ins.searchFormRef && _this.ins.searchFormRef.current) {\n        _this.ins.searchFormRef.current.resetFields();\n      }\n\n      params.page = 1; // 重置的时候清空\n\n      if (rowSelection) {\n        rowSelection.onChange([], []);\n      }\n\n      _this.ins.setState({\n        params: params\n      }, function () {\n        _this.fetchList();\n      });\n    };\n    /**\n     * 列设置变化\n     */\n\n\n    this.onSettingChange = function (selectedColumnKeys) {\n      _this.ins.setState({\n        selectedColumnKeys: selectedColumnKeys\n      });\n    };\n    /**\n     * 列设置拖拽排序完毕\n     */\n\n\n    this.onSettingSortEnd = function (_a) {\n      var oldIndex = _a.oldIndex,\n          newIndex = _a.newIndex;\n      var tableColumns = _this.ins.state.tableColumns;\n\n      if (oldIndex !== newIndex) {\n        var oldItem = tableColumns[oldIndex];\n        var newData = tableColumns.filter(function (_, i) {\n          return i !== oldIndex;\n        });\n        newData.splice(newIndex, 0, oldItem);\n\n        _this.ins.setState({\n          tableColumns: newData\n        });\n      }\n    };\n    /**\n     * 表格变化\n     * @param {*} _\n     * @param {*} filters\n     * @param {*} sorter\n     */\n\n\n    this.onTableChange = function (keys, filters, sorter) {\n      var _a;\n\n      if (!(0, _lodash.isEmpty)(sorter) || !(0, _lodash.isEmpty)(filters)) {\n        var params = (0, _tslib.__assign)((0, _tslib.__assign)({}, _this.ins.state.params), {\n          order: (_a = sorter === null || sorter === void 0 ? void 0 : sorter.order) === null || _a === void 0 ? void 0 : _a.replace('end', ''),\n          sidx: sorter === null || sorter === void 0 ? void 0 : sorter.field\n        });\n\n        for (var filterKey in filters) {\n          params[filterKey] = filters[filterKey].join(',');\n          params.page = 1;\n        } // 当rowSelection.clearOnChange为true 表格变化会清空\n\n\n        var rowSelection = _this.getRowSelection();\n\n        if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\n          rowSelection.onChange([], []);\n        }\n\n        _this.ins.setState({\n          params: params\n        }, function () {\n          return _this.fetchList();\n        });\n      }\n    };\n    /**\n     * 选项变化\n     */\n\n\n    this.onSelectChange = function (selectedRowKeys, selectedRows) {\n      var _a = _this.getModeProps(),\n          dataSource = _a.dataSource,\n          rowKey = _a.rowKey,\n          rowSelection = _a.rowSelection;\n\n      var selectAll = _this.ins.state.selectAll;\n\n      if (_this.ins.state.selectAll) {\n        var allKeys = dataSource.map(function (v) {\n          return v[rowKey];\n        });\n        var exceptKeys = (0, _lodash.union)(selectAll.exceptKeys || [], (0, _lodash.difference)(allKeys, selectedRowKeys));\n\n        _this.ins.setState({\n          selectAll: exceptKeys.length ? {\n            exceptKeys: exceptKeys\n          } : true\n        });\n      }\n\n      if (rowSelection === null || rowSelection === void 0 ? void 0 : rowSelection.onChange) {\n        rowSelection.onChange(selectedRowKeys, selectedRows);\n      } else {\n        _this.ins.setState({\n          selectedRowKeys: selectedRowKeys,\n          selectedRows: selectedRows\n        });\n      }\n    };\n    /**\n     * 分页变化\n     * @param {*} page\n     * @param {*} limit\n     */\n\n\n    this.onPageChange = function (page, limit) {\n      var params = _this.ins.state.params; // 当rowSelection.clearOnChange为true 切页面会清空\n\n      var rowSelection = _this.getRowSelection();\n\n      if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\n        rowSelection.onChange([], []);\n      }\n\n      _this.ins.setState({\n        params: (0, _tslib.__assign)((0, _tslib.__assign)({}, params), {\n          page: page,\n          limit: limit\n        })\n      }, function () {\n        return _this.fetchList();\n      });\n    };\n    /*\n     * 表格删除时候操作，刷列表\n     */\n\n\n    this.onDelete = function (deletedKeys) {\n      if (deletedKeys === void 0) {\n        deletedKeys = [];\n      }\n\n      var _a = _this.getModeProps(),\n          pagination = _a.pagination,\n          rowKey = _a.rowKey;\n\n      var total = pagination.total;\n      var _b = _this.ins.state.params,\n          page = _b.page,\n          limit = _b.limit;\n\n      if (total % limit === 1 && page === Math.ceil(total / limit)) {\n        _this.ins.setState({\n          params: (0, _tslib.__assign)((0, _tslib.__assign)({}, _this.ins.state.params), {\n            page: page - deletedKeys.length || 1\n          })\n        }, function () {\n          return _this.fetchList();\n        });\n\n        return;\n      }\n\n      var rowSelection = _this.getRowSelection();\n\n      if (rowSelection) {\n        var selectedRowKeys = rowSelection.selectedRowKeys.filter(function (v) {\n          return !deletedKeys.includes(v);\n        });\n        var selectedRows = rowSelection.selectedRows.filter(function (v) {\n          return !deletedKeys.includes(v[rowKey]);\n        });\n        rowSelection.onChange(selectedRowKeys, selectedRows);\n      }\n\n      _this.fetchList();\n    };\n\n    this.ins = ins;\n  }\n\n  return Util;\n}();\n\nvar _default = Util;\nexports.default = _default;"],"names":["require","_interopRequireDefault","Object","defineProperty","exports","value","default","_tooltip","_tslib","_react","_lodash","_moment","_adhereUiFormitemcreator","_adhereUtilIntl","Util","ins","_this","this","getModeProps","__assign","rowKey","props","mode","getDefaultSelectedColumnKeys","columns","showNumber","result","filter","v","show","hasOwnProperty","map","key","includes","unshift","getRowSelection","_a","state","_b","selectedRowKeys","_c","selectedRows","selectAll","rowSelection","clearOnChange","onChange","onSelectChange","getSortDataSource","SortableTableRef","dataSource","getParams","params","formParams","searchFormRef","current","getFieldsValue","getFormColumns","Formcolumns","size","searchNow","temp","t","contentProps","type","RANGEPICKER","SELECT","getPopupContainer","TableListRef","style","width","allowClear","onSearch","SEARCH","name","onPressEnter","e","INPUT","TEXTAREA","NUMBER","target","getPagination","pagination","defaultPageSize","page","pageSize","limit","showSizeChanger","pageSizeOptions","showQuickJumper","showTotal","total","concat","onPageChange","onShowSizeChange","getTableColumns","tableColumns","item","render","text","record","index","valueType","format","find","toString","label","ellipsis","createElement","title","placement","filtered","filters","length","dataIndex","r","i","getLoading","loading","fetchList","fetchParams","request","setState","then","searchParams","onResetSearch","resetFields","onSettingChange","selectedColumnKeys","onSettingSortEnd","oldIndex","newIndex","oldItem","newData","_","splice","onTableChange","keys","sorter","isEmpty","filterKey","order","replace","sidx","field","join","allKeys","exceptKeys","union","difference","onDelete","deletedKeys","Math","ceil","_default"],"mappings":"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"}