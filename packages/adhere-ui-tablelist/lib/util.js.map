{"version":3,"file":"util.js","sources":["util.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\n/*\r\n * @Description: 表格列表\r\n * @Author: yumeng.qin\r\n * @Date: 2021-04-27 16:23:26\r\n * @LastEditor: yumeng.qin\r\n * @LastEditTime: 2021-05-21 10:41:27\r\n */\r\nvar antd_1 = require(\"antd\");\r\nvar dayjs_1 = tslib_1.__importDefault(require(\"dayjs\"));\r\nvar lodash_1 = require(\"lodash\");\r\nvar react_1 = tslib_1.__importDefault(require(\"react\"));\r\nvar adhere_ui_formitemcreator_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-formitemcreator\"));\r\nvar adhere_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-util-intl\"));\r\nvar Util = /** @class */ (function () {\r\n    function Util(ins) {\r\n        var _this = this;\r\n        /**\r\n         * 获取对应mode的属性\r\n         */\r\n        this.getModeProps = function () {\r\n            return tslib_1.__assign({ rowKey: 'id' }, _this.ins.props[_this.ins.props.mode || 'table']);\r\n        };\r\n        /**\r\n         * 获取默认显示的列项\r\n         */\r\n        this.getDefaultSelectedColumnKeys = function (columns) {\r\n            var showNumber = _this.getModeProps().showNumber;\r\n            var result = (columns || [])\r\n                .filter(function (v) { return v.show || !v.hasOwnProperty('show'); })\r\n                .map(function (v) { return v.key; });\r\n            if (showNumber && !result.includes('xuhao')) {\r\n                result.unshift((showNumber === null || showNumber === void 0 ? void 0 : showNumber.key) || 'xuhao');\r\n            }\r\n            return result;\r\n        };\r\n        /**\r\n         * 获取rowSelection 默认支持跨页选中，如果想要跨页取消设置clearOnChange为true\r\n         */\r\n        this.getRowSelection = function () {\r\n            var _a = _this.ins.state, _b = _a.selectedRowKeys, selectedRowKeys = _b === void 0 ? [] : _b, _c = _a.selectedRows, selectedRows = _c === void 0 ? [] : _c, selectAll = _a.selectAll;\r\n            var rowSelection = _this.getModeProps().rowSelection;\r\n            return rowSelection\r\n                ? tslib_1.__assign(tslib_1.__assign({ \r\n                    // 在表格变化的时候是否清空选中\r\n                    clearOnChange: false }, rowSelection), { onChange: _this.onSelectChange, selectedRowKeys: rowSelection.selectedRowKeys || selectedRowKeys, \r\n                    // 一下是自定义的变量\r\n                    selectedRows: selectedRows, \r\n                    // 是否选中全部数据\r\n                    selectAll: selectAll }) : null;\r\n        };\r\n        /**\r\n         * 获取排序后的表格数据\r\n         */\r\n        this.getSortDataSource = function () {\r\n            return _this.ins.SortableTableRef.state.dataSource;\r\n        };\r\n        /**\r\n         * 获取参数\r\n         */\r\n        this.getParams = function () {\r\n            var params = _this.ins.props.params;\r\n            var formParams = {};\r\n            if (_this.ins.searchFormRef && _this.ins.searchFormRef.current) {\r\n                formParams = _this.ins.searchFormRef.current.getFieldsValue();\r\n            }\r\n            return tslib_1.__assign(tslib_1.__assign(tslib_1.__assign({}, formParams), _this.ins.state.params), params);\r\n        };\r\n        /**\r\n         * 获取表单统一配置\r\n         * @param {*} Formcolumns\r\n         */\r\n        this.getFormColumns = function (Formcolumns, size, searchNow) {\r\n            return Formcolumns.map(function (temp) {\r\n                var t = temp;\r\n                t.contentProps = t.contentProps || {};\r\n                t.contentProps.size = size;\r\n                if (t.type === adhere_ui_formitemcreator_1.default.RANGEPICKER || t.type === adhere_ui_formitemcreator_1.default.SELECT) {\r\n                    t.contentProps = tslib_1.__assign({ getPopupContainer: function () { return _this.ins.TableListRef; } }, t.contentProps);\r\n                }\r\n                if (t.type === adhere_ui_formitemcreator_1.default.SELECT) {\r\n                    t.contentProps = tslib_1.__assign({ style: { width: '150px' }, allowClear: true }, t.contentProps);\r\n                }\r\n                if (searchNow) {\r\n                    t.contentProps = tslib_1.__assign({ onSearch: t.type === adhere_ui_formitemcreator_1.default.SEARCH ? function (v) {\r\n                            var _a;\r\n                            return _this.onSearch((_a = {}, _a[t.name] = v, _a));\r\n                        } : null, onPressEnter: t.type !== adhere_ui_formitemcreator_1.default.SEARCH\r\n                            ? function (e) {\r\n                                var _a;\r\n                                return _this.onSearch((_a = {},\r\n                                    _a[t.name] = [\r\n                                        adhere_ui_formitemcreator_1.default.INPUT,\r\n                                        adhere_ui_formitemcreator_1.default.TEXTAREA,\r\n                                        adhere_ui_formitemcreator_1.default.NUMBER,\r\n                                    ].includes(t.type)\r\n                                        ? e.target.value\r\n                                        : e,\r\n                                    _a));\r\n                            }\r\n                            : null }, t.contentProps);\r\n                }\r\n                return t;\r\n            });\r\n        };\r\n        /**\r\n         * 获取分页\r\n         */\r\n        this.getPagination = function (pagination) {\r\n            var params = _this.ins.state.params;\r\n            return tslib_1.__assign({ size: 'default', defaultPageSize: 10, current: params.page, pageSize: params.limit, showSizeChanger: true, pageSizeOptions: ['10', '20', '50'], showQuickJumper: true, showTotal: function (total, _a) {\r\n                    var page = _a[0], pageSize = _a[1];\r\n                    return \"\\u5F53\\u524D \".concat(page, \"-\").concat(pageSize, \"/\\u5171 \").concat(total, \" \\u6761\");\r\n                }, onChange: _this.onPageChange, onShowSizeChange: _this.onPageChange }, pagination);\r\n        };\r\n        /**\r\n         * 获取表格的配置项\r\n         */\r\n        this.getTableColumns = function () {\r\n            var params = _this.ins.state.params;\r\n            var _a = _this.getModeProps(), columns = _a.columns, showNumber = _a.showNumber;\r\n            var tableColumns = (columns || []).map(function (item) {\r\n                var _a;\r\n                return (tslib_1.__assign(tslib_1.__assign({}, item), { render: function (text, record, index) {\r\n                        var result = '';\r\n                        if (item.render) {\r\n                            // 如果有render根据传入的显示\r\n                            result = item.render(text, record, index);\r\n                        }\r\n                        else if (item.valueType === 'date') {\r\n                            // 日期类型默认显示\r\n                            result = text ? (0, dayjs_1.default)(text).format('L') : '-';\r\n                        }\r\n                        else if (item.valueType === 'datetime') {\r\n                            // 带时间的日期类型默认显示\r\n                            result = text ? (0, dayjs_1.default)(text).format('LLL') : '-';\r\n                        }\r\n                        else if (item.valueType === 'map' && item.map) {\r\n                            // 根据数组匹配进行显示\r\n                            var current = text && (item.map || []).find(function (v) { return v.value.toString() === text.toString(); });\r\n                            result = text && current ? current.label : '-';\r\n                        }\r\n                        else {\r\n                            // 默认显示\r\n                            result = text;\r\n                        }\r\n                        // ellipsis 超出...\r\n                        if (item === null || item === void 0 ? void 0 : item.ellipsis) {\r\n                            return (react_1.default.createElement(antd_1.Tooltip, { title: result, placement: \"topLeft\" }, result));\r\n                        }\r\n                        return result;\r\n                    }, filtered: ((_a = item.filters) === null || _a === void 0 ? void 0 : _a.length) && params[item.key] }));\r\n            });\r\n            // 如果showNumber 则添加序号列\r\n            if (showNumber && !tableColumns.find(function (v) { return v.key === 'xuhao'; })) {\r\n                tableColumns.unshift(tslib_1.__assign({ title: adhere_util_intl_1.default.v('序号'), dataIndex: 'xuhao', key: 'xuhao', width: 80, render: function (v, r, i) {\r\n                        return (params.page - 1) * params.limit + i + 1;\r\n                    } }, showNumber));\r\n            }\r\n            return tableColumns;\r\n        };\r\n        /*\r\n         * 获取表格或者列表的loading\r\n         */\r\n        this.getLoading = function (loading) {\r\n            if (loading || _this.ins.state.loading) {\r\n                return loading && loading.hasOwnProperty('size') ? loading : { size: 'large' };\r\n            }\r\n            return false;\r\n        };\r\n        /**\r\n         * 发起请求\r\n         * @param {*} params\r\n         */\r\n        this.fetchList = function (params) {\r\n            var fetchParams = tslib_1.__assign(tslib_1.__assign({}, _this.getParams()), params);\r\n            if (_this.ins.props.request) {\r\n                _this.ins.setState({ loading: true });\r\n                _this.ins.props.request(fetchParams).then(function () {\r\n                    _this.ins.setState({ loading: false });\r\n                });\r\n            }\r\n        };\r\n        /**\r\n         * 搜索\r\n         */\r\n        this.onSearch = function (searchParams) {\r\n            var params = _this.ins.state.params;\r\n            // 当rowSelection.clearOnChange为true 搜索的时候会清空\r\n            var rowSelection = _this.getRowSelection();\r\n            if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\r\n                rowSelection.onChange([], []);\r\n            }\r\n            _this.ins.setState({\r\n                params: tslib_1.__assign(tslib_1.__assign(tslib_1.__assign({}, params), searchParams), { page: 1 }),\r\n            }, function () {\r\n                _this.fetchList();\r\n            });\r\n        };\r\n        /**\r\n         * 重置\r\n         */\r\n        this.onResetSearch = function () {\r\n            var params = _this.ins.state.params;\r\n            var rowSelection = _this.getRowSelection();\r\n            if (_this.ins.searchFormRef && _this.ins.searchFormRef.current) {\r\n                _this.ins.searchFormRef.current.resetFields();\r\n            }\r\n            params.page = 1;\r\n            // 重置的时候清空\r\n            if (rowSelection) {\r\n                rowSelection.onChange([], []);\r\n            }\r\n            _this.ins.setState({ params: params }, function () {\r\n                _this.fetchList();\r\n            });\r\n        };\r\n        /**\r\n         * 列设置变化\r\n         */\r\n        this.onSettingChange = function (selectedColumnKeys) {\r\n            _this.ins.setState({ selectedColumnKeys: selectedColumnKeys });\r\n        };\r\n        /**\r\n         * 列设置拖拽排序完毕\r\n         */\r\n        this.onSettingSortEnd = function (_a) {\r\n            var oldIndex = _a.oldIndex, newIndex = _a.newIndex;\r\n            var tableColumns = _this.ins.state.tableColumns;\r\n            if (oldIndex !== newIndex) {\r\n                var oldItem = tableColumns[oldIndex];\r\n                var newData = tableColumns.filter(function (_, i) { return i !== oldIndex; });\r\n                newData.splice(newIndex, 0, oldItem);\r\n                _this.ins.setState({ tableColumns: newData });\r\n            }\r\n        };\r\n        /**\r\n         * 表格变化\r\n         * @param {*} _\r\n         * @param {*} filters\r\n         * @param {*} sorter\r\n         */\r\n        this.onTableChange = function (keys, filters, sorter) {\r\n            var _a;\r\n            if (!(0, lodash_1.isEmpty)(sorter) || !(0, lodash_1.isEmpty)(filters)) {\r\n                var params = tslib_1.__assign(tslib_1.__assign({}, _this.ins.state.params), { order: (_a = sorter === null || sorter === void 0 ? void 0 : sorter.order) === null || _a === void 0 ? void 0 : _a.replace('end', ''), sidx: sorter === null || sorter === void 0 ? void 0 : sorter.field });\r\n                for (var filterKey in filters) {\r\n                    params[filterKey] = filters[filterKey].join(',');\r\n                    params.page = 1;\r\n                }\r\n                // 当rowSelection.clearOnChange为true 表格变化会清空\r\n                var rowSelection = _this.getRowSelection();\r\n                if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\r\n                    rowSelection.onChange([], []);\r\n                }\r\n                _this.ins.setState({ params: params }, function () { return _this.fetchList(); });\r\n            }\r\n        };\r\n        /**\r\n         * 选项变化\r\n         */\r\n        this.onSelectChange = function (selectedRowKeys, selectedRows) {\r\n            var _a = _this.getModeProps(), dataSource = _a.dataSource, rowKey = _a.rowKey, rowSelection = _a.rowSelection;\r\n            var selectAll = _this.ins.state.selectAll;\r\n            if (_this.ins.state.selectAll) {\r\n                var allKeys = dataSource.map(function (v) { return v[rowKey]; });\r\n                var exceptKeys = (0, lodash_1.union)(selectAll.exceptKeys || [], (0, lodash_1.difference)(allKeys, selectedRowKeys));\r\n                _this.ins.setState({ selectAll: exceptKeys.length ? { exceptKeys: exceptKeys } : true });\r\n            }\r\n            if (rowSelection === null || rowSelection === void 0 ? void 0 : rowSelection.onChange) {\r\n                rowSelection.onChange(selectedRowKeys, selectedRows);\r\n            }\r\n            else {\r\n                _this.ins.setState({ selectedRowKeys: selectedRowKeys, selectedRows: selectedRows });\r\n            }\r\n        };\r\n        /**\r\n         * 分页变化\r\n         * @param {*} page\r\n         * @param {*} limit\r\n         */\r\n        this.onPageChange = function (page, limit) {\r\n            var params = _this.ins.state.params;\r\n            // 当rowSelection.clearOnChange为true 切页面会清空\r\n            var rowSelection = _this.getRowSelection();\r\n            if (rowSelection && !rowSelection.selectAll && rowSelection.clearOnChange) {\r\n                rowSelection.onChange([], []);\r\n            }\r\n            _this.ins.setState({\r\n                params: tslib_1.__assign(tslib_1.__assign({}, params), { page: page, limit: limit }),\r\n            }, function () { return _this.fetchList(); });\r\n        };\r\n        /*\r\n         * 表格删除时候操作，刷列表\r\n         */\r\n        this.onDelete = function (deletedKeys) {\r\n            if (deletedKeys === void 0) { deletedKeys = []; }\r\n            var _a = _this.getModeProps(), pagination = _a.pagination, rowKey = _a.rowKey;\r\n            var total = pagination.total;\r\n            var _b = _this.ins.state.params, page = _b.page, limit = _b.limit;\r\n            if (total % limit === 1 && page === Math.ceil(total / limit)) {\r\n                _this.ins.setState({\r\n                    params: tslib_1.__assign(tslib_1.__assign({}, _this.ins.state.params), { page: page - deletedKeys.length || 1 }),\r\n                }, function () { return _this.fetchList(); });\r\n                return;\r\n            }\r\n            var rowSelection = _this.getRowSelection();\r\n            if (rowSelection) {\r\n                var selectedRowKeys = rowSelection.selectedRowKeys.filter(function (v) { return !deletedKeys.includes(v); });\r\n                var selectedRows = rowSelection.selectedRows.filter(function (v) { return !deletedKeys.includes(v[rowKey]); });\r\n                rowSelection.onChange(selectedRowKeys, selectedRows);\r\n            }\r\n            _this.fetchList();\r\n        };\r\n        this.ins = ins;\r\n    }\r\n    return Util;\r\n}());\r\nexports.default = Util;\r\n//# sourceMappingURL=util.js.map"],"names":["Object","defineProperty","exports","value","tslib_1","require","antd_1","dayjs_1","__importDefault","lodash_1","react_1","adhere_ui_formitemcreator_1","adhere_util_intl_1","Util","ins","_this","this","getModeProps","__assign","rowKey","props","mode","getDefaultSelectedColumnKeys","columns","showNumber","result","filter","v","show","hasOwnProperty","map","key","includes","unshift","getRowSelection","_a","state","_b","selectedRowKeys","_c","selectedRows","selectAll","rowSelection","clearOnChange","onChange","onSelectChange","getSortDataSource","SortableTableRef","dataSource","getParams","params","formParams","searchFormRef","current","getFieldsValue","getFormColumns","Formcolumns","size","searchNow","temp","t","contentProps","type","default","RANGEPICKER","SELECT","getPopupContainer","TableListRef","style","width","allowClear","onSearch","SEARCH","name","onPressEnter","e","INPUT","TEXTAREA","NUMBER","target","getPagination","pagination","defaultPageSize","page","pageSize","limit","showSizeChanger","pageSizeOptions","showQuickJumper","showTotal","total","concat","onPageChange","onShowSizeChange","getTableColumns","tableColumns","item","render","text","record","index","valueType","format","find","toString","label","ellipsis","createElement","Tooltip","title","placement","filtered","filters","length","dataIndex","r","i","getLoading","loading","fetchList","fetchParams","request","setState","then","searchParams","onResetSearch","resetFields","onSettingChange","selectedColumnKeys","onSettingSortEnd","oldItem","oldIndex","newIndex","newData","_","splice","onTableChange","keys","sorter","isEmpty","filterKey","order","replace","sidx","field","join","allKeys","exceptKeys","union","difference","onDelete","deletedKeys","Math","ceil"],"mappings":"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"}