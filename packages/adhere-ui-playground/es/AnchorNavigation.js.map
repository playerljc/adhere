{"version":3,"file":"AnchorNavigation.js","sources":["AnchorNavigation.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport classNames from 'classnames';\nimport React, { memo, \n/*useContext,*/\nuseEffect, useRef, useState, } from 'react';\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\nvar selectPrefix = 'adhere-ui-playground-anchor-navigation';\n/**\n * AnchorNavigation\n * @classdesc 带有锚点导航的面板\n * @constructor\n */\nvar AnchorNavigation = memo(function (props) {\n    var _a;\n    var className = props.className, style = props.style, autoClassName = props.autoClassName, autoStyle = props.autoStyle, fixedClassName = props.fixedClassName, fixedStyle = props.fixedStyle, _b = props.anchors, anchors = _b === void 0 ? [] : _b, _c = props.anchorPosition, anchorPosition = _c === void 0 ? {\n        top: 77,\n        width: 120,\n    } : _c, children = props.children;\n    var _d = useState((_a = props.activeAnchor) !== null && _a !== void 0 ? _a : ''), activeAnchor = _d[0], setActiveAnchor = _d[1];\n    var anchorRef = useRef(null);\n    // const anchorDimensionIndex = useRef<\n    //   {\n    //     anchor: string;\n    //     range: {\n    //       top: number;\n    //       bottom?: number | undefined;\n    //     };\n    //   }[]\n    // >([]);\n    // const { scrollEl } = useContext(AnchorNavigationContext);\n    // /**\n    //  * createAnchorDimensionIndex\n    //  */\n    // function createAnchorDimensionIndex(): void {\n    //   if (!scrollEl) return;\n    //\n    //   const container = scrollEl as HTMLElement;\n    //\n    //   anchorDimensionIndex.current = [];\n    //\n    //   (anchors || []).forEach(({ anchor }, index) => {\n    //     const el = document.getElementById(anchor) as HTMLElement;\n    //\n    //     if (!el) return;\n    //\n    //     const top = Util.getTopUntil({ el, untilEl: container });\n    //\n    //     const entry = {\n    //       anchor,\n    //       range: {\n    //         top,\n    //         bottom:\n    //           index === anchorDimensionIndex.current.length - 1 ? top + el.offsetHeight : undefined,\n    //       },\n    //     };\n    //\n    //     anchorDimensionIndex.current.push(entry);\n    //\n    //     if (index !== 0) {\n    //       anchorDimensionIndex.current[index - 1].range.bottom = top;\n    //     }\n    //   });\n    // }\n    // /**\n    //  * findAnchorByScrollVal\n    //  * @param scrollVal\n    //  */\n    // function findAnchorByScrollVal(scrollVal: number) {\n    //   return anchorDimensionIndex.current.find(\n    //     (anchorIndexItem) =>\n    //       scrollVal >= anchorIndexItem.range.top &&\n    //       scrollVal <= (anchorIndexItem.range.bottom as number),\n    //   );\n    // }\n    /**\n     * useEffect\n     * @description scrollEl change\n     */\n    // useEffect(() => {\n    //   if (!scrollEl) return;\n    //\n    //   /**\n    //    * onWrapScroll\n    //    */\n    //   function onWrapScroll() {\n    //     if (!scrollEl || !anchorRef.current) return;\n    //\n    //     const scrollTop = (scrollEl as HTMLElement).scrollTop;\n    //\n    //     const anchor = findAnchorByScrollVal(scrollTop);\n    //\n    //     if (anchor) {\n    //       setActiveAnchor(anchor.anchor);\n    //     }\n    //\n    //     if (scrollTop === 0) {\n    //       (anchorRef.current as HTMLElement)?.classList?.remove?.(`${selectPrefix}-affix`);\n    //       // (anchorRef.current as HTMLElement).style.top = '0';\n    //     } else {\n    //       (anchorRef.current as HTMLElement)?.classList?.add?.(`${selectPrefix}-affix`);\n    //\n    //       if ((anchorRef.current as HTMLElement).style) {\n    //         (anchorRef.current as HTMLElement).style.top = `${anchorPosition.top}px`;\n    //       }\n    //     }\n    //   }\n    //\n    //   createAnchorDimensionIndex();\n    //\n    //   (scrollEl as HTMLElement).addEventListener('scroll', onWrapScroll);\n    //\n    //   return () => {\n    //     if (!scrollEl) return;\n    //     (scrollEl as HTMLElement).removeEventListener('scroll', onWrapScroll);\n    //   };\n    // }, [scrollEl]);\n    /**\n     * useEffect\n     * @description activeAnchor change\n     */\n    useEffect(function () {\n        var _a;\n        setActiveAnchor((_a = props.activeAnchor) !== null && _a !== void 0 ? _a : '');\n    }, [props.activeAnchor]);\n    /**\n     * render jsx\n     */\n    return (React.createElement(\"div\", { className: classNames(selectPrefix, className), style: style !== null && style !== void 0 ? style : {} },\n        React.createElement(\"div\", { className: classNames(\"\".concat(selectPrefix, \"-auto\"), autoClassName), style: autoStyle !== null && autoStyle !== void 0 ? autoStyle : {} },\n            React.createElement(\"div\", { className: \"\".concat(selectPrefix, \"-inner\") }, children)),\n        React.createElement(ConditionalRender, { conditional: !!(anchors || []).length }, function () { return (React.createElement(\"div\", { className: classNames(\"\".concat(selectPrefix, \"-fixed\"), fixedClassName), style: __assign(__assign({}, (style !== null && style !== void 0 ? style : {})), { width: \"\".concat(anchorPosition.width, \"px\") }) },\n            React.createElement(\"ul\", { className: \"\".concat(selectPrefix, \"-anchor\"), ref: anchorRef }, (anchors || []).map(function (anchor, _index) { return (React.createElement(\"li\", { key: \"\".concat(_index), className: anchor.anchor === activeAnchor ? \"\".concat(selectPrefix, \"-active\") : '', title: anchor.name },\n                React.createElement(\"a\", { onClick: function () {\n                        setActiveAnchor(anchor.anchor);\n                        var anchorEl = document.getElementById(anchor.anchor);\n                        if (anchorEl) {\n                            anchorEl.scrollIntoView(true);\n                        }\n                    } }, anchor.name))); })))); })));\n});\nAnchorNavigation.displayName = 'AnchorNavigation';\nexport default AnchorNavigation;\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","classNames","React","memo","useEffect","useRef","useState","ConditionalRender","selectPrefix","AnchorNavigation","props","className","style","autoClassName","autoStyle","fixedClassName","_b","fixedStyle","anchors","_c","anchorPosition","top","width","children","_d","_a","activeAnchor","setActiveAnchor","anchorRef","createElement","concat","conditional","ref","map","anchor","_index","key","title","name","onClick","anchorEl","document","getElementById","scrollIntoView","displayName"],"mappings":"AAAA,IAAIA,SAAYC,MAAQA,KAAKD,UAAa,WAStC,OARAA,SAAWE,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE7C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAC1DN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,CACX,GACgBU,MAAMb,KAAMO,SAAS,CACzC,SACOO,eAAgB,oBAChBC,OAASC,KAEhBC,UAAWC,OAAQC,QAAwB,KAAP,eAC7BC,sBAAuB,0CAC9B,IAAIC,aAAe,yCAMfC,iBAAmBN,KAAK,SAAUO,GAClC,IACIC,EAAYD,EAAMC,UAAWC,EAAQF,EAAME,MAAOC,EAAgBH,EAAMG,cAAeC,EAAYJ,EAAMI,UAAWC,EAAiBL,EAAMK,eAA+CC,GAAlBN,EAAMO,WAAiBP,EAAMQ,SAASA,EAAiB,KAAA,IAAPF,EAAgB,GAAKA,EAAIG,EAAKT,EAAMU,eAAgBA,EAAwB,KAAA,IAAPD,EAAgB,CAC7SE,IAAK,GACLC,MAAO,GACX,EAAIH,EAAII,EAAWb,EAAMa,SACrBC,EAAKlB,SAAS,OAACmB,EAAKf,EAAMgB,cAA0CD,EAAK,EAAE,EAAGC,EAAeF,EAAG,GAAIG,EAAkBH,EAAG,GACzHI,EAAYvB,OAAO,IAAI,EA4G3B,OAPAD,UAAU,WACN,IAAIqB,EACJE,EAAgB,OAACF,EAAKf,EAAMgB,cAA0CD,EAAK,EAAE,CACjF,EAAG,CAACf,EAAMgB,aAAa,EAIfxB,MAAM2B,cAAc,MAAO,CAAElB,UAAWV,WAAWO,aAAcG,CAAS,EAAGC,MAAOA,MAAAA,EAAqCA,EAAQ,EAAG,EACxIV,MAAM2B,cAAc,MAAO,CAAElB,UAAWV,WAAW,GAAG6B,OAAOtB,aAAc,OAAO,EAAGK,CAAa,EAAGD,MAAOE,MAAAA,EAA6CA,EAAY,EAAG,EACpKZ,MAAM2B,cAAc,MAAO,CAAElB,UAAW,GAAGmB,OAAOtB,aAAc,QAAQ,CAAE,EAAGe,CAAQ,CAAC,EAC1FrB,MAAM2B,cAActB,kBAAmB,CAAEwB,YAAa,CAAC,EAAEb,GAAW,IAAIvB,MAAO,EAAG,WAAc,OAAQO,MAAM2B,cAAc,MAAO,CAAElB,UAAWV,WAAW,GAAG6B,OAAOtB,aAAc,QAAQ,EAAGO,CAAc,EAAGH,MAAO1B,SAASA,SAAS,GAAK0B,MAAAA,EAAqCA,EAAQ,EAAG,EAAG,CAAEU,MAAO,GAAGQ,OAAOV,EAAeE,MAAO,IAAI,CAAE,CAAC,CAAE,EAC9UpB,MAAM2B,cAAc,KAAM,CAAElB,UAAW,GAAGmB,OAAOtB,aAAc,SAAS,EAAGwB,IAAKJ,CAAU,GAAIV,GAAW,IAAIe,IAAI,SAAUC,EAAQC,GAAU,OAAQjC,MAAM2B,cAAc,KAAM,CAAEO,IAAK,GAAGN,OAAOK,CAAM,EAAGxB,UAAWuB,EAAOA,SAAWR,EAAe,GAAGI,OAAOtB,aAAc,SAAS,EAAI,GAAI6B,MAAOH,EAAOI,IAAK,EAC7SpC,MAAM2B,cAAc,IAAK,CAAEU,QAAS,WAC5BZ,EAAgBO,EAAOA,MAAM,EAC7B,IAAIM,EAAWC,SAASC,eAAeR,EAAOA,MAAM,EAChDM,GACAA,EAASG,eAAe,CAAA,CAAI,CAEpC,CAAE,EAAGT,EAAOI,IAAI,CAAE,CAAG,CAAC,CAAC,CAAE,CAAG,CAAC,CAAE,CACnD,CAAC,EACD7B,iBAAiBmC,YAAc,kCAChBnC"}