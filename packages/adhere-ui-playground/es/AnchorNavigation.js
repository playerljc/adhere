import React,{useEffect,useRef,useState}from"react";import PropTypes from"prop-types";import Util from"@baifendian/adhere-util";import{AnchorNavigationContext}from"./AnchorNavigationContext";var selectPrefix="adhere-ui-playground-anchor-navigation";function AnchorNavigation(r){var e=useState(r.activeAnchor),t=e[0],a=e[1],e=useState(null),c=e[0],n=e[1],i=useRef(),s=useRef([]);return useEffect(function(){function e(){a(window.location.hash.substring(1))}return window.addEventListener("hashchange",e),function(){window.removeEventListener("hashchange",e)}},[]),useEffect(function(){var o;if(c)return c&&(o=c,s.current=[],r.anchors.forEach(function(e,t){var n=e.anchor,r=document.getElementById(n),e=Util.getTopUntil({el:r,untilEl:o}),n={anchor:n,range:{top:e,bottom:void 0}};s.current.push(n),0!==t&&(s.current[t-1].range.bottom=e),t===s.current.length-1&&(n.range.bottom=e+r.offsetHeight)})),c.addEventListener("scroll",e),function(){c&&c.removeEventListener("scroll",e)};function e(){var e,t,n;c&&(e=c.scrollTop,n=e,(t=s.current.find(function(e){return n>=e.range.top&&n<=e.range.bottom}))&&a(t.anchor),0===e?i.current.classList.remove(selectPrefix+"-affix"):(i.current.classList.add(selectPrefix+"-affix"),i.current.style.top=r.anchorPosition.top+"px"))}},[c]),useEffect(function(){a(r.activeAnchor)},[r.activeAnchor]),React.createElement(AnchorNavigationContext.Consumer,null,function(e){e=e.scrollEl;return n(e),React.createElement("div",{className:selectPrefix},React.createElement("div",{className:selectPrefix+"-auto"},React.createElement("div",{className:selectPrefix+"-inner"},r.children)),React.createElement("div",{className:selectPrefix+"-fixed",style:{width:r.anchorPosition.width+"px"}},React.createElement("ul",{className:selectPrefix+"-anchor",ref:i},r.anchors.map(function(e){return React.createElement("li",{className:e.anchor===t?selectPrefix+"-active":"",title:e.name},React.createElement("a",{href:"#"+e.anchor},e.name))}))))})}AnchorNavigation.defaultProps={activeAnchor:"",anchors:[],anchorPosition:{top:77,width:120}},AnchorNavigation.propTypes={activeAnchor:PropTypes.string,anchors:PropTypes.arrayOf(PropTypes.shape({name:PropTypes.oneOfType([PropTypes.string,PropTypes.node]),anchor:PropTypes.string})),anchorPosition:PropTypes.shape({top:PropTypes.number,width:PropTypes.number})};export default AnchorNavigation;
//# sourceMappingURL=AnchorNavigation.js.map
