import React,{useContext,useEffect,useRef,useState}from"react";import ConditionalRender from"@baifendian/adhere-ui-conditionalrender";import Util from"@baifendian/adhere-util";import{AnchorNavigationContext}from"./AnchorNavigationContext";var selectPrefix="adhere-ui-playground-anchor-navigation",AnchorNavigation=function(e){var t=e.anchors,n=void 0===t?[]:t,t=e.anchorPosition,a=void 0===t?{top:77,width:120}:t,t=e.children,r=useState(e.activeAnchor||""),i=r[0],o=r[1],c=useRef(null),l=useRef([]),s=useContext(AnchorNavigationContext).scrollEl;return useEffect(function(){if("undefined"!=typeof window)return window.addEventListener("hashchange",e),function(){"undefined"!=typeof window&&window.removeEventListener("hashchange",e)};function e(){o(window.location.hash.substring(1))}},[]),useEffect(function(){var r;if(s)return s&&(r=s,l.current=[],(n||[]).forEach(function(e,t){var e=e.anchor,n=document.getElementById(e);n&&(n={anchor:e,range:{top:e=Util.getTopUntil({el:n,untilEl:r}),bottom:t===l.current.length-1?e+n.offsetHeight:void 0}},l.current.push(n),0!==t&&(l.current[t-1].range.bottom=e))})),s.addEventListener("scroll",e),function(){s&&s.removeEventListener("scroll",e)};function e(){var e,t,n;s&&(e=s.scrollTop,n=e,(t=l.current.find(function(e){return n>=e.range.top&&n<=e.range.bottom}))&&o(t.anchor),0===e?c.current.classList.remove(selectPrefix+"-affix"):(c.current.classList.add(selectPrefix+"-affix"),c.current.style.top=a.top+"px"))}},[s]),useEffect(function(){return o(e.activeAnchor||"")},[e.activeAnchor]),React.createElement("div",{className:selectPrefix},React.createElement("div",{className:selectPrefix+"-auto"},React.createElement("div",{className:selectPrefix+"-inner"},t)),React.createElement(ConditionalRender,{conditional:!!(n||[]).length},function(){return React.createElement("div",{className:selectPrefix+"-fixed",style:{width:a.width+"px"}},React.createElement("ul",{className:selectPrefix+"-anchor",ref:c},(n||[]).map(function(e){return React.createElement("li",{className:e.anchor===i?selectPrefix+"-active":"",title:e.name},React.createElement("a",{href:"#"+e.anchor},e.name))})))}))};export default AnchorNavigation;
//# sourceMappingURL=AnchorNavigation.js.map
