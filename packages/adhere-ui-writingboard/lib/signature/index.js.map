{"version":3,"file":"index.js","sources":["signature/index.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar antd_1 = require(\"antd\");\nvar react_1 = __importStar(require(\"react\"));\nvar react_color_1 = require(\"react-color\");\nvar adhere_ui_flexlayout_1 = __importDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar index_1 = __importDefault(require(\"../index\"));\nvar types_1 = require(\"../types\");\nvar selectorPrefix = 'adhere-ui-signature';\n/**\n * Signature\n * @description 签名\n * @param {SignatureProps} props\n * @param ref\n * @constructor\n */\nvar Signature = function Signature(_a, ref) {\n  var wrapProps = _a.wrapProps,\n    toolProps = _a.toolProps,\n    areaProps = _a.areaProps,\n    defaultWidth = _a.defaultWidth,\n    defaultColor = _a.defaultColor;\n  var _b = (0, react_1.useState)(types_1.Mode.FREE),\n    mode = _b[0],\n    setMode = _b[1];\n  var _c = (0, react_1.useState)(defaultColor !== null && defaultColor !== void 0 ? defaultColor : '#000'),\n    color = _c[0],\n    setColor = _c[1];\n  var _d = (0, react_1.useState)(defaultWidth !== null && defaultWidth !== void 0 ? defaultWidth : 2),\n    width = _d[0],\n    setWidth = _d[1];\n  var writingBoardRef = (0, react_1.useRef)(null);\n  var defaultProps = (0, react_1.useMemo)(function () {\n    return {\n      gutter: 20,\n      wrapClassName: \"\".concat(selectorPrefix, \"-wrap\")\n    };\n  }, []);\n  var defaultLProps = (0, react_1.useMemo)(function () {\n    return {\n      fit: true\n    };\n  }, []);\n  var defaultCProps = (0, react_1.useMemo)(function () {\n    return {\n      autoFixed: true\n    };\n  }, []);\n  var renderTool = (0, react_1.useCallback)(function () {\n    // 线条宽度\n    // 颜色\n    // 橡皮\n    // 预览\n    // 清除\n    return react_1.default.createElement(antd_1.Card, null, react_1.default.createElement(antd_1.Space, {\n      direction: \"vertical\",\n      size: 20\n    }, react_1.default.createElement(antd_1.InputNumber, {\n      style: {\n        width: '100%'\n      },\n      value: width,\n      precision: 0,\n      max: 10,\n      min: 1,\n      onChange: function onChange(v) {\n        setWidth(v);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setLineWidth(v);\n        }\n      }\n    }), react_1.default.createElement(react_color_1.CompactPicker, {\n      color: color,\n      onChangeComplete: function onChangeComplete(c) {\n        setColor(c.hex);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setStrokeStyle(c.hex);\n        }\n      }\n    }), react_1.default.createElement(antd_1.Button, {\n      size: \"large\",\n      block: true,\n      type: \"primary\",\n      onClick: function onClick() {\n        if (writingBoardRef.current) {\n          var v = mode === types_1.Mode.FREE ? types_1.Mode.RUBBER : types_1.Mode.FREE;\n          setMode(v);\n          writingBoardRef.current.setMode(v);\n        }\n      }\n    }, mode === types_1.Mode.FREE ? adhere_util_intl_1.default.v('橡皮') : adhere_util_intl_1.default.v('绘制')), react_1.default.createElement(antd_1.Button, {\n      size: \"large\",\n      block: true,\n      type: \"primary\",\n      onClick: function onClick() {\n        if (writingBoardRef.current) {\n          writingBoardRef.current.clear();\n        }\n      }\n    }, adhere_util_intl_1.default.v('清除'))));\n  }, [mode, width, color, toolProps]);\n  var renderArea = (0, react_1.useCallback)(function () {\n    return react_1.default.createElement(antd_1.Card, null, react_1.default.createElement(index_1.default, {\n      ref: writingBoardRef,\n      defaultMode: mode,\n      defaultLineWidth: width,\n      defaultStrokeStyle: color\n    }));\n  }, [areaProps]);\n  (0, react_1.useImperativeHandle)(ref, function () {\n    return {\n      /**\n       * Save\n       */\n      save: function save(backgroundColor, type, quality) {\n        if (!writingBoardRef.current) return;\n        return writingBoardRef.current.toDataURL(backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : '#fff', type !== null && type !== void 0 ? type : 'image/png', quality !== null && quality !== void 0 ? quality : 1.0);\n      }\n    };\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setWidth(defaultWidth);\n  }, [defaultWidth]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setColor(defaultColor);\n  }, [defaultColor]);\n  return react_1.default.createElement(adhere_ui_flexlayout_1.default.TRBLC.LCLayout, __assign({}, defaultProps, wrapProps, {\n    lProps: __assign(__assign(__assign({}, defaultLProps), toolProps), {\n      render: renderTool\n    }),\n    cProps: __assign(__assign(__assign({}, defaultCProps), areaProps), {\n      render: renderArea\n    })\n  }));\n};\nexports.default = (0, react_1.memo)((0, react_1.forwardRef)(Signature));"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","ahooks_1","exports","require","antd_1","react_1","react_color_1","adhere_ui_flexlayout_1","adhere_util_intl_1","index_1","types_1","selectorPrefix","Signature","_a","ref","wrapProps","toolProps","areaProps","defaultWidth","defaultColor","_b","useState","Mode","FREE","mode","setMode","_c","color","setColor","_d","width","setWidth","writingBoardRef","useRef","defaultProps","useMemo","gutter","wrapClassName","concat","defaultLProps","fit","defaultCProps","autoFixed","renderTool","useCallback","createElement","Card","Space","direction","size","InputNumber","style","precision","max","min","onChange","current","setLineWidth","CompactPicker","onChangeComplete","c","hex","setStrokeStyle","Button","block","type","onClick","RUBBER","clear","renderArea","defaultMode","defaultLineWidth","defaultStrokeStyle","useImperativeHandle","save","backgroundColor","quality","toDataURL","useUpdateEffect","TRBLC","LCLayout","lProps","render","cProps","memo","forwardRef"],"mappings":"AAAA,aAEA,IAAIA,SAA0C,WAQ5C,OAPAA,SAAWC,OAAOC,QAAU,SAAUC,GACpC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE/C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAAGN,EAAEM,GAAKL,EAAEK,IAE5E,OAAON,CACT,GACgBU,MAAMC,KAAMP,SAAS,CACvC,EACIQ,gBAAyDd,OAAOe,OAAS,SAAUC,EAAGC,EAAGC,EAAGC,GACnFC,KAAAA,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOrB,OAAOsB,yBAAyBL,EAAGC,CAAC,EAC1CG,IAAS,QAASA,EAAQJ,EAAEM,WAAaF,CAAAA,EAAKG,UAAYH,CAAAA,EAAKI,gBAClEJ,EAAO,CACLK,WAAY,CAAA,EACZC,IAAK,WACH,OAAOV,EAAEC,EACX,CACF,GAEFlB,OAAO4B,eAAeZ,EAAGG,EAAIE,CAAI,CACnC,EAAI,SAAUL,EAAGC,EAAGC,EAAGC,GAErBH,EADsBG,EAAXC,KAAAA,IAAPD,EAAuBD,EACzBC,GAAMF,EAAEC,EACZ,EACIW,mBAA+D7B,OAAOe,OAAS,SAAUC,EAAGc,GAC9F9B,OAAO4B,eAAeZ,EAAG,UAAW,CAClCU,WAAY,CAAA,EACZK,MAAOD,CACT,CAAC,CACH,EAAI,SAAUd,EAAGc,GACfd,EAAW,QAAIc,CACjB,EACIE,aAAkD,SAAUC,GAC9D,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,GACb,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBlB,OAAOS,UAAUC,eAAeC,KAAKsB,EAAKf,CAAC,GAAGJ,gBAAgBoB,EAAQD,EAAKf,CAAC,EAEvI,OADAW,mBAAmBK,EAAQD,CAAG,EACvBC,CACT,EACIC,gBAAwD,SAAUF,GACpE,OAAOA,GAAOA,EAAIV,WAAaU,EAAM,CACnCG,QAAWH,CACb,CACF,EAIII,UAHJrC,OAAO4B,eAAeU,QAAS,aAAc,CAC3CP,MAAO,CAAA,CACT,CAAC,EACcQ,QAAQ,QAAQ,GAC3BC,OAASD,QAAQ,MAAM,EACvBE,QAAUT,aAAaO,QAAQ,OAAO,CAAC,EACvCG,cAAgBH,QAAQ,aAAa,EACrCI,uBAAyBR,gBAAgBI,QAAQ,kCAAkC,CAAC,EACpFK,mBAAqBT,gBAAgBI,QAAQ,8BAA8B,CAAC,EAC5EM,QAAUV,gBAAgBI,QAAQ,UAAU,CAAC,EAC7CO,QAAUP,QAAQ,UAAU,EAC5BQ,eAAiB,sBAQjBC,UAAY,SAAmBC,EAAIC,GACrC,IAAIC,EAAYF,EAAGE,UACjBC,EAAYH,EAAGG,UACfC,EAAYJ,EAAGI,UACfC,EAAeL,EAAGK,aAClBC,EAAeN,EAAGM,aAChBC,GAAK,EAAIf,QAAQgB,UAAUX,QAAQY,KAAKC,IAAI,EAC9CC,EAAOJ,EAAG,GACVK,EAAUL,EAAG,GACXM,GAAK,EAAIrB,QAAQgB,UAAUF,MAAAA,EAAmDA,EAAe,MAAM,EACrGQ,EAAQD,EAAG,GACXE,EAAWF,EAAG,GACZG,GAAK,EAAIxB,QAAQgB,UAAUH,MAAAA,EAAmDA,EAAe,CAAC,EAChGY,EAAQD,EAAG,GACXE,EAAWF,EAAG,GACZG,GAAkB,EAAI3B,QAAQ4B,QAAQ,IAAI,EAC1CC,GAAe,EAAI7B,QAAQ8B,SAAS,WACtC,MAAO,CACLC,OAAQ,GACRC,cAAe,GAAGC,OAAO3B,eAAgB,OAAO,CAClD,CACF,EAAG,EAAE,EACD4B,GAAgB,EAAIlC,QAAQ8B,SAAS,WACvC,MAAO,CACLK,IAAK,CAAA,CACP,CACF,EAAG,EAAE,EACDC,GAAgB,EAAIpC,QAAQ8B,SAAS,WACvC,MAAO,CACLO,UAAW,CAAA,CACb,CACF,EAAG,EAAE,EACDC,GAAa,EAAItC,QAAQuC,aAAa,WAMxC,OAAOvC,QAAQL,QAAQ6C,cAAczC,OAAO0C,KAAM,KAAMzC,QAAQL,QAAQ6C,cAAczC,OAAO2C,MAAO,CAClGC,UAAW,WACXC,KAAM,EACR,EAAG5C,QAAQL,QAAQ6C,cAAczC,OAAO8C,YAAa,CACnDC,MAAO,CACLrB,MAAO,MACT,EACAnC,MAAOmC,EACPsB,UAAW,EACXC,IAAK,GACLC,IAAK,EACLC,SAAU,SAAkB7D,GAC1BqC,EAASrC,CAAC,EACNsC,EAAgBwB,SAClBxB,EAAgBwB,QAAQC,aAAa/D,CAAC,CAE1C,CACF,CAAC,EAAGW,QAAQL,QAAQ6C,cAAcvC,cAAcoD,cAAe,CAC7D/B,MAAOA,EACPgC,iBAAkB,SAA0BC,GAC1ChC,EAASgC,EAAEC,GAAG,EACV7B,EAAgBwB,SAClBxB,EAAgBwB,QAAQM,eAAeF,EAAEC,GAAG,CAEhD,CACF,CAAC,EAAGxD,QAAQL,QAAQ6C,cAAczC,OAAO2D,OAAQ,CAC/Cd,KAAM,QACNe,MAAO,CAAA,EACPC,KAAM,UACNC,QAAS,WACP,IACMxE,EADFsC,EAAgBwB,UACd9D,EAAI8B,IAASd,QAAQY,KAAKC,KAAOb,QAAQY,KAAK6C,OAASzD,QAAQY,KAAKC,KACxEE,EAAQ/B,CAAC,EACTsC,EAAgBwB,QAAQ/B,QAAQ/B,CAAC,EAErC,CACF,EAAG8B,IAASd,QAAQY,KAAKC,KAAOf,mBAAmBR,QAAQN,EAAE,IAAI,EAAIc,mBAAmBR,QAAQN,EAAE,IAAI,CAAC,EAAGW,QAAQL,QAAQ6C,cAAczC,OAAO2D,OAAQ,CACrJd,KAAM,QACNe,MAAO,CAAA,EACPC,KAAM,UACNC,QAAS,WACHlC,EAAgBwB,SAClBxB,EAAgBwB,QAAQY,MAAM,CAElC,CACF,EAAG5D,mBAAmBR,QAAQN,EAAE,IAAI,CAAC,CAAC,CAAC,CACzC,EAAG,CAAC8B,EAAMM,EAAOH,EAAOX,EAAU,EAC9BqD,GAAa,EAAIhE,QAAQuC,aAAa,WACxC,OAAOvC,QAAQL,QAAQ6C,cAAczC,OAAO0C,KAAM,KAAMzC,QAAQL,QAAQ6C,cAAcpC,QAAQT,QAAS,CACrGc,IAAKkB,EACLsC,YAAa9C,EACb+C,iBAAkBzC,EAClB0C,mBAAoB7C,CACtB,CAAC,CAAC,CACJ,EAAG,CAACV,EAAU,EAkBd,OAjBA,EAAIZ,QAAQoE,qBAAqB3D,EAAK,WACpC,MAAO,CAIL4D,KAAM,SAAcC,EAAiBV,EAAMW,GACzC,GAAK5C,EAAgBwB,QACrB,OAAOxB,EAAgBwB,QAAQqB,UAAUF,MAAAA,EAAyDA,EAAkB,OAAQV,MAAAA,EAAmCA,EAAO,YAAaW,MAAAA,EAAyCA,EAAU,CAAG,CAC3O,CACF,CACF,CAAC,GACD,EAAI3E,SAAS6E,iBAAiB,WAC5B/C,EAASb,CAAY,CACvB,EAAG,CAACA,EAAa,GACjB,EAAIjB,SAAS6E,iBAAiB,WAC5BlD,EAAST,CAAY,CACvB,EAAG,CAACA,EAAa,EACVd,QAAQL,QAAQ6C,cAActC,uBAAuBP,QAAQ+E,MAAMC,SAAUrH,SAAS,GAAIuE,EAAcnB,EAAW,CACxHkE,OAAQtH,SAASA,SAASA,SAAS,GAAI4E,CAAa,EAAGvB,CAAS,EAAG,CACjEkE,OAAQvC,CACV,CAAC,EACDwC,OAAQxH,SAASA,SAASA,SAAS,GAAI8E,CAAa,EAAGxB,CAAS,EAAG,CACjEiE,OAAQb,CACV,CAAC,CACH,CAAC,CAAC,CACJ,EACAnE,QAAQF,SAAU,EAAIK,QAAQ+E,OAAM,EAAI/E,QAAQgF,YAAYzE,SAAS,CAAC"}