{"version":3,"file":"MobileSignatureCore.js","sources":["signature/MobileSignatureCore.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar antd_1 = require(\"antd\");\nvar antd_mobile_1 = require(\"antd-mobile\");\nvar react_1 = __importStar(require(\"react\"));\nvar react_color_1 = require(\"react-color\");\nvar adhere_ui_flexlayout_1 = __importDefault(require(\"@baifendian/adhere-ui-flexlayout\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar WritingBoard_1 = __importDefault(require(\"../WritingBoard\"));\nvar types_1 = require(\"../types\");\nvar selectorPrefix = 'adhere-ui-signature-core';\n/**\n * Signature\n * @description 签名\n * @param {SignatureProps} props\n * @param ref\n * @constructor\n */\nvar Signature = (0, react_1.memo)((0, react_1.forwardRef)(function (_a, ref) {\n  var wrapProps = _a.wrapProps,\n    toolProps = _a.toolProps,\n    areaProps = _a.areaProps,\n    defaultWidth = _a.defaultWidth,\n    defaultColor = _a.defaultColor;\n  var _b = (0, react_1.useState)(types_1.Mode.FREE),\n    mode = _b[0],\n    setMode = _b[1];\n  var _c = (0, react_1.useState)(defaultColor !== null && defaultColor !== void 0 ? defaultColor : '#000'),\n    color = _c[0],\n    setColor = _c[1];\n  var _d = (0, react_1.useState)(defaultWidth !== null && defaultWidth !== void 0 ? defaultWidth : 2),\n    width = _d[0],\n    setWidth = _d[1];\n  var writingBoardRef = (0, react_1.useRef)({});\n  var defaultProps = (0, react_1.useMemo)(function () {\n    return {\n      gutter: 20,\n      wrapClassName: \"\".concat(selectorPrefix, \"-wrap\")\n    };\n  }, []);\n  var defaultBProps = (0, react_1.useMemo)(function () {\n    return {\n      fit: true\n    };\n  }, []);\n  var defaultCProps = (0, react_1.useMemo)(function () {\n    return {\n      autoFixed: true\n    };\n  }, []);\n  var renderTool = (0, react_1.useMemo)(function () {\n    return react_1.default.createElement(\"div\", null, react_1.default.createElement(antd_1.Space, {\n      direction: \"vertical\",\n      size: 20\n    }, react_1.default.createElement(antd_mobile_1.Stepper, {\n      style: {\n        width: '100%'\n      },\n      value: width,\n      max: 10,\n      min: 1,\n      onChange: function (v) {\n        setWidth(v);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setLineWidth(v);\n        }\n      }\n    }), react_1.default.createElement(react_color_1.CompactPicker, {\n      color: color,\n      onChangeComplete: function (c) {\n        setColor(c.hex);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setStrokeStyle(c.hex);\n        }\n      }\n    })), react_1.default.createElement(antd_mobile_1.Grid, {\n      columns: 2,\n      gap: 8\n    }, react_1.default.createElement(antd_mobile_1.Grid.Item, null, react_1.default.createElement(antd_mobile_1.Button, {\n      size: \"middle\",\n      block: true,\n      color: \"primary\",\n      onClick: function () {\n        if (writingBoardRef.current) {\n          var v = mode === types_1.Mode.FREE ? types_1.Mode.RUBBER : types_1.Mode.FREE;\n          setMode(v);\n          writingBoardRef.current.setMode(v);\n        }\n      }\n    }, mode === types_1.Mode.FREE ? adhere_util_intl_1.default.v('橡皮') : adhere_util_intl_1.default.v('绘制'))), react_1.default.createElement(antd_mobile_1.Grid.Item, null, react_1.default.createElement(antd_mobile_1.Button, {\n      size: \"middle\",\n      block: true,\n      color: \"primary\",\n      onClick: function () {\n        if (writingBoardRef.current) {\n          writingBoardRef.current.clear();\n        }\n      }\n    }, adhere_util_intl_1.default.v('清除')))));\n  }, [mode, width, color, toolProps]);\n  var renderArea = (0, react_1.useMemo)(function () {\n    return react_1.default.createElement(WritingBoard_1.default, {\n      ref: writingBoardRef,\n      defaultMode: mode,\n      defaultLineWidth: width,\n      defaultStrokeStyle: color\n    });\n  }, [areaProps]);\n  (0, react_1.useImperativeHandle)(ref, function () {\n    return {\n      /**\n       * Save\n       */\n      save: function (backgroundColor, type, quality) {\n        if (!writingBoardRef.current) return;\n        return writingBoardRef.current.toDataURL(backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : '#fff', type !== null && type !== void 0 ? type : 'image/png', quality !== null && quality !== void 0 ? quality : 1.0);\n      },\n      isEmpty: function () {\n        var _a, _b;\n        if (writingBoardRef === null || writingBoardRef === void 0 ? void 0 : writingBoardRef.current) {\n          return (_b = (_a = writingBoardRef === null || writingBoardRef === void 0 ? void 0 : writingBoardRef.current) === null || _a === void 0 ? void 0 : _a.isEmpty) === null || _b === void 0 ? void 0 : _b.call(_a);\n        }\n        return true;\n      }\n    };\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setWidth(defaultWidth);\n  }, [defaultWidth]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setColor(defaultColor);\n  }, [defaultColor]);\n  return react_1.default.createElement(adhere_ui_flexlayout_1.default.TRBLC.CBLayout, __assign({}, defaultProps, wrapProps, {\n    bProps: __assign(__assign(__assign({}, defaultBProps), toolProps), {\n      children: renderTool\n    }),\n    cProps: __assign(__assign(__assign({}, defaultCProps), areaProps), {\n      children: renderArea\n    })\n  }));\n}));\nSignature.displayName = 'Signature';\nexports.default = Signature;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","ahooks_1","exports","require","antd_1","antd_mobile_1","react_1","react_color_1","adhere_ui_flexlayout_1","adhere_util_intl_1","WritingBoard_1","types_1","selectorPrefix","Signature","memo","forwardRef","_a","ref","wrapProps","toolProps","areaProps","defaultWidth","defaultColor","_b","useState","Mode","FREE","mode","setMode","_c","color","setColor","_d","width","setWidth","writingBoardRef","useRef","defaultProps","useMemo","gutter","wrapClassName","concat","defaultBProps","fit","defaultCProps","autoFixed","renderTool","createElement","Space","direction","size","Stepper","style","max","min","onChange","current","setLineWidth","CompactPicker","onChangeComplete","c","hex","setStrokeStyle","Grid","columns","gap","Item","Button","block","onClick","RUBBER","clear","renderArea","defaultMode","defaultLineWidth","defaultStrokeStyle","useImperativeHandle","save","backgroundColor","type","quality","toDataURL","isEmpty","useUpdateEffect","TRBLC","CBLayout","bProps","children","cProps","displayName"],"mappings":"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"}