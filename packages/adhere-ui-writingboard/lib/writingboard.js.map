{"version":3,"file":"WritingBoard.js","sources":["WritingBoard.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar lodash_debounce_1 = __importDefault(require(\"lodash.debounce\"));\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\nvar resize_observer_1 = require(\"@juggle/resize-observer\");\nvar signature_1 = __importDefault(require(\"./signature\"));\nvar types_1 = require(\"./types\");\nvar selectorPrefix = 'adhere-ui-writing-board';\n/**\n * WritingBoard\n * @param props\n * @param ref\n * @constructor\n */\nvar InternalWritingBoard = (0, react_1.memo)((0, react_1.forwardRef)(function (props, ref) {\n  var _a, _b;\n  var _c = props.defaultMode,\n    defaultMode = _c === void 0 ? types_1.Mode.FREE : _c,\n    _d = props.defaultLineWidth,\n    defaultLineWidth = _d === void 0 ? 2 : _d,\n    _e = props.defaultStrokeStyle,\n    defaultStrokeStyle = _e === void 0 ? '#000' : _e,\n    _f = props.resizeTime,\n    resizeTime = _f === void 0 ? 300 : _f;\n  var containerRef = (0, react_1.useRef)(null);\n  var canvasRef = (0, react_1.useRef)(null);\n  var ctx = (0, react_1.useRef)(null);\n  var ro = (0, react_1.useRef)(null);\n  var startPoint = (0, react_1.useRef)(null);\n  var prePoint = (0, react_1.useRef)(null);\n  var curShape = (0, react_1.useRef)(defaultMode);\n  var lineWidth = (0, react_1.useRef)(defaultLineWidth);\n  var strokeStyle = (0, react_1.useRef)(defaultStrokeStyle);\n  var stack = (0, react_1.useRef)([]);\n  var stackIndex = (0, react_1.useRef)(0);\n  var config = (0, react_1.useRef)(new Map([\n  // 自由模式\n  [types_1.Mode.FREE, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e;\n      var sourcePoint = _a.sourcePoint,\n        targetPoint = _a.targetPoint;\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.beginPath();\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.moveTo(sourcePoint.x, sourcePoint.y);\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(targetPoint.x, targetPoint.y);\n      stack.current.push({\n        shape: curShape.current,\n        sourcePoint: sourcePoint,\n        targetPoint: targetPoint\n      });\n      style({\n        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\n        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current\n      });\n      // 描边\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c, _d;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\n      style({\n        lineWidth: item.lineWidth,\n        strokeStyle: item.strokeStyle\n      });\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\n    },\n    mouseup: function mouseup(point) {\n      draw({\n        sourcePoint: prePoint.current,\n        targetPoint: point\n      });\n    }\n  }],\n  // 直线\n  [types_1.Mode.LINE, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e, _f, _g, _h, _j, _k;\n      var targetPoint = _a.targetPoint;\n      // 清除画布\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\n      drawStack();\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\n      (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.moveTo((_g = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _g === void 0 ? void 0 : _g.x, (_h = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _h === void 0 ? void 0 : _h.y);\n      (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.lineTo(targetPoint.x, targetPoint.y);\n      style({\n        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\n        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current\n      });\n      // 描边\n      (_k = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _k === void 0 ? void 0 : _k.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c, _d;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\n      style({\n        lineWidth: item.lineWidth,\n        strokeStyle: item.strokeStyle\n      });\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\n    },\n    mouseup: function mouseup(point) {\n      var _a, _b;\n      stack.current.push({\n        shape: curShape.current,\n        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\n        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\n        sourcePoint: startPoint.current,\n        targetPoint: point\n      });\n    }\n  }],\n  // 矩形\n  [types_1.Mode.RECTANGLE, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e, _f, _g, _h, _j;\n      var targetPoint = _a.targetPoint;\n      // 清除画布\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\n      drawStack();\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\n      // 判断target在start的四个方向\n      var rectStart = getPoint({\n        startPoint: startPoint.current,\n        targetPoint: targetPoint\n      });\n      (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.rect(rectStart.x, rectStart.y, Math.abs(targetPoint.x - ((_g = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _g === void 0 ? void 0 : _g.x)), Math.abs(targetPoint.y - ((_h = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _h === void 0 ? void 0 : _h.y)));\n      style({\n        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\n        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current\n      });\n      // 描边\n      (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.rect(item.x, item.y, item.width, item.height);\n      style({\n        lineWidth: item.lineWidth,\n        strokeStyle: item.strokeStyle\n      });\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.stroke();\n    },\n    mouseup: function mouseup(point) {\n      var _a, _b, _c, _d;\n      var rectStart = getPoint({\n        startPoint: startPoint.current,\n        targetPoint: point\n      });\n      stack.current.push({\n        shape: curShape.current,\n        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\n        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\n        x: rectStart.x,\n        y: rectStart.y,\n        width: Math.abs(point.x - ((_c = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _c === void 0 ? void 0 : _c.x)),\n        height: Math.abs(point.y - ((_d = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _d === void 0 ? void 0 : _d.y))\n      });\n    }\n  }],\n  // 圆形\n  [types_1.Mode.CIRCLE, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e, _f, _g;\n      var targetPoint = _a.targetPoint;\n      // 清除画布\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\n      drawStack();\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\n      // 判断target在start的四个方向\n      var rectStart = getPoint({\n        startPoint: startPoint.current,\n        targetPoint: targetPoint\n      });\n      var radius = getDistanceByBetweenPoint({\n        p2: targetPoint,\n        p1: startPoint.current\n      });\n      (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.ellipse(rectStart.x, rectStart.y, radius, radius, 45 * Math.PI / 180, 0, 2 * Math.PI);\n      style({\n        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\n        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current\n      });\n      // 描边\n      (_g = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _g === void 0 ? void 0 : _g.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.ellipse(item.x, item.y, item.radiusX, item.radiusY, item.rotation, item.startAngle, item.endAngle);\n      style({\n        lineWidth: item.lineWidth,\n        strokeStyle: item.strokeStyle\n      });\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.stroke();\n    },\n    mouseup: function mouseup(point) {\n      var _a, _b;\n      var center = getPoint({\n        startPoint: startPoint.current,\n        targetPoint: point\n      });\n      var radius = getDistanceByBetweenPoint({\n        p2: point,\n        p1: startPoint === null || startPoint === void 0 ? void 0 : startPoint.current\n      });\n      stack.current.push({\n        shape: curShape.current,\n        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\n        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\n        x: center.x,\n        y: center.y,\n        radiusX: radius,\n        radiusY: radius,\n        rotation: 45 * Math.PI / 180,\n        startAngle: 0,\n        endAngle: 2 * Math.PI\n      });\n    }\n  }],\n  // 三角形(多边形)\n  [types_1.Mode.TRIANGLE, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e, _f, _g, _h, _j, _k;\n      var targetPoint = _a.targetPoint;\n      // 清除画布\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\n      drawStack();\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\n      var points = triangle({\n        startPoint: startPoint.current,\n        targetPoint: targetPoint\n      });\n      (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.moveTo(points[0].x, points[0].y);\n      (_g = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _g === void 0 ? void 0 : _g.lineTo(points[1].x, points[1].y);\n      (_h = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _h === void 0 ? void 0 : _h.lineTo(points[2].x, points[2].y);\n      (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.closePath();\n      style({\n        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\n        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current\n      });\n      // 描边\n      (_k = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _k === void 0 ? void 0 : _k.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c, _d, _e, _f;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.points[0].x, item.points[0].y);\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.points[1].x, item.points[1].y);\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(item.points[2].x, item.points[2].y);\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.closePath();\n      style({\n        lineWidth: item.lineWidth,\n        strokeStyle: item.strokeStyle\n      });\n      (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.stroke();\n    },\n    mouseup: function mouseup(point) {\n      var _a, _b;\n      var points = triangle({\n        startPoint: startPoint.current,\n        targetPoint: point\n      });\n      stack.current.push({\n        shape: curShape.current,\n        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\n        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\n        points: points\n      });\n    }\n  }],\n  // 橡皮\n  [types_1.Mode.RUBBER, {\n    draw: function draw(_a) {\n      var _b, _c, _d, _e;\n      var sourcePoint = _a.sourcePoint,\n        targetPoint = _a.targetPoint;\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.beginPath();\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.moveTo(sourcePoint.x, sourcePoint.y);\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(targetPoint.x, targetPoint.y);\n      stack.current.push({\n        shape: curShape.current,\n        sourcePoint: sourcePoint,\n        targetPoint: targetPoint\n      });\n      ctx.current.lineWidth = 15;\n      ctx.current.strokeStyle = '#fff';\n      ctx.current.lineCap = 'round';\n      ctx.current.lineJoin = 'round';\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.stroke();\n    },\n    drawStack: function drawStack(item) {\n      var _a, _b, _c, _d;\n      (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\n      (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\n      ctx.current.lineWidth = 15;\n      ctx.current.strokeStyle = '#fff';\n      ctx.current.lineCap = 'round';\n      ctx.current.lineJoin = 'round';\n      (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\n    },\n    mouseup: function mouseup(point) {\n      draw({\n        sourcePoint: prePoint.current,\n        targetPoint: point\n      });\n    }\n  }]]));\n  /**\n   * style\n   * @param lineWidth\n   * @param strokeStyle\n   */\n  function style(_a) {\n    var lineWidth = _a.lineWidth,\n      strokeStyle = _a.strokeStyle;\n    ctx.current.lineWidth = lineWidth;\n    ctx.current.strokeStyle = strokeStyle;\n    ctx.current.lineCap = 'round';\n    ctx.current.lineJoin = 'round';\n  }\n  /**\n   * triangle - 获取三角形的三个点坐标\n   * @param startPoint\n   * @param targetPoint\n   */\n  function triangle(_a) {\n    var startPoint = _a.startPoint,\n      targetPoint = _a.targetPoint;\n    var s = getPoint({\n      startPoint: startPoint,\n      targetPoint: targetPoint\n    });\n    var w = Math.abs(targetPoint.x - startPoint.x);\n    var h = Math.abs(targetPoint.y - startPoint.y);\n    var point1 = {\n      x: s.x,\n      y: s.y + h\n    };\n    var point2 = {\n      x: s.x + w / 2,\n      y: s.y\n    };\n    var point3 = {\n      x: s.x + w,\n      y: s.y + h\n    };\n    return [point1, point2, point3];\n  }\n  /**\n   * devicePointToCanvasPoint\n   * @param clientX\n   * @param clientY\n   */\n  function devicePointToCanvasPoint(_a) {\n    var _b;\n    var clientX = _a.clientX,\n      clientY = _a.clientY;\n    var _c = (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.getBoundingClientRect(),\n      x = _c.x,\n      y = _c.y;\n    return {\n      x: clientX - x,\n      y: clientY - y\n    };\n  }\n  /**\n   * getDistanceByBetweenPoint\n   * @description 获取p1,p2两点间的距离\n   * @param p1\n   * @param p2\n   */\n  function getDistanceByBetweenPoint(_a) {\n    var p1 = _a.p1,\n      p2 = _a.p2;\n    var Ax1 = p1.x,\n      Ay1 = p1.y;\n    var Ax2 = p2.x,\n      Ay2 = p2.y;\n    return Math.sqrt(Math.pow(Ax2 - Ax1, 2) + Math.pow(Ay2 - Ay1, 2)); // 计算A1A2的长度\n  }\n  /**\n   * drawStack\n   */\n  function drawStack() {\n    for (var i = 0; i < stack.current.length; i++) {\n      var item = stack.current[i];\n      config.current.get(item.shape).drawStack(item);\n    }\n  }\n  /**\n   * getPoint\n   * @param startPoint\n   * @param targetPoint\n   */\n  function getPoint(_a) {\n    var startPoint = _a.startPoint,\n      targetPoint = _a.targetPoint;\n    if (targetPoint.x <= startPoint.x && targetPoint.y <= startPoint.y) {\n      // leftTop\n      return targetPoint;\n    } else if (targetPoint.x <= startPoint.x && targetPoint.y >= startPoint.y) {\n      // leftBottom\n      return {\n        x: targetPoint.x,\n        y: startPoint.y\n      };\n    } else if (targetPoint.x >= startPoint.x && targetPoint.y <= startPoint.y) {\n      // rightTop\n      return {\n        x: startPoint.x,\n        y: targetPoint.y\n      };\n    } else if (targetPoint.x >= startPoint.x && targetPoint.y >= startPoint.y) {\n      // rightBottom\n      return startPoint;\n    }\n  }\n  /**\n   * draw\n   * @param sourcePoint\n   * @param targetPoint\n   */\n  function draw(_a) {\n    var _b;\n    var sourcePoint = _a.sourcePoint,\n      targetPoint = _a.targetPoint;\n    var entry = (_b = config === null || config === void 0 ? void 0 : config.current) === null || _b === void 0 ? void 0 : _b.get(curShape.current);\n    entry.draw({\n      sourcePoint: sourcePoint,\n      targetPoint: targetPoint\n    });\n  }\n  // 注册事件\n  function onMousemove(e) {\n    move(e);\n  }\n  function onTouchmove(e) {\n    move(__assign(__assign({}, e), {\n      clientX: e.targetTouches[0].clientX,\n      clientY: e.targetTouches[0].clientY\n    }));\n  }\n  function onMouseup(e) {\n    end(e);\n  }\n  function onTouchend(e) {\n    end(__assign(__assign({}, e), {\n      clientX: e.changedTouches[0].clientX,\n      clientY: e.changedTouches[0].clientY\n    }));\n  }\n  /**\n   * start\n   * @param e\n   */\n  function start(e) {\n    var _a, _b, _c, _d;\n    // 屏幕坐标转换成canvas坐标\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    startPoint.current = prePoint.current = devicePointToCanvasPoint({\n      clientX: clientX,\n      clientY: clientY\n    });\n    (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener('mousemove', onMousemove);\n    (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.addEventListener('mouseup', onMouseup);\n    (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _c === void 0 ? void 0 : _c.addEventListener('touchmove', onTouchmove);\n    (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _d === void 0 ? void 0 : _d.addEventListener('touchend', onTouchend);\n  }\n  /**\n   * move\n   * @param e\n   */\n  function move(e) {\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    var point = devicePointToCanvasPoint({\n      clientX: clientX,\n      clientY: clientY\n    });\n    draw({\n      sourcePoint: prePoint.current,\n      targetPoint: point\n    });\n    prePoint.current = point;\n  }\n  /**\n   * end\n   * @param e\n   */\n  function end(e) {\n    var _a, _b, _c, _d, _e;\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    var point = devicePointToCanvasPoint({\n      clientX: clientX,\n      clientY: clientY\n    });\n    (_a = config === null || config === void 0 ? void 0 : config.current.get(curShape.current)) === null || _a === void 0 ? void 0 : _a.mouseup(point);\n    startPoint.current = null;\n    prePoint.current = null;\n    (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('mousemove', onMousemove);\n    (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _c === void 0 ? void 0 : _c.removeEventListener('mouseup', onMouseup);\n    (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _d === void 0 ? void 0 : _d.removeEventListener('touchmove', onTouchmove);\n    (_e = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _e === void 0 ? void 0 : _e.removeEventListener('touchend', onTouchend);\n  }\n  /**\n   * clear\n   */\n  function clear() {\n    var _a, _b, _c;\n    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.clearRect(0, 0, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.height);\n    prePoint.current = startPoint.current = null;\n    stack.current = [];\n    stackIndex.current = 0;\n  }\n  /**\n   * toDataURL\n   * @default canvas导出base64\n   * @param backgroundColor\n   * @param type\n   * @param quality\n   */\n  function toDataURL(backgroundColor, type, quality) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n    if (backgroundColor) {\n      var _m = adhere_util_1.default.colorToRgb(backgroundColor),\n        R = _m[0],\n        G = _m[1],\n        B = _m[2];\n      var fillsIndex = [];\n      // 先设置背景\n      var imageData_1 = (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.getImageData(0, 0, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.height);\n      for (var i = 0; i < ((_d = imageData_1 === null || imageData_1 === void 0 ? void 0 : imageData_1.data) === null || _d === void 0 ? void 0 : _d.length); i += 4) {\n        // 当该像素是透明的，则设置成backgroundColor\n        if (imageData_1.data[i + 3] === 0) {\n          imageData_1.data[i] = R; // R\n          imageData_1.data[i + 1] = G; // G\n          imageData_1.data[i + 2] = B; // B\n          imageData_1.data[i + 3] = 255;\n          fillsIndex.push(i);\n          fillsIndex.push(i + 1);\n          fillsIndex.push(i + 2);\n          fillsIndex.push(i + 3);\n        }\n      }\n      (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.putImageData(imageData_1, 0, 0);\n      // 生成base64字符串\n      var base64 = (_f = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _f === void 0 ? void 0 : _f.toDataURL(type || 'image/png', quality);\n      // 删除背景\n      imageData_1 = (_g = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _g === void 0 ? void 0 : _g.getImageData(0, 0, (_h = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _h === void 0 ? void 0 : _h.width, (_j = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _j === void 0 ? void 0 : _j.height);\n      fillsIndex.forEach(function (index) {\n        imageData_1.data[index] = 0;\n      });\n      (_k = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _k === void 0 ? void 0 : _k.putImageData(imageData_1, 0, 0);\n      return base64;\n    }\n    return (_l = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _l === void 0 ? void 0 : _l.toDataURL(type || 'image/png', quality);\n  }\n  /**\n   * isEmpty\n   * @return {boolean}\n   */\n  function isEmpty() {\n    var _a, _b, _c;\n    // 先设置背景\n    var imageData = (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.getImageData(0, 0, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.height);\n    if (!imageData.data.length) return true;\n    return !imageData.data.some(function (v) {\n      return v !== imageData.data[0];\n    });\n  }\n  (0, react_1.useImperativeHandle)(ref, function () {\n    return {\n      /**\n       * setMode\n       * @param mode\n       */\n      setMode: function setMode(mode) {\n        curShape.current = mode;\n      },\n      /**\n       * setStrokeStyle\n       * @param style\n       */\n      setStrokeStyle: function setStrokeStyle(style) {\n        strokeStyle.current = style;\n      },\n      /**\n       * setLineWidth\n       * @param width\n       */\n      setLineWidth: function setLineWidth(width) {\n        lineWidth.current = width;\n      },\n      /**\n       * clear\n       * @description 清除画布\n       */\n      clear: clear,\n      /**\n       * toDataURL\n       * @description 获取base64\n       * @param backgroundColor 背景色\n       * @param type 导出的图片类型\n       * @param quality 搭配出图片的质量\n       */\n      toDataURL: toDataURL,\n      /**\n       * isEmpty\n       */\n      isEmpty: isEmpty\n    };\n  });\n  (0, react_1.useLayoutEffect)(function () {\n    var _a, _b, _c;\n    ctx.current = (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _a === void 0 ? void 0 : _a.getContext('2d');\n    var onResize = (0, lodash_debounce_1.default)(function () {\n      var _a, _b, _c, _d, _e;\n      canvasRef.current.width = (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.offsetWidth;\n      canvasRef.current.height = (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.offsetHeight;\n      (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.clearRect(0, 0, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.width, (_e = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _e === void 0 ? void 0 : _e.height);\n      drawStack();\n    }, resizeTime);\n    ro.current = new resize_observer_1.ResizeObserver(onResize);\n    (_c = (_b = ro === null || ro === void 0 ? void 0 : ro.current) === null || _b === void 0 ? void 0 : _b.observe) === null || _c === void 0 ? void 0 : _c.call(_b, document.body);\n    return function () {\n      var _a;\n      return (_a = ro === null || ro === void 0 ? void 0 : ro.current) === null || _a === void 0 ? void 0 : _a.disconnect();\n    };\n  }, []);\n  (0, react_1.useLayoutEffect)(function () {\n    var _a, _b;\n    function onMousedown(e) {\n      start(e);\n    }\n    function onTouchstart(e) {\n      start(__assign(__assign({}, e), {\n        clientX: e.targetTouches[0].clientX,\n        clientY: e.targetTouches[0].clientY\n      }));\n    }\n    (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener('mousedown', onMousedown);\n    (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.addEventListener('touchstart', onTouchstart);\n    return function () {\n      var _a, _b;\n      (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('mousedown', onMousedown);\n      (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('touchstart', onTouchstart);\n    };\n  }, []);\n  return react_1.default.createElement(\"div\", {\n    ref: containerRef,\n    className: (0, classnames_1.default)(selectorPrefix, (_a = props.className) !== null && _a !== void 0 ? _a : ''),\n    style: (_b = props.style) !== null && _b !== void 0 ? _b : {}\n  }, react_1.default.createElement(\"canvas\", {\n    ref: canvasRef\n  }));\n}));\nvar WritingBoard = InternalWritingBoard;\nWritingBoard.displayName = 'WritingBoard';\nWritingBoard.Signature = signature_1.default;\nexports.default = WritingBoard;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","classnames_1","exports","require","lodash_debounce_1","react_1","adhere_util_1","resize_observer_1","signature_1","types_1","selectorPrefix","InternalWritingBoard","memo","forwardRef","props","ref","_c","defaultMode","Mode","FREE","_d","defaultLineWidth","_e","defaultStrokeStyle","_f","resizeTime","containerRef","useRef","canvasRef","ctx","ro","startPoint","prePoint","curShape","lineWidth","strokeStyle","stack","stackIndex","config","Map","draw","_a","sourcePoint","targetPoint","_b","current","beginPath","moveTo","x","y","lineTo","push","shape","style","stroke","drawStack","item","mouseup","point","LINE","_k","clearRect","width","height","_g","_h","_j","RECTANGLE","rectStart","getPoint","rect","Math","abs","CIRCLE","radius","getDistanceByBetweenPoint","p2","p1","ellipse","PI","radiusX","radiusY","rotation","startAngle","endAngle","center","TRIANGLE","points","triangle","closePath","RUBBER","lineCap","lineJoin","w","h","devicePointToCanvasPoint","clientX","clientY","getBoundingClientRect","Ax1","Ay1","Ax2","Ay2","sqrt","pow","onMousemove","e","move","onTouchmove","targetTouches","onMouseup","end","onTouchend","changedTouches","start","addEventListener","removeEventListener","clear","toDataURL","backgroundColor","type","quality","_l","_m","colorToRgb","R","G","B","fillsIndex","imageData_1","getImageData","data","putImageData","base64","forEach","index","isEmpty","imageData","some","useImperativeHandle","setMode","mode","setStrokeStyle","setLineWidth","useLayoutEffect","getContext","onResize","offsetWidth","offsetHeight","ResizeObserver","observe","document","body","disconnect","onMousedown","onTouchstart","createElement","className","WritingBoard","displayName","Signature"],"mappings":"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"}