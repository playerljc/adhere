{"version":3,"file":"writingboard.js","sources":["writingboard.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React, { forwardRef, useEffect, useImperativeHandle, useLayoutEffect, useRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport debounce from 'lodash/debounce';\r\n// @ts-ignore\r\nimport { ResizeObserver } from '@juggle/resize-observer';\r\nimport { Mode } from './types';\r\nvar selectorPrefix = 'adhere-ui-writingboard';\r\n/**\r\n * WritingBoard\r\n * @param props\r\n * @param ref\r\n * @constructor\r\n */\r\nfunction WritingBoard(props, ref) {\r\n    var containerRef = useRef(null);\r\n    var canvasRef = useRef(null);\r\n    var ctx = useRef(null);\r\n    var ro = useRef(null);\r\n    var startPoint = useRef(null);\r\n    var prePoint = useRef(null);\r\n    var curShape = useRef(props.defaultMode);\r\n    var lineWidth = useRef(props.defaultLineWidth);\r\n    var strokeStyle = useRef(props.defaultStrokeStyle);\r\n    var stack = useRef([]);\r\n    var stackIndex = useRef(0);\r\n    var config = useRef(new Map([\r\n        // 自由模式\r\n        [\r\n            Mode.FREE,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e;\r\n                    var sourcePoint = _a.sourcePoint, targetPoint = _a.targetPoint;\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.beginPath();\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.moveTo(sourcePoint.x, sourcePoint.y);\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(targetPoint.x, targetPoint.y);\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        sourcePoint: sourcePoint,\r\n                        targetPoint: targetPoint,\r\n                    });\r\n                    style({\r\n                        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\r\n                        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current,\r\n                    });\r\n                    // 描边\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c, _d;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\r\n                    style({\r\n                        lineWidth: item.lineWidth,\r\n                        strokeStyle: item.strokeStyle,\r\n                    });\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    draw({ sourcePoint: prePoint.current, targetPoint: point });\r\n                },\r\n            },\r\n        ],\r\n        // 直线\r\n        [\r\n            Mode.LINE,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n                    var targetPoint = _a.targetPoint;\r\n                    // 清除画布\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\r\n                    drawStack();\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\r\n                    (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.moveTo((_g = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _g === void 0 ? void 0 : _g.x, (_h = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _h === void 0 ? void 0 : _h.y);\r\n                    (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.lineTo(targetPoint.x, targetPoint.y);\r\n                    style({\r\n                        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\r\n                        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current,\r\n                    });\r\n                    // 描边\r\n                    (_k = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _k === void 0 ? void 0 : _k.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c, _d;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\r\n                    style({\r\n                        lineWidth: item.lineWidth,\r\n                        strokeStyle: item.strokeStyle,\r\n                    });\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    var _a, _b;\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\r\n                        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\r\n                        sourcePoint: startPoint.current,\r\n                        targetPoint: point,\r\n                    });\r\n                },\r\n            },\r\n        ],\r\n        // 矩形\r\n        [\r\n            Mode.RECTANGLE,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e, _f, _g, _h, _j;\r\n                    var targetPoint = _a.targetPoint;\r\n                    // 清除画布\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\r\n                    drawStack();\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\r\n                    // 判断target在start的四个方向\r\n                    var rectStart = getPoint({ startPoint: startPoint.current, targetPoint: targetPoint });\r\n                    (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.rect(rectStart.x, rectStart.y, Math.abs(targetPoint.x - ((_g = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _g === void 0 ? void 0 : _g.x)), Math.abs(targetPoint.y - ((_h = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _h === void 0 ? void 0 : _h.y)));\r\n                    style({\r\n                        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\r\n                        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current,\r\n                    });\r\n                    // 描边\r\n                    (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.rect(item.x, item.y, item.width, item.height);\r\n                    style({\r\n                        lineWidth: item.lineWidth,\r\n                        strokeStyle: item.strokeStyle,\r\n                    });\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    var _a, _b, _c, _d;\r\n                    var rectStart = getPoint({ startPoint: startPoint.current, targetPoint: point });\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\r\n                        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\r\n                        x: rectStart.x,\r\n                        y: rectStart.y,\r\n                        width: Math.abs(point.x - ((_c = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _c === void 0 ? void 0 : _c.x)),\r\n                        height: Math.abs(point.y - ((_d = startPoint === null || startPoint === void 0 ? void 0 : startPoint.current) === null || _d === void 0 ? void 0 : _d.y)),\r\n                    });\r\n                },\r\n            },\r\n        ],\r\n        // 圆形\r\n        [\r\n            Mode.CIRCLE,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e, _f, _g;\r\n                    var targetPoint = _a.targetPoint;\r\n                    // 清除画布\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\r\n                    drawStack();\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\r\n                    // 判断target在start的四个方向\r\n                    var rectStart = getPoint({ startPoint: startPoint.current, targetPoint: targetPoint });\r\n                    var radius = getDistanceByBetweenPoint({ p2: targetPoint, p1: startPoint.current });\r\n                    (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.ellipse(rectStart.x, rectStart.y, radius, radius, (45 * Math.PI) / 180, 0, 2 * Math.PI);\r\n                    style({\r\n                        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\r\n                        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current,\r\n                    });\r\n                    // 描边\r\n                    (_g = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _g === void 0 ? void 0 : _g.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.ellipse(item.x, item.y, item.radiusX, item.radiusY, item.rotation, item.startAngle, item.endAngle);\r\n                    style({\r\n                        lineWidth: item.lineWidth,\r\n                        strokeStyle: item.strokeStyle,\r\n                    });\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    var _a, _b;\r\n                    var center = getPoint({ startPoint: startPoint.current, targetPoint: point });\r\n                    var radius = getDistanceByBetweenPoint({ p2: point, p1: startPoint === null || startPoint === void 0 ? void 0 : startPoint.current });\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\r\n                        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\r\n                        x: center.x,\r\n                        y: center.y,\r\n                        radiusX: radius,\r\n                        radiusY: radius,\r\n                        rotation: (45 * Math.PI) / 180,\r\n                        startAngle: 0,\r\n                        endAngle: 2 * Math.PI,\r\n                    });\r\n                },\r\n            },\r\n        ],\r\n        // 三角形(多边形)\r\n        [\r\n            Mode.TRIANGLE,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n                    var targetPoint = _a.targetPoint;\r\n                    // 清除画布\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _d === void 0 ? void 0 : _d.height);\r\n                    drawStack();\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.beginPath();\r\n                    var points = triangle({ startPoint: startPoint.current, targetPoint: targetPoint });\r\n                    (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.moveTo(points[0].x, points[0].y);\r\n                    (_g = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _g === void 0 ? void 0 : _g.lineTo(points[1].x, points[1].y);\r\n                    (_h = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _h === void 0 ? void 0 : _h.lineTo(points[2].x, points[2].y);\r\n                    (_j = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _j === void 0 ? void 0 : _j.closePath();\r\n                    style({\r\n                        lineWidth: lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current,\r\n                        strokeStyle: strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current,\r\n                    });\r\n                    // 描边\r\n                    (_k = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _k === void 0 ? void 0 : _k.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c, _d, _e, _f;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.points[0].x, item.points[0].y);\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.points[1].x, item.points[1].y);\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(item.points[2].x, item.points[2].y);\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.closePath();\r\n                    style({\r\n                        lineWidth: item.lineWidth,\r\n                        strokeStyle: item.strokeStyle,\r\n                    });\r\n                    (_f = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _f === void 0 ? void 0 : _f.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    var _a, _b;\r\n                    var points = triangle({ startPoint: startPoint.current, targetPoint: point });\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        lineWidth: (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.lineWidth,\r\n                        strokeStyle: (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.strokeStyle,\r\n                        points: points,\r\n                    });\r\n                },\r\n            },\r\n        ],\r\n        // 橡皮\r\n        [\r\n            Mode.RUBBER,\r\n            {\r\n                draw: function (_a) {\r\n                    var _b, _c, _d, _e;\r\n                    var sourcePoint = _a.sourcePoint, targetPoint = _a.targetPoint;\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.beginPath();\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.moveTo(sourcePoint.x, sourcePoint.y);\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.lineTo(targetPoint.x, targetPoint.y);\r\n                    stack.current.push({\r\n                        shape: curShape.current,\r\n                        sourcePoint: sourcePoint,\r\n                        targetPoint: targetPoint,\r\n                    });\r\n                    ctx.current.lineWidth = 15;\r\n                    ctx.current.strokeStyle = '#fff';\r\n                    ctx.current.lineCap = 'round';\r\n                    ctx.current.lineJoin = 'round';\r\n                    (_e = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _e === void 0 ? void 0 : _e.stroke();\r\n                },\r\n                drawStack: function (item) {\r\n                    var _a, _b, _c, _d;\r\n                    (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.beginPath();\r\n                    (_b = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _b === void 0 ? void 0 : _b.moveTo(item.sourcePoint.x, item.sourcePoint.y);\r\n                    (_c = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _c === void 0 ? void 0 : _c.lineTo(item.targetPoint.x, item.targetPoint.y);\r\n                    ctx.current.lineWidth = 15;\r\n                    ctx.current.strokeStyle = '#fff';\r\n                    ctx.current.lineCap = 'round';\r\n                    ctx.current.lineJoin = 'round';\r\n                    (_d = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _d === void 0 ? void 0 : _d.stroke();\r\n                },\r\n                mouseup: function (point) {\r\n                    draw({ sourcePoint: prePoint.current, targetPoint: point });\r\n                },\r\n            },\r\n        ],\r\n    ]));\r\n    /**\r\n     * style\r\n     * @param lineWidth\r\n     * @param strokeStyle\r\n     */\r\n    function style(_a) {\r\n        var lineWidth = _a.lineWidth, strokeStyle = _a.strokeStyle;\r\n        ctx.current.lineWidth = lineWidth;\r\n        ctx.current.strokeStyle = strokeStyle;\r\n        ctx.current.lineCap = 'round';\r\n        ctx.current.lineJoin = 'round';\r\n    }\r\n    /**\r\n     * triangle - 获取三角形的三个点坐标\r\n     * @param startPoint\r\n     * @param targetPoint\r\n     */\r\n    function triangle(_a) {\r\n        var startPoint = _a.startPoint, targetPoint = _a.targetPoint;\r\n        var s = getPoint({ startPoint: startPoint, targetPoint: targetPoint });\r\n        var w = Math.abs(targetPoint.x - startPoint.x);\r\n        var h = Math.abs(targetPoint.y - startPoint.y);\r\n        var point1 = {\r\n            x: s.x,\r\n            y: s.y + h,\r\n        };\r\n        var point2 = {\r\n            x: s.x + w / 2,\r\n            y: s.y,\r\n        };\r\n        var point3 = {\r\n            x: s.x + w,\r\n            y: s.y + h,\r\n        };\r\n        return [point1, point2, point3];\r\n    }\r\n    /**\r\n     * devicePointToCanvasPoint\r\n     * @param clientX\r\n     * @param clientY\r\n     */\r\n    function devicePointToCanvasPoint(_a) {\r\n        var _b;\r\n        var clientX = _a.clientX, clientY = _a.clientY;\r\n        var _c = (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.getBoundingClientRect(), x = _c.x, y = _c.y;\r\n        return {\r\n            x: clientX - x,\r\n            y: clientY - y,\r\n        };\r\n    }\r\n    /**\r\n     * getDistanceByBetweenPoint\r\n     * @description 获取p1,p2两点间的距离\r\n     * @param p1\r\n     * @param p2\r\n     */\r\n    function getDistanceByBetweenPoint(_a) {\r\n        var p1 = _a.p1, p2 = _a.p2;\r\n        var Ax1 = p1.x, Ay1 = p1.y;\r\n        var Ax2 = p2.x, Ay2 = p2.y;\r\n        return Math.sqrt(Math.pow(Ax2 - Ax1, 2) + Math.pow(Ay2 - Ay1, 2)); // 计算A1A2的长度\r\n    }\r\n    /**\r\n     * drawStack\r\n     */\r\n    function drawStack() {\r\n        for (var i = 0; i < stack.current.length; i++) {\r\n            var item = stack.current[i];\r\n            config.current.get(item.shape).drawStack(item);\r\n        }\r\n    }\r\n    /**\r\n     * getPoint\r\n     * @param startPoint\r\n     * @param targetPoint\r\n     */\r\n    function getPoint(_a) {\r\n        var startPoint = _a.startPoint, targetPoint = _a.targetPoint;\r\n        if (targetPoint.x <= startPoint.x && targetPoint.y <= startPoint.y) {\r\n            // leftTop\r\n            return targetPoint;\r\n        }\r\n        else if (targetPoint.x <= startPoint.x && targetPoint.y >= startPoint.y) {\r\n            // leftBottom\r\n            return {\r\n                x: targetPoint.x,\r\n                y: startPoint.y,\r\n            };\r\n        }\r\n        else if (targetPoint.x >= startPoint.x && targetPoint.y <= startPoint.y) {\r\n            // rightTop\r\n            return {\r\n                x: startPoint.x,\r\n                y: targetPoint.y,\r\n            };\r\n        }\r\n        else if (targetPoint.x >= startPoint.x && targetPoint.y >= startPoint.y) {\r\n            // rightBottom\r\n            return startPoint;\r\n        }\r\n    }\r\n    /**\r\n     * draw\r\n     * @param sourcePoint\r\n     * @param targetPoint\r\n     */\r\n    function draw(_a) {\r\n        var _b;\r\n        var sourcePoint = _a.sourcePoint, targetPoint = _a.targetPoint;\r\n        var entry = (_b = config === null || config === void 0 ? void 0 : config.current) === null || _b === void 0 ? void 0 : _b.get(curShape.current);\r\n        entry.draw({ sourcePoint: sourcePoint, targetPoint: targetPoint });\r\n    }\r\n    // 注册事件\r\n    function onMousemove(e) {\r\n        move(e);\r\n    }\r\n    function onTouchmove(e) {\r\n        move(__assign(__assign({}, e), { clientX: e.targetTouches[0].clientX, clientY: e.targetTouches[0].clientY }));\r\n    }\r\n    function onMouseup(e) {\r\n        end(e);\r\n    }\r\n    function onTouchend(e) {\r\n        end(__assign(__assign({}, e), { clientX: e.changedTouches[0].clientX, clientY: e.changedTouches[0].clientY }));\r\n    }\r\n    /**\r\n     * start\r\n     * @param e\r\n     */\r\n    function start(e) {\r\n        var _a, _b, _c, _d;\r\n        // 屏幕坐标转换成canvas坐标\r\n        var clientX = e.clientX, clientY = e.clientY;\r\n        startPoint.current = prePoint.current = devicePointToCanvasPoint({ clientX: clientX, clientY: clientY });\r\n        (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener('mousemove', onMousemove);\r\n        (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.addEventListener('mouseup', onMouseup);\r\n        (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _c === void 0 ? void 0 : _c.addEventListener('touchmove', onTouchmove);\r\n        (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _d === void 0 ? void 0 : _d.addEventListener('touchend', onTouchend);\r\n    }\r\n    /**\r\n     * move\r\n     * @param e\r\n     */\r\n    function move(e) {\r\n        var clientX = e.clientX, clientY = e.clientY;\r\n        var point = devicePointToCanvasPoint({ clientX: clientX, clientY: clientY });\r\n        draw({ sourcePoint: prePoint.current, targetPoint: point });\r\n        prePoint.current = point;\r\n    }\r\n    /**\r\n     * end\r\n     * @param e\r\n     */\r\n    function end(e) {\r\n        var _a, _b, _c, _d, _e;\r\n        var clientX = e.clientX, clientY = e.clientY;\r\n        var point = devicePointToCanvasPoint({ clientX: clientX, clientY: clientY });\r\n        (_a = config === null || config === void 0 ? void 0 : config.current.get(curShape.current)) === null || _a === void 0 ? void 0 : _a.mouseup(point);\r\n        startPoint.current = null;\r\n        prePoint.current = null;\r\n        (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('mousemove', onMousemove);\r\n        (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _c === void 0 ? void 0 : _c.removeEventListener('mouseup', onMouseup);\r\n        (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _d === void 0 ? void 0 : _d.removeEventListener('touchmove', onTouchmove);\r\n        (_e = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _e === void 0 ? void 0 : _e.removeEventListener('touchend', onTouchend);\r\n    }\r\n    useImperativeHandle(ref, function () { return ({\r\n        setMode: function (mode) {\r\n            curShape.current = mode;\r\n        },\r\n        setStrokeStyle: function (style) {\r\n            strokeStyle.current = style;\r\n        },\r\n        setLineWidth: function (width) {\r\n            lineWidth.current = width;\r\n        },\r\n        /**\r\n         * clear\r\n         * @description 清除画布\r\n         */\r\n        clear: function () {\r\n            var _a, _b, _c;\r\n            (_a = ctx === null || ctx === void 0 ? void 0 : ctx.current) === null || _a === void 0 ? void 0 : _a.clearRect(0, 0, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _c === void 0 ? void 0 : _c.height);\r\n            prePoint.current = startPoint.current = null;\r\n            stack.current = [];\r\n            stackIndex.current = 0;\r\n        },\r\n        /**\r\n         * toDataURL\r\n         * @description 获取base64\r\n         */\r\n        toDataURL: function () { var _a; return (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _a === void 0 ? void 0 : _a.toDataURL('image/png', 1.0); },\r\n    }); });\r\n    useEffect(function () { }, [lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.current, strokeStyle === null || strokeStyle === void 0 ? void 0 : strokeStyle.current]);\r\n    useLayoutEffect(function () {\r\n        var _a, _b, _c;\r\n        ctx.current = (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.current) === null || _a === void 0 ? void 0 : _a.getContext('2d');\r\n        var onResize = debounce(function () {\r\n            var _a, _b;\r\n            canvasRef.current.width = (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.offsetWidth;\r\n            canvasRef.current.height = (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.offsetHeight;\r\n        }, props.resizeTime);\r\n        ro.current = new ResizeObserver(onResize);\r\n        // @ts-ignore\r\n        (_c = (_b = ro === null || ro === void 0 ? void 0 : ro.current) === null || _b === void 0 ? void 0 : _b.observe) === null || _c === void 0 ? void 0 : _c.call(_b, document.body);\r\n        return function () { var _a; return (_a = ro === null || ro === void 0 ? void 0 : ro.current) === null || _a === void 0 ? void 0 : _a.disconnect(); };\r\n    }, []);\r\n    useLayoutEffect(function () {\r\n        var _a, _b;\r\n        function onMousedown(e) {\r\n            start(e);\r\n        }\r\n        function onTouchstart(e) {\r\n            start(__assign(__assign({}, e), { clientX: e.targetTouches[0].clientX, clientY: e.targetTouches[0].clientY }));\r\n        }\r\n        (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.addEventListener('mousedown', onMousedown);\r\n        (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.addEventListener('touchstart', onTouchstart);\r\n        return function () {\r\n            var _a, _b;\r\n            (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('mousedown', onMousedown);\r\n            (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('touchstart', onTouchstart);\r\n        };\r\n    }, []);\r\n    return (React.createElement(\"div\", { ref: containerRef, className: classNames(selectorPrefix, props.className || ''), style: props.style || {} },\r\n        React.createElement(\"canvas\", { ref: canvasRef })));\r\n}\r\nvar Wrap = forwardRef(WritingBoard);\r\nWrap.defaultProps = {\r\n    className: '',\r\n    style: {},\r\n    defaultMode: Mode.FREE,\r\n    defaultStrokeStyle: '#000',\r\n    defaultLineWidth: 2,\r\n    resizeTime: 300,\r\n};\r\nWrap.propTypes = {\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    // @ts-ignore\r\n    defaultMode: PropTypes.string,\r\n    // @ts-ignore\r\n    defaultStrokeStyle: PropTypes.string,\r\n    // @ts-ignore\r\n    defaultLineWidth: PropTypes.number,\r\n    // @ts-ignore\r\n    resizeTime: PropTypes.number,\r\n};\r\nexport default Wrap;\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","forwardRef","useEffect","useImperativeHandle","useLayoutEffect","useRef","PropTypes","classNames","debounce","ResizeObserver","Mode","selectorPrefix","WritingBoard","props","ref","containerRef","canvasRef","ctx","ro","startPoint","prePoint","curShape","defaultMode","lineWidth","defaultLineWidth","strokeStyle","defaultStrokeStyle","stack","stackIndex","config","Map","FREE","draw","_a","sourcePoint","targetPoint","_b","current","beginPath","_c","moveTo","x","y","_d","lineTo","push","shape","style","_e","stroke","drawStack","item","mouseup","point","LINE","_f","_j","clearRect","width","height","_g","_h","_k","RECTANGLE","rectStart","getPoint","rect","Math","abs","CIRCLE","radius","getDistanceByBetweenPoint","p2","p1","ellipse","PI","radiusX","radiusY","rotation","startAngle","endAngle","center","TRIANGLE","points","triangle","closePath","RUBBER","lineCap","lineJoin","w","h","devicePointToCanvasPoint","clientX","clientY","getBoundingClientRect","Ax1","Ay1","Ax2","Ay2","sqrt","pow","get","onMousemove","e","move","onTouchmove","targetTouches","onMouseup","end","onTouchend","changedTouches","start","addEventListener","removeEventListener","setMode","mode","setStrokeStyle","setLineWidth","clear","toDataURL","getContext","onResize","offsetWidth","offsetHeight","resizeTime","observe","document","body","disconnect","onMousedown","onTouchstart","createElement","className","Wrap","defaultProps","propTypes","string","object","number"],"mappings":"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"}