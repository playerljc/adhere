{"version":3,"file":"index.js","sources":["signature/index.js"],"sourcesContent":["import _Button from \"antd/es/button\";\nimport _InputNumber from \"antd/es/input-number\";\nimport _Space from \"antd/es/space\";\nimport _Card from \"antd/es/card\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport { useUpdateEffect } from 'ahooks';\nimport React, { forwardRef, memo, useCallback, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { CompactPicker } from 'react-color';\nimport FlexLayout from '@baifendian/adhere-ui-flexlayout';\nimport Intl from '@baifendian/adhere-util-intl';\nimport WritingBoard from '../index';\nimport { Mode } from '../types';\nvar selectorPrefix = 'adhere-ui-signature';\n/**\n * Signature\n * @description 签名\n * @param {SignatureProps} props\n * @param ref\n * @constructor\n */\nvar Signature = function Signature(_a, ref) {\n  var wrapProps = _a.wrapProps,\n    toolProps = _a.toolProps,\n    areaProps = _a.areaProps,\n    defaultWidth = _a.defaultWidth,\n    defaultColor = _a.defaultColor;\n  var _b = useState(Mode.FREE),\n    mode = _b[0],\n    setMode = _b[1];\n  var _c = useState(defaultColor !== null && defaultColor !== void 0 ? defaultColor : '#000'),\n    color = _c[0],\n    setColor = _c[1];\n  var _d = useState(defaultWidth !== null && defaultWidth !== void 0 ? defaultWidth : 2),\n    width = _d[0],\n    setWidth = _d[1];\n  var writingBoardRef = useRef(null);\n  var defaultProps = useMemo(function () {\n    return {\n      gutter: 20,\n      wrapClassName: \"\".concat(selectorPrefix, \"-wrap\")\n    };\n  }, []);\n  var defaultLProps = useMemo(function () {\n    return {\n      fit: true\n    };\n  }, []);\n  var defaultCProps = useMemo(function () {\n    return {\n      autoFixed: true\n    };\n  }, []);\n  var renderTool = useCallback(function () {\n    // 线条宽度\n    // 颜色\n    // 橡皮\n    // 预览\n    // 清除\n    return /*#__PURE__*/React.createElement(_Card, null, /*#__PURE__*/React.createElement(_Space, {\n      direction: \"vertical\",\n      size: 20\n    }, /*#__PURE__*/React.createElement(_InputNumber, {\n      style: {\n        width: '100%'\n      },\n      value: width,\n      precision: 0,\n      max: 10,\n      min: 1,\n      onChange: function onChange(v) {\n        setWidth(v);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setLineWidth(v);\n        }\n      }\n    }), /*#__PURE__*/React.createElement(CompactPicker, {\n      color: color,\n      onChangeComplete: function onChangeComplete(c) {\n        setColor(c.hex);\n        if (writingBoardRef.current) {\n          writingBoardRef.current.setStrokeStyle(c.hex);\n        }\n      }\n    }), /*#__PURE__*/React.createElement(_Button, {\n      size: \"large\",\n      block: true,\n      type: \"primary\",\n      onClick: function onClick() {\n        if (writingBoardRef.current) {\n          var v = mode === Mode.FREE ? Mode.RUBBER : Mode.FREE;\n          setMode(v);\n          writingBoardRef.current.setMode(v);\n        }\n      }\n    }, mode === Mode.FREE ? Intl.v('橡皮') : Intl.v('绘制')), /*#__PURE__*/React.createElement(_Button, {\n      size: \"large\",\n      block: true,\n      type: \"primary\",\n      onClick: function onClick() {\n        if (writingBoardRef.current) {\n          writingBoardRef.current.clear();\n        }\n      }\n    }, Intl.v('清除'))));\n  }, [mode, width, color, toolProps]);\n  var renderArea = useCallback(function () {\n    return /*#__PURE__*/React.createElement(_Card, null, /*#__PURE__*/React.createElement(WritingBoard, {\n      ref: writingBoardRef,\n      defaultMode: mode,\n      defaultLineWidth: width,\n      defaultStrokeStyle: color\n    }));\n  }, [areaProps]);\n  useImperativeHandle(ref, function () {\n    return {\n      /**\n       * Save\n       */\n      save: function save(backgroundColor, type, quality) {\n        if (!writingBoardRef.current) return;\n        return writingBoardRef.current.toDataURL(backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : '#fff', type !== null && type !== void 0 ? type : 'image/png', quality !== null && quality !== void 0 ? quality : 1.0);\n      }\n    };\n  });\n  useUpdateEffect(function () {\n    setWidth(defaultWidth);\n  }, [defaultWidth]);\n  useUpdateEffect(function () {\n    setColor(defaultColor);\n  }, [defaultColor]);\n  return /*#__PURE__*/React.createElement(FlexLayout.TRBLC.LCLayout, __assign({}, defaultProps, wrapProps, {\n    lProps: __assign(__assign(__assign({}, defaultLProps), toolProps), {\n      render: renderTool\n    }),\n    cProps: __assign(__assign(__assign({}, defaultCProps), areaProps), {\n      render: renderArea\n    })\n  }));\n};\nexport default /*#__PURE__*/memo( /*#__PURE__*/forwardRef(Signature));"],"names":["_Button","_InputNumber","_Space","_Card","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","useUpdateEffect","React","forwardRef","memo","useCallback","useImperativeHandle","useMemo","useRef","useState","CompactPicker","FlexLayout","Intl","WritingBoard","Mode","selectorPrefix","Signature","_a","ref","wrapProps","toolProps","areaProps","defaultWidth","defaultColor","_b","FREE","mode","setMode","_c","color","setColor","_d","width","setWidth","writingBoardRef","defaultProps","gutter","wrapClassName","concat","defaultLProps","fit","defaultCProps","autoFixed","renderTool","createElement","direction","size","style","value","precision","max","min","onChange","v","current","setLineWidth","onChangeComplete","c","hex","setStrokeStyle","block","type","onClick","RUBBER","clear","renderArea","defaultMode","defaultLineWidth","defaultStrokeStyle","save","backgroundColor","quality","toDataURL","TRBLC","LCLayout","lProps","render","cProps"],"mappings":"OAAOA,YAAa,wBACbC,iBAAkB,8BAClBC,WAAY,uBACZC,UAAW,eAClB,IAAIC,SAAWC,MAAQA,KAAKD,UAAY,WAQtC,OAPAA,SAAWE,OAAOC,QAAU,SAAUC,GACpC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE/C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAAGN,EAAEM,GAAKL,EAAEK,IAE5E,OAAON,CACT,GACgBU,MAAMb,KAAMO,SAAS,CACvC,SACSO,eAA+B,KAAR,gBACzBC,OAASC,WAAYC,KAAMC,YAAaC,oBAAqBC,QAASC,OAAQC,QAAuB,KAAP,eAC5FC,aAAkC,KAAb,qBACvBC,eAAgB,0CAChBC,SAAU,sCACVC,iBAAkB,kBAChBC,IAAsB,KAAV,WACrB,IAAIC,eAAiB,sBAQjBC,UAAY,SAAmBC,EAAIC,GACrC,IAAIC,EAAYF,EAAGE,UACjBC,EAAYH,EAAGG,UACfC,EAAYJ,EAAGI,UACfC,EAAeL,EAAGK,aAClBC,EAAeN,EAAGM,aAChBC,EAAKf,SAASK,KAAKW,IAAI,EACzBC,EAAOF,EAAG,GACVG,EAAUH,EAAG,GACXI,EAAKnB,SAASc,MAAAA,EAAmDA,EAAe,MAAM,EACxFM,EAAQD,EAAG,GACXE,EAAWF,EAAG,GACZG,EAAKtB,SAASa,MAAAA,EAAmDA,EAAe,CAAC,EACnFU,EAAQD,EAAG,GACXE,EAAWF,EAAG,GACZG,EAAkB1B,OAAO,IAAI,EAC7B2B,EAAe5B,QAAQ,WACzB,MAAO,CACL6B,OAAQ,GACRC,cAAe,GAAGC,OAAOvB,eAAgB,OAAO,CAClD,CACF,EAAG,EAAE,EACDwB,EAAgBhC,QAAQ,WAC1B,MAAO,CACLiC,IAAK,CAAA,CACP,CACF,EAAG,EAAE,EACDC,EAAgBlC,QAAQ,WAC1B,MAAO,CACLmC,UAAW,CAAA,CACb,CACF,EAAG,EAAE,EACDC,EAAatC,YAAY,WAM3B,OAAoBH,MAAM0C,cAAc3D,MAAO,KAAmBiB,MAAM0C,cAAc5D,OAAQ,CAC5F6D,UAAW,WACXC,KAAM,EACR,EAAgB5C,MAAM0C,cAAc7D,aAAc,CAChDgE,MAAO,CACLf,MAAO,MACT,EACAgB,MAAOhB,EACPiB,UAAW,EACXC,IAAK,GACLC,IAAK,EACLC,SAAU,SAAkBC,GAC1BpB,EAASoB,CAAC,EACNnB,EAAgBoB,SAClBpB,EAAgBoB,QAAQC,aAAaF,CAAC,CAE1C,CACF,CAAC,EAAgBnD,MAAM0C,cAAclC,cAAe,CAClDmB,MAAOA,EACP2B,iBAAkB,SAA0BC,GAC1C3B,EAAS2B,EAAEC,GAAG,EACVxB,EAAgBoB,SAClBpB,EAAgBoB,QAAQK,eAAeF,EAAEC,GAAG,CAEhD,CACF,CAAC,EAAgBxD,MAAM0C,cAAc9D,QAAS,CAC5CgE,KAAM,QACNc,MAAO,CAAA,EACPC,KAAM,UACNC,QAAS,WACP,IACMT,EADFnB,EAAgBoB,UACdD,EAAI3B,IAASZ,KAAKW,KAAOX,KAAKiD,OAASjD,KAAKW,KAChDE,EAAQ0B,CAAC,EACTnB,EAAgBoB,QAAQ3B,QAAQ0B,CAAC,EAErC,CACF,EAAG3B,IAASZ,KAAKW,KAAOb,KAAKyC,EAAE,IAAI,EAAIzC,KAAKyC,EAAE,IAAI,CAAC,EAAgBnD,MAAM0C,cAAc9D,QAAS,CAC9FgE,KAAM,QACNc,MAAO,CAAA,EACPC,KAAM,UACNC,QAAS,WACH5B,EAAgBoB,SAClBpB,EAAgBoB,QAAQU,MAAM,CAElC,CACF,EAAGpD,KAAKyC,EAAE,IAAI,CAAC,CAAC,CAAC,CACnB,EAAG,CAAC3B,EAAMM,EAAOH,EAAOT,EAAU,EAC9B6C,EAAa5D,YAAY,WAC3B,OAAoBH,MAAM0C,cAAc3D,MAAO,KAAmBiB,MAAM0C,cAAc/B,aAAc,CAClGK,IAAKgB,EACLgC,YAAaxC,EACbyC,iBAAkBnC,EAClBoC,mBAAoBvC,CACtB,CAAC,CAAC,CACJ,EAAG,CAACR,EAAU,EAkBd,OAjBAf,oBAAoBY,EAAK,WACvB,MAAO,CAILmD,KAAM,SAAcC,EAAiBT,EAAMU,GACzC,GAAKrC,EAAgBoB,QACrB,OAAOpB,EAAgBoB,QAAQkB,UAAUF,MAAAA,EAAyDA,EAAkB,OAAQT,MAAAA,EAAmCA,EAAO,YAAaU,MAAAA,EAAyCA,EAAU,CAAG,CAC3O,CACF,CACF,CAAC,EACDtE,gBAAgB,WACdgC,EAASX,CAAY,CACvB,EAAG,CAACA,EAAa,EACjBrB,gBAAgB,WACd6B,EAASP,CAAY,CACvB,EAAG,CAACA,EAAa,EACGrB,MAAM0C,cAAcjC,WAAW8D,MAAMC,SAAUxF,SAAS,GAAIiD,EAAchB,EAAW,CACvGwD,OAAQzF,SAASA,SAASA,SAAS,GAAIqD,CAAa,EAAGnB,CAAS,EAAG,CACjEwD,OAAQjC,CACV,CAAC,EACDkC,OAAQ3F,SAASA,SAASA,SAAS,GAAIuD,CAAa,EAAGpB,CAAS,EAAG,CACjEuD,OAAQX,CACV,CAAC,CACH,CAAC,CAAC,CACJ,iBAC4B7D,KAAmBD,WAAWa,SAAS,CAAC"}