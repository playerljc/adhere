import _Button from"antd-mobile/es/components/button";import _Grid from"antd-mobile/es/components/grid";import _Stepper from"antd-mobile/es/components/stepper";import _Space from"antd/es/space";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};import{useUpdateEffect}from"ahooks";import React,{forwardRef,memo,useImperativeHandle,useMemo,useRef,useState}from"react";import{CompactPicker}from"react-color";import FlexLayout from"@baifendian/adhere-ui-flexlayout";import Intl from"@baifendian/adhere-util-intl";import WritingBoard from"../WritingBoard";import{Mode}from"../types";var selectorPrefix="adhere-ui-signature-core",Signature=memo(forwardRef(function(e,t){var r=e.wrapProps,n=e.toolProps,o=e.areaProps,a=e.defaultWidth,i=e.defaultColor,e=useState(Mode.FREE),u=e[0],c=e[1],e=useState(null!=i?i:"#000"),l=e[0],s=e[1],e=useState(null!=a?a:2),m=e[0],f=e[1],d=useRef({}),e=useMemo(function(){return{gutter:20,wrapClassName:"".concat(selectorPrefix,"-wrap")}},[]),p=useMemo(function(){return{fit:!0}},[]),_=useMemo(function(){return{autoFixed:!0}},[]),g=useMemo(function(){return React.createElement("div",null,React.createElement(_Space,{direction:"vertical",size:20},React.createElement(_Stepper,{style:{width:"100%"},value:m,max:10,min:1,onChange:function(e){f(e),d.current&&d.current.setLineWidth(e)}}),React.createElement(CompactPicker,{color:l,onChangeComplete:function(e){s(e.hex),d.current&&d.current.setStrokeStyle(e.hex)}})),React.createElement(_Grid,{columns:2,gap:8},React.createElement(_Grid.Item,null,React.createElement(_Button,{size:"middle",block:!0,color:"primary",onClick:function(){var e;d.current&&(e=u===Mode.FREE?Mode.RUBBER:Mode.FREE,c(e),d.current.setMode(e))}},u===Mode.FREE?Intl.v("橡皮"):Intl.v("绘制"))),React.createElement(_Grid.Item,null,React.createElement(_Button,{size:"middle",block:!0,color:"primary",onClick:function(){d.current&&d.current.clear()}},Intl.v("清除")))))},[u,m,l,n]),E=useMemo(function(){return React.createElement(WritingBoard,{ref:d,defaultMode:u,defaultLineWidth:m,defaultStrokeStyle:l})},[o]);return useImperativeHandle(t,function(){return{save:function(e,t,r){if(d.current)return d.current.toDataURL(null!=e?e:"#fff",null!=t?t:"image/png",null!=r?r:1)},isEmpty:function(){var e,t;return null==d||!d.current||(null==(t=null==(e=null==d?void 0:d.current)?void 0:e.isEmpty)?void 0:t.call(e))}}}),useUpdateEffect(function(){f(a)},[a]),useUpdateEffect(function(){s(i)},[i]),React.createElement(FlexLayout.TRBLC.CBLayout,__assign({},e,r,{bProps:__assign(__assign(__assign({},p),n),{children:g}),cProps:__assign(__assign(__assign({},_),o),{children:E})}))}));Signature.displayName="Signature";export default Signature;
//# sourceMappingURL=MobileSignatureCore.js.map
