{"version":3,"file":"useSlide.js","sources":["useSlide.js"],"sourcesContent":["// import React from 'react';\r\n// import { ISlideLayoutProps, ISlideLayoutState } from './types';\r\n//\r\n// import { createMask } from './slidelayout';\r\n//\r\n// /**\r\n//  * SlideLayout\r\n//  * @class SlideLayout\r\n//  * @classdesc SlideLayout\r\n//  */\r\n// abstract class SlideLayout<\r\n//   P extends ISlideLayoutProps,\r\n//   S extends ISlideLayoutState,\r\n// > extends React.Component<P, S> {\r\n//   // @ts-ignore\r\n//   protected positionConfig: {\r\n//     init: object;\r\n//     show: object;\r\n//     close: object;\r\n//   } = {};\r\n//\r\n//   protected el: HTMLElement | null | undefined;\r\n//   protected maskEl: HTMLElement | undefined;\r\n//\r\n//   componentWillReceiveProps(nextProps: Readonly<P>, nextContext: any) {\r\n//     if (nextProps.collapse !== this.state.collapse) {\r\n//       this.setState({\r\n//         collapse: nextProps.collapse,\r\n//       });\r\n//     }\r\n//   }\r\n//\r\n//   componentDidMount() {\r\n//     if (this.props.mask) {\r\n//       this.maskEl = createMask(this.props.zIndex, () => {\r\n//         this.close();\r\n//       });\r\n//\r\n//       this.el?.parentElement?.insertBefore(this.maskEl, this.el);\r\n//     }\r\n//\r\n//     this.initial();\r\n//   }\r\n//\r\n//   // @ts-ignore\r\n//   componentDidUpdate(prevProps: Readonly<P>, prevState: S, snapshot?: any) {\r\n//     if (prevState.collapse !== this.state.collapse) {\r\n//       if (this.state.collapse) {\r\n//         // @ts-ignore\r\n//         this.positionConfig['show'][this.props.direction]();\r\n//       } else {\r\n//         // @ts-ignore\r\n//         this.positionConfig['close'][this.props.direction]();\r\n//       }\r\n//     }\r\n//   }\r\n//\r\n//   componentWillUnmount() {\r\n//     if (this.maskEl) {\r\n//       // @ts-ignore\r\n//       this.maskEl.parentElement.removeChild(this.maskEl);\r\n//     }\r\n//   }\r\n//\r\n//   /**\r\n//    * getDuration\r\n//    * @param time\r\n//    */\r\n//   protected getDuration(time: undefined | null | string | number) {\r\n//     return time !== undefined && time !== null ? time : this.props.time;\r\n//   }\r\n//\r\n//   /**\r\n//    * initial\r\n//    */\r\n//   protected initial() {\r\n//     const {\r\n//       el,\r\n//       props: {\r\n//         // @ts-ignore\r\n//         direction,\r\n//         // @ts-ignore\r\n//         width,\r\n//         // @ts-ignore\r\n//         height,\r\n//       },\r\n//     } = this;\r\n//\r\n//     if (direction === 'left' || direction === 'right') {\r\n//       // 赋值宽度\r\n//       // @ts-ignore\r\n//       el?.style.height = '100%';\r\n//       width\r\n//         ? // @ts-ignore\r\n//           (el?.style.width = width)\r\n//         : // @ts-ignore\r\n//           (el?.style.width = `${el?.parentElement?.offsetWidth * 0.9}px`);\r\n//     } else {\r\n//       // 赋值高度\r\n//       // @ts-ignore\r\n//       el?.style.width = '100%';\r\n//       height\r\n//         ? // @ts-ignore\r\n//           (el?.style.height = height)\r\n//         : // @ts-ignore\r\n//           (el?.style.height = `${el?.parentElement?.offsetHeight * 0.3}px`);\r\n//     }\r\n//\r\n//     // 赋值默认位置\r\n//     // @ts-ignore\r\n//     this.positionConfig['init'][this.props.direction]();\r\n//\r\n//     if (this.state.collapse) {\r\n//       // @ts-ignore\r\n//       this.positionConfig['show'][this.props.direction](0);\r\n//     }\r\n//   }\r\n//\r\n//   /**\r\n//    * show\r\n//    */\r\n//   protected show() {\r\n//     const { onBeforeShow } = this.props;\r\n//     if (onBeforeShow) {\r\n//       onBeforeShow();\r\n//     }\r\n//\r\n//     const { direction } = this.props;\r\n//\r\n//     this.setState(\r\n//       {\r\n//         collapse: true,\r\n//       },\r\n//       () => {\r\n//         // @ts-ignore\r\n//         this.positionConfig['show'][direction]();\r\n//       },\r\n//     );\r\n//   }\r\n//\r\n//   /**\r\n//    * close\r\n//    */\r\n//   protected close() {\r\n//     const { onBeforeClose } = this.props;\r\n//     if (onBeforeClose) {\r\n//       onBeforeClose();\r\n//     }\r\n//\r\n//     const { direction } = this.props;\r\n//\r\n//     this.setState(\r\n//       {\r\n//         collapse: false,\r\n//       },\r\n//       () => {\r\n//         // @ts-ignore\r\n//         this.positionConfig['close'][direction]();\r\n//       },\r\n//     );\r\n//   }\r\n// }\r\n//\r\n// export default SlideLayout;\r\nimport { useEffect, useRef, useState, useLayoutEffect, } from 'react';\r\nimport { createMask } from './slidelayout';\r\nexport default (function (props, el, positionConfig) {\r\n    var _a = props.time, time = _a === void 0 ? 300 : _a, _b = props.mask, mask = _b === void 0 ? true : _b, _c = props.zIndex, zIndex = _c === void 0 ? 9999 : _c, _d = props.direction, direction = _d === void 0 ? 'left' : _d, _e = props.width, width = _e === void 0 ? '80%' : _e, _f = props.height, height = _f === void 0 ? '40%' : _f, onBeforeClose = props.onBeforeClose;\r\n    var _g = useState(props.collapse), collapse = _g[0], setCollapse = _g[1];\r\n    var maskEl = useRef();\r\n    function close() {\r\n        onBeforeClose && onBeforeClose();\r\n        setCollapse(false);\r\n    }\r\n    function initial() {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        if (direction === 'left' || direction === 'right') {\r\n            // 赋值宽度\r\n            el.current.style.height = '100%';\r\n            if (typeof width === 'string') {\r\n                el.current.style.width = width;\r\n            }\r\n            else {\r\n                el.current.style.width = ((_a = el.current) === null || _a === void 0 ? void 0 : _a.parentElement).offsetWidth * 0.9 + \"px\";\r\n            }\r\n        }\r\n        else {\r\n            // 赋值高度\r\n            el.current.style.width = '100%';\r\n            if (typeof height === 'string') {\r\n                el.current.style.height = height;\r\n            }\r\n            else {\r\n                el.current.style.height = ((_b = el.current) === null || _b === void 0 ? void 0 : _b.parentElement).offsetHeight * 0.3 + \"px\";\r\n            }\r\n        }\r\n        // 赋值默认位置\r\n        (_d = (_c = positionConfig.current['init'])[direction]) === null || _d === void 0 ? void 0 : _d.call(_c);\r\n        if (collapse) {\r\n            (_f = (_e = positionConfig.current['show'])[direction]) === null || _f === void 0 ? void 0 : _f.call(_e, 0);\r\n        }\r\n    }\r\n    useEffect(function () { return setCollapse(props.collapse); }, [props.collapse]);\r\n    useLayoutEffect(function () {\r\n        var _a;\r\n        if (mask) {\r\n            maskEl.current = createMask(zIndex, function () { return close(); });\r\n            ((_a = el.current) === null || _a === void 0 ? void 0 : _a.parentElement).insertBefore(maskEl.current, el.current);\r\n        }\r\n        initial();\r\n    }, []);\r\n    useLayoutEffect(function () {\r\n        var _a, _b, _c, _d;\r\n        if (collapse) {\r\n            (_b = (_a = positionConfig.current['show'])[direction]) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        }\r\n        else {\r\n            (_d = (_c = positionConfig.current['close'])[direction]) === null || _d === void 0 ? void 0 : _d.call(_c);\r\n        }\r\n    }, [collapse]);\r\n    function getDuration(_time) {\r\n        return _time !== undefined && _time !== null ? _time : time;\r\n    }\r\n    return {\r\n        getDuration: getDuration,\r\n        maskEl: maskEl,\r\n    };\r\n});\r\n"],"names":["useEffect","useRef","useState","useLayoutEffect","createMask","props","el","positionConfig","_a","time","_b","mask","_c","zIndex","_d","direction","_e","width","_f","height","onBeforeClose","_g","collapse","setCollapse","maskEl","current","parentElement","insertBefore","style","offsetWidth","offsetHeight","call","getDuration","_time"],"mappings":"OAoKSA,UAAWC,OAAQC,SAAUC,mCAC7BC,8CACM,SAAWC,EAAOC,EAAIC,GACjC,IAAIC,EAAKH,EAAMI,KAAMA,OAAc,IAAPD,EAAgB,IAAMA,EAAIE,EAAKL,EAAMM,KAAMA,OAAc,IAAPD,GAAuBA,EAAIE,EAAKP,EAAMQ,OAAQA,OAAgB,IAAPD,EAAgB,KAAOA,EAAIE,EAAKT,EAAMU,UAAWA,OAAmB,IAAPD,EAAgB,OAASA,EAAIE,EAAKX,EAAMY,MAAOA,OAAe,IAAPD,EAAgB,MAAQA,EAAIE,EAAKb,EAAMc,OAAQA,OAAgB,IAAPD,EAAgB,MAAQA,EAAIE,EAAgBf,EAAMe,cAC/VC,EAAKnB,SAASG,EAAMiB,UAAWA,EAAWD,EAAG,GAAIE,EAAcF,EAAG,GAClEG,EAASvB,SAsDb,OArBAD,UAAU,WAAc,OAAOuB,EAAYlB,EAAMiB,WAAc,CAACjB,EAAMiB,WACtEnB,gBAAgB,WACZ,IAAIK,EA7BQI,EAAIE,EAAIE,EAAIE,EA8BpBP,IACAa,EAAOC,QAAUrB,WAAWS,EAAQ,WAnCxCO,GAAiBA,IACjBG,GAAY,MAmCe,QAArBf,EAAKF,EAAGmB,eAA4B,IAAPjB,OAAgB,EAASA,EAAGkB,eAAeC,aAAaH,EAAOC,QAASnB,EAAGmB,UA/B5F,SAAdV,GAAsC,UAAdA,GAExBT,EAAGmB,QAAQG,MAAMT,OAAS,OAEtBb,EAAGmB,QAAQG,MAAMX,MADA,iBAAVA,EACkBA,EAGwF,IAAjE,QAArBT,EAAKF,EAAGmB,eAA4B,IAAPjB,OAAgB,EAASA,EAAGkB,eAAeG,YAAoB,OAK3HvB,EAAGmB,QAAQG,MAAMX,MAAQ,OAErBX,EAAGmB,QAAQG,MAAMT,OADC,iBAAXA,EACmBA,EAGyF,IAAlE,QAArBT,EAAKJ,EAAGmB,eAA4B,IAAPf,OAAgB,EAASA,EAAGgB,eAAeI,aAAqB,MAIrE,QAA3DhB,GAAMF,EAAKL,EAAekB,QAAc,MAAGV,UAA+B,IAAPD,GAAyBA,EAAGiB,KAAKnB,GACjGU,GAC4D,QAA3DJ,GAAMF,EAAKT,EAAekB,QAAc,MAAGV,UAA+B,IAAPG,GAAyBA,EAAGa,KAAKf,EAAI,IAW9G,IACHb,gBAAgB,WACZ,IAAYS,EAAIE,EACZQ,EAC4D,QAA3DZ,GAAMF,EAAKD,EAAekB,QAAc,MAAGV,UAA+B,IAAPL,GAAyBA,EAAGqB,KAAKvB,GAGxC,QAA5DM,GAAMF,EAAKL,EAAekB,QAAe,OAAGV,UAA+B,IAAPD,GAAyBA,EAAGiB,KAAKnB,IAE3G,CAACU,IAIG,CACHU,YAJJ,SAAqBC,GACjB,OAAOA,MAAAA,EAAwCA,EAAQxB,GAIvDe,OAAQA"}