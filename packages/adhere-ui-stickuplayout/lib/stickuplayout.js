"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var u in r=arguments[t])Object.prototype.hasOwnProperty.call(r,u)&&(e[u]=r[u]);return e}).apply(this,arguments)},__createBinding=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){e[n=void 0===n?t:n]=r[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(require("react")),classnames_1=__importDefault(require("classnames")),item_1=__importDefault(require("./item")),selectorPrefix="adhere-ui-stickuplayout",StickupLayout=function(e,r){var t=e.className,n=e.style,u=e.fixedClassName,c=e.fixedStyle,i=e.innerClassName,a=e.innerStyle,o=e.onChange,e=e.children,l=react_1.useRef(null),s=react_1.useRef(null),f=react_1.useRef(null),d=react_1.useRef(!1),_=react_1.useRef([]),m=react_1.useRef(),p=react_1.useRef(null),v=react_1.useRef();function h(){return"updateInterval"in screen?screen.updateInterval:16.7}function y(){for(var e,r=f.current.scrollTop,t=0,n=_.current.length-1;t<=n&&t<=_.current.length-1&&n<=_.current.length-1;){var u,c=_.current[u=n+t>>1];if(r>=c.start&&r<c.end){e=c;break}r<c.start?n=u-1:t=1+u}e&&(p.current&&p.current.index===e.index||(p.current=e,s.current.innerHTML=e.dom.outerHTML,o&&o(e.index)))}function g(){d.current=!1,_.current=[],m.current=l.current.querySelectorAll("."+selectorPrefix+"-item-header"),function(){var e=0;_.current=[],p.current=null;for(var r=0,t=m.current.length;r<t;r++){var n=m.current[r],u=e,c=void 0,c=r!==t-1?m.current[r+1].offsetTop-n.offsetHeight:f.current.scrollHeight;if(_.current.push({start:u,end:c,dom:n,index:r}),(e=c)>f.current.scrollHeight-f.current.offsetHeight)break}}(),y(),f.current.removeEventListener("scroll",b),f.current.addEventListener("scroll",b)}function w(t,e){var n,u,c;void 0===t&&(t=0),void 0===e&&(e=300),d.current||("undefined"!=typeof window&&(v.current||(v.current=document.createElement("div"),v.current.className=selectorPrefix+"-mask",window.document.body.appendChild(v.current))),d.current=!0,v.current.style.display="block",n=f.current.scrollTop,u=n,c=f.current.scrollHeight/(e/h()+(e%h()!=0?1:0)),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function r(){d.current=!1,v.current.style.display="none"}n<t?t<u+c?u=t:u+=c:u-c<t?u=t:u-=c,f.current.scrollTop=u,n<t?t<=u?r():"undefined"!=typeof window&&window.requestAnimationFrame(e):u<=t?r():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))}function x(e,r){e=e.start+m.current[e.index].offsetHeight;0===(r=void 0===r?300:r)?f.current.scrollTop=e:w(e,r)}function b(){y()}return react_1.useImperativeHandle(r,function(){return{refresh:g,scrollToByIndex:function(e,r){void 0===r&&(r=300);for(var t,n=0;n<_.current.length;n++)if(_.current[n].index===e){t=_.current[n];break}if(!t)return!1;x(t,r)},scrollToByHeaderEl:function(e,r){void 0===r&&(r=300);for(var t,n=0;n<_.current.length;n++)if(_.current[n].dom===e){t=_.current[n],0;break}if(!t)return!1;x(t,r)}}}),react_1.useLayoutEffect(function(){return g(),function(){var e;v.current&&null!==(e=v.current.parentElement)&&void 0!==e&&e.removeChild(v.current)}},[]),react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix,t),style:n||{},ref:l},react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-fixed",u),style:c||{},ref:s}),react_1.default.createElement("div",{className:classnames_1.default(selectorPrefix+"-inner",i),style:a||{},ref:f},e))},StickupLayoutHOC=__assign({Item:item_1.default},react_1.forwardRef(StickupLayout));exports.default=StickupLayoutHOC;
//# sourceMappingURL=stickuplayout.js.map
