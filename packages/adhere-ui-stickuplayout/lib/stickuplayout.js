"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var u=Object.getOwnPropertyDescriptor(t,r);u&&("get"in u?t.__esModule:!u.writable&&!u.configurable)||(u={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,u)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},classnames_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("classnames"))),react_1=__importStar(require("react")),Item_1=__importDefault(require("./Item")),selectorPrefix="adhere-ui-stickup-layout",InternalStickupLayout=(0,react_1.memo)((0,react_1.forwardRef)(function(e,t){var r=e.className,n=e.style,u=e.fixedClassName,c=e.fixedStyle,l=e.innerClassName,a=e.innerStyle,i=e.onChange,e=e.children,o=(0,react_1.useRef)(null),s=(0,react_1.useRef)(null),f=(0,react_1.useRef)(null),d=(0,react_1.useRef)(!1),_=(0,react_1.useRef)([]),m=(0,react_1.useRef)(),p=(0,react_1.useRef)(null),v=(0,react_1.useRef)();function y(){return"updateInterval"in screen?screen.updateInterval:16.7}function h(){for(var e,t,r=f.current.scrollTop,n=0,u=_.current.length-1;n<=u&&n<=_.current.length-1&&u<=_.current.length-1;){var c,l=_.current[c=u+n>>1];if(r>=l.start&&r<l.end){t=l;break}r<l.start?u=c-1:n=1+c}!t||p.current&&(null==(e=p.current)?void 0:e.index)===t.index||(p.current=t,s.current.innerHTML=t.dom.outerHTML,i&&i(t.index))}function g(){d.current=!1,_.current=[],m.current=null==(t=o.current)?void 0:t.querySelectorAll(".".concat(selectorPrefix,"-item-header"));var e,t,r=0;_.current=[],p.current=null;for(var n=0,u=m.current.length;n<u;n++){var c=m.current[n],l=r,a=void 0,a=n!==u-1?m.current[n+1].offsetTop-c.offsetHeight:f.current.scrollHeight;if(_.current.push({start:l,end:a,dom:c,index:n}),(r=a)>f.current.scrollHeight-f.current.offsetHeight)break}h(),null!=(e=null==(t=f.current)?void 0:t.removeEventListener)&&e.call(t,"scroll",b),null!=(t=null==(e=f.current)?void 0:e.addEventListener)&&t.call(e,"scroll",b)}function w(r,e){var n,u,c;void 0===r&&(r=0),void 0===e&&(e=300),d.current||("undefined"==typeof window||v.current||(v.current=document.createElement("div"),v.current.className="".concat(selectorPrefix,"-mask"),window.document.body.appendChild(v.current)),d.current=!0,v.current.style.display="block",n=f.current.scrollTop,u=n,c=f.current.scrollHeight/(e/y()+(e%y()!=0?1:0)),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function t(){d.current=!1,v.current.style.display="none"}n<r?r<u+c?u=r:u+=c:u-c<r?u=r:u-=c,f.current.scrollTop=u,n<r?r<=u?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):u<=r?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))}function x(e,t){e=e.start+m.current[e.index].offsetHeight;0===(t=void 0===t?300:t)?f.current.scrollTop=e:w(e,t)}function b(){h()}return(0,react_1.useImperativeHandle)(t,function(){return{refresh:g,scrollToByIndex:function(e,t){void 0===t&&(t=300);for(var r,n=0;n<_.current.length;n++)if(_.current[n].index===e){r=_.current[n];break}x(r=r||_.current[_.current.length-1],t)},scrollToByHeaderEl:function(e,t){void 0===t&&(t=300);for(var r,n=0;n<_.current.length;n++)if(_.current[n].dom===e){r=_.current[n],0;break}x(r=r||_.current[_.current.length-1],t)}}}),(0,react_1.useLayoutEffect)(function(){return g(),function(){var e;v.current&&null!=(e=null==(e=v.current)?void 0:e.parentElement)&&e.removeChild(v.current)}},[]),react_1.default.createElement("div",{className:(0,classnames_1.default)(selectorPrefix,null!=r?r:""),style:null!=n?n:{},ref:o},react_1.default.createElement("div",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-fixed"),null!=u?u:""),style:null!=c?c:{},ref:s}),react_1.default.createElement("div",{className:(0,classnames_1.default)("".concat(selectorPrefix,"-inner"),null!=l?l:""),style:null!=a?a:{},ref:f},e))})),StickupLayout=InternalStickupLayout;StickupLayout.displayName="StickupLayout",StickupLayout.Item=Item_1.default,exports.default=StickupLayout;
//# sourceMappingURL=StickUpLayout.js.map
