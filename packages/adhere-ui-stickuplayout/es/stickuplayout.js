import React,{forwardRef,useImperativeHandle,useLayoutEffect,useRef}from"react";import classNames from"classnames";var selectorPrefix="adhere-ui-stickuplayout",StickupLayout=function(e,r){var n=e.className,t=e.style,u=e.fixedClassName,c=e.fixedStyle,o=e.innerClassName,i=e.innerStyle,l=e.onChange,e=e.children,s=useRef(null),a=useRef(null),f=useRef(null),d=useRef(!1),m=useRef([]),v=useRef(),p=useRef(null),y=useRef();function h(){return"updateInterval"in screen?screen.updateInterval:16.7}function w(){for(var e,r=f.current.scrollTop,n=0,t=m.current.length-1;n<=t&&n<=m.current.length-1&&t<=m.current.length-1;){var u,c=m.current[u=t+n>>1];if(r>=c.start&&r<c.end){e=c;break}r<c.start?t=u-1:n=1+u}e&&(p.current&&p.current.index===e.index||(p.current=e,a.current.innerHTML=e.dom.outerHTML,l&&l(e.index)))}function x(){d.current=!1,m.current=[],v.current=s.current.querySelectorAll("."+selectorPrefix+"-item-header"),function(){var e=0;m.current=[],p.current=null;for(var r=0,n=v.current.length;r<n;r++){var t=v.current[r],u=e,c=void 0,c=r!==n-1?v.current[r+1].offsetTop-t.offsetHeight:f.current.scrollHeight;if(m.current.push({start:u,end:c,dom:t,index:r}),(e=c)>f.current.scrollHeight-f.current.offsetHeight)break}}(),w(),f.current.removeEventListener("scroll",H),f.current.addEventListener("scroll",H)}function R(n,e){var t,u,c;void 0===n&&(n=0),void 0===e&&(e=300),d.current||("undefined"!=typeof window&&(y.current||(y.current=document.createElement("div"),y.current.className=selectorPrefix+"-mask",window.document.body.appendChild(y.current))),d.current=!0,y.current.style.display="block",t=f.current.scrollTop,u=t,c=f.current.scrollHeight/(e/h()+(e%h()!=0?1:0)),"undefined"!=typeof window&&window.requestAnimationFrame(function e(){function r(){d.current=!1,y.current.style.display="none"}t<n?n<u+c?u=n:u+=c:u-c<n?u=n:u-=c,f.current.scrollTop=u,t<n?n<=u?r():"undefined"!=typeof window&&window.requestAnimationFrame(e):u<=n?r():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))}function g(e,r){e=e.start+v.current[e.index].offsetHeight;0===(r=void 0===r?300:r)?f.current.scrollTop=e:R(e,r)}function H(){w()}return useImperativeHandle(r,function(){return{refresh:x,scrollToByIndex:function(e,r){void 0===r&&(r=300);for(var n,t=0;t<m.current.length;t++)if(m.current[t].index===e){n=m.current[t];break}if(!n)return!1;g(n,r)},scrollToByHeaderEl:function(e,r){void 0===r&&(r=300);for(var n,t=0;t<m.current.length;t++)if(m.current[t].dom===e){n=m.current[t],0;break}if(!n)return!1;g(n,r)}}}),useLayoutEffect(function(){return x(),function(){var e;y.current&&null!==(e=y.current.parentElement)&&void 0!==e&&e.removeChild(y.current)}},[]),React.createElement("div",{className:classNames(selectorPrefix,n),style:t||{},ref:s},React.createElement("div",{className:classNames(selectorPrefix+"-fixed",u),style:c||{},ref:a}),React.createElement("div",{className:classNames(selectorPrefix+"-inner",o),style:i||{},ref:f},e))};export default forwardRef(StickupLayout);
//# sourceMappingURL=stickuplayout.js.map
