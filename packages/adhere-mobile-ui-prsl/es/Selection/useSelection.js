var __spreadArray=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,o=0,u=r.length;o<u;o++)!n&&o in r||((n=n||Array.prototype.slice.call(r,0,o))[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))};import{useLatest,useUpdateEffect}from"ahooks";import difference from"lodash.difference";import{useMemo,useState}from"react";var DEFAULT_SELECTION_MULTIPLE=!0;export default function UseSelection(e){var r=e.selectedRowKeys,t=e.selectionMultiple,n=e.mode,o=e.dataSource,u=e.rowKey,e=useState(null!=r?r:[]),a=e[0],l=e[1],e=useState(null!=r?r:[]),s=e[0],c=e[1],i=useLatest(a),f=useLatest(s),e=useMemo(function(){return"selection"===n},[n]),d=useMemo(function(){return null!=t?t:DEFAULT_SELECTION_MULTIPLE},[t]);return useUpdateEffect(function(){l(null!=r?r:[]),c(null!=r?r:[])},[r]),{optionSelectedRowKeys:s,targetSelectedRowKeys:a,isUseSelectionMode:e,isSelectionMultiple:d,selectionChange:function(r,t){c(function(e){return r?d?__spreadArray(__spreadArray([],e,!0),[t],!1):[t]:d?e.filter(function(e){return e!==t}):[]})},selectionAllChange:function(r){c(function(e){return r?__spreadArray([],o.map(function(e){return e[u]}),!0):[]})},finish:function(){var e=__spreadArray([],i.current,!0),r=__spreadArray([],f.current,!0),t=(l(r),difference(e,r)),e=difference(r,e);return{selectedRowKeys:r,selectedRows:r.map(function(r){return o.find(function(e){return(null==e?void 0:e[u])===r})}),changeRowKeys:__spreadArray(__spreadArray([],null!=t?t:[],!0),null!=e?e:[],!0),info:{type:(null!=e?e:[]).length?"select":"unselect"}}},cancel:function(){c(__spreadArray([],i.current,!0))}}}
//# sourceMappingURL=useSelection.js.map
