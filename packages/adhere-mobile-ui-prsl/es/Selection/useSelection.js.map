{"version":3,"file":"useSelection.js","sources":["Selection/useSelection.js"],"sourcesContent":["var __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useUpdateEffect } from 'ahooks';\nimport difference from 'lodash.difference';\nimport { useMemo, useState } from 'react';\nvar DEFAULT_SELECTION_MULTIPLE = true;\nexport default function UseSelection(_a) {\n  var selectedRowKeys = _a.selectedRowKeys,\n    selectionMultiple = _a.selectionMultiple,\n    mode = _a.mode,\n    dataSource = _a.dataSource,\n    rowKey = _a.rowKey;\n  var _b = useState(selectedRowKeys !== null && selectedRowKeys !== void 0 ? selectedRowKeys : []),\n    targetSelectedRowKeys = _b[0],\n    setTargetSelectedRowKeys = _b[1];\n  var _c = useState(selectedRowKeys !== null && selectedRowKeys !== void 0 ? selectedRowKeys : []),\n    optionSelectedRowKeys = _c[0],\n    setOptionSelectedRowKeys = _c[1];\n  var isUseSelectionMode = useMemo(function () {\n    return mode === 'selection';\n  }, [mode]);\n  var isSelectionMultiple = useMemo(function () {\n    return selectionMultiple !== null && selectionMultiple !== void 0 ? selectionMultiple : DEFAULT_SELECTION_MULTIPLE;\n  }, [selectionMultiple]);\n  function finish() {\n    var _preSelectedRowKeys = __spreadArray([], targetSelectedRowKeys, true);\n    var _targetSelectedRowKeys = __spreadArray([], optionSelectedRowKeys, true);\n    setTargetSelectedRowKeys(_targetSelectedRowKeys);\n    var removed = difference(_preSelectedRowKeys, _targetSelectedRowKeys);\n    var added = difference(_targetSelectedRowKeys, _preSelectedRowKeys);\n    return {\n      selectedRowKeys: _targetSelectedRowKeys,\n      selectedRows: _targetSelectedRowKeys.map(function (_id) {\n        return dataSource.find(function (r) {\n          return (r === null || r === void 0 ? void 0 : r[rowKey]) === _id;\n        });\n      }),\n      changeRowKeys: __spreadArray(__spreadArray([], removed !== null && removed !== void 0 ? removed : [], true), added !== null && added !== void 0 ? added : [], true),\n      info: {\n        type: (added !== null && added !== void 0 ? added : []).length ? 'select' : 'unselect'\n      }\n    };\n  }\n  function cancel() {\n    setOptionSelectedRowKeys(__spreadArray([], targetSelectedRowKeys, true));\n  }\n  function selectionChange(_checked, _id) {\n    setOptionSelectedRowKeys(function (_optionSelectedRowKeys) {\n      if (_checked) {\n        if (isSelectionMultiple) {\n          return __spreadArray(__spreadArray([], _optionSelectedRowKeys, true), [_id], false);\n        } else {\n          return [_id];\n        }\n      } else {\n        if (isSelectionMultiple) {\n          return _optionSelectedRowKeys.filter(function (_v) {\n            return _v !== _id;\n          });\n        } else {\n          return [];\n        }\n      }\n    });\n  }\n  function selectionAllChange(_checkAll) {\n    setOptionSelectedRowKeys(function (_optionSelectedRowKeys) {\n      if (_checkAll) {\n        return __spreadArray([], dataSource.map(function (t) {\n          return t[rowKey];\n        }), true);\n      } else {\n        return [];\n      }\n    });\n  }\n  useUpdateEffect(function () {\n    setTargetSelectedRowKeys(selectedRowKeys !== null && selectedRowKeys !== void 0 ? selectedRowKeys : []);\n    setOptionSelectedRowKeys(selectedRowKeys !== null && selectedRowKeys !== void 0 ? selectedRowKeys : []);\n  }, [selectedRowKeys]);\n  return {\n    optionSelectedRowKeys: optionSelectedRowKeys,\n    targetSelectedRowKeys: targetSelectedRowKeys,\n    isUseSelectionMode: isUseSelectionMode,\n    isSelectionMultiple: isSelectionMultiple,\n    selectionChange: selectionChange,\n    selectionAllChange: selectionAllChange,\n    finish: finish,\n    cancel: cancel\n  };\n}"],"names":["__spreadArray","this","to","from","pack","arguments","length","ar","i","l","Array","prototype","slice","call","concat","useUpdateEffect","difference","useMemo","useState","DEFAULT_SELECTION_MULTIPLE","UseSelection","_a","selectedRowKeys","selectionMultiple","mode","dataSource","rowKey","_b","targetSelectedRowKeys","setTargetSelectedRowKeys","_c","optionSelectedRowKeys","setOptionSelectedRowKeys","isUseSelectionMode","isSelectionMultiple","selectionChange","_checked","_id","_optionSelectedRowKeys","filter","_v","selectionAllChange","_checkAll","map","t","finish","_preSelectedRowKeys","_targetSelectedRowKeys","removed","added","selectedRows","find","r","changeRowKeys","info","type","cancel"],"mappings":"AAAA,IAAIA,cAAgBC,MAAQA,KAAKD,eAAiB,SAAUE,EAAIC,EAAMC,GACpE,GAAIA,GAA6B,IAArBC,UAAUC,OAAc,IAAK,IAA4BC,EAAxBC,EAAI,EAAGC,EAAIN,EAAKG,OAAYE,EAAIC,EAAGD,CAAC,GAC3ED,CAAAA,GAAQC,KAAKL,KACVI,EAAAA,GAASG,MAAMC,UAAUC,MAAMC,KAAKV,EAAM,EAAGK,CAAC,GAChDA,GAAKL,EAAKK,IAGjB,OAAON,EAAGY,OAAOP,GAAMG,MAAMC,UAAUC,MAAMC,KAAKV,CAAI,CAAC,CACzD,SACSY,eAA+B,KAAR,gBACzBC,eAAgB,2BACdC,QAASC,QAAuB,KAAP,QAClC,IAAIC,2BAA6B,CAAA,iBAClB,SAASC,aAAaC,GACnC,IAAIC,EAAkBD,EAAGC,gBACvBC,EAAoBF,EAAGE,kBACvBC,EAAOH,EAAGG,KACVC,EAAaJ,EAAGI,WAChBC,EAASL,EAAGK,OACVC,EAAKT,SAASI,MAAAA,EAAyDA,EAAkB,EAAE,EAC7FM,EAAwBD,EAAG,GAC3BE,EAA2BF,EAAG,GAC5BG,EAAKZ,SAASI,MAAAA,EAAyDA,EAAkB,EAAE,EAC7FS,EAAwBD,EAAG,GAC3BE,EAA2BF,EAAG,GAC5BG,EAAqBhB,QAAQ,WAC/B,MAAgB,cAATO,CACT,EAAG,CAACA,EAAK,EACLU,EAAsBjB,QAAQ,WAChC,OAAOM,MAAAA,EAA6DA,EAAoBJ,0BAC1F,EAAG,CAACI,EAAkB,EAyDtB,OAJAR,gBAAgB,WACdc,EAAyBP,MAAAA,EAAyDA,EAAkB,EAAE,EACtGU,EAAyBV,MAAAA,EAAyDA,EAAkB,EAAE,CACxG,EAAG,CAACA,EAAgB,EACb,CACLS,sBAAuBA,EACvBH,sBAAuBA,EACvBK,mBAAoBA,EACpBC,oBAAqBA,EACrBC,gBAvCF,SAAyBC,EAAUC,GACjCL,EAAyB,SAAUM,GACjC,OAAIF,EACEF,EACKlC,cAAcA,cAAc,GAAIsC,EAAwB,CAAA,CAAI,EAAG,CAACD,GAAM,CAAA,CAAK,EAE3E,CAACA,GAGNH,EACKI,EAAuBC,OAAO,SAAUC,GAC7C,OAAOA,IAAOH,CAChB,CAAC,EAEM,EAGb,CAAC,CACH,EAsBEI,mBArBF,SAA4BC,GAC1BV,EAAyB,SAAUM,GACjC,OAAII,EACK1C,cAAc,GAAIyB,EAAWkB,IAAI,SAAUC,GAChD,OAAOA,EAAElB,EACX,CAAC,EAAG,CAAA,CAAI,EAED,EAEX,CAAC,CACH,EAYEmB,OA/DF,WACE,IAAIC,EAAsB9C,cAAc,GAAI4B,EAAuB,CAAA,CAAI,EACnEmB,EAAyB/C,cAAc,GAAI+B,EAAuB,CAAA,CAAI,EAEtEiB,GADJnB,EAAyBkB,CAAsB,EACjC/B,WAAW8B,EAAqBC,CAAsB,GAChEE,EAAQjC,WAAW+B,EAAwBD,CAAmB,EAClE,MAAO,CACLxB,gBAAiByB,EACjBG,aAAcH,EAAuBJ,IAAI,SAAUN,GACjD,OAAOZ,EAAW0B,KAAK,SAAUC,GAC/B,OAAQA,MAAAA,EAA6B,KAAA,EAASA,EAAE1B,MAAaW,CAC/D,CAAC,CACH,CAAC,EACDgB,cAAerD,cAAcA,cAAc,GAAIgD,MAAAA,EAAyCA,EAAU,GAAI,CAAA,CAAI,EAAGC,MAAAA,EAAqCA,EAAQ,GAAI,CAAA,CAAI,EAClKK,KAAM,CACJC,MAAON,MAAAA,EAAqCA,EAAQ,IAAI3C,OAAS,SAAW,UAC9E,CACF,CACF,EA8CEkD,OA7CF,WACExB,EAAyBhC,cAAc,GAAI4B,EAAuB,CAAA,CAAI,CAAC,CACzE,CA4CA,CACF"}