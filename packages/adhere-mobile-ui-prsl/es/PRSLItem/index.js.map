{"version":3,"file":"index.js","sources":["PRSLItem/index.js"],"sourcesContent":["import _Radio from \"antd-mobile/es/components/radio\";\nimport _Checkbox from \"antd-mobile/es/components/checkbox\";\nimport classNames from 'classnames';\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { ActionSheetTrigger, ActionSwiper } from '../Action';\nimport Context from '../Context';\nimport { DragHandle, SortableItem } from '../DND';\nvar selectorPrefix = 'adhere-mobile-ui-prsl-item';\n/**\n * PRSLItem\n * @param className\n * @param style\n * @param children\n * @param record\n * @constructor\n */\nvar PRSLItem = function PRSLItem(_a) {\n  var className = _a.className,\n    style = _a.style,\n    children = _a.children,\n    record = _a.record;\n  var _b = useContext(Context),\n    isUseSelectionMode = _b.isUseSelectionMode,\n    isUseDNDMode = _b.isUseDNDMode,\n    getRowKey = _b.getRowKey,\n    getOptionSelectedRowKeys = _b.getOptionSelectedRowKeys,\n    selectionChange = _b.selectionChange,\n    getSelectionMultiple = _b.getSelectionMultiple,\n    getIndexByIdFormOptionDataSource = _b.getIndexByIdFormOptionDataSource,\n    getDndDragHandle = _b.getDndDragHandle,\n    getActionTriggerMode = _b.getActionTriggerMode,\n    onAction = _b.onAction;\n  var rowKey = getRowKey();\n  var id = record === null || record === void 0 ? void 0 : record[rowKey];\n  var rowIndex = getIndexByIdFormOptionDataSource(id);\n  var selectionMultiple = getSelectionMultiple();\n  var optionSelectedRowKeys = getOptionSelectedRowKeys();\n  var actionTriggerMode = getActionTriggerMode();\n  // 每一行Action的配置\n  var actionsConfig = onAction(record, rowIndex);\n  // 是否使用ActionSheet显示Action\n  var isActionSheetTriggerMode = useMemo(function () {\n    return actionTriggerMode === 'ActionSheet';\n  }, [actionTriggerMode]);\n  var wrapper = useCallback(function (_children) {\n    var wrapperMemo = /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(selectorPrefix, className !== null && className !== void 0 ? className : ''),\n      style: style !== null && style !== void 0 ? style : {}\n    }, _children);\n    if (!isActionSheetTriggerMode) {\n      return /*#__PURE__*/React.createElement(ActionSwiper, {\n        config: actionsConfig\n      }, wrapperMemo);\n    }\n    return wrapperMemo;\n  }, [className, style, isActionSheetTriggerMode, actionsConfig]);\n  var childrenWrapper = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-main\")\n    }, children === null || children === void 0 ? void 0 : children({\n      actionSheetTrigger: isActionSheetTriggerMode && actionsConfig.length ? /*#__PURE__*/React.createElement(ActionSheetTrigger, {\n        config: actionsConfig\n      }) : null\n    }));\n  }, [children, isActionSheetTriggerMode, actionsConfig]);\n  function renderChildren() {\n    // 选择模式\n    if (isUseSelectionMode()) {\n      return wrapper( /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-extra\")\n      }, selectionMultiple && /*#__PURE__*/React.createElement(_Checkbox, {\n        checked: optionSelectedRowKeys.includes(id),\n        onChange: function onChange(_checked) {\n          selectionChange(_checked, id);\n        }\n      }), !selectionMultiple && /*#__PURE__*/React.createElement(_Radio, {\n        checked: optionSelectedRowKeys.includes(id),\n        onChange: function onChange(_checked) {\n          selectionChange(_checked, id);\n        }\n      })), childrenWrapper));\n    }\n    // DND模式\n    else if (isUseDNDMode()) {\n      return /*#__PURE__*/React.createElement(SortableItem, {\n        index: rowIndex\n      }, wrapper( /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-extra\")\n      }, /*#__PURE__*/React.createElement(DragHandle, null, getDndDragHandle())), childrenWrapper)));\n    }\n    // 普通的模式\n    else {\n      return wrapper(childrenWrapper);\n    }\n  }\n  return renderChildren();\n};\nexport default PRSLItem;"],"names":["_Radio","_Checkbox","classNames","React","useCallback","useContext","useMemo","ActionSheetTrigger","ActionSwiper","Context","DragHandle","SortableItem","selectorPrefix","PRSLItem","_a","className","style","children","record","_b","isUseSelectionMode","isUseDNDMode","getRowKey","getOptionSelectedRowKeys","selectionChange","getSelectionMultiple","getIndexByIdFormOptionDataSource","getDndDragHandle","getActionTriggerMode","onAction","rowKey","id","rowIndex","selectionMultiple","optionSelectedRowKeys","actionTriggerMode","actionsConfig","isActionSheetTriggerMode","wrapper","_children","wrapperMemo","createElement","config","childrenWrapper","concat","actionSheetTrigger","length","Fragment","checked","includes","onChange","_checked","index"],"mappings":"OAAOA,WAAY,yCACZC,cAAe,4CACfC,eAAgB,oBAChBC,OAASC,YAAaC,WAAYC,OAAsB,KAAP,eAC/CC,mBAAoBC,YAA+B,KAAX,mBAC1CC,YAAa,oBACXC,WAAYC,YAA4B,KAAR,SACzC,IAAIC,eAAiB,6BASjBC,SAAW,SAAkBC,GAC/B,IAAIC,EAAYD,EAAGC,UACjBC,EAAQF,EAAGE,MACXC,EAAWH,EAAGG,SACdC,EAASJ,EAAGI,OACVC,EAAKd,WAAWI,OAAO,EACzBW,EAAqBD,EAAGC,mBACxBC,EAAeF,EAAGE,aAClBC,EAAYH,EAAGG,UACfC,EAA2BJ,EAAGI,yBAC9BC,EAAkBL,EAAGK,gBACrBC,EAAuBN,EAAGM,qBAC1BC,EAAmCP,EAAGO,iCACtCC,EAAmBR,EAAGQ,iBACtBC,EAAuBT,EAAGS,qBAC1BC,EAAWV,EAAGU,SACZC,EAASR,EAAU,EACnBS,EAAKb,MAAAA,EAAuC,KAAA,EAASA,EAAOY,GAC5DE,EAAWN,EAAiCK,CAAE,EAC9CE,EAAoBR,EAAqB,EACzCS,EAAwBX,EAAyB,EACjDY,EAAoBP,EAAqB,EAEzCQ,EAAgBP,EAASX,EAAQc,CAAQ,EAEzCK,EAA2B/B,QAAQ,WACrC,MAA6B,gBAAtB6B,CACT,EAAG,CAACA,EAAkB,EAClBG,EAAUlC,YAAY,SAAUmC,GAC9BC,EAA2BrC,MAAMsC,cAAc,MAAO,CACxD1B,UAAWb,WAAWU,eAAgBG,MAAAA,EAA6CA,EAAY,EAAE,EACjGC,MAAOA,MAAAA,EAAqCA,EAAQ,EACtD,EAAGuB,CAAS,EACZ,OAAKF,EAKEG,EAJerC,MAAMsC,cAAcjC,aAAc,CACpDkC,OAAQN,CACV,EAAGI,CAAW,CAGlB,EAAG,CAACzB,EAAWC,EAAOqB,EAA0BD,EAAc,EAC1DO,EAAkBrC,QAAQ,WAC5B,OAAoBH,MAAMsC,cAAc,MAAO,CAC7C1B,UAAW,GAAG6B,OAAOhC,eAAgB,OAAO,CAC9C,EAAGK,MAAAA,EAA2C,KAAA,EAASA,EAAS,CAC9D4B,mBAAoBR,GAA4BD,EAAcU,OAAsB3C,MAAMsC,cAAclC,mBAAoB,CAC1HmC,OAAQN,CACV,CAAC,EAAI,IACP,CAAC,CAAC,CACJ,EAAG,CAACnB,EAAUoB,EAA0BD,EAAc,EA+BtD,OA5BMhB,EAAmB,EACdkB,EAAsBnC,MAAMsC,cAActC,MAAM4C,SAAU,KAAmB5C,MAAMsC,cAAc,MAAO,CAC7G1B,UAAW,GAAG6B,OAAOhC,eAAgB,QAAQ,CAC/C,EAAGqB,GAAkC9B,MAAMsC,cAAcxC,UAAW,CAClE+C,QAASd,EAAsBe,SAASlB,CAAE,EAC1CmB,SAAU,SAAkBC,GAC1B3B,EAAgB2B,EAAUpB,CAAE,CAC9B,CACF,CAAC,EAAG,CAACE,GAAkC9B,MAAMsC,cAAczC,OAAQ,CACjEgD,QAASd,EAAsBe,SAASlB,CAAE,EAC1CmB,SAAU,SAAkBC,GAC1B3B,EAAgB2B,EAAUpB,CAAE,CAC9B,CACF,CAAC,CAAC,EAAGY,CAAe,CAAC,EAGdtB,EAAa,EACAlB,MAAMsC,cAAc9B,aAAc,CACpDyC,MAAOpB,CACT,EAAGM,EAAsBnC,MAAMsC,cAActC,MAAM4C,SAAU,KAAmB5C,MAAMsC,cAAc,MAAO,CACzG1B,UAAW,GAAG6B,OAAOhC,eAAgB,QAAQ,CAC/C,EAAgBT,MAAMsC,cAAc/B,WAAY,KAAMiB,EAAiB,CAAC,CAAC,EAAGgB,CAAe,CAAC,CAAC,EAItFL,EAAQK,CAAe,CAIpC,iBACe9B"}