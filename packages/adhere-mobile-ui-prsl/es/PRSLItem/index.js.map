{"version":3,"file":"index.js","sources":["PRSLItem/index.js"],"sourcesContent":["import _Radio from \"antd-mobile/es/components/radio\";\nimport _Checkbox from \"antd-mobile/es/components/checkbox\";\nimport classNames from 'classnames';\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { ActionSheetTrigger, ActionSwiper } from '../Action';\nimport Context from '../Context';\nimport { DragHandle, SortableItem } from '../DND';\nvar selectorPrefix = 'adhere-mobile-ui-prsl-item';\n/**\n * PRSLItem\n * @param className\n * @param style\n * @param children\n * @param record\n * @constructor\n */\nvar PRSLItem = function PRSLItem(_a) {\n  var className = _a.className,\n    style = _a.style,\n    children = _a.children,\n    record = _a.record;\n  var _b = useContext(Context),\n    isUseSelectionMode = _b.isUseSelectionMode,\n    isUseDNDMode = _b.isUseDNDMode,\n    getRowKey = _b.getRowKey,\n    getOptionSelectedRowKeys = _b.getOptionSelectedRowKeys,\n    selectionChange = _b.selectionChange,\n    getSelectionMultiple = _b.getSelectionMultiple,\n    getIndexByIdFormOptionDataSource = _b.getIndexByIdFormOptionDataSource,\n    getDndDragHandle = _b.getDndDragHandle,\n    getActionTriggerMode = _b.getActionTriggerMode,\n    getRenderActionSheetTrigger = _b.getRenderActionSheetTrigger,\n    onAction = _b.onAction;\n  var rowKey = getRowKey();\n  var id = record === null || record === void 0 ? void 0 : record[rowKey];\n  var rowIndex = getIndexByIdFormOptionDataSource(id);\n  var selectionMultiple = getSelectionMultiple();\n  var optionSelectedRowKeys = getOptionSelectedRowKeys();\n  var actionTriggerMode = getActionTriggerMode();\n  var actionSheetTrigger = getRenderActionSheetTrigger === null || getRenderActionSheetTrigger === void 0 ? void 0 : getRenderActionSheetTrigger();\n  // 每一行Action的配置\n  var actionsConfig = onAction(record, rowIndex);\n  // 是否使用ActionSheet显示Action\n  var isActionSheetTriggerMode = useMemo(function () {\n    return actionTriggerMode === 'ActionSheet';\n  }, [actionTriggerMode]);\n  var wrapper = useCallback(function (_children) {\n    var wrapperMemo = /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(selectorPrefix, className !== null && className !== void 0 ? className : ''),\n      style: style !== null && style !== void 0 ? style : {}\n    }, _children);\n    if (!isActionSheetTriggerMode) {\n      return /*#__PURE__*/React.createElement(ActionSwiper, {\n        config: actionsConfig\n      }, wrapperMemo);\n    }\n    return wrapperMemo;\n  }, [className, style, isActionSheetTriggerMode, actionsConfig]);\n  var childrenWrapper = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-main\")\n    }, children === null || children === void 0 ? void 0 : children({\n      actionSheetTrigger: isActionSheetTriggerMode && actionsConfig.length ? /*#__PURE__*/React.createElement(ActionSheetTrigger, {\n        config: actionsConfig,\n        actionSheetTrigger: actionSheetTrigger\n      }) : null\n    }));\n  }, [children, isActionSheetTriggerMode, actionsConfig]);\n  function renderChildren() {\n    // 选择模式\n    if (isUseSelectionMode()) {\n      return wrapper( /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-extra\")\n      }, selectionMultiple && /*#__PURE__*/React.createElement(_Checkbox, {\n        checked: optionSelectedRowKeys.includes(id),\n        onChange: function onChange(_checked) {\n          selectionChange(_checked, id);\n        }\n      }), !selectionMultiple && /*#__PURE__*/React.createElement(_Radio, {\n        checked: optionSelectedRowKeys.includes(id),\n        onChange: function onChange(_checked) {\n          selectionChange(_checked, id);\n        }\n      })), childrenWrapper));\n    }\n    // DND模式\n    else if (isUseDNDMode()) {\n      return /*#__PURE__*/React.createElement(SortableItem, {\n        index: rowIndex\n      }, wrapper( /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-extra\")\n      }, /*#__PURE__*/React.createElement(DragHandle, null, getDndDragHandle())), childrenWrapper)));\n    }\n    // 普通的模式\n    else {\n      return wrapper(childrenWrapper);\n    }\n  }\n  return renderChildren();\n};\nexport default PRSLItem;"],"names":["_Radio","_Checkbox","classNames","React","useCallback","useContext","useMemo","ActionSheetTrigger","ActionSwiper","Context","DragHandle","SortableItem","selectorPrefix","PRSLItem","_a","className","style","children","record","_b","isUseSelectionMode","isUseDNDMode","getRowKey","getOptionSelectedRowKeys","selectionChange","getSelectionMultiple","getIndexByIdFormOptionDataSource","getDndDragHandle","getActionTriggerMode","getRenderActionSheetTrigger","onAction","rowKey","id","rowIndex","selectionMultiple","optionSelectedRowKeys","actionTriggerMode","actionSheetTrigger","actionsConfig","isActionSheetTriggerMode","wrapper","_children","wrapperMemo","createElement","config","childrenWrapper","concat","length","Fragment","checked","includes","onChange","_checked","index"],"mappings":"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"}