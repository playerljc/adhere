import _Popup from"@baifendian/adhere-mobile-ui-anthoc/es/popup";import _Dialog from"@baifendian/adhere-mobile-ui-anthoc/es/dialog";import _Modal from"@baifendian/adhere-mobile-ui-anthoc/es/modal";import _CheckList from"antd-mobile/es/components/check-list";import _AppstoreOutline from"antd-mobile-icons/es/AppstoreOutline";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};import{useUpdateEffect}from"ahooks";import React,{useCallback,useMemo,useState}from"react";import AdherePopup from"@baifendian/adhere-ui-popup";import Intl from"@baifendian/adhere-util-intl";import NormalItem from"../NormalItem";var selectorPrefix="adhere-mobile-ui-prsl-toolbar-view-setting-item",ViewSettingItem=function(e){var t=e.children,o=e.disabled,n=e.viewSettingTriggerMode,r=void 0===n?"popup-bottom":n,i=e.viewSettingTriggerProps,a=e.renderViewSetting,l=e.viewSettingConfig,u=e.defaultViewSettingValue,s=e.onViewSetting,p=e.onViewSettingReset,n=useState(null!=u?u:"normal"),m=n[0],c=n[1],d=useMemo(function(){return Array.isArray(m)?m:m?[m]:[]},[m]),g=React.createElement(NormalItem,{key:"view-setting-item",className:selectorPrefix,icon:React.createElement(_AppstoreOutline,null),label:Intl.v("视图")}),f=useMemo(function(){var e;return null!=(e=null==t?void 0:t(g))?e:g},[t,g]),_=useMemo(function(){return"adhere-popup"===r?[{key:"reset",type:"primary",children:Intl.v("重置"),onClick:h}]:[{key:"reset",primary:!0,text:Intl.v("重置"),onClick:h}]},[r]),v=useCallback(function(e){var t=e.close;return a?null==a?void 0:a(null!=m?m:"normal"):React.createElement(_CheckList,{className:"".concat(selectorPrefix,"-list"),value:d,defaultValue:d,multiple:!1,onChange:function(e){var e=e.length?e[0]:"normal";c(e),c(e=e),null!=s&&s(null!=e?e:"normal"),"adhere-popup"===r?AdherePopup.closeAll():null!=t&&t()}},null==l?void 0:l.map(function(e){return React.createElement(_CheckList.Item,{key:e.name,value:e.name,className:"".concat(selectorPrefix,"-list-item")},React.createElement("div",{className:"".concat(selectorPrefix,"-list-item-label")},e.label))}))},[a,l,r,d]),b=useMemo(function(){return"modal"===r?React.createElement(_Modal.Context.Consumer,null,function(e){return v(e)}):"dialog"===r?React.createElement(_Dialog.Context.Consumer,null,function(e){return v(e)}):"popup-bottom"===r?React.createElement(_Popup.Context.Consumer,null,function(e){return v(e)}):v},[r,v]),e=useMemo(function(){var e,t,n=__assign({},i);return["popup-bottom","popup-top","modal","dialog"].includes(null!=r?r:"")?(e=__assign(__assign({},n),{actions:_,popoverTriggerProps:__assign(__assign({},null==i?void 0:i.popoverTriggerProps),{renderTrigger:function(){return f}})}),["popup-bottom","popup-top"].includes(null!=r?r:"")?(t=new Map([["popup-bottom","bottom"],["popup-top","top"]]),t=__assign(__assign({},e),{position:t.get(null!=r?r:"")}),React.createElement(_Popup.Trigger,__assign({disabled:o},t),b)):"modal"===r?React.createElement(_Modal.TriggerPrompt,__assign({disabled:o},e),b):"dialog"===r?React.createElement(_Dialog.TriggerPrompt,__assign({disabled:o},e),b):void 0):"adhere-popup"===r?React.createElement(AdherePopup.Trigger,__assign({},n,{disabled:o,renderTrigger:function(){return f},actions:_}),b):void 0},[r,i,f,b,_]);function h(){return c(null!=u?u:"normal"),p?null==p?void 0:p():Promise.resolve()}return useUpdateEffect(function(){c(null!=u?u:"normal")},[u]),e};ViewSettingItem.displayName="ViewSettingItem";export default ViewSettingItem;
//# sourceMappingURL=index.js.map
