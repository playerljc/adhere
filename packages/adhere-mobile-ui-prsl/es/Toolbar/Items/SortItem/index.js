import _Popup from"@baifendian/adhere-mobile-ui-anthoc/es/popup";import _Dialog from"@baifendian/adhere-mobile-ui-anthoc/es/dialog";import _Modal from"@baifendian/adhere-mobile-ui-anthoc/es/modal";import _SortAscendingOutlined from"@ant-design/icons/es/icons/SortAscendingOutlined";import _SortDescendingOutlined from"@ant-design/icons/es/icons/SortDescendingOutlined";import _List from"antd-mobile/es/components/list";import _TransportQRcodeOutline from"antd-mobile-icons/es/TransportQRcodeOutline";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};import{useUpdateEffect}from"ahooks";import classNames from"classnames";import React,{useCallback,useMemo,useState}from"react";import AdherePopup from"@baifendian/adhere-ui-popup";import Intl from"@baifendian/adhere-util-intl";import NormalItem from"../NormalItem";var selectorPrefix="adhere-mobile-ui-prsl-toolbar-sort-item",SortItem=function(e){var t=e.children,o=e.disabled,r=e.sortTriggerMode,a=void 0===r?"popup-bottom":r,n=e.sortTriggerProps,i=e.renderSort,s=e.sortConfig,l=e.defaultSortValues,c=e.onSort,u=e.onSortReset,r=useState(l),m=r[0],p=r[1],d=React.createElement(NormalItem,{key:"sort-item",className:selectorPrefix,icon:React.createElement(_TransportQRcodeOutline,null),label:Intl.v("排序")}),_=useMemo(function(){var e;return null!=(e=null==t?void 0:t(d))?e:d},[t,d]),f=useMemo(function(){return"adhere-popup"===a?[{key:"reset",type:"primary",children:Intl.v("重置"),onClick:b}]:[{key:"reset",primary:!0,text:Intl.v("重置"),onClick:b}]},[a]),g=useCallback(function(e){var n=e.close;return i?null==i?void 0:i(null!=m?m:[]):React.createElement(_List,{className:"".concat(selectorPrefix,"-list")},null==s?void 0:s.map(function(o){var e;return React.createElement(_List.Item,{key:o.name,className:"".concat(selectorPrefix,"-list-item"),onClick:function(){var t=o,e=__spreadArray([],null!=m?m:[],!0),r=e.findIndex(function(e){return e.name===t.name});-1===r?e.push({name:t.name,order:"asc"}):e[r].order?"asc"===e[r].order?e[r]=__assign(__assign({},e[r]),{order:""}):"desc"===e[r].order&&(e[r]=__assign(__assign({},e[r]),{order:"asc"})):e[r]=__assign(__assign({},e[r]),{order:"desc"}),p(e),null!=c&&c(null!=e?e:[]),"adhere-popup"===a?AdherePopup.closeAll():null!=n&&n()},extra:React.createElement("div",{className:"".concat(selectorPrefix,"-list-item-order")},React.createElement(_SortDescendingOutlined,{className:classNames("".concat(selectorPrefix,"-list-order-item"),((e={})["".concat(selectorPrefix,"-active")]=null==m?void 0:m.some(function(e){return e.name===o.name&&"asc"===e.order}),e))}),React.createElement(_SortAscendingOutlined,{className:classNames("".concat(selectorPrefix,"-list-order-item"),((e={})["".concat(selectorPrefix,"-active")]=null==m?void 0:m.some(function(e){return e.name===o.name&&"desc"===e.order}),e))}))},React.createElement("div",{className:"".concat(selectorPrefix,"-list-item-label")},o.label))}))},[i,s,a,m]),v=useMemo(function(){return"modal"===a?React.createElement(_Modal.Context.Consumer,null,function(e){return g(e)}):"dialog"===a?React.createElement(_Dialog.Context.Consumer,null,function(e){return g(e)}):"popup-bottom"===a?React.createElement(_Popup.Context.Consumer,null,function(e){return g(e)}):g},[a,g]),e=useMemo(function(){var e,t,r=__assign({},n);return["popup-bottom","popup-top","modal","dialog"].includes(null!=a?a:"")?(e=__assign(__assign({},r),{actions:f,popoverTriggerProps:__assign(__assign({},null==n?void 0:n.popoverTriggerProps),{renderTrigger:function(){return _}})}),["popup-bottom","popup-top"].includes(null!=a?a:"")?(t=new Map([["popup-bottom","bottom"],["popup-top","top"]]),t=__assign(__assign({},e),{position:t.get(null!=a?a:"")}),React.createElement(_Popup.Trigger,__assign({disabled:o},t),v)):"modal"===a?React.createElement(_Modal.TriggerPrompt,__assign({disabled:o},e),v):"dialog"===a?React.createElement(_Dialog.TriggerPrompt,__assign({disabled:o},e),v):void 0):"adhere-popup"===a?React.createElement(AdherePopup.Trigger,__assign({},r,{disabled:o,renderTrigger:function(){return _},actions:f}),v):void 0},[a,n,_,v,f]);function b(){return p(l),u?null==u?void 0:u():Promise.resolve()}return useUpdateEffect(function(){p(l)},[l]),e};SortItem.displayName="SortItem";export default SortItem;
//# sourceMappingURL=index.js.map
