{"version":3,"file":"index.js","sources":["Toolbar/Items/SortItem/index.js"],"sourcesContent":["import _Popup from \"@baifendian/adhere-mobile-ui-anthoc/es/popup\";\nimport _Dialog from \"@baifendian/adhere-mobile-ui-anthoc/es/dialog\";\nimport _Modal from \"@baifendian/adhere-mobile-ui-anthoc/es/modal\";\nimport _SortAscendingOutlined from \"@ant-design/icons/es/icons/SortAscendingOutlined\";\nimport _SortDescendingOutlined from \"@ant-design/icons/es/icons/SortDescendingOutlined\";\nimport _List from \"antd-mobile/es/components/list\";\nimport _TransportQRcodeOutline from \"antd-mobile-icons/es/TransportQRcodeOutline\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useUpdateEffect } from 'ahooks';\nimport classNames from 'classnames';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport AdherePopup from '@baifendian/adhere-ui-popup';\nimport Intl from '@baifendian/adhere-util-intl';\nimport NormalItem from '../NormalItem';\nvar selectorPrefix = 'adhere-mobile-ui-prsl-toolbar-sort-item';\n/**\n * SortItem\n * @param children\n * @param sortTriggerMode\n * @param sortTriggerProps\n * @param renderSort\n * @param sortConfig\n * @param defaultSortValues\n * @param onSort\n * @param onSortReset\n * @constructor\n */\nvar SortItem = function (_a) {\n  var children = _a.children,\n    disabled = _a.disabled,\n    _b = _a.sortTriggerMode,\n    sortTriggerMode = _b === void 0 ? 'popup-bottom' : _b,\n    sortTriggerProps = _a.sortTriggerProps,\n    renderSort = _a.renderSort,\n    sortConfig = _a.sortConfig,\n    defaultSortValues = _a.defaultSortValues,\n    onSort = _a.onSort,\n    onSortReset = _a.onSortReset;\n  var _c = useState(defaultSortValues),\n    sortValues = _c[0],\n    setSortValues = _c[1];\n  var defaultElement = /*#__PURE__*/React.createElement(NormalItem, {\n    key: \"sort-item\",\n    className: selectorPrefix,\n    icon: /*#__PURE__*/React.createElement(_TransportQRcodeOutline, null),\n    label: Intl.v('排序')\n  });\n  var triggerElement = useMemo(function () {\n    var _a;\n    return (_a = children === null || children === void 0 ? void 0 : children(defaultElement)) !== null && _a !== void 0 ? _a : defaultElement;\n  }, [children, defaultElement]);\n  var actions = useMemo(function () {\n    if (sortTriggerMode === 'adhere-popup') {\n      return [{\n        key: 'reset',\n        type: 'primary',\n        children: Intl.v('重置'),\n        onClick: reset\n      }];\n    }\n    return [{\n      key: 'reset',\n      primary: true,\n      text: Intl.v('重置'),\n      onClick: reset\n    }];\n  }, [sortTriggerMode]);\n  var renderSortElement = useCallback(function (_a) {\n    var close = _a.close;\n    if (renderSort) {\n      return renderSort === null || renderSort === void 0 ? void 0 : renderSort(sortValues !== null && sortValues !== void 0 ? sortValues : []);\n    }\n    return /*#__PURE__*/React.createElement(_List, {\n      className: \"\".concat(selectorPrefix, \"-list\")\n    }, sortConfig === null || sortConfig === void 0 ? void 0 : sortConfig.map(function (sortValue) {\n      var _a, _b;\n      return /*#__PURE__*/React.createElement(_List.Item, {\n        key: sortValue.name,\n        className: \"\".concat(selectorPrefix, \"-list-item\"),\n        onClick: function () {\n          sort(sortValue);\n          if (sortTriggerMode === 'adhere-popup') {\n            AdherePopup.closeAll();\n          } else {\n            close === null || close === void 0 ? void 0 : close();\n          }\n        },\n        extra: /*#__PURE__*/React.createElement(\"div\", {\n          className: \"\".concat(selectorPrefix, \"-list-item-order\")\n        }, /*#__PURE__*/React.createElement(_SortDescendingOutlined, {\n          className: classNames(\"\".concat(selectorPrefix, \"-list-order-item\"), (_a = {}, _a[\"\".concat(selectorPrefix, \"-active\")] = sortValues === null || sortValues === void 0 ? void 0 : sortValues.some(function (t) {\n            return t.name === sortValue.name && t.order === 'asc';\n          }), _a))\n        }), /*#__PURE__*/React.createElement(_SortAscendingOutlined, {\n          className: classNames(\"\".concat(selectorPrefix, \"-list-order-item\"), (_b = {}, _b[\"\".concat(selectorPrefix, \"-active\")] = sortValues === null || sortValues === void 0 ? void 0 : sortValues.some(function (t) {\n            return t.name === sortValue.name && t.order === 'desc';\n          }), _b))\n        }))\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-list-item-label\")\n      }, sortValue.label));\n    }));\n  }, [renderSort, sortConfig, sortTriggerMode, sortValues]);\n  var triggerContext = useMemo(function () {\n    if (sortTriggerMode === 'modal') {\n      return /*#__PURE__*/React.createElement(_Modal.Context.Consumer, null, function (value) {\n        return renderSortElement(value);\n      });\n    } else if (sortTriggerMode === 'dialog') {\n      return /*#__PURE__*/React.createElement(_Dialog.Context.Consumer, null, function (value) {\n        return renderSortElement(value);\n      });\n    } else if (sortTriggerMode === 'popup-bottom') {\n      return /*#__PURE__*/React.createElement(_Popup.Context.Consumer, null, function (value) {\n        return renderSortElement(value);\n      });\n    } else {\n      return renderSortElement;\n    }\n  }, [sortTriggerMode, renderSortElement]);\n  var childrenElement = useMemo(function () {\n    var commonProps = __assign({}, sortTriggerProps);\n    // hoc\n    if (['popup-bottom', 'popup-top', 'modal', 'dialog'].includes(sortTriggerMode !== null && sortTriggerMode !== void 0 ? sortTriggerMode : '')) {\n      var hocProps = __assign(__assign({}, commonProps), {\n        actions: actions,\n        popoverTriggerProps: __assign(__assign({}, sortTriggerProps === null || sortTriggerProps === void 0 ? void 0 : sortTriggerProps.popoverTriggerProps), {\n          renderTrigger: function () {\n            return triggerElement;\n          }\n        })\n      });\n      // Popup\n      if (['popup-bottom', 'popup-top'].includes(sortTriggerMode !== null && sortTriggerMode !== void 0 ? sortTriggerMode : '')) {\n        var position = new Map([['popup-bottom', 'bottom'], ['popup-top', 'top']]);\n        var popupProps = __assign(__assign({}, hocProps), {\n          position: position.get(sortTriggerMode !== null && sortTriggerMode !== void 0 ? sortTriggerMode : '')\n        });\n        return /*#__PURE__*/React.createElement(_Popup.Trigger, __assign({\n          disabled: disabled\n        }, popupProps), triggerContext);\n      }\n      // Modal\n      else if (sortTriggerMode === 'modal') {\n        return /*#__PURE__*/React.createElement(_Modal.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), triggerContext);\n      }\n      // Dialog\n      else if (sortTriggerMode === 'dialog') {\n        return /*#__PURE__*/React.createElement(_Dialog.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), triggerContext);\n      }\n    }\n    // adhere-popup\n    else if (sortTriggerMode === 'adhere-popup') {\n      return /*#__PURE__*/React.createElement(AdherePopup.Trigger, __assign({}, commonProps, {\n        disabled: disabled,\n        renderTrigger: function () {\n          return triggerElement;\n        },\n        actions: actions\n      }), triggerContext);\n    }\n  }, [sortTriggerMode, sortTriggerProps, triggerElement, triggerContext, actions]);\n  function sort(sortItemConfig) {\n    var draft = __spreadArray([], sortValues !== null && sortValues !== void 0 ? sortValues : [], true);\n    var sortValueIndex = draft.findIndex(function (t) {\n      return t.name === sortItemConfig.name;\n    });\n    if (sortValueIndex === -1) {\n      draft.push({\n        name: sortItemConfig.name,\n        order: 'asc'\n      });\n    } else {\n      if (!draft[sortValueIndex].order) {\n        draft[sortValueIndex] = __assign(__assign({}, draft[sortValueIndex]), {\n          order: 'desc'\n        });\n      } else {\n        if (draft[sortValueIndex].order === 'asc') {\n          draft[sortValueIndex] = __assign(__assign({}, draft[sortValueIndex]), {\n            order: ''\n          });\n        } else if (draft[sortValueIndex].order === 'desc') {\n          draft[sortValueIndex] = __assign(__assign({}, draft[sortValueIndex]), {\n            order: 'asc'\n          });\n        }\n      }\n    }\n    setSortValues(draft);\n    return onSort === null || onSort === void 0 ? void 0 : onSort(draft !== null && draft !== void 0 ? draft : []);\n  }\n  function reset() {\n    setSortValues(defaultSortValues);\n    if (!onSortReset) return Promise.resolve();\n    return onSortReset === null || onSortReset === void 0 ? void 0 : onSortReset();\n  }\n  useUpdateEffect(function () {\n    setSortValues(defaultSortValues);\n  }, [defaultSortValues]);\n  return childrenElement;\n};\nSortItem.displayName = 'SortItem';\nexport default SortItem;"],"names":["_Popup","_Dialog","_Modal","_SortAscendingOutlined","_SortDescendingOutlined","_List","_TransportQRcodeOutline","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","ar","l","Array","slice","concat","useUpdateEffect","classNames","React","useCallback","useMemo","useState","AdherePopup","Intl","NormalItem","selectorPrefix","SortItem","_a","children","disabled","_b","sortTriggerMode","sortTriggerProps","renderSort","sortConfig","defaultSortValues","onSort","onSortReset","_c","sortValues","setSortValues","defaultElement","createElement","key","className","icon","label","v","triggerElement","actions","type","onClick","reset","primary","text","renderSortElement","close","map","sortValue","Item","name","sort","sortItemConfig","draft","sortValueIndex","findIndex","push","order","closeAll","extra","some","triggerContext","Context","Consumer","value","childrenElement","hocProps","popupProps","commonProps","includes","popoverTriggerProps","renderTrigger","position","Map","get","Trigger","TriggerPrompt","Promise","resolve","displayName"],"mappings":"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"}