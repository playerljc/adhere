{"version":3,"file":"index.js","sources":["Toolbar/Items/FilterItem/index.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar antd_mobile_1 = require(\"antd-mobile\");\nvar antd_mobile_icons_1 = require(\"antd-mobile-icons\");\nvar lodash_isempty_1 = __importDefault(require(\"lodash.isempty\"));\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_mobile_ui_anthoc_1 = require(\"@baifendian/adhere-mobile-ui-anthoc\");\nvar adhere_ui_popup_1 = __importDefault(require(\"@baifendian/adhere-ui-popup\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar NormalItem_1 = __importDefault(require(\"../NormalItem\"));\nvar selectorPrefix = 'adhere-mobile-ui-prsl-toolbar-filter-item';\n/**\n * FilterItem\n * @param children\n * @param disabled\n * @param filterTriggerMode\n * @param filterTriggerProps\n * @param renderFilter\n * @param filterFormProps\n * @param filterConfig\n * @param defaultFilterValues\n * @param onFilter\n * @param onFilterReset\n * @constructor\n */\nvar FilterItem = function (_a) {\n  var children = _a.children,\n    disabled = _a.disabled,\n    _b = _a.filterTriggerMode,\n    filterTriggerMode = _b === void 0 ? 'popup-bottom' : _b,\n    _c = _a.filterTriggerProps,\n    filterTriggerProps = _c === void 0 ? {} : _c,\n    renderFilter = _a.renderFilter,\n    filterFormProps = _a.filterFormProps,\n    filterConfig = _a.filterConfig,\n    defaultFilterValues = _a.defaultFilterValues,\n    onFilter = _a.onFilter,\n    onFilterReset = _a.onFilterReset;\n  var form = antd_mobile_1.Form.useForm()[0];\n  var defaultElement = react_1.default.createElement(NormalItem_1.default, {\n    key: \"filter-item\",\n    className: selectorPrefix,\n    icon: react_1.default.createElement(antd_mobile_icons_1.FilterOutline, null),\n    label: adhere_util_intl_1.default.v('筛选')\n  });\n  var triggerElement = (0, react_1.useMemo)(function () {\n    var _a;\n    return (_a = children === null || children === void 0 ? void 0 : children(defaultElement)) !== null && _a !== void 0 ? _a : defaultElement;\n  }, [children, defaultElement]);\n  var actions = (0, react_1.useMemo)(function () {\n    if (filterTriggerMode === 'adhere-popup') {\n      return [{\n        key: 'ok',\n        type: 'primary',\n        children: adhere_util_intl_1.default.v('确定'),\n        onClick: search\n      }, {\n        key: 'reset',\n        type: 'primary',\n        children: adhere_util_intl_1.default.v('重置'),\n        onClick: reset\n      }];\n    }\n    return [{\n      key: 'ok',\n      primary: true,\n      text: adhere_util_intl_1.default.v('确定'),\n      onClick: search\n    }, {\n      key: 'reset',\n      primary: true,\n      text: adhere_util_intl_1.default.v('重置'),\n      onClick: reset\n    }];\n  }, [filterTriggerMode]);\n  var searchElement = (0, react_1.useMemo)(function () {\n    if (renderFilter) {\n      return renderFilter === null || renderFilter === void 0 ? void 0 : renderFilter(defaultFilterValues !== null && defaultFilterValues !== void 0 ? defaultFilterValues : {});\n    }\n    return react_1.default.createElement(antd_mobile_1.Form, __assign({\n      form: form,\n      layout: \"horizontal\"\n    }, filterFormProps), filterConfig === null || filterConfig === void 0 ? void 0 : filterConfig.map(function (_a) {\n      var key = _a.key,\n        name = _a.name,\n        label = _a.label,\n        formItemProps = _a.formItemProps,\n        render = _a.render;\n      return react_1.default.createElement(antd_mobile_1.Form.Item, __assign({\n        key: key,\n        name: name,\n        label: label\n      }, formItemProps !== null && formItemProps !== void 0 ? formItemProps : {}), render === null || render === void 0 ? void 0 : render(form));\n    }));\n  }, [renderFilter, defaultFilterValues]);\n  var childrenElement = (0, react_1.useMemo)(function () {\n    var commonProps = __assign({}, filterTriggerProps);\n    // hoc\n    if (['popup-bottom', 'popup-top', 'modal', 'dialog'].includes(filterTriggerMode !== null && filterTriggerMode !== void 0 ? filterTriggerMode : '')) {\n      var hocProps = __assign(__assign({}, commonProps), {\n        actions: actions,\n        popoverTriggerProps: __assign(__assign({}, filterTriggerProps === null || filterTriggerProps === void 0 ? void 0 : filterTriggerProps.popoverTriggerProps), {\n          renderTrigger: function () {\n            return triggerElement;\n          }\n        })\n      });\n      // Popup\n      if (['popup-bottom', 'popup-top'].includes(filterTriggerMode !== null && filterTriggerMode !== void 0 ? filterTriggerMode : '')) {\n        var position = new Map([['popup-bottom', 'bottom'], ['popup-top', 'top']]);\n        var popupProps = __assign(__assign({}, hocProps), {\n          position: position.get(filterTriggerMode !== null && filterTriggerMode !== void 0 ? filterTriggerMode : '')\n        });\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Popup.Trigger, __assign({\n          disabled: disabled\n        }, popupProps), searchElement);\n      }\n      // Modal\n      else if (filterTriggerMode === 'modal') {\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Modal.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), searchElement);\n      }\n      // Dialog\n      else if (filterTriggerMode === 'dialog') {\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Dialog.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), searchElement);\n      }\n    }\n    // adhere-popup\n    else if (filterTriggerMode === 'adhere-popup') {\n      return react_1.default.createElement(adhere_ui_popup_1.default.Trigger, __assign({}, commonProps, {\n        disabled: disabled,\n        renderTrigger: function () {\n          return triggerElement;\n        },\n        actions: actions\n      }), searchElement);\n    }\n  }, [filterTriggerMode, filterTriggerProps, triggerElement, searchElement, actions, disabled]);\n  function search() {\n    if (!onFilter) return Promise.resolve();\n    var filterData = form ? form.getFieldsValue() : defaultFilterValues;\n    return onFilter === null || onFilter === void 0 ? void 0 : onFilter(filterData);\n  }\n  function reset() {\n    // @ts-ignore\n    form === null || form === void 0 ? void 0 : form.resetFields((0, lodash_isempty_1.default)(defaultFilterValues) ? undefined : defaultFilterValues);\n    if (!onFilterReset) {\n      return Promise.resolve();\n    }\n    return onFilterReset === null || onFilterReset === void 0 ? void 0 : onFilterReset();\n  }\n  (0, ahooks_1.useMount)(function () {\n    if (!form) return;\n    form.setFieldsValue(defaultFilterValues);\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    if (!form) return;\n    if (!defaultFilterValues) {\n      form.resetFields();\n    } else {\n      form.setFieldsValue(defaultFilterValues);\n    }\n  }, [defaultFilterValues]);\n  return childrenElement;\n};\nFilterItem.displayName = 'FilterItem';\nexports.default = FilterItem;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","ahooks_1","exports","require","antd_mobile_1","antd_mobile_icons_1","lodash_isempty_1","react_1","adhere_mobile_ui_anthoc_1","adhere_ui_popup_1","adhere_util_intl_1","NormalItem_1","selectorPrefix","FilterItem","_a","children","disabled","_b","filterTriggerMode","_c","filterTriggerProps","renderFilter","filterFormProps","filterConfig","defaultFilterValues","onFilter","onFilterReset","form","Form","useForm","defaultElement","createElement","key","className","icon","FilterOutline","label","triggerElement","useMemo","actions","type","onClick","search","reset","primary","text","searchElement","layout","map","name","formItemProps","render","Item","childrenElement","hocProps","popupProps","commonProps","includes","popoverTriggerProps","renderTrigger","position","Map","Popup","Trigger","Modal","TriggerPrompt","Dialog","filterData","getFieldsValue","Promise","resolve","resetFields","useMount","setFieldsValue","useUpdateEffect","displayName"],"mappings":"AAAA,aAEA,IAAIA,SAA0C,WAQ5C,OAPAA,SAAWC,OAAOC,QAAU,SAAUC,GACpC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,CAAC,GAE/C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,CAAC,IAAGN,EAAEM,GAAKL,EAAEK,IAE5E,OAAON,CACT,GACgBU,MAAMC,KAAMP,SAAS,CACvC,EACIQ,gBAAyDd,OAAOe,OAAS,SAAUC,EAAGC,EAAGC,EAAGC,GACnFC,KAAAA,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOrB,OAAOsB,yBAAyBL,EAAGC,CAAC,EAC1CG,IAAS,QAASA,EAAQJ,EAAEM,WAAaF,CAAAA,EAAKG,UAAYH,CAAAA,EAAKI,gBAClEJ,EAAO,CACLK,WAAY,CAAA,EACZC,IAAK,WACH,OAAOV,EAAEC,EACX,CACF,GAEFlB,OAAO4B,eAAeZ,EAAGG,EAAIE,CAAI,CACnC,EAAI,SAAUL,EAAGC,EAAGC,EAAGC,GAErBH,EADsBG,EAAXC,KAAAA,IAAPD,EAAuBD,EACzBC,GAAMF,EAAEC,EACZ,EACIW,mBAA+D7B,OAAOe,OAAS,SAAUC,EAAGc,GAC9F9B,OAAO4B,eAAeZ,EAAG,UAAW,CAClCU,WAAY,CAAA,EACZK,MAAOD,CACT,CAAC,CACH,EAAI,SAAUd,EAAGc,GACfd,EAAW,QAAIc,CACjB,EACIE,aAAkD,SAAUC,GAC9D,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,GACb,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBlB,OAAOS,UAAUC,eAAeC,KAAKsB,EAAKf,CAAC,GAAGJ,gBAAgBoB,EAAQD,EAAKf,CAAC,EAEvI,OADAW,mBAAmBK,EAAQD,CAAG,EACvBC,CACT,EACIC,gBAAwD,SAAUF,GACpE,OAAOA,GAAOA,EAAIV,WAAaU,EAAM,CACnCG,QAAWH,CACb,CACF,EAIII,UAHJrC,OAAO4B,eAAeU,QAAS,aAAc,CAC3CP,MAAO,CAAA,CACT,CAAC,EACcQ,QAAQ,QAAQ,GAC3BC,cAAgBD,QAAQ,aAAa,EACrCE,oBAAsBF,QAAQ,mBAAmB,EACjDG,iBAAmBP,gBAAgBI,QAAQ,gBAAgB,CAAC,EAC5DI,QAAUX,aAAaO,QAAQ,OAAO,CAAC,EACvCK,0BAA4BL,QAAQ,qCAAqC,EACzEM,kBAAoBV,gBAAgBI,QAAQ,6BAA6B,CAAC,EAC1EO,mBAAqBX,gBAAgBI,QAAQ,8BAA8B,CAAC,EAC5EQ,aAAeZ,gBAAgBI,QAAQ,eAAe,CAAC,EACvDS,eAAiB,4CAejBC,WAAa,SAAUC,GACzB,IAAIC,EAAWD,EAAGC,SAChBC,EAAWF,EAAGE,SACdC,EAAKH,EAAGI,kBACRA,EAA2B,KAAA,IAAPD,EAAgB,eAAiBA,EACrDE,EAAKL,EAAGM,mBACRA,EAA4B,KAAA,IAAPD,EAAgB,GAAKA,EAC1CE,EAAeP,EAAGO,aAClBC,EAAkBR,EAAGQ,gBACrBC,EAAeT,EAAGS,aAClBC,EAAsBV,EAAGU,oBACzBC,EAAWX,EAAGW,SACdC,EAAgBZ,EAAGY,cACjBC,EAAOvB,cAAcwB,KAAKC,QAAQ,EAAE,GACpCC,EAAiBvB,QAAQP,QAAQ+B,cAAcpB,aAAaX,QAAS,CACvEgC,IAAK,cACLC,UAAWrB,eACXsB,KAAM3B,QAAQP,QAAQ+B,cAAc1B,oBAAoB8B,cAAe,IAAI,EAC3EC,MAAO1B,mBAAmBV,QAAQN,EAAE,IAAI,CAC1C,CAAC,EACG2C,GAAiB,EAAI9B,QAAQ+B,SAAS,WACxC,IAAIxB,EACJ,OAAO,OAACA,EAAKC,MAAAA,EAA2C,KAAA,EAASA,EAASe,CAAc,GAA+BhB,EAAKgB,CAC9H,EAAG,CAACf,EAAUe,EAAe,EACzBS,GAAU,EAAIhC,QAAQ+B,SAAS,WACjC,MAA0B,iBAAtBpB,EACK,CAAC,CACNc,IAAK,KACLQ,KAAM,UACNzB,SAAUL,mBAAmBV,QAAQN,EAAE,IAAI,EAC3C+C,QAASC,CACX,EAAG,CACDV,IAAK,QACLQ,KAAM,UACNzB,SAAUL,mBAAmBV,QAAQN,EAAE,IAAI,EAC3C+C,QAASE,CACX,GAEK,CAAC,CACNX,IAAK,KACLY,QAAS,CAAA,EACTC,KAAMnC,mBAAmBV,QAAQN,EAAE,IAAI,EACvC+C,QAASC,CACX,EAAG,CACDV,IAAK,QACLY,QAAS,CAAA,EACTC,KAAMnC,mBAAmBV,QAAQN,EAAE,IAAI,EACvC+C,QAASE,CACX,EACF,EAAG,CAACzB,EAAkB,EAClB4B,GAAgB,EAAIvC,QAAQ+B,SAAS,WACvC,OAAIjB,EACKA,MAAAA,EAAmD,KAAA,EAASA,EAAaG,MAAAA,EAAiEA,EAAsB,EAAE,EAEpKjB,QAAQP,QAAQ+B,cAAc3B,cAAcwB,KAAMjE,SAAS,CAChEgE,KAAMA,EACNoB,OAAQ,YACV,EAAGzB,CAAe,EAAGC,MAAAA,EAAmD,KAAA,EAASA,EAAayB,IAAI,SAAUlC,GAC1G,IAAIkB,EAAMlB,EAAGkB,IACXiB,EAAOnC,EAAGmC,KACVb,EAAQtB,EAAGsB,MACXc,EAAgBpC,EAAGoC,cACnBC,EAASrC,EAAGqC,OACd,OAAO5C,QAAQP,QAAQ+B,cAAc3B,cAAcwB,KAAKwB,KAAMzF,SAAS,CACrEqE,IAAKA,EACLiB,KAAMA,EACNb,MAAOA,CACT,EAAGc,MAAAA,EAAqDA,EAAgB,EAAE,EAAGC,MAAAA,EAAuC,KAAA,EAASA,EAAOxB,CAAI,CAAC,CAC3I,CAAC,CAAC,CACJ,EAAG,CAACN,EAAcG,EAAoB,EAClC6B,GAAkB,EAAI9C,QAAQ+B,SAAS,WACzC,IAGMgB,EAWEC,EAdJC,EAAc7F,SAAS,GAAIyD,CAAkB,EAEjD,MAAI,CAAC,eAAgB,YAAa,QAAS,UAAUqC,SAASvC,MAAAA,EAA6DA,EAAoB,EAAE,GAC3IoC,EAAW3F,SAASA,SAAS,GAAI6F,CAAW,EAAG,CACjDjB,QAASA,EACTmB,oBAAqB/F,SAASA,SAAS,GAAIyD,MAAAA,EAA+D,KAAA,EAASA,EAAmBsC,mBAAmB,EAAG,CAC1JC,cAAe,WACb,OAAOtB,CACT,CACF,CAAC,CACH,CAAC,EAEG,CAAC,eAAgB,aAAaoB,SAASvC,MAAAA,EAA6DA,EAAoB,EAAE,GACxH0C,EAAW,IAAIC,IAAI,CAAC,CAAC,eAAgB,UAAW,CAAC,YAAa,OAAO,EACrEN,EAAa5F,SAASA,SAAS,GAAI2F,CAAQ,EAAG,CAChDM,SAAUA,EAASrE,IAAI2B,MAAAA,EAA6DA,EAAoB,EAAE,CAC5G,CAAC,EACMX,QAAQP,QAAQ+B,cAAcvB,0BAA0BsD,MAAMC,QAASpG,SAAS,CACrFqD,SAAUA,CACZ,EAAGuC,CAAU,EAAGT,CAAa,GAGA,UAAtB5B,EACAX,QAAQP,QAAQ+B,cAAcvB,0BAA0BwD,MAAMC,cAAetG,SAAS,CAC3FqD,SAAUA,CACZ,EAAGsC,CAAQ,EAAGR,CAAa,EAGE,WAAtB5B,EACAX,QAAQP,QAAQ+B,cAAcvB,0BAA0B0D,OAAOD,cAAetG,SAAS,CAC5FqD,SAAUA,CACZ,EAAGsC,CAAQ,EAAGR,CAAa,EAHxB,KAAA,GAOwB,iBAAtB5B,EACAX,QAAQP,QAAQ+B,cAActB,kBAAkBT,QAAQ+D,QAASpG,SAAS,GAAI6F,EAAa,CAChGxC,SAAUA,EACV2C,cAAe,WACb,OAAOtB,CACT,EACAE,QAASA,CACX,CAAC,EAAGO,CAAa,EAPd,KAAA,CASP,EAAG,CAAC5B,EAAmBE,EAAoBiB,EAAgBS,EAAeP,EAASvB,EAAS,EAC5F,SAAS0B,IACP,IACIyB,EADJ,OAAK1C,GACD0C,EAAaxC,EAAOA,EAAKyC,eAAe,EAAI5C,EACzCC,MAAAA,EAA2C,KAAA,EAASA,EAAS0C,CAAU,GAFxDE,QAAQC,QAAQ,CAGxC,CACA,SAAS3B,IAGP,OADAhB,MAAAA,GAA4CA,EAAK4C,aAAY,EAAIjE,iBAAiBN,SAASwB,CAAmB,EAAIxC,KAAAA,EAAYwC,CAAmB,EAC5IE,EAGEA,MAAAA,EAAqD,KAAA,EAASA,EAAc,EAF1E2C,QAAQC,QAAQ,CAG3B,CAaA,OAZA,EAAIrE,SAASuE,UAAU,WAChB7C,GACLA,EAAK8C,eAAejD,CAAmB,CACzC,CAAC,GACD,EAAIvB,SAASyE,iBAAiB,WACvB/C,IACAH,EAGHG,EAAK8C,eAAejD,CAAmB,EAFvCG,EAAK4C,YAAY,EAIrB,EAAG,CAAC/C,EAAoB,EACjB6B,CACT,EACAxC,WAAW8D,YAAc,aACzBzE,QAAQF,QAAUa"}