{"version":3,"file":"index.js","sources":["Toolbar/Items/ViewSettingItem/index.js"],"sourcesContent":["\"use strict\";\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = void 0 && (void 0).__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = void 0 && (void 0).__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ahooks_1 = require(\"ahooks\");\nvar antd_mobile_1 = require(\"antd-mobile\");\nvar antd_mobile_icons_1 = require(\"antd-mobile-icons\");\nvar react_1 = __importStar(require(\"react\"));\nvar adhere_mobile_ui_anthoc_1 = require(\"@baifendian/adhere-mobile-ui-anthoc\");\nvar adhere_ui_popup_1 = __importDefault(require(\"@baifendian/adhere-ui-popup\"));\nvar adhere_util_intl_1 = __importDefault(require(\"@baifendian/adhere-util-intl\"));\nvar NormalItem_1 = __importDefault(require(\"../NormalItem\"));\nvar selectorPrefix = 'adhere-mobile-ui-prsl-toolbar-view-setting-item';\nvar ViewSettingItem = function (_a) {\n  var children = _a.children,\n    disabled = _a.disabled,\n    _b = _a.viewSettingTriggerMode,\n    viewSettingTriggerMode = _b === void 0 ? 'popup-bottom' : _b,\n    viewSettingTriggerProps = _a.viewSettingTriggerProps,\n    renderViewSetting = _a.renderViewSetting,\n    viewSettingConfig = _a.viewSettingConfig,\n    defaultViewSettingValue = _a.defaultViewSettingValue,\n    onViewSetting = _a.onViewSetting,\n    onViewSettingReset = _a.onViewSettingReset;\n  var _c = (0, react_1.useState)(defaultViewSettingValue !== null && defaultViewSettingValue !== void 0 ? defaultViewSettingValue : 'normal'),\n    viewSettingValue = _c[0],\n    setViewSettingValue = _c[1];\n  var targetViewSettingValue = (0, react_1.useMemo)(function () {\n    if (Array.isArray(viewSettingValue)) return viewSettingValue;\n    if (!viewSettingValue) return [];\n    return [viewSettingValue];\n  }, [viewSettingValue]);\n  var defaultElement = react_1.default.createElement(NormalItem_1.default, {\n    key: \"view-setting-item\",\n    className: selectorPrefix,\n    icon: react_1.default.createElement(antd_mobile_icons_1.AppstoreOutline, null),\n    label: adhere_util_intl_1.default.v('视图')\n  });\n  var triggerElement = (0, react_1.useMemo)(function () {\n    var _a;\n    return (_a = children === null || children === void 0 ? void 0 : children(defaultElement)) !== null && _a !== void 0 ? _a : defaultElement;\n  }, [children, defaultElement]);\n  var actions = (0, react_1.useMemo)(function () {\n    if (viewSettingTriggerMode === 'adhere-popup') {\n      return [{\n        key: 'reset',\n        type: 'primary',\n        children: adhere_util_intl_1.default.v('重置'),\n        onClick: reset\n      }];\n    }\n    return [{\n      key: 'reset',\n      primary: true,\n      text: adhere_util_intl_1.default.v('重置'),\n      onClick: reset\n    }];\n  }, [viewSettingTriggerMode]);\n  var renderViewSettingElement = (0, react_1.useCallback)(function (_a) {\n    var close = _a.close;\n    if (renderViewSetting) {\n      return renderViewSetting === null || renderViewSetting === void 0 ? void 0 : renderViewSetting(viewSettingValue !== null && viewSettingValue !== void 0 ? viewSettingValue : 'normal');\n    }\n    return react_1.default.createElement(antd_mobile_1.CheckList, {\n      className: \"\".concat(selectorPrefix, \"-list\"),\n      value: targetViewSettingValue,\n      defaultValue: targetViewSettingValue,\n      multiple: false,\n      onChange: function (v) {\n        var _viewSettingValue = v.length ? v[0] : 'normal';\n        setViewSettingValue(_viewSettingValue);\n        viewSetting(_viewSettingValue);\n        if (viewSettingTriggerMode === 'adhere-popup') {\n          adhere_ui_popup_1.default.closeAll();\n        } else {\n          close === null || close === void 0 ? void 0 : close();\n        }\n      }\n    }, viewSettingConfig === null || viewSettingConfig === void 0 ? void 0 : viewSettingConfig.map(function (_viewSettingValue) {\n      return react_1.default.createElement(antd_mobile_1.CheckList.Item, {\n        key: _viewSettingValue.name,\n        value: _viewSettingValue.name,\n        className: \"\".concat(selectorPrefix, \"-list-item\")\n      }, react_1.default.createElement(\"div\", {\n        className: \"\".concat(selectorPrefix, \"-list-item-label\")\n      }, _viewSettingValue.label));\n    }));\n  }, [renderViewSetting, viewSettingConfig, viewSettingTriggerMode, targetViewSettingValue]);\n  var triggerContext = (0, react_1.useMemo)(function () {\n    if (viewSettingTriggerMode === 'modal') {\n      return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Modal.Context.Consumer, null, function (value) {\n        return renderViewSettingElement(value);\n      });\n    } else if (viewSettingTriggerMode === 'dialog') {\n      return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Dialog.Context.Consumer, null, function (value) {\n        return renderViewSettingElement(value);\n      });\n    } else if (viewSettingTriggerMode === 'popup-bottom') {\n      return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Popup.Context.Consumer, null, function (value) {\n        return renderViewSettingElement(value);\n      });\n    } else {\n      return renderViewSettingElement;\n    }\n  }, [viewSettingTriggerMode, renderViewSettingElement]);\n  var childrenElement = (0, react_1.useMemo)(function () {\n    var commonProps = __assign({}, viewSettingTriggerProps);\n    // hoc\n    if (['popup-bottom', 'popup-top', 'modal', 'dialog'].includes(viewSettingTriggerMode !== null && viewSettingTriggerMode !== void 0 ? viewSettingTriggerMode : '')) {\n      var hocProps = __assign(__assign({}, commonProps), {\n        actions: actions,\n        popoverTriggerProps: __assign(__assign({}, viewSettingTriggerProps === null || viewSettingTriggerProps === void 0 ? void 0 : viewSettingTriggerProps.popoverTriggerProps), {\n          renderTrigger: function () {\n            return triggerElement;\n          }\n        })\n      });\n      // Popup\n      if (['popup-bottom', 'popup-top'].includes(viewSettingTriggerMode !== null && viewSettingTriggerMode !== void 0 ? viewSettingTriggerMode : '')) {\n        var position = new Map([['popup-bottom', 'bottom'], ['popup-top', 'top']]);\n        var popupProps = __assign(__assign({}, hocProps), {\n          position: position.get(viewSettingTriggerMode !== null && viewSettingTriggerMode !== void 0 ? viewSettingTriggerMode : '')\n        });\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Popup.Trigger, __assign({\n          disabled: disabled\n        }, popupProps), triggerContext);\n      }\n      // Modal\n      else if (viewSettingTriggerMode === 'modal') {\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Modal.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), triggerContext);\n      }\n      // Dialog\n      else if (viewSettingTriggerMode === 'dialog') {\n        return react_1.default.createElement(adhere_mobile_ui_anthoc_1.Dialog.TriggerPrompt, __assign({\n          disabled: disabled\n        }, hocProps), triggerContext);\n      }\n    }\n    // adhere-popup\n    else if (viewSettingTriggerMode === 'adhere-popup') {\n      return react_1.default.createElement(adhere_ui_popup_1.default.Trigger, __assign({}, commonProps, {\n        disabled: disabled,\n        renderTrigger: function () {\n          return triggerElement;\n        },\n        actions: actions\n      }), triggerContext);\n    }\n  }, [viewSettingTriggerMode, viewSettingTriggerProps, triggerElement, triggerContext, actions]);\n  function viewSetting(viewSettingValue) {\n    setViewSettingValue(viewSettingValue);\n    return onViewSetting === null || onViewSetting === void 0 ? void 0 : onViewSetting(viewSettingValue !== null && viewSettingValue !== void 0 ? viewSettingValue : 'normal');\n  }\n  function reset() {\n    setViewSettingValue(defaultViewSettingValue !== null && defaultViewSettingValue !== void 0 ? defaultViewSettingValue : 'normal');\n    if (!onViewSettingReset) return Promise.resolve();\n    return onViewSettingReset === null || onViewSettingReset === void 0 ? void 0 : onViewSettingReset();\n  }\n  (0, ahooks_1.useUpdateEffect)(function () {\n    setViewSettingValue(defaultViewSettingValue !== null && defaultViewSettingValue !== void 0 ? defaultViewSettingValue : 'normal');\n  }, [defaultViewSettingValue]);\n  return childrenElement;\n};\nViewSettingItem.displayName = 'ViewSettingItem';\nexports.default = ViewSettingItem;"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","default","ahooks_1","exports","require","antd_mobile_1","antd_mobile_icons_1","react_1","adhere_mobile_ui_anthoc_1","adhere_ui_popup_1","adhere_util_intl_1","NormalItem_1","selectorPrefix","ViewSettingItem","_a","children","disabled","_b","viewSettingTriggerMode","viewSettingTriggerProps","renderViewSetting","viewSettingConfig","defaultViewSettingValue","onViewSetting","onViewSettingReset","_c","useState","viewSettingValue","setViewSettingValue","targetViewSettingValue","useMemo","Array","isArray","defaultElement","createElement","key","className","icon","AppstoreOutline","label","triggerElement","actions","type","onClick","reset","primary","text","renderViewSettingElement","useCallback","close","CheckList","concat","defaultValue","multiple","onChange","_viewSettingValue","closeAll","map","Item","name","triggerContext","Modal","Context","Consumer","Dialog","Popup","childrenElement","hocProps","popupProps","commonProps","includes","popoverTriggerProps","renderTrigger","position","Map","Trigger","TriggerPrompt","Promise","resolve","useUpdateEffect","displayName"],"mappings":"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"}