{"version":3,"file":"Notification.js","sources":["Notification.js"],"sourcesContent":["import React, { useContext, useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { v1 } from 'uuid';\nimport ConfigProvider from '@baifendian/adhere-ui-configprovider';\nimport Util from '@baifendian/adhere-util';\nvar selectorPrefix = 'adhere-ui-notification';\nvar renderToWrapper;\n/**\n * Notification\n * @class Notification\n * @classdesc Notification\n */\nvar Notification = /** @class */ (function () {\n    function Notification(container, config) {\n        this.config = {\n            style: 'material',\n            type: 'top',\n        };\n        // 存放所有的notification\n        this.notifications = {};\n        this.key = false;\n        this.container = container;\n        this.config = Object.assign(this.config, config);\n        this.createInnerContainer();\n        this.init();\n        this.initEvents();\n    }\n    /**\n     * createInnerContainer\n     * @private\n     */\n    Notification.prototype.createInnerContainer = function () {\n        var _a;\n        var innerContainer = this.container.querySelector(\".\".concat(selectorPrefix));\n        if (innerContainer) {\n            (_a = innerContainer === null || innerContainer === void 0 ? void 0 : innerContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(innerContainer);\n        }\n        this.innerContainer = document.createElement('div');\n        this.innerContainer.className = selectorPrefix;\n        this.notificationContainer = document.createElement('ul');\n        this.innerContainer.appendChild(this.notificationContainer);\n        this.container.appendChild(this.innerContainer);\n    };\n    /**\n     * init\n     * @private\n     */\n    Notification.prototype.init = function () {\n        var _a, _b;\n        var config = this.config;\n        (_a = this.innerContainer) === null || _a === void 0 ? void 0 : _a.classList.remove([selectorPrefix].concat([config.type === 'top' ? 'bottom' : 'top', config.style]).join('-'));\n        (_b = this.innerContainer) === null || _b === void 0 ? void 0 : _b.classList.add([selectorPrefix].concat([config.type, config.style]).join('-'));\n    };\n    /**\n     * initEvents\n     * @private\n     */\n    Notification.prototype.initEvents = function () {\n        var _a;\n        var self = this;\n        (_a = this.notificationContainer) === null || _a === void 0 ? void 0 : _a.addEventListener('click', function (e) {\n            if (e.target.classList.contains('close-btn')) {\n                self.closeNotification.call(self, e.target.parentNode.dataset.id);\n            }\n        });\n    };\n    /**\n     * closeNotification - 点击删除通知\n     * closeNotification\n     * @param {string} id\n     * @access private\n     */\n    Notification.prototype.closeNotification = function (id) {\n        var self = this;\n        if (self.key)\n            return;\n        self.key = true;\n        var n = self.notifications[id];\n        function transitionendAction() {\n            var _a;\n            n.removeEventListener('transitionend', transitionendAction);\n            (_a = self === null || self === void 0 ? void 0 : self.notificationContainer) === null || _a === void 0 ? void 0 : _a.removeChild(n);\n            self.key = false;\n            // closeAfter\n            self.trigger('onCloseAfter', n);\n        }\n        // closeBefore\n        self.trigger('onCloseBefore', n);\n        n.addEventListener('transitionend', transitionendAction);\n        n.style.overflow = 'hidden';\n        n.querySelector('.info').style.opacity = '0';\n        n.style.height = '0';\n    };\n    /**\n     * buildCustom\n     * @param config\n     * @return string\n     * @private\n     */\n    Notification.prototype.buildCustom = function (config) {\n        var _this = this;\n        var _a;\n        var closed = config.closed, children = config.children;\n        var id = v1();\n        var n = document.createElement('li');\n        n.dataset.id = id;\n        var Component = function () {\n            var media = useContext(ConfigProvider.Context).media;\n            useEffect(function () {\n                _this.build(id, n, media);\n            }, []);\n            return (React.createElement(React.Fragment, null,\n                React.createElement(\"div\", { className: \"info\" }, children),\n                closed ? React.createElement(\"span\", { className: \"close-btn\" }) : null));\n        };\n        ReactDOM.createRoot(n).render((_a = renderToWrapper === null || renderToWrapper === void 0 ? void 0 : renderToWrapper(function () { return React.createElement(Component, null); })) !== null && _a !== void 0 ? _a : React.createElement(Component, null));\n        return id;\n    };\n    /**\n     * buildStandard\n     * @param config\n     * @return string\n     * @private\n     */\n    Notification.prototype.buildStandard = function (config) {\n        var _this = this;\n        var _a;\n        var _b = config.headerLabel, headerLabel = _b === void 0 ? '' : _b, _c = config.headerIcon, headerIcon = _c === void 0 ? '' : _c, _d = config.title, title = _d === void 0 ? '' : _d, _e = config.text, text = _e === void 0 ? '' : _e, _f = config.icon, icon = _f === void 0 ? '' : _f, _g = config.closed, closed = _g === void 0 ? true : _g, _h = config.datetime, datetime = _h === void 0 ? '' : _h;\n        var id = v1();\n        var n = document.createElement('li');\n        n.dataset.id = id;\n        var Component = function () {\n            var media = useContext(ConfigProvider.Context).media;\n            useEffect(function () {\n                _this.build(id, n, media);\n            }, []);\n            return (React.createElement(React.Fragment, null,\n                React.createElement(\"div\", { className: \"info\" },\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header\") },\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-icon\") }, headerIcon ? React.createElement(\"img\", { src: headerIcon, alt: \"\" }) : null),\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-label\") }, headerLabel !== null && headerLabel !== void 0 ? headerLabel : '')),\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content\") },\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-l\") }, icon ? React.createElement(\"img\", { src: icon, alt: \"\" }) : null),\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row\") },\n                            React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-title\") }, title !== null && title !== void 0 ? title : ''),\n                            React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-text\") }, text !== null && text !== void 0 ? text : '')),\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-r\") }, datetime !== null && datetime !== void 0 ? datetime : ''))),\n                closed ? React.createElement(\"span\", { className: \"close-btn\" }) : null));\n        };\n        ReactDOM.createRoot(n).render((_a = renderToWrapper === null || renderToWrapper === void 0 ? void 0 : renderToWrapper(function () { return React.createElement(Component, null); })) !== null && _a !== void 0 ? _a : React.createElement(Component, null));\n        this.build(id, n);\n        return id;\n    };\n    /**\n     * build\n     * @param id\n     * @param n\n     * @param media\n     * @return string\n     * @private\n     */\n    Notification.prototype.build = function (id, n, media) {\n        if (media === void 0) { media = { isUseMedia: false, designWidth: 192 }; }\n        var self = this;\n        this.notifications[id] = n;\n        // @ts-ignore\n        this.notificationContainer.appendChild(n);\n        setTimeout(function () {\n            // onCreate\n            self.trigger('onCreate', n);\n            n.style.height = 'auto';\n            var targetHeight = n.clientHeight;\n            // 会有最小高度的限制\n            if (self.config.style === 'material') {\n                if (targetHeight < 40) {\n                    targetHeight = 40;\n                }\n            }\n            else if (self.config.style === 'ios') {\n                if (targetHeight < 70) {\n                    targetHeight = 70;\n                }\n            }\n            n.style.height = '0';\n            setTimeout(function () {\n                var targetHeightValue = \"\".concat(targetHeight, \"px\");\n                if (media === null || media === void 0 ? void 0 : media.isUseMedia) {\n                    targetHeightValue = \"\".concat(Util.pxToRem(targetHeight, media === null || media === void 0 ? void 0 : media.designWidth));\n                }\n                n.style.height = \"\".concat(targetHeightValue);\n                n.querySelector('.info').style.opacity = '1';\n                self.trigger('onShow', n);\n            }, 100);\n        }, 100);\n        return id;\n    };\n    /**\n     * trigger\n     * @param action\n     * @param params\n     * @private\n     */\n    Notification.prototype.trigger = function (action, params) {\n        if (this.config[action]) {\n            this.config[action](params);\n        }\n    };\n    /**\n     * show\n     * @param {Object} config\n     * @return {string} id\n     */\n    Notification.prototype.show = function (config) {\n        return this.buildCustom(config);\n    };\n    /**\n     * showStandard\n     * @param {Object} config\n     * @return {string} id\n     */\n    Notification.prototype.showStandard = function (config) {\n        return this.buildStandard(config);\n    };\n    /**\n     * close\n     * @param {string} id\n     */\n    Notification.prototype.close = function (id) {\n        this.closeNotification(id);\n    };\n    return Notification;\n}());\nvar NotificationFactory = {\n    /**\n     * setRenderToWrapper\n     * @description 设置renderToWrapper方法\n     * @param _renderToWrapper\n     */\n    setRenderToWrapper: function (_renderToWrapper) {\n        renderToWrapper = _renderToWrapper;\n    },\n    /**\n     * build\n     * @param container\n     * @param config\n     * @return Notification\n     */\n    build: function (container, config) {\n        return new Notification(container, config);\n    },\n};\n/**\n * NotificationFactory\n */\nexport default NotificationFactory;\n"],"names":["React","useContext","useEffect","ReactDOM","v1","ConfigProvider","Util","renderToWrapper","selectorPrefix","Notification","container","config","this","style","type","notifications","key","Object","assign","createInnerContainer","init","initEvents","prototype","_a","innerContainer","querySelector","concat","parentElement","removeChild","document","createElement","className","notificationContainer","appendChild","_b","classList","remove","join","add","self","addEventListener","e","target","contains","closeNotification","call","parentNode","dataset","id","n","trigger","transitionendAction","removeEventListener","overflow","opacity","height","buildCustom","Component","media","Context","_this","build","Fragment","children","closed","createRoot","render","buildStandard","headerIcon","src","alt","headerLabel","icon","title","text","datetime","_c","_d","_e","_f","_g","_h","isUseMedia","designWidth","setTimeout","targetHeight","clientHeight","targetHeightValue","pxToRem","action","params","show","showStandard","close","NotificationFactory","setRenderToWrapper","_renderToWrapper"],"mappings":"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"}