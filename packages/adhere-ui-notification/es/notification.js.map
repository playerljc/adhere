{"version":3,"file":"notification.js","sources":["notification.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { v1 } from 'uuid';\nvar selectorPrefix = 'adhere-ui-notification';\n/**\n * Notification\n * @class Notification\n * @classdesc Notification\n */\nvar Notification = /** @class */ (function () {\n    function Notification(container, config) {\n        this.config = {\n            style: 'material',\n            type: 'top',\n        };\n        // 存放所有的notification\n        this.notifications = {};\n        this.key = false;\n        this.container = container;\n        this.config = Object.assign(this.config, config);\n        this.createInnerContainer();\n        this.init();\n        this.initEvents();\n    }\n    /**\n     * createInnerContainer\n     * @private\n     */\n    Notification.prototype.createInnerContainer = function () {\n        var _a;\n        var innerContainer = this.container.querySelector(\".\".concat(selectorPrefix));\n        if (innerContainer) {\n            (_a = innerContainer === null || innerContainer === void 0 ? void 0 : innerContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(innerContainer);\n        }\n        this.innerContainer = document.createElement('div');\n        this.innerContainer.className = selectorPrefix;\n        this.notificationContainer = document.createElement('ul');\n        this.innerContainer.appendChild(this.notificationContainer);\n        this.container.appendChild(this.innerContainer);\n    };\n    /**\n     * init\n     * @private\n     */\n    Notification.prototype.init = function () {\n        var _a, _b;\n        var config = this.config;\n        (_a = this.innerContainer) === null || _a === void 0 ? void 0 : _a.classList.remove([selectorPrefix].concat([config.type === 'top' ? 'bottom' : 'top', config.style]).join('-'));\n        (_b = this.innerContainer) === null || _b === void 0 ? void 0 : _b.classList.add([selectorPrefix].concat([config.type, config.style]).join('-'));\n    };\n    /**\n     * initEvents\n     * @private\n     */\n    Notification.prototype.initEvents = function () {\n        var _a;\n        var self = this;\n        (_a = this.notificationContainer) === null || _a === void 0 ? void 0 : _a.addEventListener('click', function (e) {\n            if (e.target.classList.contains('closeBtn')) {\n                self.closeNotification.call(self, e.target.parentNode.dataset.id);\n            }\n        });\n    };\n    /**\n     * closeNotification - 点击删除通知\n     * closeNotification\n     * @param {string} id\n     * @access private\n     */\n    Notification.prototype.closeNotification = function (id) {\n        var self = this;\n        if (self.key)\n            return;\n        self.key = true;\n        var n = self.notifications[id];\n        function transitionendAction() {\n            var _a;\n            n.removeEventListener('transitionend', transitionendAction);\n            (_a = self === null || self === void 0 ? void 0 : self.notificationContainer) === null || _a === void 0 ? void 0 : _a.removeChild(n);\n            self.key = false;\n            // closeAfter\n            self.trigger('onCloseAfter', n);\n        }\n        // closeBefore\n        self.trigger('onCloseBefore', n);\n        n.addEventListener('transitionend', transitionendAction);\n        n.style.overflow = 'hidden';\n        n.querySelector('.info').style.opacity = '0';\n        n.style.height = '0';\n    };\n    /**\n     * buildCustom\n     * @param config\n     * @return string\n     * @private\n     */\n    Notification.prototype.buildCustom = function (config) {\n        var closed = config.closed, children = config.children;\n        // console.log('IShowConfig', config);\n        var id = v1();\n        var n = document.createElement('li');\n        n.dataset.id = id;\n        var Component = function () { return (React.createElement(React.Fragment, null,\n            React.createElement(\"div\", { className: \"info\" }, children),\n            closed ? React.createElement(\"span\", { className: \"closeBtn\" }) : null)); };\n        ReactDOM.createRoot(n).render(React.createElement(Component, null));\n        return this.build(id, n);\n    };\n    /**\n     * buildStandard\n     * @param config\n     * @return string\n     * @private\n     */\n    Notification.prototype.buildStandard = function (config) {\n        var _a = config.headerLabel, headerLabel = _a === void 0 ? '' : _a, _b = config.headerIcon, headerIcon = _b === void 0 ? '' : _b, _c = config.title, title = _c === void 0 ? '' : _c, _d = config.text, text = _d === void 0 ? '' : _d, _e = config.icon, icon = _e === void 0 ? '' : _e, _f = config.closed, closed = _f === void 0 ? true : _f, _g = config.datetime, datetime = _g === void 0 ? '' : _g;\n        // console.log('IShowStandardConfig', config);\n        var id = v1();\n        var n = document.createElement('li');\n        n.dataset.id = id;\n        var Component = function () { return (React.createElement(React.Fragment, null,\n            React.createElement(\"div\", { className: \"info\" },\n                React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header\") },\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-icon\") }, headerIcon ? React.createElement(\"img\", { src: headerIcon, alt: \"\" }) : null),\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-label\") }, headerLabel || '')),\n                React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content\") },\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-l\") }, icon ? React.createElement(\"img\", { src: icon, alt: \"\" }) : null),\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row\") },\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-title\") }, title || ''),\n                        React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-text\") }, text || '')),\n                    React.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-r\") }, datetime || ''))),\n            closed ? React.createElement(\"span\", { className: \"closeBtn\" }) : null)); };\n        ReactDOM.createRoot(n).render(React.createElement(Component, null));\n        return this.build(id, n);\n    };\n    /**\n     * build\n     * @param id\n     * @param n\n     * @return string\n     * @private\n     */\n    Notification.prototype.build = function (id, n) {\n        var self = this;\n        this.notifications[id] = n;\n        // @ts-ignore\n        this.notificationContainer.appendChild(n);\n        setTimeout(function () {\n            // onCreate\n            self.trigger('onCreate', n);\n            n.style.height = 'auto';\n            var targetHeight = n.clientHeight;\n            // 会有最小高度的限制\n            if (self.config.style === 'material') {\n                if (targetHeight < 40) {\n                    targetHeight = 40;\n                }\n            }\n            else if (self.config.style === 'ios') {\n                if (targetHeight < 70) {\n                    targetHeight = 70;\n                }\n            }\n            n.style.height = '0';\n            setTimeout(function () {\n                n.style.height = \"\".concat(targetHeight, \"px\");\n                n.querySelector('.info').style.opacity = '1';\n                self.trigger('onShow', n);\n            }, 100);\n        }, 100);\n        return id;\n    };\n    /**\n     * trigger\n     * @param action\n     * @param params\n     * @private\n     */\n    Notification.prototype.trigger = function (action, params) {\n        if (this.config[action]) {\n            this.config[action](params);\n        }\n    };\n    /**\n     * show\n     * @param {Object} config\n     * @return {string} id\n     */\n    Notification.prototype.show = function (config) {\n        return this.buildCustom(config);\n    };\n    /**\n     * showStandard\n     * @param {Object} config\n     * @return {string} id\n     */\n    Notification.prototype.showStandard = function (config) {\n        return this.buildStandard(config);\n    };\n    /**\n     * close\n     * @param {string} id\n     */\n    Notification.prototype.close = function (id) {\n        this.closeNotification(id);\n    };\n    return Notification;\n}());\n/**\n * NotificationFactory\n */\nexport default {\n    /**\n     * build\n     * @param container\n     * @param config\n     * @return Notification\n     */\n    build: function (container, config) {\n        return new Notification(container, config);\n    },\n};\n"],"names":["React","ReactDOM","v1","selectorPrefix","Notification","container","config","this","style","type","notifications","key","Object","assign","createInnerContainer","init","initEvents","prototype","_a","innerContainer","querySelector","concat","parentElement","removeChild","document","createElement","className","notificationContainer","appendChild","_b","classList","remove","join","add","self","addEventListener","e","target","contains","closeNotification","call","parentNode","dataset","id","n","trigger","transitionendAction","removeEventListener","overflow","opacity","height","buildCustom","closed","children","createRoot","render","Fragment","build","buildStandard","headerLabel","headerIcon","_c","title","_d","text","_e","icon","_f","_g","datetime","src","alt","setTimeout","targetHeight","clientHeight","action","params","show","showStandard","close"],"mappings":"OAAOA,UAAW,eACXC,aAAc,0BACZC,EAAgB,KAAN,OACnB,IAAIC,eAAiB,yBAMjBC,aAA8B,WAC9B,SAASA,EAAaC,EAAWC,GAC7BC,KAAKD,OAAS,CACVE,MAAO,WACPC,KAAM,KACV,EAEAF,KAAKG,cAAgB,GACrBH,KAAKI,IAAM,CAAA,EACXJ,KAAKF,UAAYA,EACjBE,KAAKD,OAASM,OAAOC,OAAON,KAAKD,OAAQA,CAAM,EAC/CC,KAAKO,qBAAqB,EAC1BP,KAAKQ,KAAK,EACVR,KAAKS,WAAW,CACpB,CAuLA,OAlLAZ,EAAaa,UAAUH,qBAAuB,WAC1C,IAAII,EACAC,EAAiBZ,KAAKF,UAAUe,cAAc,IAAIC,OAAOlB,cAAc,CAAC,EACxEgB,GACA,OAACD,EAAKC,MAAAA,EAAuD,KAAA,EAASA,EAAeG,gBAAoDJ,EAAGK,YAAYJ,CAAc,EAE1KZ,KAAKY,eAAiBK,SAASC,cAAc,KAAK,EAClDlB,KAAKY,eAAeO,UAAYvB,eAChCI,KAAKoB,sBAAwBH,SAASC,cAAc,IAAI,EACxDlB,KAAKY,eAAeS,YAAYrB,KAAKoB,qBAAqB,EAC1DpB,KAAKF,UAAUuB,YAAYrB,KAAKY,cAAc,CAClD,EAKAf,EAAaa,UAAUF,KAAO,WAC1B,IAAQc,EACJvB,EAASC,KAAKD,OAClB,OAACY,EAAKX,KAAKY,iBAAqDD,EAAGY,UAAUC,OAAO,CAAC5B,gBAAgBkB,OAAO,CAAiB,QAAhBf,EAAOG,KAAiB,SAAW,MAAOH,EAAOE,MAAM,EAAEwB,KAAK,GAAG,CAAC,EAC/K,OAACH,EAAKtB,KAAKY,iBAAqDU,EAAGC,UAAUG,IAAI,CAAC9B,gBAAgBkB,OAAO,CAACf,EAAOG,KAAMH,EAAOE,MAAM,EAAEwB,KAAK,GAAG,CAAC,CACnJ,EAKA5B,EAAaa,UAAUD,WAAa,WAChC,IAAIE,EACAgB,EAAO3B,KACX,OAACW,EAAKX,KAAKoB,wBAA4DT,EAAGiB,iBAAiB,QAAS,SAAUC,GACtGA,EAAEC,OAAOP,UAAUQ,SAAS,UAAU,GACtCJ,EAAKK,kBAAkBC,KAAKN,EAAME,EAAEC,OAAOI,WAAWC,QAAQC,EAAE,CAExE,CAAC,CACL,EAOAvC,EAAaa,UAAUsB,kBAAoB,SAAUI,GACjD,IAIIC,EAJAV,EAAO3B,KACP2B,EAAKvB,MAETuB,EAAKvB,IAAM,CAAA,EACPiC,EAAIV,EAAKxB,cAAciC,GAU3BT,EAAKW,QAAQ,gBAAiBD,CAAC,EAC/BA,EAAET,iBAAiB,gBAVnB,SAASW,IACL,IAAI5B,EACJ0B,EAAEG,oBAAoB,gBAAiBD,CAAmB,EAC1D,OAAC5B,EAAKgB,MAAAA,EAAmC,KAAA,EAASA,EAAKP,wBAA4DT,EAAGK,YAAYqB,CAAC,EACnIV,EAAKvB,IAAM,CAAA,EAEXuB,EAAKW,QAAQ,eAAgBD,CAAC,CAClC,CAGuD,EACvDA,EAAEpC,MAAMwC,SAAW,SACnBJ,EAAExB,cAAc,OAAO,EAAEZ,MAAMyC,QAAU,IACzCL,EAAEpC,MAAM0C,OAAS,IACrB,EAOA9C,EAAaa,UAAUkC,YAAc,SAAU7C,GAC3C,IAAI8C,EAAS9C,EAAO8C,OAAQC,EAAW/C,EAAO+C,SAE1CV,EAAKzC,GAAG,EACR0C,EAAIpB,SAASC,cAAc,IAAI,EACnCmB,EAAEF,QAAQC,GAAKA,EAKf,OADA1C,SAASqD,WAAWV,CAAC,EAAEW,OAAOvD,MAAMyB,cAHpB,WAAc,OAAQzB,MAAMyB,cAAczB,MAAMwD,SAAU,KACtExD,MAAMyB,cAAc,MAAO,CAAEC,UAAW,MAAO,EAAG2B,CAAQ,EAC1DD,EAASpD,MAAMyB,cAAc,OAAQ,CAAEC,UAAW,UAAW,CAAC,EAAI,IAAK,CAAG,EACjB,IAAI,CAAC,EAC3DnB,KAAKkD,MAAMd,EAAIC,CAAC,CAC3B,EAOAxC,EAAaa,UAAUyC,cAAgB,SAAUpD,GAC7C,IAAIY,EAAKZ,EAAOqD,YAAaA,EAAqB,KAAA,IAAPzC,EAAgB,GAAKA,EAAIW,EAAKvB,EAAOsD,WAAYA,EAAoB,KAAA,IAAP/B,EAAgB,GAAKA,EAAIgC,EAAKvD,EAAOwD,MAAOA,EAAe,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAKzD,EAAO0D,KAAMA,EAAc,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAK3D,EAAO4D,KAAMA,EAAc,KAAA,IAAPD,EAAgB,GAAKA,EAAIE,EAAK7D,EAAO8C,OAAQA,EAAgB,KAAA,IAAPe,GAAuBA,EAAIC,EAAK9D,EAAO+D,SAAUA,EAAkB,KAAA,IAAPD,EAAgB,GAAKA,EAEpYzB,EAAKzC,GAAG,EACR0C,EAAIpB,SAASC,cAAc,IAAI,EACnCmB,EAAEF,QAAQC,GAAKA,EAcf,OADA1C,SAASqD,WAAWV,CAAC,EAAEW,OAAOvD,MAAMyB,cAZpB,WAAc,OAAQzB,MAAMyB,cAAczB,MAAMwD,SAAU,KACtExD,MAAMyB,cAAc,MAAO,CAAEC,UAAW,MAAO,EAC3C1B,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,kBAAkB,CAAE,EAClFH,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,uBAAuB,CAAE,EAAGyD,EAAa5D,MAAMyB,cAAc,MAAO,CAAE6C,IAAKV,EAAYW,IAAK,EAAG,CAAC,EAAI,IAAI,EAC1KvE,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,wBAAwB,CAAE,EAAGwD,GAAe,EAAE,CAAC,EACrH3D,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,mBAAmB,CAAE,EACnFH,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,2BAA2B,CAAE,EAAG+D,EAAOlE,MAAMyB,cAAc,MAAO,CAAE6C,IAAKJ,EAAMK,IAAK,EAAG,CAAC,EAAI,IAAI,EAClKvE,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,uBAAuB,CAAE,EACvFH,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,6BAA6B,CAAE,EAAG2D,GAAS,EAAE,EAC/G9D,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,4BAA4B,CAAE,EAAG6D,GAAQ,EAAE,CAAC,EAClHhE,MAAMyB,cAAc,MAAO,CAAEC,UAAW,GAAGL,OAAOlB,eAAgB,2BAA2B,CAAE,EAAGkE,GAAY,EAAE,CAAC,CAAC,EAC1HjB,EAASpD,MAAMyB,cAAc,OAAQ,CAAEC,UAAW,UAAW,CAAC,EAAI,IAAK,CAAG,EACjB,IAAI,CAAC,EAC3DnB,KAAKkD,MAAMd,EAAIC,CAAC,CAC3B,EAQAxC,EAAaa,UAAUwC,MAAQ,SAAUd,EAAIC,GACzC,IAAIV,EAAO3B,KA2BX,OA1BAA,KAAKG,cAAciC,GAAMC,EAEzBrC,KAAKoB,sBAAsBC,YAAYgB,CAAC,EACxC4B,WAAW,WAEPtC,EAAKW,QAAQ,WAAYD,CAAC,EAC1BA,EAAEpC,MAAM0C,OAAS,OACjB,IAAIuB,EAAe7B,EAAE8B,aAEK,aAAtBxC,EAAK5B,OAAOE,MACRiE,EAAe,KACfA,EAAe,IAGQ,QAAtBvC,EAAK5B,OAAOE,OACbiE,EAAe,KACfA,EAAe,IAGvB7B,EAAEpC,MAAM0C,OAAS,IACjBsB,WAAW,WACP5B,EAAEpC,MAAM0C,OAAS,GAAG7B,OAAOoD,EAAc,IAAI,EAC7C7B,EAAExB,cAAc,OAAO,EAAEZ,MAAMyC,QAAU,IACzCf,EAAKW,QAAQ,SAAUD,CAAC,CAC5B,EAAG,GAAG,CACV,EAAG,GAAG,EACCD,CACX,EAOAvC,EAAaa,UAAU4B,QAAU,SAAU8B,EAAQC,GAC3CrE,KAAKD,OAAOqE,IACZpE,KAAKD,OAAOqE,GAAQC,CAAM,CAElC,EAMAxE,EAAaa,UAAU4D,KAAO,SAAUvE,GACpC,OAAOC,KAAK4C,YAAY7C,CAAM,CAClC,EAMAF,EAAaa,UAAU6D,aAAe,SAAUxE,GAC5C,OAAOC,KAAKmD,cAAcpD,CAAM,CACpC,EAKAF,EAAaa,UAAU8D,MAAQ,SAAUpC,GACrCpC,KAAKgC,kBAAkBI,CAAE,CAC7B,EACOvC,CACX,EAAG,gBAIY,CAOXqD,MAAO,SAAUpD,EAAWC,GACxB,OAAO,IAAIF,aAAaC,EAAWC,CAAM,CAC7C,CACJ"}