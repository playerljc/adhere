{"version":3,"file":"notification.js","sources":["notification.js"],"sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar client_1 = __importDefault(require(\"react-dom/client\"));\r\nvar uuid_1 = require(\"uuid\");\r\nvar selectorPrefix = 'adhere-ui-notification';\r\n/**\r\n * Notification\r\n * @class Notification\r\n * @classdesc Notification\r\n */\r\nvar Notification = /** @class */ (function () {\r\n    function Notification(container, config) {\r\n        this.config = {\r\n            style: 'material',\r\n            type: 'top',\r\n        };\r\n        // 存放所有的notification\r\n        this.notifications = {};\r\n        this.key = false;\r\n        this.container = container;\r\n        this.config = Object.assign(this.config, config);\r\n        this.createInnerContainer();\r\n        this.init();\r\n        this.initEvents();\r\n    }\r\n    /**\r\n     * createInnerContainer\r\n     * @private\r\n     */\r\n    Notification.prototype.createInnerContainer = function () {\r\n        var _a;\r\n        var innerContainer = this.container.querySelector(\".\".concat(selectorPrefix));\r\n        if (innerContainer) {\r\n            (_a = innerContainer === null || innerContainer === void 0 ? void 0 : innerContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(innerContainer);\r\n        }\r\n        this.innerContainer = document.createElement('div');\r\n        this.innerContainer.className = selectorPrefix;\r\n        this.notificationContainer = document.createElement('ul');\r\n        this.innerContainer.appendChild(this.notificationContainer);\r\n        this.container.appendChild(this.innerContainer);\r\n    };\r\n    /**\r\n     * init\r\n     * @private\r\n     */\r\n    Notification.prototype.init = function () {\r\n        var _a, _b;\r\n        var config = this.config;\r\n        (_a = this.innerContainer) === null || _a === void 0 ? void 0 : _a.classList.remove([selectorPrefix].concat([config.type === 'top' ? 'bottom' : 'top', config.style]).join('-'));\r\n        (_b = this.innerContainer) === null || _b === void 0 ? void 0 : _b.classList.add([selectorPrefix].concat([config.type, config.style]).join('-'));\r\n    };\r\n    /**\r\n     * initEvents\r\n     * @private\r\n     */\r\n    Notification.prototype.initEvents = function () {\r\n        var _a;\r\n        var self = this;\r\n        (_a = this.notificationContainer) === null || _a === void 0 ? void 0 : _a.addEventListener('click', function (e) {\r\n            if (e.target.classList.contains('closeBtn')) {\r\n                self.closeNotification.call(self, e.target.parentNode.dataset.id);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * closeNotification - 点击删除通知\r\n     * closeNotification\r\n     * @param {string} id\r\n     * @access private\r\n     */\r\n    Notification.prototype.closeNotification = function (id) {\r\n        var self = this;\r\n        if (self.key)\r\n            return;\r\n        self.key = true;\r\n        var n = self.notifications[id];\r\n        function transitionendAction() {\r\n            var _a;\r\n            n.removeEventListener('transitionend', transitionendAction);\r\n            (_a = self === null || self === void 0 ? void 0 : self.notificationContainer) === null || _a === void 0 ? void 0 : _a.removeChild(n);\r\n            self.key = false;\r\n            // closeAfter\r\n            self.trigger('onCloseAfter', n);\r\n        }\r\n        // closeBefore\r\n        self.trigger('onCloseBefore', n);\r\n        n.addEventListener('transitionend', transitionendAction);\r\n        n.style.overflow = 'hidden';\r\n        n.querySelector('.info').style.opacity = '0';\r\n        n.style.height = '0';\r\n    };\r\n    /**\r\n     * buildCustom\r\n     * @param config\r\n     * @return string\r\n     * @private\r\n     */\r\n    Notification.prototype.buildCustom = function (config) {\r\n        var closed = config.closed, children = config.children;\r\n        // console.log('IShowConfig', config);\r\n        var id = (0, uuid_1.v1)();\r\n        var n = document.createElement('li');\r\n        n.dataset.id = id;\r\n        var Component = function () { return (react_1.default.createElement(react_1.default.Fragment, null,\r\n            react_1.default.createElement(\"div\", { className: \"info\" }, children),\r\n            closed ? react_1.default.createElement(\"span\", { className: \"closeBtn\" }) : null)); };\r\n        client_1.default.createRoot(n).render(react_1.default.createElement(Component, null));\r\n        return this.build(id, n);\r\n    };\r\n    /**\r\n     * buildStandard\r\n     * @param config\r\n     * @return string\r\n     * @private\r\n     */\r\n    Notification.prototype.buildStandard = function (config) {\r\n        var _a = config.headerLabel, headerLabel = _a === void 0 ? '' : _a, _b = config.headerIcon, headerIcon = _b === void 0 ? '' : _b, _c = config.title, title = _c === void 0 ? '' : _c, _d = config.text, text = _d === void 0 ? '' : _d, _e = config.icon, icon = _e === void 0 ? '' : _e, _f = config.closed, closed = _f === void 0 ? true : _f, _g = config.datetime, datetime = _g === void 0 ? '' : _g;\r\n        // console.log('IShowStandardConfig', config);\r\n        var id = (0, uuid_1.v1)();\r\n        var n = document.createElement('li');\r\n        n.dataset.id = id;\r\n        var Component = function () { return (react_1.default.createElement(react_1.default.Fragment, null,\r\n            react_1.default.createElement(\"div\", { className: \"info\" },\r\n                react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header\") },\r\n                    react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-icon\") }, headerIcon ? react_1.default.createElement(\"img\", { src: headerIcon, alt: \"\" }) : null),\r\n                    react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-header-label\") }, headerLabel || '')),\r\n                react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content\") },\r\n                    react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-l\") }, icon ? react_1.default.createElement(\"img\", { src: icon, alt: \"\" }) : null),\r\n                    react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row\") },\r\n                        react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-title\") }, title || ''),\r\n                        react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-row-text\") }, text || '')),\r\n                    react_1.default.createElement(\"div\", { className: \"\".concat(selectorPrefix, \"-standard-content-media-r\") }, datetime || ''))),\r\n            closed ? react_1.default.createElement(\"span\", { className: \"closeBtn\" }) : null)); };\r\n        client_1.default.createRoot(n).render(react_1.default.createElement(Component, null));\r\n        return this.build(id, n);\r\n    };\r\n    /**\r\n     * build\r\n     * @param id\r\n     * @param n\r\n     * @return string\r\n     * @private\r\n     */\r\n    Notification.prototype.build = function (id, n) {\r\n        var self = this;\r\n        this.notifications[id] = n;\r\n        // @ts-ignore\r\n        this.notificationContainer.appendChild(n);\r\n        setTimeout(function () {\r\n            // onCreate\r\n            self.trigger('onCreate', n);\r\n            n.style.height = 'auto';\r\n            var targetHeight = n.clientHeight;\r\n            // 会有最小高度的限制\r\n            if (self.config.style === 'material') {\r\n                if (targetHeight < 40) {\r\n                    targetHeight = 40;\r\n                }\r\n            }\r\n            else if (self.config.style === 'ios') {\r\n                if (targetHeight < 70) {\r\n                    targetHeight = 70;\r\n                }\r\n            }\r\n            n.style.height = '0';\r\n            setTimeout(function () {\r\n                n.style.height = \"\".concat(targetHeight, \"px\");\r\n                n.querySelector('.info').style.opacity = '1';\r\n                self.trigger('onShow', n);\r\n            }, 100);\r\n        }, 100);\r\n        return id;\r\n    };\r\n    /**\r\n     * trigger\r\n     * @param action\r\n     * @param params\r\n     * @private\r\n     */\r\n    Notification.prototype.trigger = function (action, params) {\r\n        if (this.config[action]) {\r\n            this.config[action](params);\r\n        }\r\n    };\r\n    /**\r\n     * show\r\n     * @param {Object} config\r\n     * @return {string} id\r\n     */\r\n    Notification.prototype.show = function (config) {\r\n        return this.buildCustom(config);\r\n    };\r\n    /**\r\n     * showStandard\r\n     * @param {Object} config\r\n     * @return {string} id\r\n     */\r\n    Notification.prototype.showStandard = function (config) {\r\n        return this.buildStandard(config);\r\n    };\r\n    /**\r\n     * close\r\n     * @param {string} id\r\n     */\r\n    Notification.prototype.close = function (id) {\r\n        this.closeNotification(id);\r\n    };\r\n    return Notification;\r\n}());\r\n/**\r\n * NotificationFactory\r\n */\r\nexports.default = {\r\n    /**\r\n     * build\r\n     * @param container\r\n     * @param config\r\n     * @return Notification\r\n     */\r\n    build: function (container, config) {\r\n        return new Notification(container, config);\r\n    },\r\n};\r\n"],"names":["__importDefault","this","mod","__esModule","default","react_1","Object","defineProperty","exports","value","require","client_1","uuid_1","selectorPrefix","Notification","container","config","style","type","notifications","key","assign","createInnerContainer","init","initEvents","prototype","_a","innerContainer","querySelector","concat","parentElement","removeChild","document","createElement","className","notificationContainer","appendChild","_b","classList","remove","join","add","self","addEventListener","e","target","contains","closeNotification","call","parentNode","dataset","id","n","trigger","transitionendAction","removeEventListener","overflow","opacity","height","buildCustom","closed","children","v1","createRoot","render","Fragment","build","buildStandard","headerLabel","headerIcon","_c","title","_d","text","_e","icon","_f","_g","datetime","src","alt","setTimeout","targetHeight","clientHeight","action","params","show","showStandard","close"],"mappings":"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"}