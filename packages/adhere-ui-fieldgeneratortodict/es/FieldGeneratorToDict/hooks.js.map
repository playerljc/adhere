{"version":3,"file":"hooks.js","sources":["FieldGeneratorToDict/hooks.js"],"sourcesContent":["var __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useMount, useUpdateEffect } from 'ahooks';\nimport { useCallback, useState } from 'react';\nimport Dict from '@baifendian/adhere-util-dict';\nimport { deepDep } from './util';\n/**\n * useDict\n * @description 静态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nexport function useDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = Dict.value[dictName].value;\n  var _b = useState([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  function loadData() {\n    if (dictValue instanceof Function) {\n      setDataSource(dictValue(cascadeParams));\n    } else {\n      setDataSource(dictValue);\n    }\n  }\n  useMount(function () {\n    loadData();\n  });\n  useUpdateEffect(function () {\n    loadData();\n  }, [deepDep(cascadeParams)]);\n  useUpdateEffect(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return dataSource;\n}\n/**\n * useDynamicDict\n * @description 动态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nexport function useDynamicDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var _b = useState([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  var dictValue = Dict.value[dictName].value;\n  function loadData() {\n    if (dictValue instanceof Function) {\n      dictValue(cascadeParams).then(function (res) {\n        setDataSource(res);\n      });\n    } else if (dictValue.then) {\n      dictValue.then(function (res) {\n        setDataSource(res);\n      });\n    }\n  }\n  useMount(function () {\n    loadData();\n  });\n  useUpdateEffect(function () {\n    loadData();\n  }, [deepDep(cascadeParams)]);\n  useUpdateEffect(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return dataSource;\n}\n/**\n * useAutoCompleteDict\n * @description AutoComplete处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nexport function useAutoCompleteDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = Dict.value[dictName].value;\n  var _b = useState([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  useUpdateEffect(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return {\n    options: __spreadArray([], dataSource, true),\n    loadData: function loadData(_kw) {\n      return new Promise(function (resolve, reject) {\n        dictValue(_kw, cascadeParams).then(function (res) {\n          setDataSource(res);\n          resolve();\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  };\n}\n/**\n * usePaging\n * @description 分页的处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nexport function usePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = Dict.value[dictName].value;\n  // @ts-ignore\n  return useCallback(function () {\n    return function (page, limit) {\n      return dictValue(page, limit, cascadeParams).then(function (res) {\n        onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res);\n        return res;\n      });\n    };\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\n/**\n * useAutoCompletePaging\n * @description AutoComplete的分页处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nexport function useAutoCompletePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = Dict.value[dictName].value;\n  // @ts-ignore\n  return useCallback(function () {\n    return function (page, limit, kw) {\n      return dictValue(page, limit, kw, cascadeParams).then(function (res) {\n        onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res);\n        return res;\n      });\n    };\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\n/**\n * useAsyncTree\n * @description TreeSelece或Cascader的Async\n * @param {string} dictName 字典名称\n */\nexport function useAsyncTree(_a) {\n  var dictName = _a.dictName;\n  var dictValue = Dict.value[dictName].value;\n  // @ts-ignore\n  return useCallback(function () {\n    return dictValue;\n  }, [dictName]);\n}"],"names":["__spreadArray","this","to","from","pack","arguments","length","ar","i","l","Array","prototype","slice","call","concat","useMount","useUpdateEffect","useCallback","useState","Dict","deepDep","useDict","_a","dictName","cascadeParams","onDataSourceChange","dictValue","value","_b","dataSource","setDataSource","loadData","Function","useDynamicDict","then","res","useAutoCompleteDict","options","_kw","Promise","resolve","reject","catch","error","usePaging","page","limit","useAutoCompletePaging","kw","useAsyncTree"],"mappings":"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"}