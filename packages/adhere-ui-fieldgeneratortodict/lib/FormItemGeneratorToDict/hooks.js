"use strict";var __spreadArray=function(e,t,r){if(r||2===arguments.length)for(var n,u=0,a=t.length;u<a;u++)!n&&u in t||((n=n||Array.prototype.slice.call(t,0,u))[u]=t[u]);return e.concat(n||Array.prototype.slice.call(t))},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},ahooks_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.useAsyncTreeSelect=exports.useTreeSelectLeaf=void 0,require("ahooks")),react_1=require("react"),adhere_util_dict_1=__importDefault(require("@baifendian/adhere-util-dict")),util_1=require("./util");function useTreeSelectLeaf(t){return(0,react_1.useMemo)(function(){var e=JSON.parse(JSON.stringify(t));return function t(e){(e||[]).forEach(function(e){e.disabled=!("leaf"in e&&e.leaf),t(e.children)})}(e),e},[t])}function useAsyncTreeSelect(e,t){function n(e,u){return function e(t){for(var r,n=0;n<t.length;n++){if(t[n].value===u){r=t[n];break}if(r=e(t[n].children||[]))break}return r}(e)}function r(){_(null!=c?c:"",a).then(function(e){s(e)})}function u(){var e,t;null!=(t=null==(e=null==i?void 0:i(l,a))?void 0:e.then)&&t.call(e,function(e){e&&Array.isArray(e)&&e.length&&s(e)})}var a=t.cascadeParams,o=t.onDataSourceChange,i=t.fetchBranch,c=t.defaultId,l=t.value,t=(0,react_1.useState)([]),f=t[0],s=t[1],d=(0,ahooks_1.usePrevious)(l),_=adhere_util_dict_1.default.value[e].value;return(0,ahooks_1.useMount)(function(){(l&&(!Array.isArray(l)||l.length)?u:r)()}),(0,ahooks_1.useUpdateEffect)(function(){!d&&l&&u()},[l]),(0,ahooks_1.useUpdateEffect)(function(){(l?u:r)()},[(0,util_1.deepDep)(a)]),(0,ahooks_1.useUpdateEffect)(function(){null!=o&&o(f)},[f]),{treeData:f,onLoadData:function(e){var r=e.value;return new Promise(function(e){setTimeout(function(){_(r,a).then(function(e){return e}).then(function(t){s(function(e){return n(e,r).children=t,__spreadArray([],e,!0)})}),e(void 0)},300)})}}}exports.useTreeSelectLeaf=useTreeSelectLeaf,exports.useAsyncTreeSelect=useAsyncTreeSelect;
//# sourceMappingURL=hooks.js.map
