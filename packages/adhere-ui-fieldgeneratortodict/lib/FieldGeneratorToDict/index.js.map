{"version":3,"file":"index.js","sources":["FieldGeneratorToDict/index.js"],"sourcesContent":["\"use strict\";\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AsyncTreeEntityValueHOC = exports.TreeEntityValueHOC = exports.ArrayEntityValueHOC = exports.genDictComponentName = exports.getDictComponent = exports.ItemNames = exports.Components = exports.validatorMulti = exports.validatorNormal = void 0;\nvar ArrayEntityValueHOC_1 = __importDefault(require(\"./ArrayEntityValueHOC\"));\nexports.ArrayEntityValueHOC = ArrayEntityValueHOC_1.default;\nvar AsyncTreeEntityValueHOC_1 = __importDefault(require(\"./AsyncTreeEntityValueHOC\"));\nexports.AsyncTreeEntityValueHOC = AsyncTreeEntityValueHOC_1.default;\nvar Components_1 = __importDefault(require(\"./Components\"));\nexports.Components = Components_1.default;\nvar ItemFactory_1 = __importDefault(require(\"./ItemFactory\"));\nvar TreeEntityValueHOC_1 = __importDefault(require(\"./TreeEntityValueHOC\"));\nexports.TreeEntityValueHOC = TreeEntityValueHOC_1.default;\nrequire(\"./fields/AutoComplete\");\nrequire(\"./fields/Breadcrumb\");\nrequire(\"./fields/Cascader\");\nrequire(\"./fields/CheckBox\");\nrequire(\"./fields/Dropdown\");\nrequire(\"./fields/List\");\nrequire(\"./fields/Mentions\");\nrequire(\"./fields/Menu\");\nrequire(\"./fields/MobileCascaderView\");\nrequire(\"./fields/MobileCheckList\");\nrequire(\"./fields/MobileCheckbox\");\nrequire(\"./fields/MobileList\");\nrequire(\"./fields/MobileRadio\");\nrequire(\"./fields/MobileSelector\");\nrequire(\"./fields/Radio\");\nrequire(\"./fields/Segmented\");\nrequire(\"./fields/Select\");\nrequire(\"./fields/Steps\");\nrequire(\"./fields/Table\");\nrequire(\"./fields/Tag\");\nrequire(\"./fields/Timeline\");\nrequire(\"./fields/Transfer\");\nrequire(\"./fields/TreeSelect\");\nvar validatorNormal = function validatorNormal(message) {\n  return {\n    validator: function validator(_, value) {\n      if (!value) {\n        return Promise.reject(message);\n      }\n      return Promise.resolve();\n    }\n  };\n};\nexports.validatorNormal = validatorNormal;\nvar validatorMulti = function validatorMulti(message) {\n  return {\n    validator: function validator(_, value) {\n      if (!value) {\n        return Promise.reject(message);\n      }\n      if (Array.isArray(value) && !value.length) {\n        return Promise.reject(message);\n      }\n      return Promise.resolve();\n    }\n  };\n};\nexports.validatorMulti = validatorMulti;\nvar dictComponentHash = Object.entries(Components_1.default).reduce(function (ret, entry) {\n  var componentName = entry[0],\n    functionNameHash = entry[1];\n  var functionNameArray = Object.keys(functionNameHash);\n  functionNameArray.forEach(function (functionName) {\n    var dictComponentName = functionNameHash[functionName];\n    ret[dictComponentName] = {\n      componentName: componentName,\n      functionName: functionName\n    };\n  });\n  return ret;\n}, {});\nvar ItemNames = Object.entries(Components_1.default).reduce(function (ret, entry) {\n  var componentName = entry[0],\n    functionNameHash = entry[1];\n  var functionNameArray = Object.keys(functionNameHash);\n  ret.set(componentName, functionNameArray);\n  return ret;\n}, new Map());\nexports.ItemNames = ItemNames;\n/**\n * 生成字典组件名\n * @param dictName - 字典名\n * @param componentName - 组件名 (如: SelectFormItem)，可通过 Components 获取\n * @example\n * ```js\n * const dictComponentName = genDictComponentName('SystemUsers', Components.Select.FormItem);\n * ```\n */\nvar genDictComponentName = function genDictComponentName(dictName, componentName) {\n  return \"\".concat(dictName).concat(componentName);\n};\nexports.genDictComponentName = genDictComponentName;\n/**\n * 获取字典组件\n * @param dictName - 字典名\n * @param componentName - 组件名 (如: SelectFormItem)，可通过 Components 获取\n * @returns\n */\nvar getDictComponent = function getDictComponent(dictName, componentName) {\n  var _a = dictComponentHash[componentName],\n    itemName = _a.componentName,\n    functionName = _a.functionName;\n  return (0, ItemFactory_1.default)({\n    dictName: dictName,\n    itemName: itemName,\n    functionName: functionName\n  });\n};\nexports.getDictComponent = getDictComponent;\nvar ProxyComponent = new Proxy({}, {\n  get: function get(target, p, receiver) {\n    // p\n    // p = SystemAppBasicLayoutRectifyTransferListSectionSelectDynamicMultiFormItem\n    // p = SystemAppBasicLayoutRectifyTransferListSectionSelectDynamic + MultiFormItem\n    // (业务名 + 组件名 + 功能名)\n    // p = SystemAppBasicLayoutRectifyTransferListSection + SelectDynamic + MultiFormItem\n    var _a;\n    if (p === '$$typeof') return Reflect.get(target, p, receiver);\n    // 存在则返回\n    if (p in target && !!target[p]) return Reflect.get(target, p, receiver);\n    // 组件名\n    var itemName;\n    // 功能名\n    var functionName;\n    // 根据 p 进行匹配的结果\n    var matches = [];\n    // 所有组件名称\n    var itemNames = Array.from(ItemNames.keys());\n    var _loop_1 = function _loop_1(i) {\n      // Components的key\n      var _itemName = itemNames[i];\n      // key的值\n      var _functionNames = (_a = ItemNames.get(_itemName)) !== null && _a !== void 0 ? _a : [];\n      var _functionNameIndex = _functionNames.findIndex(function (_functionName) {\n        var concatName = \"\".concat(_itemName).concat(_functionName);\n        return p.endsWith(concatName);\n      });\n      if (_functionNameIndex !== -1) {\n        itemName = _itemName;\n        functionName = _functionNames[_functionNameIndex];\n        matches.push({\n          itemName: itemName,\n          functionName: functionName\n        });\n      }\n    };\n    // loop start\n    for (var i = 0; i < itemNames.length; i++) {\n      _loop_1(i);\n    }\n    // loop end\n    // 没有匹配到\n    if (matches.length === 0) {\n      return;\n    }\n    // 匹配大于1，进行合并后的长度从大到小排序，找出最精确的匹配值\n    if (matches.length > 1) {\n      matches.sort(function (t1, t2) {\n        var str1 = \"\".concat(t1.itemName).concat(t1.functionName);\n        var str2 = \"\".concat(t2.itemName).concat(t2.functionName);\n        if (str1.length > str2.length) return -1;else if (str1.length < str2.length) return 1;else return 0;\n      });\n    }\n    itemName = matches[0].itemName;\n    functionName = matches[0].functionName;\n    // 字典名\n    var dictName = p.substring(0, p.lastIndexOf(functionName));\n    receiver[p] = (0, ItemFactory_1.default)({\n      itemName: itemName,\n      functionName: functionName,\n      dictName: dictName\n    });\n    return Reflect.get(target, p, receiver);\n  }\n});\nexports.default = ProxyComponent;"],"names":["__importDefault","mod","__esModule","default","ArrayEntityValueHOC_1","Object","defineProperty","exports","value","AsyncTreeEntityValueHOC","TreeEntityValueHOC","ArrayEntityValueHOC","genDictComponentName","getDictComponent","ItemNames","Components","validatorMulti","validatorNormal","require","AsyncTreeEntityValueHOC_1","Components_1","ItemFactory_1","TreeEntityValueHOC_1","message","validator","_","Promise","resolve","reject","Array","isArray","length","dictComponentHash","entries","reduce","ret","entry","componentName","functionNameHash","keys","forEach","functionName","dictComponentName","functionNameArray","set","Map","dictName","concat","_a","itemName","ProxyComponent","Proxy","get","target","p","receiver","Reflect","matches","itemNames","from","i","_loop_1","_itemName","_functionNames","_functionNameIndex","findIndex","_functionName","concatName","endsWith","push","sort","t1","t2","str1","str2","substring","lastIndexOf"],"mappings":"AAAA,aAEA,IAAIA,gBAAwD,SAAUC,GACpE,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CACnCE,QAAWF,CACb,CACF,EAKIG,uBAJJC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EACDD,QAAQE,wBAA0BF,QAAQG,mBAAqBH,QAAQI,oBAAsBJ,QAAQK,qBAAuBL,QAAQM,iBAAmBN,QAAQO,UAAYP,QAAQQ,WAAaR,QAAQS,eAAiBT,QAAQU,gBAAkB,KAAA,EACvNjB,gBAAgBkB,QAAQ,uBAAuB,CAAC,GAExEC,2BADJZ,QAAQI,oBAAsBP,sBAAsBD,QACpBH,gBAAgBkB,QAAQ,2BAA2B,CAAC,GAEhFE,cADJb,QAAQE,wBAA0BU,0BAA0BhB,QACzCH,gBAAgBkB,QAAQ,cAAc,CAAC,GAEtDG,eADJd,QAAQQ,WAAaK,aAAajB,QACdH,gBAAgBkB,QAAQ,eAAe,CAAC,GACxDI,qBAAuBtB,gBAAgBkB,QAAQ,sBAAsB,CAAC,EAyBtED,iBAxBJV,QAAQG,mBAAqBY,qBAAqBnB,QAClDe,QAAQ,uBAAuB,EAC/BA,QAAQ,qBAAqB,EAC7BA,QAAQ,mBAAmB,EAC3BA,QAAQ,mBAAmB,EAC3BA,QAAQ,mBAAmB,EAC3BA,QAAQ,eAAe,EACvBA,QAAQ,mBAAmB,EAC3BA,QAAQ,eAAe,EACvBA,QAAQ,6BAA6B,EACrCA,QAAQ,0BAA0B,EAClCA,QAAQ,yBAAyB,EACjCA,QAAQ,qBAAqB,EAC7BA,QAAQ,sBAAsB,EAC9BA,QAAQ,yBAAyB,EACjCA,QAAQ,gBAAgB,EACxBA,QAAQ,oBAAoB,EAC5BA,QAAQ,iBAAiB,EACzBA,QAAQ,gBAAgB,EACxBA,QAAQ,gBAAgB,EACxBA,QAAQ,cAAc,EACtBA,QAAQ,mBAAmB,EAC3BA,QAAQ,mBAAmB,EAC3BA,QAAQ,qBAAqB,EACP,SAAyBK,GAC7C,MAAO,CACLC,UAAW,SAAmBC,EAAGjB,GAC/B,OAAKA,EAGEkB,QAAQC,QAAQ,EAFdD,QAAQE,OAAOL,CAAO,CAGjC,CACF,CACF,GAEIP,gBADJT,QAAQU,gBAAkBA,gBACL,SAAwBM,GAC3C,MAAO,CACLC,UAAW,SAAmBC,EAAGjB,GAC/B,MAAKA,CAAAA,GAGDqB,MAAMC,QAAQtB,CAAK,GAAK,CAACA,EAAMuB,OAF1BL,QAAQE,OAAOL,CAAO,EAKxBG,QAAQC,QAAQ,CACzB,CACF,CACF,GAEIK,mBADJzB,QAAQS,eAAiBA,eACDX,OAAO4B,QAAQb,aAAajB,OAAO,EAAE+B,OAAO,SAAUC,EAAKC,GACjF,IAAIC,EAAgBD,EAAM,GACxBE,EAAmBF,EAAM,GAS3B,OARwB/B,OAAOkC,KAAKD,CAAgB,EAClCE,QAAQ,SAAUC,GAClC,IAAIC,EAAoBJ,EAAiBG,GACzCN,EAAIO,GAAqB,CACvBL,cAAeA,EACfI,aAAcA,CAChB,CACF,CAAC,EACMN,CACT,EAAG,EAAE,GACDrB,UAAYT,OAAO4B,QAAQb,aAAajB,OAAO,EAAE+B,OAAO,SAAUC,EAAKC,GACzE,IAAIC,EAAgBD,EAAM,GACxBE,EAAmBF,EAAM,GACvBO,EAAoBtC,OAAOkC,KAAKD,CAAgB,EAEpD,OADAH,EAAIS,IAAIP,EAAeM,CAAiB,EACjCR,CACT,EAAG,IAAIU,GAAK,EAWRjC,sBAVJL,QAAQO,UAAYA,UAUO,SAA8BgC,EAAUT,GACjE,MAAO,GAAGU,OAAOD,CAAQ,EAAEC,OAAOV,CAAa,CACjD,GAQIxB,kBAPJN,QAAQK,qBAAuBA,qBAOR,SAA0BkC,EAAUT,GACzD,IAAIW,EAAKhB,kBAAkBK,GACzBY,EAAWD,EAAGX,cACdI,EAAeO,EAAGP,aACpB,OAAO,EAAIpB,cAAclB,SAAS,CAChC2C,SAAUA,EACVG,SAAUA,EACVR,aAAcA,CAChB,CAAC,CACH,GAEIS,gBADJ3C,QAAQM,iBAAmBA,iBACN,IAAIsC,MAAM,GAAI,CACjCC,IAAK,SAAaC,EAAQC,EAAGC,GAM3B,IAAIP,EACJ,GAAU,aAANM,EAAkB,OAAOE,QAAQJ,IAAIC,EAAQC,EAAGC,CAAQ,EAE5D,GAAID,KAAKD,GAAYA,EAAOC,GAAI,OAAOE,QAAQJ,IAAIC,EAAQC,EAAGC,CAAQ,EA4BtE,IAtBA,IAsCAN,EACAR,EAEIK,EAzCAW,EAAU,GAEVC,EAAY7B,MAAM8B,KAAK7C,UAAUyB,KAAK,CAAC,EAoBlCqB,EAAI,EAAGA,EAAIF,EAAU3B,OAAQ6B,CAAC,GACrCC,CApBY,SAAiBD,GAE7B,IAAIE,EAAYJ,EAAUE,GAEtBG,EAAiB,OAACf,EAAKlC,UAAUsC,IAAIU,CAAS,GAA+Bd,EAAK,GAClFgB,EAAqBD,EAAeE,UAAU,SAAUC,GACtDC,EAAa,GAAGpB,OAAOe,CAAS,EAAEf,OAAOmB,CAAa,EAC1D,OAAOZ,EAAEc,SAASD,CAAU,CAC9B,CAAC,EAC0B,CAAC,IAAxBH,IACFf,EAAWa,EACXrB,EAAesB,EAAeC,GAC9BP,EAAQY,KAAK,CACXpB,SAAUA,EACVR,aAAcA,CAChB,CAAC,EAEL,EAGUmB,CAAC,EAIX,OAAuB,IAAnBH,EAAQ1B,QAIS,EAAjB0B,EAAQ1B,QACV0B,EAAQa,KAAK,SAAUC,EAAIC,GACrBC,EAAO,GAAG1B,OAAOwB,EAAGtB,QAAQ,EAAEF,OAAOwB,EAAG9B,YAAY,EACpDiC,EAAO,GAAG3B,OAAOyB,EAAGvB,QAAQ,EAAEF,OAAOyB,EAAG/B,YAAY,EACxD,OAAIgC,EAAK1C,OAAS2C,EAAK3C,OAAe,CAAC,EAAW0C,EAAK1C,OAAS2C,EAAK3C,OAAe,EAAc,CACpG,CAAC,EAEHkB,EAAWQ,EAAQ,GAAGR,SACtBR,EAAegB,EAAQ,GAAGhB,aAEtBK,EAAWQ,EAAEqB,UAAU,EAAGrB,EAAEsB,YAAYnC,CAAY,CAAC,EACzDc,EAASD,IAAK,EAAIjC,cAAclB,SAAS,CACvC8C,SAAUA,EACVR,aAAcA,EACdK,SAAUA,CACZ,CAAC,EACMU,QAAQJ,IAAIC,EAAQC,EAAGC,CAAQ,GApBtC,KAAA,CAqBF,CACF,CAAC,GACDhD,QAAQJ,QAAU+C"}