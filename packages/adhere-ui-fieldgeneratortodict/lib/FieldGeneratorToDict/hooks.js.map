{"version":3,"file":"Hooks.js","sources":["FieldGeneratorToDict/Hooks.js"],"sourcesContent":["\"use strict\";\n\nvar __spreadArray = void 0 && (void 0).__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useAsyncTree = exports.useAutoCompletePaging = exports.usePaging = exports.useAutoCompleteDict = exports.useDynamicDict = exports.useDict = void 0;\nvar ahooks_1 = require(\"ahooks\");\nvar react_1 = require(\"react\");\nvar adhere_util_dict_1 = __importDefault(require(\"@baifendian/adhere-util-dict\"));\nvar Util_1 = require(\"./Util\");\n/**\n * useDict\n * @description 静态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  function loadData() {\n    if (dictValue instanceof Function) {\n      setDataSource(dictValue(cascadeParams));\n    } else {\n      setDataSource(dictValue);\n    }\n  }\n  (0, ahooks_1.useMount)(function () {\n    loadData();\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    loadData();\n  }, [(0, Util_1.deepDep)(cascadeParams)]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return dataSource;\n}\nexports.useDict = useDict;\n/**\n * useDynamicDict\n * @description 动态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useDynamicDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  function loadData() {\n    if (dictValue instanceof Function) {\n      dictValue(cascadeParams).then(function (res) {\n        setDataSource(res);\n      });\n    } else if (dictValue.then) {\n      dictValue.then(function (res) {\n        setDataSource(res);\n      });\n    }\n  }\n  (0, ahooks_1.useMount)(function () {\n    loadData();\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    loadData();\n  }, [(0, Util_1.deepDep)(cascadeParams)]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  // @ts-ignore\n  return __spreadArray([], dataSource, true);\n}\nexports.useDynamicDict = useDynamicDict;\n/**\n * useAutoCompleteDict\n * @description AutoComplete处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useAutoCompleteDict(_a) {\n  var _b;\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  var _c = (0, react_1.useState)([]),\n    dataSource = _c[0],\n    setDataSource = _c[1];\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return {\n    options: __spreadArray([], (_b = dataSource) !== null && _b !== void 0 ? _b : [], true),\n    loadData: function loadData(_kw) {\n      return new Promise(function (resolve, reject) {\n        dictValue(_kw, cascadeParams).then(function (res) {\n          setDataSource(res);\n          resolve();\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  };\n}\nexports.useAutoCompleteDict = useAutoCompleteDict;\n/**\n * usePaging\n * @description 分页的处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction usePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  return (0, react_1.useCallback)(function (page, limit) {\n    return dictValue(page, limit, cascadeParams).then(function (res) {\n      onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res, {\n        type: 'paging',\n        info: {\n          page: page,\n          limit: limit\n        }\n      });\n      return res;\n    });\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\nexports.usePaging = usePaging;\n/**\n * useAutoCompletePaging\n * @description AutoComplete的分页处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useAutoCompletePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  return (0, react_1.useCallback)(function (page, limit, kw) {\n    return dictValue(page, limit, kw, cascadeParams).then(function (res) {\n      onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res, {\n        type: 'paging',\n        info: {\n          page: page,\n          limit: limit\n        }\n      });\n      return res;\n    });\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\nexports.useAutoCompletePaging = useAutoCompletePaging;\n/**\n * useAsyncTree\n * @description TreeSelece或Cascader的Async\n * @param {string} dictName 字典名称\n */\nfunction useAsyncTree(_a) {\n  var dictName = _a.dictName;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  return (0, react_1.useCallback)(dictValue, [dictName]);\n}\nexports.useAsyncTree = useAsyncTree;"],"names":["__spreadArray","to","from","pack","arguments","length","ar","i","l","Array","prototype","slice","call","concat","__importDefault","mod","__esModule","default","ahooks_1","Object","defineProperty","exports","value","useAsyncTree","useAutoCompletePaging","usePaging","useAutoCompleteDict","useDynamicDict","useDict","require","react_1","adhere_util_dict_1","Util_1","_a","dictName","cascadeParams","onDataSourceChange","dictValue","_b","useState","dataSource","setDataSource","loadData","Function","useMount","useUpdateEffect","deepDep","then","res","_c","options","_kw","Promise","resolve","reject","catch","error","useCallback","page","limit","type","info","kw"],"mappings":"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"}