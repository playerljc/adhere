{"version":3,"file":"Hooks.js","sources":["FieldGeneratorToDict/Hooks.js"],"sourcesContent":["\"use strict\";\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useAsyncTree = exports.useAutoCompletePaging = exports.usePaging = exports.useTreeAutoCompleteDict = exports.useAutoCompleteDict = exports.useDynamicDict = exports.useDict = void 0;\nvar ahooks_1 = require(\"ahooks\");\nvar react_1 = require(\"react\");\nvar adhere_util_dict_1 = __importDefault(require(\"@baifendian/adhere-util-dict\"));\nvar Util_1 = require(\"./Util\");\n/**\n * useDict\n * @description 静态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  function loadData() {\n    if (dictValue instanceof Function) {\n      setDataSource(dictValue(cascadeParams));\n    } else {\n      setDataSource(dictValue);\n    }\n  }\n  (0, ahooks_1.useMount)(function () {\n    loadData();\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    loadData();\n  }, [(0, Util_1.deepDep)(cascadeParams)]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return dataSource;\n}\nexports.useDict = useDict;\n/**\n * useDynamicDict\n * @description 动态字典处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useDynamicDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  function loadData() {\n    if (dictValue instanceof Function) {\n      dictValue(cascadeParams).then(function (res) {\n        setDataSource(res);\n      });\n    } else if (dictValue.then) {\n      dictValue.then(function (res) {\n        setDataSource(res);\n      });\n    }\n  }\n  (0, ahooks_1.useMount)(function () {\n    loadData();\n  });\n  (0, ahooks_1.useUpdateEffect)(function () {\n    loadData();\n  }, [(0, Util_1.deepDep)(cascadeParams)]);\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  return dataSource;\n}\nexports.useDynamicDict = useDynamicDict;\n/**\n * useAutoCompleteDict\n * @description AutoComplete处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useAutoCompleteDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  var loadData = (0, react_1.useCallback)(function (_kw) {\n    return new Promise(function (resolve, reject) {\n      dictValue(_kw, cascadeParams).then(function (res) {\n        setDataSource(res);\n        resolve();\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  }, [cascadeParams]);\n  return {\n    // @ts-ignore\n    options: dataSource /*[...((dataSource as any) ?? [])]*/,\n    loadData: loadData\n  };\n}\nexports.useAutoCompleteDict = useAutoCompleteDict;\n/**\n * useTreeAutoCompleteDict\n * @param dictName\n * @param cascadeParams\n * @param onDataSourceChange\n */\nfunction useTreeAutoCompleteDict(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  var _b = (0, react_1.useState)([]),\n    dataSource = _b[0],\n    setDataSource = _b[1];\n  (0, ahooks_1.useUpdateEffect)(function () {\n    onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(dataSource);\n  }, [dataSource]);\n  var loadData = (0, react_1.useCallback)(function (_kw) {\n    return new Promise(function (resolve, reject) {\n      dictValue(_kw, cascadeParams).then(function (res) {\n        setDataSource(res);\n        resolve();\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  }, [cascadeParams]);\n  return {\n    // @ts-ignore\n    treeData: dataSource,\n    loadData: loadData\n  };\n}\nexports.useTreeAutoCompleteDict = useTreeAutoCompleteDict;\n/**\n * usePaging\n * @description 分页的处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction usePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  // @ts-ignore\n  return (0, react_1.useCallback)(function (page, limit) {\n    return dictValue(page, limit, cascadeParams).then(function (res) {\n      onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res, {\n        type: 'paging',\n        info: {\n          page: page,\n          limit: limit\n        }\n      });\n      return res;\n    });\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\nexports.usePaging = usePaging;\n/**\n * useAutoCompletePaging\n * @description AutoComplete的分页处理\n * @param {string} dictName 字典名称\n * @param {Object} cascadeParams 级联参数\n * @param {Function} onDataSourceChange dataSource改变\n */\nfunction useAutoCompletePaging(_a) {\n  var dictName = _a.dictName,\n    cascadeParams = _a.cascadeParams,\n    onDataSourceChange = _a.onDataSourceChange;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  return (0, react_1.useCallback)(function (page, limit, kw) {\n    return dictValue(page, limit, kw, cascadeParams).then(function (res) {\n      onDataSourceChange === null || onDataSourceChange === void 0 ? void 0 : onDataSourceChange(res, {\n        type: 'paging',\n        info: {\n          page: page,\n          limit: limit\n        }\n      });\n      return res;\n    });\n  }, [dictName, onDataSourceChange, cascadeParams]);\n}\nexports.useAutoCompletePaging = useAutoCompletePaging;\n/**\n * useAsyncTree\n * @description TreeSelece或Cascader的Async\n * @param {string} dictName 字典名称\n */\nfunction useAsyncTree(_a) {\n  var dictName = _a.dictName;\n  var dictValue = adhere_util_dict_1.default.value[dictName].value;\n  return (0, react_1.useCallback)(dictValue, [dictName]);\n}\nexports.useAsyncTree = useAsyncTree;"],"names":["__importDefault","mod","__esModule","default","ahooks_1","Object","defineProperty","exports","value","useAsyncTree","useAutoCompletePaging","usePaging","useTreeAutoCompleteDict","useAutoCompleteDict","useDynamicDict","useDict","require","react_1","adhere_util_dict_1","Util_1","_a","dictName","cascadeParams","onDataSourceChange","dictValue","_b","useState","dataSource","setDataSource","loadData","Function","useMount","useUpdateEffect","deepDep","then","res","useCallback","_kw","Promise","resolve","reject","catch","error","options","treeData","page","limit","type","info","kw"],"mappings":"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"}