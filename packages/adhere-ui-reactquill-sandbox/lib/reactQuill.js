"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<o;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,i++)n[i]=r[s];return n},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},isEqual_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("lodash/isEqual"))),quill_1=__importDefault(require("quill")),react_1=__importDefault(require("react")),react_dom_1=__importDefault(require("react-dom")),ReactQuill=function(e){function t(t){var r=e.call(this,t)||this,t=(r.dirtyProps=["modules","formats","bounds","theme","children"],r.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],r.state={generation:0},r.selection=null,r.onEditorChange=function(t,e,o,n){var i;"text-change"===t?null!=(i=r.onEditorChangeText)&&i.call(r,r.editor.root.innerHTML,e,n,r.unprivilegedEditor):"selection-change"===t&&null!=(i=r.onEditorChangeSelection)&&i.call(r,e,n,r.unprivilegedEditor)},r.isControlled()?t.value:t.defaultValue);return r.value=null!=t?t:"",r}return __extends(t,e),t.prototype.validateProps=function(t){if(1<react_1.default.Children.count(t.children))throw new Error("The Quill editing area can only be composed of a single React element.");if(react_1.default.Children.count(t.children)){var e=react_1.default.Children.only(t.children);if("textarea"===(null==e?void 0:e.type))throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&t.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},t.prototype.shouldComponentUpdate=function(e,t){var o,n=this;return this.validateProps(e),!this.editor||this.state.generation!==t.generation||("value"in e&&(t=this.getEditorContents(),o=null!=(o=e.value)?o:"",this.isEqualValue(o,t)||this.setEditorContents(this.editor,o)),e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),__spreadArrays(this.cleanProps,this.dirtyProps).some(function(t){return!isEqual_1.default(e[t],n.props[t])}))},t.prototype.shouldComponentRegenerate=function(e){var o=this;return this.dirtyProps.some(function(t){return!isEqual_1.default(e[t],o.props[t])})},t.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},t.prototype.componentWillUnmount=function(){this.destroyEditor()},t.prototype.componentDidUpdate=function(t,e){var o,n,i,r=this;this.editor&&this.shouldComponentRegenerate(t)&&(o=this.editor.getContents(),t=this.editor.getSelection(),this.regenerationSnapshot={delta:o,selection:t},this.setState({generation:this.state.generation+1}),this.destroyEditor()),this.state.generation!==e.generation&&(o=(t=this.regenerationSnapshot).delta,n=t.selection,delete this.regenerationSnapshot,this.instantiateEditor(),(i=this.editor).setContents(o),postpone(function(){return r.setEditorSelection(i,n)}))},t.prototype.instantiateEditor=function(){this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},t.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},t.prototype.isControlled=function(){return"value"in this.props},t.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},t.prototype.getEditor=function(){if(this.editor)return this.editor;throw new Error("Accessing non-instantiated editor")},t.prototype.createEditor=function(t,e){t=new quill_1.default(t,e);return null!=e.tabIndex&&this.setEditorTabIndex(t,e.tabIndex),this.hookEditor(t),t},t.prototype.hookEditor=function(t){this.unprivilegedEditor=this.makeUnprivilegedEditor(t),t.on("editor-change",this.onEditorChange)},t.prototype.unhookEditor=function(t){t.off("editor-change",this.onEditorChange)},t.prototype.getEditorContents=function(){return this.value},t.prototype.getEditorSelection=function(){return this.selection},t.prototype.isDelta=function(t){return t&&t.ops},t.prototype.isEqualValue=function(t,e){return this.isDelta(t)&&this.isDelta(e)?isEqual_1.default(t.ops,e.ops):isEqual_1.default(t,e)},t.prototype.setEditorContents=function(t,e){var o=this,n=(this.value=e,this.getEditorSelection());"string"==typeof e?t.setContents(t.clipboard.convert(e)):t.setContents(e),postpone(function(){return o.setEditorSelection(t,n)})},t.prototype.setEditorSelection=function(t,e){var o;(this.selection=e)&&(o=t.getLength(),e.index=Math.max(0,Math.min(e.index,o-1)),e.length=Math.max(0,Math.min(e.length,o-1-e.index)),t.setSelection(e))},t.prototype.setEditorTabIndex=function(t,e){var o;null!=(o=null==t?void 0:t.scroll)&&o.domNode&&(t.scroll.domNode.tabIndex=e)},t.prototype.setEditorReadOnly=function(t,e){e?t.disable():t.enable()},t.prototype.makeUnprivilegedEditor=function(t){var e=t;return{getHTML:function(){return e.root.innerHTML},getLength:e.getLength.bind(e),getText:e.getText.bind(e),getContents:e.getContents.bind(e),getSelection:e.getSelection.bind(e),getBounds:e.getBounds.bind(e)}},t.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var t=react_dom_1.default.findDOMNode(this.editingArea);if(!t)throw new Error("Cannot find element for editing area");if(3===t.nodeType)throw new Error("Editing area cannot be a text node");return t},t.prototype.renderEditingArea=function(){var e=this,t=this.props,o=t.children,t=t.preserveWhitespace,n={key:this.state.generation,ref:function(t){e.editingArea=t}};return react_1.default.Children.count(o)?react_1.default.cloneElement(react_1.default.Children.only(o),n):t?react_1.default.createElement("pre",__assign({},n)):react_1.default.createElement("div",__assign({},n))},t.prototype.render=function(){var t;return react_1.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(null!=(t=this.props.className)?t:""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},t.prototype.onEditorChangeText=function(t,e,o,n){var i,r;!this.editor||(r=this.isDelta(this.value)?n.getContents():n.getHTML())!==this.getEditorContents()&&(this.lastDeltaChangeSet=e,this.value=r,null!=(i=(r=this.props).onChange)&&i.call(r,t,e,o,n))},t.prototype.onEditorChangeSelection=function(t,e,o){var n,i,r,s,a;this.editor&&(s=!(r=this.getEditorSelection())&&t,a=r&&!t,isEqual_1.default(t,r)||(this.selection=t,null!=(n=(i=this.props).onChangeSelection)&&n.call(i,t,e,o),s?null!=(i=(n=this.props).onFocus)&&i.call(n,t,e,o):a&&null!=(i=(s=this.props).onBlur)&&i.call(s,r,e,o)))},t.prototype.focus=function(){this.editor&&this.editor.focus()},t.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},t.displayName="React Quill",t.Quill=quill_1.default,t.defaultProps={theme:"snow",modules:{},readOnly:!1},t}(react_1.default.Component);function postpone(t){Promise.resolve().then(t)}exports.default=ReactQuill;
//# sourceMappingURL=reactQuill.js.map
