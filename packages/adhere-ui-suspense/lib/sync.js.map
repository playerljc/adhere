{"version":3,"file":"sync.js","sources":["sync.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Empty } from 'antd';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\r\nimport Util from '@baifendian/adhere-util';\r\nimport Suspense from './suspense';\r\n/**\r\n * SuspenseSync\r\n * @class\r\n * @classdesc 传数据\r\n */\r\nvar SuspenseSync = /** @class */ (function (_super) {\r\n    __extends(SuspenseSync, _super);\r\n    function SuspenseSync() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = {\r\n            loading: true,\r\n        };\r\n        _this.isLoading = true;\r\n        return _this;\r\n    }\r\n    SuspenseSync.prototype.componentWillReceiveProps = function (nextProps) {\r\n        var _this = this;\r\n        var data = this.props.data;\r\n        if (this.isLoading && this.isDataDirty(data, nextProps.data)) {\r\n            this.setState({\r\n                loading: false,\r\n            }, function () {\r\n                _this.isLoading = false;\r\n            });\r\n        }\r\n    };\r\n    SuspenseSync.prototype.isDataDirty = function (data, nextData) {\r\n        if (typeof data !== typeof nextData)\r\n            return true;\r\n        if (Util.isObject(data) && Util.isObject(nextData)) {\r\n            return !Object.is(data, nextData);\r\n        }\r\n        if (Util.isArray(data) && Util.isArray(nextData)) {\r\n            if (data.length !== nextData.length)\r\n                return true;\r\n            return data.some(function (t1, index) { return !Object.is(t1, nextData[index]); });\r\n        }\r\n        return false;\r\n    };\r\n    SuspenseSync.prototype.reset = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            // 第一次\r\n            _this.isFirst = true;\r\n            // 第一次加载\r\n            _this.isFirstLoading = false;\r\n            _this.isLoading = true;\r\n            _this.setState({\r\n                loading: true,\r\n            }, function () { return resolve(); });\r\n        });\r\n    };\r\n    SuspenseSync.prototype.showLoading = function () {\r\n        return this.state.loading;\r\n    };\r\n    SuspenseSync.prototype.renderInner = function () {\r\n        var _a = this.props, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty, children = _a.children;\r\n        return (React.createElement(ConditionalRender, { conditional: !isEmpty(), noMatch: function () { return (renderEmpty ? renderEmpty() : React.createElement(Empty, null)); } }, function () { return children; }));\r\n    };\r\n    SuspenseSync.prototype.fetchData = function () { };\r\n    return SuspenseSync;\r\n}(Suspense));\r\nSuspenseSync.defaultProps = {};\r\nSuspenseSync.propTypes = {\r\n    firstLoading: PropTypes.node,\r\n    isEmpty: PropTypes.func.isRequired,\r\n    renderEmpty: PropTypes.func,\r\n};\r\nexport default SuspenseSync;\r\n"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","Empty","PropTypes","React","ConditionalRender","Util","Suspense","SuspenseSync","_super","_this","apply","arguments","state","loading","isLoading","componentWillReceiveProps","nextProps","data","props","isDataDirty","setState","nextData","isObject","is","isArray","length","some","t1","index","reset","Promise","resolve","isFirst","isFirstLoading","showLoading","renderInner","_a","isEmpty","renderEmpty","children","createElement","conditional","noMatch","fetchData","defaultProps","propTypes","firstLoading","node","func","isRequired"],"mappings":"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"}