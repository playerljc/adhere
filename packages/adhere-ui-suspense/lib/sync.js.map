{"version":3,"file":"sync.js","sources":["sync.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar antd_1 = require(\"antd\");\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\nvar react_1 = __importDefault(require(\"react\"));\nvar adhere_ui_conditionalrender_1 = __importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\nvar adhere_util_1 = __importDefault(require(\"@baifendian/adhere-util\"));\nvar suspense_1 = __importDefault(require(\"./suspense\"));\n/**\n * SuspenseSync\n * @class\n * @classdesc 传数据\n */\nvar SuspenseSync = /** @class */function (_super) {\n  __extends(SuspenseSync, _super);\n  function SuspenseSync() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      loading: true\n    };\n    _this.isLoading = true;\n    return _this;\n  }\n  SuspenseSync.prototype.componentWillReceiveProps = function (nextProps) {\n    var _this = this;\n    var data = this.props.data;\n    if (this.isLoading && this.isDataDirty(data, nextProps.data)) {\n      this.setState({\n        loading: false\n      }, function () {\n        _this.isLoading = false;\n      });\n    }\n  };\n  SuspenseSync.prototype.isDataDirty = function (data, nextData) {\n    if ((0, _typeof2.default)(data) !== (0, _typeof2.default)(nextData)) return true;\n    if (adhere_util_1.default.isObject(data) && adhere_util_1.default.isObject(nextData)) {\n      return !Object.is(data, nextData);\n    }\n    if (adhere_util_1.default.isArray(data) && adhere_util_1.default.isArray(nextData)) {\n      if (data.length !== nextData.length) return true;\n      return data.some(function (t1, index) {\n        return !Object.is(t1, nextData[index]);\n      });\n    }\n    return false;\n  };\n  SuspenseSync.prototype.reset = function () {\n    var _this = this;\n    return new Promise(function (resolve) {\n      // 第一次\n      _this.isFirst = true;\n      // 第一次加载\n      _this.isFirstLoading = false;\n      _this.isLoading = true;\n      _this.setState({\n        loading: true\n      }, function () {\n        return resolve();\n      });\n    });\n  };\n  SuspenseSync.prototype.showLoading = function () {\n    return this.state.loading;\n  };\n  SuspenseSync.prototype.renderInner = function () {\n    var _a = this.props,\n      isEmpty = _a.isEmpty,\n      renderEmpty = _a.renderEmpty,\n      children = _a.children;\n    return react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty ? renderEmpty() : react_1.default.createElement(antd_1.Empty, null);\n      }\n    }, function () {\n      return children;\n    });\n  };\n  SuspenseSync.prototype.fetchData = function () {};\n  return SuspenseSync;\n}(suspense_1.default);\nSuspenseSync.defaultProps = {};\nSuspenseSync.propTypes = {\n  firstLoading: prop_types_1.default.node,\n  isEmpty: prop_types_1.default.func.isRequired,\n  renderEmpty: prop_types_1.default.func,\n  data: prop_types_1.default.object\n};\nexports.default = SuspenseSync;"],"names":["_interopRequireDefault","require","_typeof2","__extends","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","__importDefault","mod","__esModule","default","antd_1","defineProperty","exports","value","prop_types_1","react_1","adhere_ui_conditionalrender_1","adhere_util_1","suspense_1","SuspenseSync","_super","_this","apply","arguments","state","loading","isLoading","componentWillReceiveProps","nextProps","data","props","isDataDirty","setState","nextData","isObject","is","isArray","length","some","t1","index","reset","Promise","resolve","isFirst","isFirstLoading","showLoading","renderInner","_a","isEmpty","renderEmpty","children","createElement","conditional","noMatch","Empty","fetchData","defaultProps","propTypes","firstLoading","node","func","isRequired","object"],"mappings":"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"}