{"version":3,"file":"async.js","sources":["async.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.promise.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = tslib_1.__importDefault(require(\"react\"));\n\nvar prop_types_1 = tslib_1.__importDefault(require(\"prop-types\"));\n\nvar antd_1 = require(\"antd\");\n\nvar adhere_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adhere-ui-conditionalrender\"));\n\nvar suspense_1 = tslib_1.__importDefault(require(\"./suspense\"));\n/**\n * SuspenseAsync\n * @class\n * @classdesc 调用接口\n */\n// @ts-ignore\n\n\nvar SuspenseAsync =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(SuspenseAsync, _super);\n\n  function SuspenseAsync() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n\n  SuspenseAsync.prototype.showLoading = function () {\n    return this.state.loading;\n  };\n\n  SuspenseAsync.prototype.renderInner = function () {\n    var _a = this.props,\n        isEmpty = _a.isEmpty,\n        renderEmpty = _a.renderEmpty,\n        children = _a.children;\n    return react_1.default.createElement(adhere_ui_conditionalrender_1.default, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty ? renderEmpty() : react_1.default.createElement(antd_1.Empty, null);\n      }\n    }, function () {\n      return children;\n    });\n  };\n\n  SuspenseAsync.prototype.reset = function () {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      // 第一次\n      _this.isFirst = true; // 第一次加载\n\n      _this.isFirstLoading = false;\n\n      _this.fetchData().then(function () {\n        return resolve();\n      }).catch(function () {\n        return resolve();\n      });\n    });\n  };\n\n  SuspenseAsync.prototype.fetchData = function () {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var _a, _b, _c, _d;\n\n      if (!_this.props.fetchData) {\n        _this.setState({\n          loading: false\n        });\n\n        resolve();\n        return;\n      }\n\n      _this.setState({\n        loading: true\n      });\n\n      return (_d = (_c = (_b = (_a = _this === null || _this === void 0 ? void 0 : _this.props) === null || _a === void 0 ? void 0 : _a.fetchData) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.then(function () {\n        _this.setState({\n          loading: false\n        }, function () {\n          return resolve();\n        });\n      })) === null || _d === void 0 ? void 0 : _d.catch(function () {\n        _this.setState({\n          loading: false\n        }, function () {\n          return resolve();\n        });\n      });\n    });\n  };\n\n  return SuspenseAsync;\n}(suspense_1.default);\n\nSuspenseAsync.defaultProps = {};\nSuspenseAsync.propTypes = {\n  firstLoading: prop_types_1.default.node,\n  isEmpty: prop_types_1.default.func.isRequired,\n  renderEmpty: prop_types_1.default.func,\n  fetchData: prop_types_1.default.func\n};\nexports.default = SuspenseAsync;"],"names":["require","Object","defineProperty","exports","value","tslib_1","react_1","__importDefault","prop_types_1","antd_1","adhere_ui_conditionalrender_1","suspense_1","SuspenseAsync","_super","_this","apply","this","arguments","state","loading","__extends","prototype","showLoading","renderInner","_a","props","isEmpty","renderEmpty","children","default","createElement","conditional","noMatch","Empty","reset","Promise","resolve","isFirst","isFirstLoading","fetchData","then","catch","_b","_d","setState","_c","call","defaultProps","propTypes","firstLoading","node","func","isRequired"],"mappings":"aAEAA,QAAQ,gDAERA,QAAQ,0CAERA,QAAQ,iCAERC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAGT,IAAIC,QAAUL,QAAQ,SAElBM,QAAUD,QAAQE,gBAAgBP,QAAQ,UAE1CQ,aAAeH,QAAQE,gBAAgBP,QAAQ,eAE/CS,OAAST,QAAQ,QAEjBU,8BAAgCL,QAAQE,gBAAgBP,QAAQ,4CAEhEW,WAAaN,QAAQE,gBAAgBP,QAAQ,eAS7CY,cAEJ,SAAUC,GAGR,SAASD,IACP,IAAIE,EAAmB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAKhE,OAHAF,EAAMI,MAAQ,CACZC,SAAS,GAEJL,EA0ET,OAlFAT,QAAQe,UAAUR,EAAeC,GAWjCD,EAAcS,UAAUC,YAAc,WACpC,OAAON,KAAKE,MAAMC,SAGpBP,EAAcS,UAAUE,YAAc,WACpC,IAAIC,EAAKR,KAAKS,MACVC,EAAUF,EAAGE,QACbC,EAAcH,EAAGG,YACjBC,EAAWJ,EAAGI,SAClB,OAAOtB,QAAQuB,QAAQC,cAAcpB,8BAA8BmB,QAAS,CAC1EE,aAAcL,IACdM,QAAS,WACP,OAAOL,EAAcA,IAAgBrB,QAAQuB,QAAQC,cAAcrB,OAAOwB,MAAO,QAElF,WACD,OAAOL,KAIXhB,EAAcS,UAAUa,MAAQ,WAC9B,IAAIpB,EAAQE,KAEZ,OAAO,IAAImB,QAAQ,SAAUC,GAE3BtB,EAAMuB,SAAU,EAEhBvB,EAAMwB,gBAAiB,EAEvBxB,EAAMyB,YAAYC,KAAK,WACrB,OAAOJ,MACNK,MAAM,WACP,OAAOL,SAKbxB,EAAcS,UAAUkB,UAAY,WAClC,IAAIzB,EAAQE,KAEZ,OAAO,IAAImB,QAAQ,SAAUC,GAC3B,IAAQM,EAAQC,EAEhB,OAAK7B,EAAMW,MAAMc,WASjBzB,EAAM8B,SAAS,CACbzB,SAAS,IASH,QANAwB,EAA2L,QAArLE,EAAmI,QAA7HH,EAA0E,QAApElB,EAAKV,MAAAA,OAAqC,EAASA,EAAMW,aAA0B,IAAPD,OAAgB,EAASA,EAAGe,iBAA8B,IAAPG,OAAgB,EAASA,EAAGI,KAAKtB,UAAwB,IAAPqB,OAAgB,EAASA,EAAGL,KAAK,WAC1O1B,EAAM8B,SAAS,CACbzB,SAAS,GACR,WACD,OAAOiB,eAEY,IAAPO,OAAgB,EAASA,EAAGF,MAAM,WAChD3B,EAAM8B,SAAS,CACbzB,SAAS,GACR,WACD,OAAOiB,UAtBTtB,EAAM8B,SAAS,CACbzB,SAAS,SAGXiB,QAwBCxB,EAnFT,CAoFED,WAAWkB,SAEbjB,cAAcmC,aAAe,GAC7BnC,cAAcoC,UAAY,CACxBC,aAAczC,aAAaqB,QAAQqB,KACnCxB,QAASlB,aAAaqB,QAAQsB,KAAKC,WACnCzB,YAAanB,aAAaqB,QAAQsB,KAClCZ,UAAW/B,aAAaqB,QAAQsB,MAElChD,QAAQ0B,QAAUjB"}