{"version":3,"file":"Suspense.js","sources":["Suspense.js"],"sourcesContent":["\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar antd_1 = require(\"antd\");\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar prop_types_1 = __importDefault(require(\"prop-types\"));\nvar react_1 = __importDefault(require(\"react\"));\nvar adhere_ui_spin_1 = __importDefault(require(\"@baifendian/adhere-ui-spin\"));\nvar selectorPrefix = 'adhere-ui-suspense';\n/**\n * Suspense\n * @class Suspense\n * @classdesc Suspense\n *\n * 需要重写的方法\n * fetchData\n * renderInner\n * showLoading\n */\nvar Suspense = /** @class */function (_super) {\n  __extends(Suspense, _super);\n  function Suspense(props) {\n    var _this = _super.call(this, props) || this;\n    // 第一次\n    _this.isFirst = true;\n    // 第一次加载\n    _this.isFirstLoading = false;\n    return _this;\n  }\n  Suspense.prototype.componentWillReceiveProps = function (nextProps) {\n    if (nextProps.reset) {\n      // 第一次\n      this.isFirst = true;\n      // 第一次加载\n      this.isFirstLoading = false;\n      this.forceUpdate();\n    }\n  };\n  Suspense.prototype.componentDidMount = function () {\n    var _this = this;\n    var _a, _b, _c, _d, _e, _f;\n    if (this.onFirstFetchDataBefore) {\n      (_c = (_b = (_a = this.onFirstFetchDataBefore) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function () {\n        var _a, _b, _c;\n        (_c = (_b = (_a = _this === null || _this === void 0 ? void 0 : _this.fetchData) === null || _a === void 0 ? void 0 : _a.call(_this)) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function (res) {\n          var _a;\n          (_a = _this === null || _this === void 0 ? void 0 : _this.onFirstFetchDataAfter) === null || _a === void 0 ? void 0 : _a.call(_this, res);\n        });\n      });\n    } else {\n      (_f = (_e = (_d = this === null || this === void 0 ? void 0 : this.fetchData) === null || _d === void 0 ? void 0 : _d.call(this)) === null || _e === void 0 ? void 0 : _e.then) === null || _f === void 0 ? void 0 : _f.call(_e, function (res) {\n        var _a;\n        (_a = _this === null || _this === void 0 ? void 0 : _this.onFirstFetchDataAfter) === null || _a === void 0 ? void 0 : _a.call(_this, res);\n      });\n    }\n  };\n  /**\n   * renderNormalFirstLoading\n   * @return React.ReactElement\n   */\n  Suspense.renderNormalFirstLoading = function () {\n    var result = [];\n    for (var i = 0; i < 7; i++) {\n      result.push(react_1.default.createElement(antd_1.Skeleton, {\n        key: i + 1,\n        loading: true,\n        active: true,\n        avatar: true\n      }));\n    }\n    return react_1.default.createElement(\"div\", {\n      className: \"\".concat(selectorPrefix, \"-loading\")\n    }, result);\n  };\n  /**\n   * renderFirstLoading - 渲染第一次Loading的UI\n   * @return {React.Element}\n   */\n  Suspense.prototype.renderFirstLoading = function () {\n    var firstLoading = this.props.firstLoading;\n    if (firstLoading !== undefined && firstLoading !== null) {\n      return firstLoading;\n    }\n    return Suspense.renderNormalFirstLoading();\n  };\n  /**\n   * renderNormal - 渲染正常的UI\n   * @return {React.Element}\n   */\n  Suspense.prototype.renderNormal = function () {\n    var _a, _b;\n    var children = this.renderInner();\n    // 如果自定义了normalLoading则使用renderNormalLoading\n    if (this.props.renderNormalLoading) {\n      return (_b = (_a = this.props).renderNormalLoading) === null || _b === void 0 ? void 0 : _b.call(_a, {\n        children: children,\n        loading: this.showLoading()\n      });\n    }\n    // 缺省的normalLoading\n    return react_1.default.createElement(react_1.default.Fragment, null, react_1.default.createElement(adhere_ui_spin_1.default, {\n      size: \"large\",\n      spinning: this.showLoading()\n    }), children);\n  };\n  /**\n   * renderDispatch\n   * @return {React.Element|*}\n   */\n  Suspense.prototype.renderDispatch = function () {\n    var loading = this.showLoading();\n    if (this.isFirst && !this.isFirstLoading && loading) {\n      this.isFirstLoading = true;\n    }\n    if (this.isFirst && this.isFirstLoading && !loading) {\n      this.isFirst = false;\n      this.isFirstLoading = false;\n    }\n    // console.log('suspense loading', loading);\n    // console.log('suspense isFirst', this.isFirst);\n    // console.log('suspense isFirstLoading', this.isFirstLoading);\n    if (this.isFirst) {\n      return this.renderFirstLoading();\n    }\n    return this.renderNormal();\n  };\n  Suspense.prototype.render = function () {\n    var _a, _b;\n    return react_1.default.createElement(\"div\", {\n      className: (0, classnames_1.default)(selectorPrefix, (_a = this.props.className) !== null && _a !== void 0 ? _a : ''),\n      style: (_b = this.props.style) !== null && _b !== void 0 ? _b : {}\n    }, this.renderDispatch());\n  };\n  Suspense.displayName = 'Suspense';\n  return Suspense;\n}(react_1.default.PureComponent);\nSuspense.defaultProps = {\n  className: '',\n  style: {},\n  reset: false,\n  firstLoading: null\n};\nSuspense.propTypes = {\n  className: prop_types_1.default.string,\n  style: prop_types_1.default.object,\n  reset: prop_types_1.default.bool,\n  firstLoading: prop_types_1.default.node,\n  renderNormalLoading: prop_types_1.default.func\n};\n// 前女友閨密\nexports.default = Suspense;"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","__importDefault","mod","__esModule","default","antd_1","defineProperty","exports","value","require","classnames_1","prop_types_1","react_1","adhere_ui_spin_1","selectorPrefix","Suspense","_super","props","_this","isFirst","isFirstLoading","componentWillReceiveProps","nextProps","reset","forceUpdate","componentDidMount","_e","_f","onFirstFetchDataBefore","_c","_b","_a","then","fetchData","res","onFirstFetchDataAfter","_d","renderNormalFirstLoading","result","i","push","createElement","Skeleton","key","loading","active","avatar","className","concat","renderFirstLoading","firstLoading","renderNormal","children","renderInner","renderNormalLoading","showLoading","Fragment","size","spinning","renderDispatch","render","style","displayName","PureComponent","defaultProps","propTypes","string","object","bool","node","func"],"mappings":"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"}