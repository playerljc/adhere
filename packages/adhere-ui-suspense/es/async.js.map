{"version":3,"file":"Async.js","sources":["Async.js"],"sourcesContent":["import _Empty from \"antd/es/empty\";\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\nimport Suspense from './Suspense';\n/**\n * SuspenseAsync\n * @class\n * @classdesc 调用接口\n */\nvar SuspenseAsync = /** @class */function (_super) {\n  __extends(SuspenseAsync, _super);\n  function SuspenseAsync() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n  SuspenseAsync.prototype.showLoading = function () {\n    return this.state.loading;\n  };\n  SuspenseAsync.prototype.renderInner = function () {\n    var _a = this.props,\n      isEmpty = _a.isEmpty,\n      renderEmpty = _a.renderEmpty,\n      children = _a.children;\n    return /*#__PURE__*/React.createElement(ConditionalRender, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty ? renderEmpty() : /*#__PURE__*/React.createElement(_Empty, null);\n      }\n    }, function () {\n      return children;\n    });\n  };\n  SuspenseAsync.prototype.reset = function () {\n    var _this = this;\n    return new Promise(function (resolve) {\n      // 第一次\n      // console.log('async reset');\n      _this.isFirst = true;\n      // 第一次加载\n      _this.isFirstLoading = false;\n      _this.fetchData().then(function (res) {\n        return resolve(res);\n      }).catch(function () {\n        return resolve(null);\n      });\n    });\n  };\n  SuspenseAsync.prototype.fetchData = function () {\n    var _this = this;\n    return new Promise(function (resolve) {\n      // console.log('suspense fetchData loading', this.showLoading());\n      // console.log('suspense fetchData isFirst', this.isFirst);\n      // console.log('suspense fetchData isFirstLoading', this.isFirstLoading);\n      if (!_this.props.fetchData) {\n        _this.setState({\n          loading: false\n        });\n        resolve(null);\n        return;\n      }\n      _this.setState({\n        loading: true\n      }, function () {\n        var _a, _b, _c, _d;\n        (_d = (_c = (_b = (_a = _this === null || _this === void 0 ? void 0 : _this.props) === null || _a === void 0 ? void 0 : _a.fetchData) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.then(function (res) {\n          _this.setState({\n            loading: false\n          }, function () {\n            return resolve(res);\n          });\n        })) === null || _d === void 0 ? void 0 : _d.catch(function () {\n          _this.setState({\n            loading: false\n          }, function () {\n            return resolve(null);\n          });\n        });\n      });\n    });\n  };\n  return SuspenseAsync;\n}(Suspense);\nSuspenseAsync.defaultProps = {};\nSuspenseAsync.propTypes = {\n  firstLoading: PropTypes.node,\n  isEmpty: PropTypes.func.isRequired,\n  renderEmpty: PropTypes.func,\n  fetchData: PropTypes.func\n};\nexport default SuspenseAsync;"],"names":["_Empty","__extends","this","_extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","PropTypes","React","ConditionalRender","Suspense","SuspenseAsync","_super","_this","apply","arguments","state","loading","showLoading","renderInner","_a","props","isEmpty","renderEmpty","children","createElement","conditional","noMatch","reset","Promise","resolve","isFirst","isFirstLoading","fetchData","then","res","catch","setState","_c","_d","_b","defaultProps","propTypes","firstLoading","node","func","isRequired"],"mappings":"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"}