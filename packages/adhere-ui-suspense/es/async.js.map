{"version":3,"file":"async.js","sources":["async.js"],"sourcesContent":["import _Empty from \"antd/es/empty\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport { __extends } from \"tslib\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\nimport Suspense from './suspense';\n/**\n * SuspenseAsync\n * @class\n * @classdesc 调用接口\n */\n// @ts-ignore\n\nvar SuspenseAsync =\n/** @class */\nfunction (_super) {\n  __extends(SuspenseAsync, _super);\n\n  function SuspenseAsync() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n\n  SuspenseAsync.prototype.showLoading = function () {\n    return this.state.loading;\n  };\n\n  SuspenseAsync.prototype.renderInner = function () {\n    var _a = this.props,\n        isEmpty = _a.isEmpty,\n        renderEmpty = _a.renderEmpty,\n        children = _a.children;\n    return /*#__PURE__*/React.createElement(ConditionalRender, {\n      conditional: !isEmpty(),\n      noMatch: function noMatch() {\n        return renderEmpty ? renderEmpty() : /*#__PURE__*/React.createElement(_Empty, null);\n      }\n    }, function () {\n      return children;\n    });\n  };\n\n  SuspenseAsync.prototype.reset = function () {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      // 第一次\n      _this.isFirst = true; // 第一次加载\n\n      _this.isFirstLoading = false;\n\n      _this.fetchData().then(function () {\n        return resolve();\n      }).catch(function () {\n        return resolve();\n      });\n    });\n  };\n\n  SuspenseAsync.prototype.fetchData = function () {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var _a, _b, _c, _d;\n\n      if (!_this.props.fetchData) {\n        _this.setState({\n          loading: false\n        });\n\n        resolve();\n        return;\n      }\n\n      _this.setState({\n        loading: true\n      });\n\n      return (_d = (_c = (_b = (_a = _this === null || _this === void 0 ? void 0 : _this.props) === null || _a === void 0 ? void 0 : _a.fetchData) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.then(function () {\n        _this.setState({\n          loading: false\n        }, function () {\n          return resolve();\n        });\n      })) === null || _d === void 0 ? void 0 : _d.catch(function () {\n        _this.setState({\n          loading: false\n        }, function () {\n          return resolve();\n        });\n      });\n    });\n  };\n\n  return SuspenseAsync;\n}(Suspense);\n\nSuspenseAsync.defaultProps = {};\nSuspenseAsync.propTypes = {\n  firstLoading: PropTypes.node,\n  isEmpty: PropTypes.func.isRequired,\n  renderEmpty: PropTypes.func,\n  fetchData: PropTypes.func\n};\nexport default SuspenseAsync;"],"names":["_Empty","__extends","React","PropTypes","ConditionalRender","Suspense","SuspenseAsync","_super","_this","apply","this","arguments","state","loading","prototype","showLoading","renderInner","_a","props","isEmpty","renderEmpty","children","createElement","conditional","noMatch","reset","Promise","resolve","isFirst","isFirstLoading","fetchData","then","catch","_b","_d","setState","_c","call","defaultProps","propTypes","firstLoading","node","func","isRequired"],"mappings":"OAAOA,uHAGEC,6BACFC,yBACAC,kCACAC,uEACAC,0BAQP,IAAIC,cAEJ,SAAUC,GAGR,SAASD,IACP,IAAIE,EAAmB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAKhE,OAHAF,EAAMI,MAAQ,CACZC,SAAS,GAEJL,EA0ET,OAlFAP,UAAUK,EAAeC,GAWzBD,EAAcQ,UAAUC,YAAc,WACpC,OAAOL,KAAKE,MAAMC,SAGpBP,EAAcQ,UAAUE,YAAc,WACpC,IAAIC,EAAKP,KAAKQ,MACVC,EAAUF,EAAGE,QACbC,EAAcH,EAAGG,YACjBC,EAAWJ,EAAGI,SAClB,OAAoBnB,MAAMoB,cAAclB,kBAAmB,CACzDmB,aAAcJ,IACdK,QAAS,WACP,OAAOJ,EAAcA,IAA6BlB,MAAMoB,cAActB,OAAQ,QAE/E,WACD,OAAOqB,KAIXf,EAAcQ,UAAUW,MAAQ,WAC9B,IAAIjB,EAAQE,KAEZ,OAAO,IAAIgB,QAAQ,SAAUC,GAE3BnB,EAAMoB,SAAU,EAEhBpB,EAAMqB,gBAAiB,EAEvBrB,EAAMsB,YAAYC,KAAK,WACrB,OAAOJ,MACNK,MAAM,WACP,OAAOL,SAKbrB,EAAcQ,UAAUgB,UAAY,WAClC,IAAItB,EAAQE,KAEZ,OAAO,IAAIgB,QAAQ,SAAUC,GAC3B,IAAQM,EAAQC,EAEhB,OAAK1B,EAAMU,MAAMY,WASjBtB,EAAM2B,SAAS,CACbtB,SAAS,IASH,QANAqB,EAA2L,QAArLE,EAAmI,QAA7HH,EAA0E,QAApEhB,EAAKT,MAAAA,OAAqC,EAASA,EAAMU,aAA0B,IAAPD,OAAgB,EAASA,EAAGa,iBAA8B,IAAPG,OAAgB,EAASA,EAAGI,KAAKpB,UAAwB,IAAPmB,OAAgB,EAASA,EAAGL,KAAK,WAC1OvB,EAAM2B,SAAS,CACbtB,SAAS,GACR,WACD,OAAOc,eAEY,IAAPO,OAAgB,EAASA,EAAGF,MAAM,WAChDxB,EAAM2B,SAAS,CACbtB,SAAS,GACR,WACD,OAAOc,UAtBTnB,EAAM2B,SAAS,CACbtB,SAAS,SAGXc,QAwBCrB,EAnFT,CAoFED,UAEFC,cAAcgC,aAAe,GAC7BhC,cAAciC,UAAY,CACxBC,aAAcrC,UAAUsC,KACxBtB,QAAShB,UAAUuC,KAAKC,WACxBvB,YAAajB,UAAUuC,KACvBZ,UAAW3B,UAAUuC,qBAERpC"}