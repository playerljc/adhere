{"version":3,"file":"async.js","sources":["async.js"],"sourcesContent":["import { __extends } from \"tslib\";\r\nimport { Empty } from 'antd';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport ConditionalRender from '@baifendian/adhere-ui-conditionalrender';\r\nimport Suspense from './suspense';\r\n/**\r\n * SuspenseAsync\r\n * @class\r\n * @classdesc 调用接口\r\n */\r\nvar SuspenseAsync = /** @class */ (function (_super) {\r\n    __extends(SuspenseAsync, _super);\r\n    function SuspenseAsync() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = {\r\n            loading: false,\r\n        };\r\n        return _this;\r\n    }\r\n    SuspenseAsync.prototype.showLoading = function () {\r\n        return this.state.loading;\r\n    };\r\n    SuspenseAsync.prototype.renderInner = function () {\r\n        var _a = this.props, isEmpty = _a.isEmpty, renderEmpty = _a.renderEmpty, children = _a.children;\r\n        return (React.createElement(ConditionalRender, { conditional: !isEmpty(), noMatch: function () { return (renderEmpty ? renderEmpty() : React.createElement(Empty, null)); } }, function () { return children; }));\r\n    };\r\n    SuspenseAsync.prototype.reset = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            // 第一次\r\n            _this.isFirst = true;\r\n            // 第一次加载\r\n            _this.isFirstLoading = false;\r\n            _this.fetchData()\r\n                .then(function () { return resolve(); })\r\n                .catch(function () { return resolve(); });\r\n        });\r\n    };\r\n    SuspenseAsync.prototype.fetchData = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            var _a, _b, _c, _d;\r\n            if (!_this.props.fetchData) {\r\n                _this.setState({\r\n                    loading: false,\r\n                });\r\n                resolve();\r\n                return;\r\n            }\r\n            _this.setState({\r\n                loading: true,\r\n            });\r\n            return (_d = (_c = (_b = (_a = _this === null || _this === void 0 ? void 0 : _this.props) === null || _a === void 0 ? void 0 : _a.fetchData) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.then(function () {\r\n                _this.setState({\r\n                    loading: false,\r\n                }, function () { return resolve(); });\r\n            })) === null || _d === void 0 ? void 0 : _d.catch(function () {\r\n                _this.setState({\r\n                    loading: false,\r\n                }, function () { return resolve(); });\r\n            });\r\n        });\r\n    };\r\n    return SuspenseAsync;\r\n}(Suspense));\r\nSuspenseAsync.defaultProps = {};\r\nSuspenseAsync.propTypes = {\r\n    firstLoading: PropTypes.node,\r\n    isEmpty: PropTypes.func.isRequired,\r\n    renderEmpty: PropTypes.func,\r\n    fetchData: PropTypes.func,\r\n};\r\nexport default SuspenseAsync;\r\n//# sourceMappingURL=async.js.map"],"names":["__extends","Empty","PropTypes","React","ConditionalRender","Suspense","SuspenseAsync","_super","_this","apply","this","arguments","state","loading","prototype","showLoading","renderInner","_a","props","isEmpty","renderEmpty","children","createElement","conditional","noMatch","reset","Promise","resolve","isFirst","isFirstLoading","fetchData","then","catch","_c","_d","setState","_b","call","defaultProps","propTypes","firstLoading","node","func","isRequired"],"mappings":"OAASA,SAAwB,KAAP,eACjBC,KAAmB,KAAN,cACfC,cAAe,oBACfC,UAAW,eACXC,sBAAuB,iDACvBC,aAAc,aAMrB,IAAIC,cAA+B,SAAUC,GAEzC,SAASD,IACL,IAAIE,EAAmB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,SAAS,GAAKD,KAIhE,OAHAF,EAAMI,MAAQ,CACVC,QAAS,CAAA,CACb,EACOL,CACX,CA6CA,OApDAR,UAAUM,EAAeC,CAAM,EAQ/BD,EAAcQ,UAAUC,YAAc,WAClC,OAAOL,KAAKE,MAAMC,OACtB,EACAP,EAAcQ,UAAUE,YAAc,WAClC,IAAIC,EAAKP,KAAKQ,MAAOC,EAAUF,EAAGE,QAASC,EAAcH,EAAGG,YAAaC,EAAWJ,EAAGI,SACvF,OAAQlB,MAAMmB,cAAclB,kBAAmB,CAAEmB,YAAa,CAACJ,EAAQ,EAAGK,QAAS,WAAc,OAAQJ,EAAcA,EAAY,EAAIjB,MAAMmB,cAAcrB,MAAO,IAAI,CAAI,CAAE,EAAG,WAAc,OAAOoB,CAAU,CAAE,CACpN,EACAf,EAAcQ,UAAUW,MAAQ,WAC5B,IAAIjB,EAAQE,KACZ,OAAO,IAAIgB,QAAQ,SAAUC,GAEzBnB,EAAMoB,QAAU,CAAA,EAEhBpB,EAAMqB,eAAiB,CAAA,EACvBrB,EAAMsB,UAAU,EACXC,KAAK,WAAc,OAAOJ,EAAQ,CAAG,CAAC,EACtCK,MAAM,WAAc,OAAOL,EAAQ,CAAG,CAAC,CAChD,CAAC,CACL,EACArB,EAAcQ,UAAUgB,UAAY,WAChC,IAAItB,EAAQE,KACZ,OAAO,IAAIgB,QAAQ,SAAUC,GACzB,IAAYM,EAAIC,EAChB,GAAK1B,EAAMU,MAAMY,UAUjB,OAHAtB,EAAM2B,SAAS,CACXtB,QAAS,CAAA,CACb,CAAC,EACM,OAACqB,EAAK,OAACD,EAAK,OAACG,EAAK,OAACnB,EAAKT,MAAAA,EAAqC,KAAA,EAASA,EAAMU,OAAmC,KAAA,EAASD,EAAGa,WAAuC,KAAA,EAASM,EAAGC,KAAKpB,CAAE,GAA+B,KAAA,EAASgB,EAAGF,KAAK,WACxOvB,EAAM2B,SAAS,CACXtB,QAAS,CAAA,CACb,EAAG,WAAc,OAAOc,EAAQ,CAAG,CAAC,CACxC,CAAC,GAA+B,KAAA,EAASO,EAAGF,MAAM,WAC9CxB,EAAM2B,SAAS,CACXtB,QAAS,CAAA,CACb,EAAG,WAAc,OAAOc,EAAQ,CAAG,CAAC,CACxC,CAAC,EAjBGnB,EAAM2B,SAAS,CACXtB,QAAS,CAAA,CACb,CAAC,EACDc,EAAQ,CAehB,CAAC,CACL,EACOrB,CACX,EAAED,QAAS,EACXC,cAAcgC,aAAe,GAC7BhC,cAAciC,UAAY,CACtBC,aAActC,UAAUuC,KACxBtB,QAASjB,UAAUwC,KAAKC,WACxBvB,YAAalB,UAAUwC,KACvBZ,UAAW5B,UAAUwC,IACzB,iBACepC"}